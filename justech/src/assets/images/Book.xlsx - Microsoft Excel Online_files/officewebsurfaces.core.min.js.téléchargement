/*! For license information please see officewebsurfaces.core.min.js.LICENSE.txt */
var OfficeWebSurfaces=function(e){function t(t){for(var n,i,o=t[0],s=t[1],a=0,c=[];a<o.length;a++)i=o[a],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&c.push(r[i][0]),r[i]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);for(u&&u(t);c.length;)c.shift()()}var n={},r={0:0};function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,i){n=r[e]=[t,i]}));t.push(n[2]=o);var s,a=document.createElement("script");a.charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.src=function(e){return i.p+""+({1:"officewebsurfaces.fabric"}[e]||e)+".min.js"}(e);var u=new Error;s=function(t){a.onerror=a.onload=null,clearTimeout(c);var n=r[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+i+": "+o+")",u.name="ChunkLoadError",u.type=i,u.request=o,n[1](u)}r[e]=void 0}};var c=setTimeout((function(){s({type:"timeout",target:a})}),12e4);a.onerror=a.onload=s,document.head.appendChild(a)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var o=window.webpackJsonpOfficeWebSurfaces=window.webpackJsonpOfficeWebSurfaces||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var a=0;a<o.length;a++)t(o[a]);var u=s;return i(i.s=3)}([function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"g",(function(){return l}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function s(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function a(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}function u(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))}function c(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function l(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}},,function(e,t,n){var r=n(6),i=n(7);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[o+a]=s[a];return t||i(s)}},function(e,t,n){e.exports=n(8)},function(e,t){!function(){if("function"!=typeof window.CustomEvent){var e=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0],r=e[1],i=void 0===r?{}:r,o=i.bubbles,s=void 0!==o&&o,a=i.cancelable,u=void 0!==a&&a,c=i.detail,l=void 0===c?null:c,d=document.createEvent("CustomEvent");return d.initCustomEvent(n,s,u,l),d};e.prototype=Event.prototype,window.CustomEvent=e}}()},function(e,t,n){"use strict";String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,t){var n=!t||t<0?0:+t;return this.substring(n,n+e.length)===e}}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=t;return(void 0===n||n>this.length)&&(n=this.length),this.substring(n-e.length,n)===e})},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},function(e,t,n){"use strict";n.r(t),n.d(t,"GetSurfaceContainerId",(function(){return ee})),n.d(t,"Initialize",(function(){return Vn})),n.d(t,"RemoveSurface",(function(){return dr})),n.d(t,"RenderSurface",(function(){return Jr}));var r={};n.r(r),n.d(r,"_Utf8_GetBytes",(function(){return Dt})),n.d(r,"_Base64_GetString",(function(){return At})),n.d(r,"_Varint_GetBytes",(function(){return Bt})),n.d(r,"_Varint64_GetBytes",(function(){return Nt})),n.d(r,"_Double_GetBytes",(function(){return xt})),n.d(r,"_Zigzag_EncodeZigzag32",(function(){return Pt})),n.d(r,"_Zigzag_EncodeZigzag64",(function(){return Ft}));var i={};n.r(i),n.d(i,"MemoryStream",(function(){return Mt}));n(4),n(5);var o,s=n(0);function a(){try{return window&&window.navigator?window.navigator.userAgent:""}catch(e){return""}}!function(e){e[e.Unknown=0]="Unknown",e[e.Windows=1]="Windows",e[e.Mac=2]="Mac",e[e.Unix=3]="Unix",e[e.Linux=4]="Linux"}(o||(o={}));var u,c=(-1===(u=function(){var e=a(),t=-1,n=e.indexOf("MSIE ");if(n>0&&(t=parseInt(e.substring(n+5,e.indexOf(".",n)),10)),e.indexOf("Trident/")>0){var r=e.indexOf("rv:");t=parseInt(e.substring(r+3,e.indexOf(".",r)),10)}return t}())&&(u=function(){var e=a(),t=-1;if(e.indexOf("Trident/")>0){var n=e.indexOf("rv:");t=parseInt(e.substring(n+3,e.indexOf(".",n)),10)}return t}()),u>0),l=!1;function d(){return l&&null!==console&&null!==console.log}var f,h,p,v,g,m,y,_=function(e){if(!e||!Object.assign)return e;var t={};return Object.keys(e).forEach((function(n){"object"==typeof e[n]?Object.assign(t,_(e[n])):t[n]=e[n]})),t};function S(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];d()&&(c?console.log(t,_(n)):console.log("%c%s",e,t,_(n)))}function b(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];S.apply(void 0,Object(s.g)(["color:red",e],t))}function T(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];S.apply(void 0,Object(s.g)(["color:blue",e],t))}function w(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];d()&&(window&&!("Firebug"in window)?console.assert.apply(console,Object(s.g)([e,t],n)):e||b.apply(void 0,Object(s.g)(["Assertion failure: "+t],n)))}function E(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];d()&&w(e,t,n)}!function(e){e[e.None=0]="None",e[e.Trace=1]="Trace",e[e.Info=2]="Info",e[e.Warning=3]="Warning",e[e.Error=4]="Error"}(f||(f={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(h||(h={})),function(e){e[e.NotSet=0]="NotSet",e[e.SoftwareSetup=1]="SoftwareSetup",e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance",e[e.DeviceConfiguration=8]="DeviceConfiguration",e[e.InkingTypingSpeech=16]="InkingTypingSpeech"}(p||(p={})),function(e){e[e.ReservedDoNotUse=0]="ReservedDoNotUse",e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.NecessaryServiceDataEvent=110]="NecessaryServiceDataEvent",e[e.AlwaysOnNecessaryServiceDataEvent=120]="AlwaysOnNecessaryServiceDataEvent"}(v||(v={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(g||(g={})),function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"}(m||(m={})),function(e){e[e.None=0]="None",e[e.Test=1]="Test",e[e.Dev=2]="Dev",e[e.Edog=3]="Edog",e[e.Int=4]="Int",e[e.Prod=5]="Prod"}(y||(y={}));var I=function(e){switch(e||"production"){case"development":return y.Dev;case"test":return y.Test;default:return y.Prod}},C=function(e,t){var n=t||"production";E(n,"Invalid environment!");var r=e||"";E(r,"Invalid deployment url!");var i=r.toLowerCase(),o=0===i.indexOf("http");y.None;return o?i.indexOf("//localhost:")>=0||i.indexOf("//127.0.0.1:")>=0?y.Dev:i.indexOf("/int/")>=0?y.Int:i.indexOf("/edog/")>=0?y.Edog:y.Prod:"development"===n?y.Dev:"test"===n?y.Test:y.Prod},k=new function(){var e=this;this.config=null,this.setConfiguration=function(t){e.config=t},this.getConfiguration=function(){return e.config},this.isProduction=function(){return I()===y.Prod},this.isTest=function(){return I()===y.Test},this.isDevelopment=function(){return I()===y.Dev}},O=n(2),D=n.n(O),A=function(){return D()().toString()},B=function(e){return Object(s.b)(void 0,void 0,void 0,(function(){return Object(s.e)(this,(function(t){return[2,new Promise((function(t){setTimeout(t,e)}))]}))}))},N=Object.keys,x=new Date,P=A(),F=function(e){return e===Object(e)},M=x.toISOString();function L(e){return{correlationId:A(),currentTime:(new Date).toISOString(),environment:e?y[e.Environment]:y[y.None],sessionId:e&&e.CustomSessionId?e.CustomSessionId:P,sessionStartTime:M}}function R(){var e=-1,t=window&&window.performance;if(t){var n=t.timeOrigin||t.timing&&t.timing.navigationStart;e=n&&Date.now()-n}return e}function U(){return{windowHeight:window?window.innerHeight:void 0,windowWidth:window?window.innerWidth:void 0}}function W(e,t,n,r){E(e!==f.None,"Invalid logLevel"),w(t>0,"Invalid tagId"),E(n,"Invalid message"),E(r,"Invalid messageDetails");var i=r&&r.length>0?r.map((function(e){return"string"==typeof e?e:V(e)})):void 0,o="string"==typeof n?{eventFlags:void 0,message:n}:n;return{eventFlags:o.eventFlags,eventTagId:t,logLevel:e,message:o.message,messageDetails:i}}var j=function(e,t){e&&Object.keys(e).forEach((function(n){var r=e[n];null!=r&&(F(r)?t(n,JSON.stringify(r)):("string"==typeof r||function(e){return"boolean"==typeof e}(r)||function(e){return"number"==typeof e}(r))&&t(n,r))}))};function H(e,t){E(t,"Invalid callback"),E(e,"Invalid logEntry"),j(e.metadata,t),j(e.messageData,t),j(e.eventActionData,t),j(e.customData,t),j(e.browserData,t)}var q=["name","number","message","description"];function V(e){return JSON.stringify(e,(function(e,t){if(t instanceof Error){var n={name:"",message:""};return Object.getOwnPropertyNames(t).forEach((function(e){var r=e;-1!==q.indexOf(e.toLowerCase())&&(n[r]=t[r])})),n}return t}))}var z=function(e,t){return void 0===t&&(t={dataCategories:p.ProductServicePerformance}),Object(s.a)(Object(s.a)({},t),e)},Q=new function(e,t,n){var r=this;void 0===n&&(n=f.Info),this.logSinks=e,this.configuration=t,this.logLevel=n,this.assert=w,this.debug=E,this.clearSinks=function(){r.logSinks=[]},this.setLogLevel=function(e){return r.logLevel=e},this.getLogLevel=function(){return r.logLevel},this.getConfiguration=function(){return r.configuration},this.setConfiguration=function(e){return r.configuration=e},this.addSink=function(e){if(e){var t=r.logSinks.filter((function(t){return t.name()===e.name()}));E(!t||0===t.length,"Sink already exists",e,r.logSinks),t&&t.length>0||r.logSinks.push(e)}else w(e,"Invalid logSink!")},this.removeSinks=function(e){r.logSinks.filter((function(t){return t.name()===e})).forEach((function(e){var t=r.logSinks.indexOf(e);r.logSinks.splice(t,1)}))},this.reserve=function(e){return e},this.trace=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=r.createMessageLogEntry(W(f.Trace,e,t,n));r.writeEntry(o)},this.info=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=r.createMessageLogEntry(W(f.Info,e,t,n));r.writeEntry(o)},this.warn=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=r.createMessageLogEntry(W(f.Warning,e,t,n));r.writeEntry(o)},this.error=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=r.createMessageLogEntry(W(f.Error,e,t,n));r.writeEntry(o)},this.local=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=r.createMessageLogEntry(W(f.Info,68769,e,t));r.writeEntry(i,!0)},this.localWarn=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=r.createMessageLogEntry(W(f.Warning,68769,e,t));r.writeEntry(i,!0)},this.instrument=function(e,t,n,i){return void 0===i&&(i={}),Object(s.b)(r,void 0,void 0,(function(){var r,o,a,u,c,l,d=this,f=i.logError,h=void 0===f||f,p=i.onEndEvent,v=i.rethrow,g=void 0===v||v,m=Object(s.f)(i,["logError","onEndEvent","rethrow"]);return Object(s.e)(this,(function(i){switch(i.label){case 0:r=this.beginEvent(e,t,m),m.payloadData||(m.payloadData={}),o=m.payloadData,a=function(){d.endEvent(r,o),p&&p(o.resultType)},u=null,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,n(o)];case 2:return u=i.sent(),o.resultType=o.resultType||"None",a(),[3,4];case 3:if(c=i.sent(),l=c,h&&this.error(595985052,"Instrumentation error handler",e,t,l),o.resultType="Failure",!o.resultInfo&&h&&(o.resultInfo=V(l)),!o.responseCode&&l.code&&(o.responseCode=l.code),a(),g)throw l;return[3,4];case 4:return[2,u]}}))}))},this.event=function(e,t,n){void 0===n&&(n={});var i=r.beginEvent(e,t,n);r.endEvent(i,void 0,!1)},this.userActionEvent=function(e,t,n){var i=void 0===n?{}:n,o=i.customData,a=i.eventFlags,u=i.payloadData;return r.event(e,t,{customData:o,eventFlags:Object(s.a)({dataCategories:p.ProductServiceUsage},a),payloadData:u})},this.beginEvent=function(e,t,n){void 0===n&&(n={}),r.assert(0!==e,"Invalid eventTagId"),r.debug(t,"Invalid eventActionType");var i={};return r.safeEnumerateSinks((function(e){var n=e.beginEvent(t);n&&(i[e.name()]=n)})),{eventActionType:t,eventData:n,eventEnded:!1,eventStartTime:Date.now(),eventTagId:e,sinkContexts:i}},this.beginUserActionEvent=function(e,t,n){var i=void 0===n?{}:n,o=i.customData,a=i.eventFlags,u=i.payloadData;return r.beginEvent(e,t,{customData:o,eventFlags:Object(s.a)({dataCategories:p.ProductServiceUsage},a),payloadData:u})},this.endEvent=function(e,t,n){if(void 0===n&&(n=!0),r.debug(e,"Invalid beginEventData"),r.assert(!e.eventEnded,"Event already ended - "+e.eventActionType),r.debug(e.eventData,"Invalid eventData",e),r.debug(e.eventStartTime,"Invalid eventStartTime",e),r.debug(e.eventActionType,"Invalid eventActionType",e),e&&!e.eventEnded){if(n){var i=e.eventData,o=e.eventStartTime,a=Date.now();i.payloadData=Object(s.a)({responseTime:a-o},i.payloadData)}r.configuration&&r.configuration.CustomMetadata&&(e.eventData.customData=Object(s.a)(Object(s.a)({},r.configuration.CustomMetadata),e.eventData.customData)),e.eventData.payloadData=Object(s.a)(Object(s.a)({},e.eventData.payloadData),t),r.sendEvent(e)}},this.createEventLogEntry=function(e){var t=e.eventTagId,n=e.eventActionType,i=e.eventData,o=i.customData,a=i.eventFlags,u=i.payloadData;return{customData:o,eventActionData:Object(s.a)({eventActionType:n,eventTagId:t},u),eventFlags:z(a),metadata:L(r.configuration)}},this.createMessageLogEntry=function(e){var t=e.eventFlags,n=Object(s.f)(e,["eventFlags"]);return{eventFlags:z(t),messageData:n,metadata:L(r.configuration)}},this.writeEntry=function(e,t){void 0===t&&(t=!1),e.messageData&&e.messageData.logLevel<r.logLevel||r.safeEnumerateSinks((function(t){t.writeEntry(e)}),t)},this.sendEvent=function(e){var t=r.createEventLogEntry(e),n=e.sinkContexts;r.safeEnumerateSinks((function(e){e.endEvent(t,n[e.name()])})),e.eventEnded=!0},this.safeEnumerateSinks=function(e,t){if(void 0===t&&(t=!1),E(e&&r.logSinks,"Invalid input",e,r.logSinks),e&&r.logSinks)for(var n=0,i=r.logSinks;n<i.length;n++){var o=i[n];try{(!t||o.isLocal&&o.isLocal())&&e(o)}catch(t){E(!1,"Error with callback",t,o,e)}}}}([]),G=Date.now(),K={},Z=!1,J="",X=function(){return G},Y=function(){return K},$=function(){return Z},ee=function(){return J},te=function(){var e=Y();return e.fabricDependencies||(e.fabricDependencies=function(){if("React"in window&&"ReactDOM"in window&&"Fabric"in window){var e=window.React,t=e.createElement,n=e.useEffect,r=e.useRef,i=e.useState,o=window.ReactDOM,s=o.render,a=o.unmountComponentAtNode,u=window.Fabric;return{Coachmark:u.Coachmark,Customizer:u.Customizer,DirectionalHint:u.DirectionalHint,TeachingBubble:u.TeachingBubble,TeachingBubbleContent:u.TeachingBubbleContent,createElement:t,createTheme:u.createTheme,registerIcons:u.registerIcons,render:s,styled:u.styled,unmountComponentAtNode:a,useEffect:n,useRef:r,useState:i}}}()),e.fabricDependencies},ne=function(){return Object(s.b)(void 0,void 0,void 0,(function(){var e,t,r,i,o;return Object(s.e)(this,(function(s){switch(s.label){case 0:if(e=Y(),te())return[3,4];s.label=1;case 1:return s.trys.push([1,3,,4]),n.p=null!==(o=null!==(i=e.fabricPackagePath)&&void 0!==i?i:void 0)&&void 0!==o?o:function(){for(var e=document.getElementsByTagName("script"),t=0;t<e.length;t++){var n=/(.*\/)officewebsurfaces.core(\.min)?\.js/.exec(e[t].src);if(n)return n[1]}return""}(),n.p.endsWith("/")||(n.p+="/"),t=e,[4,n.e(1).then(n.bind(null,36))];case 2:return t.fabricDependencies=s.sent().fabricDependencies,[3,4];case 3:throw r=s.sent(),Q.error(593359773,"failed to load fabric dependencies",r),r;case 4:return[2,e.fabricDependencies]}}))}))},re=function(){var e=this;this.name=function(){return"ConsoleLogSink"},this.beginEvent=function(){return null},this.isLocal=function(){return!0},this.endEvent=function(t,n){E(!n,"Expected context to be null for sink",e.name()),e.writeEntry(t)},this.writeEntry=function(e){if(e.messageData){var t=function(e){switch(e){case f.Info:return"color:green";case f.Warning:return"color:Orange";case f.Error:return"color:red";default:b("Unknown LogLevel: ",e)}return"color:black"}(e.messageData.logLevel),n=e.messageData;S(t,"Log."+f[e.messageData.logLevel],"0x"+n.eventTagId.toString(16),n.message,n.messageDetails)}e.eventActionData&&T("Log.Event:"+e.eventActionData.eventActionType,{tagId:"0x"+e.eventActionData.eventTagId.toString(16)},e.eventActionData,e.customData)}};function ie(e){var t="";if(void 0!==e){var n=document.querySelector('script[src^="'+e+'"]');n&&(t=n.getAttribute("src"))}return t||void 0}var oe,se,ae,ue,ce,le,de=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e.prototype.getListenerCount=function(){return this._listeners.length},e}(),fe=new de;function he(e,t,n){fe.fireEvent({level:e,category:t,message:n})}function pe(e,t){return le.validateInt(t),{name:e,dataType:ce.Int64,value:t}}function ve(e,t){return{name:e,dataType:ce.String,value:t}}!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(oe||(oe={})),function(e){e[e.Core=0]="Core",e[e.Sink=1]="Sink",e[e.Transport=2]="Transport"}(se||(se={})),function(e){e[e.Aria=0]="Aria",e[e.Nexus=1]="Nexus"}(ae||(ae={})),function(e){var t={},n={},r={};function i(e){if("object"!=typeof e)throw new Error("tokenTree must be an object");r=function e(t,n){if("object"!=typeof n)return n;for(var r=0,i=Object.keys(n);r<i.length;r++){var o=i[r];o in t&&(t[o],1)?t[o]=e(t[o],n[o]):t[o]=n[o]}return t}(r,e)}function o(e){if(t[e])return t[e];var n=a(e,ae.Aria);return"string"==typeof n?(t[e]=n,n):void 0}function s(e){if(n[e])return n[e];var t=a(e,ae.Nexus);return"number"==typeof t?(n[e]=t,t):void 0}function a(e,t){var n=e.split("."),i=r,o=void 0;if(i){for(var s=0;s<n.length-1;s++)i[n[s]]&&(i=i[n[s]],t===ae.Aria&&"string"==typeof i.ariaTenantToken?o=i.ariaTenantToken:t===ae.Nexus&&"number"==typeof i.nexusTenantToken&&(o=i.nexusTenantToken));return o}}e.setTenantToken=function(e,t,n){var r=e.split(".");if(r.length<2||"Office"!==r[0])he(oe.Error,se.Core,(function(){return"Invalid namespace: "+e}));else{var o=Object.create(Object.prototype);t&&(o.ariaTenantToken=t),n&&(o.nexusTenantToken=n);var s,a=o;for(s=r.length-1;s>=0;--s){var u=Object.create(Object.prototype);u[r[s]]=a,a=u}i(a)}},e.setTenantTokens=i,e.getTenantTokens=function(e){var t=o(e),n=s(e);if(!n||!t)throw new Error("Could not find tenant token");return{ariaTenantToken:t,nexusTenantToken:n}},e.getAriaTenantToken=o,e.getNexusTenantToken=s,e.clear=function(){t={},n={},r={}}}(ue||(ue={})),function(e){e[e.String=0]="String",e[e.Boolean=1]="Boolean",e[e.Int64=2]="Int64",e[e.Double=3]="Double"}(ce||(ce={})),function(e){var t=/^[A-Z][a-zA-Z0-9]*$/,n=/^[a-zA-Z0-9_\.]*$/;function r(e){return void 0!==e&&n.test(e)}function i(e){if(!((t=e.name)&&r(t)&&t.length+5<100))throw new Error("Invalid dataField name");var t;e.dataType===ce.Int64&&o(e.value)}function o(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>9007199254740991)throw{message:"Invalid integer "+JSON.stringify(e)}}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>98)return!1;var n=e.split("."),r=n[n.length-1];return function(e){return!!e&&e.length>=3&&"Office"===e[0]}(n)&&(i=r,void 0!==i&&t.test(i));var i}(e.eventName))throw new Error("Invalid eventName");if(e.eventContract&&!r(e.eventContract.name))throw new Error("Invalid eventContract");if(null!=e.dataFields)for(var n=0;n<e.dataFields.length;n++)i(e.dataFields[n])},e.validateInt=o}(le||(le={}));var ge,me=function(){function e(e,t){var n,r;this.onSendEvent=new de,this.telemetryEnabled=!0,this.queriedForTelemetryEnabled=!1,this.persistentDataFields=[],e?(this.onSendEvent=e.onSendEvent,(n=this.persistentDataFields).push.apply(n,e.persistentDataFields)):this.persistentDataFields.push(ve("OTelJS.Version","3.1.4")),t&&(r=this.persistentDataFields).push.apply(r,t)}return e.prototype.sendTelemetryEvent=function(e){try{if(!this.isTelemetryEnabled())return;if(0===this.onSendEvent.getListenerCount())return void he(oe.Warning,se.Core,(function(){return"No telemetry sinks are attached."}));var t=this.cloneEvent(e);this.processTelemetryEvent(t),this.onSendEvent.fireEvent(t)}catch(e){var n;n=e instanceof Error?e.message:JSON.stringify(e),he(oe.Error,se.Core,(function(){return n}))}},e.prototype.processTelemetryEvent=function(e){var t;e.telemetryProperties||(e.telemetryProperties=ue.getTenantTokens(e.eventName)),(t=e.dataFields).push.apply(t,this.persistentDataFields),le.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.onSendEvent.addListener((function(t){return e.sendTelemetryEvent(t)}))},e.prototype.setTenantToken=function(e,t,n){ue.setTenantToken(e,t,n)},e.prototype.setTenantTokens=function(e){ue.setTenantTokens(e)},e.prototype.setIsTelemetryEnabled_TestOnly=function(e){this.telemetryEnabled=e,this.queriedForTelemetryEnabled=!0},e.prototype.cloneEvent=function(e){var t={eventName:e.eventName,eventFlags:e.eventFlags};return e.telemetryProperties&&(t.telemetryProperties={ariaTenantToken:e.telemetryProperties.ariaTenantToken,nexusTenantToken:e.telemetryProperties.nexusTenantToken}),e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t.dataFields=e.dataFields?e.dataFields.slice():[],t},e.prototype.isTelemetryEnabled=function(){return this.queriedForTelemetryEnabled||(this.telemetryEnabled=this.isTelemetryEnabledInternal(),this.queriedForTelemetryEnabled=!0),this.telemetryEnabled},e.prototype.isTelemetryEnabledInternal=function(){return"undefined"==typeof OSF||void 0!==OSF.AppTelemetry&&void 0!==OSF.AppTelemetry.enableTelemetry&&!1!==OSF.AppTelemetry.enableTelemetry||(he(oe.Warning,se.Core,(function(){return"AppTelemetry is disabled for this platform."})),!1)},e}();!function(e){var t,n=0;e.getNext=function(){return void 0===t&&(t=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],n=0;n<22;n++)t.push(e.charAt(Math.floor(Math.random()*e.length)));return t.join("")}()),new r(t,++n)},e.getNextChild=function(e){return new r(e.getString(),++e.nextChild)};var r=function(){function e(e,t){this.base=e,this.id=t,this.nextChild=0}return e.prototype.getString=function(){return this.base+"."+this.id},e}();e.CV=r}(ge||(ge={}));var ye=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,a)}u((r=r.apply(e,t||[])).next())}))},_e=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Se=function(){return 1e3*Date.now()};"object"==typeof window.performance&&"now"in window.performance&&(Se=function(){return 1e3*Math.floor(window.performance.now())});var be,Te,we,Ee,Ie,Ce,ke,Oe,De=function(){function e(e,t,n){this._optionalEventFlags={},this._ended=!1,this._telemetryLogger=e,this._activityName=t,this._cv=n?ge.getNextChild(n._cv):ge.getNext(),this._dataFields=[],this._success=void 0,this._startTime=Se()}return e.createNew=function(t,n){return new e(t,n)},e.prototype.createChildActivity=function(t){return new e(this._telemetryLogger,t,this)},e.prototype.setEventFlags=function(e){this._optionalEventFlags=e},e.prototype.addDataField=function(e){this._dataFields.push(e)},e.prototype.addDataFields=function(e){var t;(t=this._dataFields).push.apply(t,e)},e.prototype.setSuccess=function(e){this._success=e},e.prototype.setResult=function(e,t,n){this._result={code:e,type:t,tag:n}},e.prototype.endNow=function(){if(!this._ended){void 0===this._success&&void 0===this._result&&he(oe.Warning,se.Core,(function(){return"Activity does not have success or result set"}));var e=Se()-this._startTime;this._ended=!0;var t={duration:e,count:1,aggMode:0,cV:this._cv.getString(),success:this._success,result:this._result};return this._telemetryLogger.sendActivity(this._activityName,t,this._dataFields,this._optionalEventFlags)}he(oe.Error,se.Core,(function(){return"Activity has already ended"}))},e.prototype.executeAsync=function(e){return ye(this,void 0,void 0,(function(){var t=this;return _e(this,(function(n){return[2,e(this).then((function(e){return t.endNow(),e})).catch((function(e){throw t.endNow(),e}))]}))}))},e.prototype.executeSync=function(e){try{var t=e(this);return this.endNow(),t}catch(e){throw this.endNow(),e}},e.prototype.executeChildActivityAsync=function(e,t){return ye(this,void 0,void 0,(function(){return _e(this,(function(n){return[2,this.createChildActivity(e).executeAsync(t)]}))}))},e.prototype.executeChildActivitySync=function(e,t){return this.createChildActivity(e).executeSync(t)},e}();function Ae(e,t,n){e.push(ve("zC."+t,n))}!function(e){e.getFields=function(e,t){var n=[];return n.push(ve(e+".ErrorGroup",t.errorGroup)),n.push(pe(e+".Tag",t.tag)),void 0!==t.code&&n.push(pe(e+".Code",t.code)),void 0!==t.id&&n.push(pe(e+".Id",t.id)),void 0!==t.count&&n.push(pe(e+".Count",t.count)),Ae(n,e,"Office.System.Error"),n}}(be||(be={})),(Te||(Te={})).getFields=function(e,t){var n=[];return n.push(pe(e+".Code",t.code)),void 0!==t.type&&n.push(ve(e+".Type",t.type)),void 0!==t.tag&&n.push(pe(e+".Tag",t.tag)),Ae(n,e,"Office.System.Result"),n},(Ee=we||(we={})).contractName="Office.System.Activity",Ee.getFields=function(e){var t,n,r=[];return void 0!==e.cV&&r.push(ve("Activity.CV",e.cV)),r.push(pe("Activity.Duration",e.duration)),r.push(pe("Activity.Count",e.count)),r.push(pe("Activity.AggMode",e.aggMode)),void 0!==e.success&&r.push((t="Activity.Success",n=e.success,{name:t,dataType:ce.Boolean,value:n})),void 0!==e.result&&r.push.apply(r,Te.getFields("Activity.Result",e.result)),Ae(r,"Activity",Ee.contractName),r},(Ie||(Ie={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(ve(e+".Id",t.id)),void 0!==t.version&&n.push(ve(e+".Version",t.version)),void 0!==t.sessionId&&n.push(ve(e+".SessionId",t.sessionId)),Ae(n,e,"Office.System.Host"),n},(Ce||(Ce={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(ve(e+".Id",t.id)),void 0!==t.version&&n.push(ve(e+".Version",t.version)),void 0!==t.instanceId&&n.push(ve(e+".InstanceId",t.instanceId)),void 0!==t.name&&n.push(ve(e+".Name",t.name)),void 0!==t.marketplaceType&&n.push(ve(e+".MarketplaceType",t.marketplaceType)),void 0!==t.sessionId&&n.push(ve(e+".SessionId",t.sessionId)),void 0!==t.browserToken&&n.push(ve(e+".BrowserToken",t.browserToken)),void 0!==t.osfRuntimeVersion&&n.push(ve(e+".OsfRuntimeVersion",t.osfRuntimeVersion)),void 0!==t.officeJsVersion&&n.push(ve(e+".OfficeJsVersion",t.officeJsVersion)),void 0!==t.hostJsVersion&&n.push(ve(e+".HostJsVersion",t.hostJsVersion)),void 0!==t.assetId&&n.push(ve(e+".AssetId",t.assetId)),void 0!==t.providerName&&n.push(ve(e+".ProviderName",t.providerName)),void 0!==t.type&&n.push(ve(e+".Type",t.type)),void 0!==t.url&&n.push(ve(e+".Url",t.url)),Ae(n,e,"Office.System.SDX"),n},(ke||(ke={})).getFields=function(e,t){var n=[];return void 0!==t.name&&n.push(ve(e+".Name",t.name)),void 0!==t.state&&n.push(ve(e+".State",t.state)),Ae(n,e,"Office.System.Funnel"),n},(Oe||(Oe={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(pe(e+".Id",t.id)),void 0!==t.name&&n.push(ve(e+".Name",t.name)),void 0!==t.commandSurface&&n.push(ve(e+".CommandSurface",t.commandSurface)),void 0!==t.parentName&&n.push(ve(e+".ParentName",t.parentName)),void 0!==t.triggerMethod&&n.push(ve(e+".TriggerMethod",t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push(pe(e+".TimeOffsetMs",t.timeOffsetMs)),Ae(n,e,"Office.System.UserAction"),n};var Be,Ne=we,xe=Te,Pe=be,Fe=ke,Me=Ie,Le=Ce,Re=Oe;!function(e){!function(e){!function(e){e.Activity=Ne,e.Result=xe,e.Error=Pe,e.Funnel=Fe,e.Host=Me,e.SDX=Le,e.UserAction=Re}(e.System||(e.System={}))}(e.Office||(e.Office={}))}(Be||(Be={}));var Ue,We,je,He,qe,Ve,ze,Qe,Ge,Ke,Ze=(Ue=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}Ue(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Je=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,a)}u((r=r.apply(e,t||[])).next())}))},Xe=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ze(t,e),t.prototype.executeActivityAsync=function(e,t){return Je(this,void 0,void 0,(function(){return Xe(this,(function(n){return[2,this.createNewActivity(e).executeAsync(t)]}))}))},t.prototype.executeActivitySync=function(e,t){return this.createNewActivity(e).executeSync(t)},t.prototype.createNewActivity=function(e){return De.createNew(this,e)},t.prototype.sendActivity=function(e,t,n,r){return this.sendTelemetryEvent({eventName:e,eventContract:{name:Be.Office.System.Activity.contractName,dataFields:Be.Office.System.Activity.getFields(t)},dataFields:n,eventFlags:r})},t.prototype.sendError=function(e){return this.sendTelemetryEvent({eventName:e.eventName,dataFields:be.getFields("Error",e.error),eventFlags:e.eventFlags})},t}(me);!function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"}(We||(We={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.String=1]="String",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Boolean=4]="Boolean",e[e.Date=5]="Date"}(je||(je={})),function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(He||(He={})),function(e){e[e.NotSet=0]="NotSet",e[e.GenericContent=1]="GenericContent"}(qe||(qe={})),function(e){e[e.Low=1]="Low",e[e.Normal=2]="Normal",e[e.High=3]="High",e[e.Immediate_sync=5]="Immediate_sync"}(Ve||(Ve={})),function(e){e[e.NonRetryableStatus=1]="NonRetryableStatus",e[e.QueueFull=3]="QueueFull",e[e.MaxRetryLimit=4]="MaxRetryLimit"}(ze||(ze={})),function(e){e[e.InvalidEvent=1]="InvalidEvent",e[e.SizeLimitExceeded=2]="SizeLimitExceeded",e[e.KillSwitch=3]="KillSwitch"}(Qe||(Qe={})),function(e){e[e.Unknown=0]="Unknown",e[e.MSACID=1]="MSACID",e[e.MSAPUID=2]="MSAPUID",e[e.ANID=3]="ANID",e[e.OrgIdCID=4]="OrgIdCID",e[e.OrgIdPUID=5]="OrgIdPUID",e[e.UserObjectId=6]="UserObjectId",e[e.Skype=7]="Skype",e[e.Yammer=8]="Yammer",e[e.EmailAddress=9]="EmailAddress",e[e.PhoneNumber=10]="PhoneNumber",e[e.SipAddress=11]="SipAddress",e[e.MUID=12]="MUID"}(Ge||(Ge={})),function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"}(Ke||(Ke={}));var $e=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10),this.low<0&&(this.high=-1)}return e.prototype._Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}(),et=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10)}return e.prototype._Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}(),tt=function(){function e(){}return e._ToByte=function(e){return this._ToUInt8(e)},e._ToUInt8=function(e){return 255&e},e._ToInt32=function(e){return 2147483647&e|2147483648&e},e._ToUInt32=function(e){return 4294967295&e},e}(),nt=/[xy]/g,rt=/^[a-zA-Z]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,it=/\./g,ot=/^[a-zA-Z](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,st="a387cfcf60114a43a7699f9fbb49289e-9bceb9fe-1c06-460f-96c5-6a0b247358bc-7238",at=null,ut=null,ct=null;function lt(e){var t=new $e("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t}function dt(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(nt,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function ft(e){return"string"==typeof e}function ht(e){return"number"==typeof e}function pt(e){return e instanceof Date}function vt(){return null===ut&&(ut="undefined"!=typeof Uint8Array&&!function(){if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.toLowerCase();if((e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0)return!0}return!1}()&&!St()),ut}function gt(e){return!(!ht(e)||!(e>=1&&e<=3||5===e))}function mt(e,t){return!ot.test(e)||Tt(t)?null:(Tt(t.value)&&(t={value:t,type:je.Unspecified}),t.type=function(e,t){switch(t=function(e){if(ht(e)&&e>=0&&e<=4)return!0;return!1}(t)?t:je.Unspecified){case je.Unspecified:return function(e){switch(typeof e){case"string":return je.String;case"boolean":return je.Boolean;case"number":return je.Double;case"object":return pt(e)?je.Date:null}return null}(e);case je.String:return ft(e)?t:null;case je.Boolean:return function(e){return"boolean"==typeof e}(e)?t:null;case je.Date:return pt(e)&&NaN!==e.getTime()?t:null;case je.Int64:return ht(e)&&e%1==0?t:null;case je.Double:return ht(e)?t:null}return null}(t.value,t.type),t.type?(pt(t.value)&&(t.value=1e4*(t.value.getTime()+621355968e5)),t.pii>0&&t.cc>0?null:t.pii?function(e){if(ht(e)&&e>=0&&e<=13)return!0;return!1}(t.pii)?t:null:t.cc?function(e){if(ht(e)&&e>=0&&e<=1)return!0;return!1}(t.cc)?t:null:t):null)}function yt(e){return e.getUTCFullYear()+"-"+bt(e.getUTCMonth()+1)+"-"+bt(e.getUTCDate())+"T"+bt(e.getUTCHours())+":"+bt(e.getUTCMinutes())+":"+bt(e.getUTCSeconds())+"."+function(e){if(e<10)return"00"+e;if(e<100)return"0"+e;return e.toString()}(e.getUTCMilliseconds())+"Z"}function _t(){return St()||function(){if("object"==typeof self)return"ServiceWorkerGlobalScope"===self.constructor.name;return!1}()}function St(){return!("undefined"==typeof navigator||!navigator.product)&&"ReactNative"===navigator.product}function bt(e){return e<10?"0"+e:e.toString()}function Tt(e){return null==e||""===e}var wt,Et=function(){function e(e){this._event={name:"",properties:{}},e&&this.setName(e)}return e.prototype.setName=function(e){this._event.name=e},e.prototype.getName=function(){return this._event.name},e.prototype.setType=function(e){this._event.type=e},e.prototype.getType=function(){return this._event.type},e.prototype.setTimestamp=function(e){this._event.timestamp=e},e.prototype.getTimestamp=function(){return this._event.timestamp},e.prototype.setEventPriority=function(e){this._event.priority=e},e.prototype.getEventPriority=function(){return this._event.priority},e.prototype.setProperty=function(e,t,n){void 0===n&&(n=je.Unspecified);var r={value:t,type:n,pii:He.NotSet,cc:qe.NotSet};null!==(r=mt(e,r))?this._event.properties[e]=r:delete this._event.properties[e]},e.prototype.setPropertyWithPii=function(e,t,n,r){void 0===r&&(r=je.Unspecified);var i={value:t,type:r,pii:n,cc:qe.NotSet};null!==(i=mt(e,i))?this._event.properties[e]=i:delete this._event.properties[e]},e.prototype.setPropertyWithCustomerContent=function(e,t,n,r){void 0===r&&(r=je.Unspecified);var i={value:t,type:r,pii:He.NotSet,cc:n};null!==(i=mt(e,i))?this._event.properties[e]=i:delete this._event.properties[e]},e.prototype.getPropertyMap=function(){return this._event.properties},e.prototype.getEvent=function(){return this._event},e}(),It=function(){function e(){}return e.addNotificationListener=function(e){this.listeners.push(e)},e.removeNotificationListener=function(e){for(var t=this.listeners.indexOf(e);t>-1;)this.listeners.splice(t,1),t=this.listeners.indexOf(e)},e.eventsSent=function(e){for(var t=this,n=function(n){r.listeners[n].eventsSent&&setTimeout((function(){return t.listeners[n].eventsSent(e)}),0)},r=this,i=0;i<this.listeners.length;++i)n(i)},e.eventsDropped=function(e,t){for(var n=this,r=function(r){i.listeners[r].eventsDropped&&setTimeout((function(){return n.listeners[r].eventsDropped(e,t)}),0)},i=this,o=0;o<this.listeners.length;++o)r(o)},e.eventsRetrying=function(e){for(var t=this,n=function(n){r.listeners[n].eventsRetrying&&setTimeout((function(){return t.listeners[n].eventsRetrying(e)}),0)},r=this,i=0;i<this.listeners.length;++i)n(i)},e.eventsRejected=function(e,t){for(var n=this,r=function(r){i.listeners[r].eventsRejected&&setTimeout((function(){return n.listeners[r].eventsRejected(e,t)}),0)},i=this,o=0;o<this.listeners.length;++o)r(o)},e.listeners=[],e}(),Ct=function(){function e(){}return e.initialize=function(e){var t=this;this._sendStats=e,this._isInitalized=!0,It.addNotificationListener({eventsSent:function(e){t._addStat("records_sent_count",e.length,e[0].apiKey)},eventsDropped:function(e,n){switch(n){case ze.NonRetryableStatus:t._addStat("d_send_fail",e.length,e[0].apiKey),t._addStat("records_dropped_count",e.length,e[0].apiKey);break;case ze.MaxRetryLimit:t._addStat("d_retry_limit",e.length,e[0].apiKey),t._addStat("records_dropped_count",e.length,e[0].apiKey);break;case ze.QueueFull:t._addStat("d_queue_full",e.length,e[0].apiKey)}},eventsRejected:function(e,n){switch(n){case Qe.InvalidEvent:t._addStat("r_inv",e.length,e[0].apiKey);break;case Qe.KillSwitch:t._addStat("r_kl",e.length,e[0].apiKey);break;case Qe.SizeLimitExceeded:t._addStat("r_size",e.length,e[0].apiKey)}t._addStat("r_count",e.length,e[0].apiKey)},eventsRetrying:null}),setTimeout((function(){return t.flush()}),6e4)},e.teardown=function(){this._isInitalized&&(this.flush(),this._isInitalized=!1)},e.eventReceived=function(t){e._addStat("records_received_count",1,t)},e.flush=function(){var e=this;if(this._isInitalized){for(var t in this._stats)this._stats.hasOwnProperty(t)&&this._sendStats(this._stats[t],t);this._stats={},setTimeout((function(){return e.flush()}),6e4)}},e._addStat=function(e,t,n){if(this._isInitalized&&n!==st){var r=function(e){var t=e.indexOf("-");return t>-1?e.substring(0,t):""}(n);this._stats[r]||(this._stats[r]={}),this._stats[r][e]?this._stats[r][e]=this._stats[r][e]+t:this._stats[r][e]=t}},e._isInitalized=!1,e._stats={},e}();!function(e){e[e._BT_STOP=0]="_BT_STOP",e[e._BT_STOP_BASE=1]="_BT_STOP_BASE",e[e._BT_BOOL=2]="_BT_BOOL",e[e._BT_DOUBLE=8]="_BT_DOUBLE",e[e._BT_STRING=9]="_BT_STRING",e[e._BT_STRUCT=10]="_BT_STRUCT",e[e._BT_LIST=11]="_BT_LIST",e[e._BT_MAP=13]="_BT_MAP",e[e._BT_INT32=16]="_BT_INT32",e[e._BT_INT64=17]="_BT_INT64"}(wt||(wt={}));var kt=function(){function e(){}return e._ConvertNumberToArray=function(e,t){if(!e)return t?this._doubleZero:this._floatZero;var n=t?52:23,r=(1<<(t?11:8)-1)-1,i=1-r,o=r,s=e<0?1:0;e=Math.abs(e);for(var a=Math.floor(e),u=e-a,c=2*(r+2)+n,l=new Array(c),d=0;d<c;)l[d++]=0;for(d=r+2;d&&a;)l[--d]=a%2,a=Math.floor(a/2);for(d=r+1;d<c-1&&u>0;)(u*=2)>=1?(l[++d]=1,--u):l[++d]=0;for(var f=0;f<c&&!l[f];)f++;var h=r+1-f,p=f+n;if(l[p+1]){for(d=p;d>f&&(l[d]=1-l[d],!l);--d);d===f&&++h}if(h>o||a)return s?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(h<i)return t?this._doubleZero:this._floatZero;if(t){var v=0;for(d=0;d<20;++d)v=v<<1|l[++f];for(var g=0;d<52;++d)g=g<<1|l[++f];return[255&g,g>>8&255,g>>16&255,g>>>24,255&(v=s<<31|2147483647&(v|=h+r<<20)),v>>8&255,v>>16&255,v>>>24]}var m=0;for(d=0;d<23;++d)m=m<<1|l[++f];return[255&(m=s<<31|2147483647&(m|=h+r<<23)),m>>8&255,m>>16&255,m>>>24]},e._floatZero=[0,0,0,0],e._doubleZero=[0,0,0,0,0,0,0,0],e._floatInifinity=[0,0,128,127],e._floatNegInifinity=[0,0,128,255],e._doubleInifinity=[0,0,0,0,0,0,240,127],e._doubleNegInifinity=[0,0,0,0,0,0,240,255],e}(),Ot=function(){function e(){}return e._IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},e}();function Dt(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?t.push(192|r>>6,128|63&r):r<55296||r>=57344?t.push(224|r>>12,128|r>>6&63,128|63&r):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++n)),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return t}function At(e){for(var t,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[],i=e.length%3,o=0,s=e.length-i;o<s;o+=3){var a=(e[o]<<16)+(e[o+1]<<8)+e[o+2];r.push([n.charAt((t=a)>>18&63),n.charAt(t>>12&63),n.charAt(t>>6&63),n.charAt(63&t)].join(""))}switch(i){case 1:a=e[e.length-1];r.push(n.charAt(a>>2)),r.push(n.charAt(a<<4&63)),r.push("==");break;case 2:var u=(e[e.length-2]<<8)+e[e.length-1];r.push(n.charAt(u>>10)),r.push(n.charAt(u>>4&63)),r.push(n.charAt(u<<2&63)),r.push("=")}return r.join("")}function Bt(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t}function Nt(e){for(var t=e.low,n=e.high,r=[];n||4294967168&t;)r.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return r.push(127&t),r}function xt(e){if(Ot._IsDataViewSupport()){var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,e,!0);for(var n=[],r=0;r<8;++r)n.push(t.getUint8(r));return n}return kt._ConvertNumberToArray(e,!0)}function Pt(e){return(e=tt._ToInt32(e))<<1^e>>31}function Ft(e){var t=e.low,n=e.high,r=n<<1|t>>>31,i=t<<1;2147483648&n&&(r=~r,i=~i);var o=new et("0");return o.low=i,o.high=r,o}var Mt=function(){function e(){this._buffer=[]}return e.prototype._WriteByte=function(e){this._buffer.push(tt._ToByte(e))},e.prototype._Write=function(e,t,n){for(;n--;)this._WriteByte(e[t++])},e.prototype._GetBuffer=function(){return this._buffer},e}(),Lt=function(){function e(e){this._stream=e}return e.prototype._WriteBlob=function(e){this._stream._Write(e,0,e.length)},e.prototype._WriteBool=function(e){this._stream._WriteByte(e?1:0)},e.prototype._WriteContainerBegin=function(e,t){this._WriteUInt8(t),this._WriteUInt32(e)},e.prototype._WriteMapContainerBegin=function(e,t,n){this._WriteUInt8(t),this._WriteUInt8(n),this._WriteUInt32(e)},e.prototype._WriteDouble=function(e){var t=xt(e);this._stream._Write(t,0,t.length)},e.prototype._WriteFieldBegin=function(e,t,n){t<=5?this._stream._WriteByte(e|t<<5):t<=255?(this._stream._WriteByte(192|e),this._stream._WriteByte(t)):(this._stream._WriteByte(224|e),this._stream._WriteByte(t),this._stream._WriteByte(t>>8))},e.prototype._WriteInt32=function(e){e=Pt(e),this._WriteUInt32(e)},e.prototype._WriteInt64=function(e){this._WriteUInt64(Ft(e))},e.prototype._WriteString=function(e){if(""===e)this._WriteUInt32(0);else{var t=Dt(e);this._WriteUInt32(t.length),this._stream._Write(t,0,t.length)}},e.prototype._WriteStructEnd=function(e){this._WriteUInt8(e?wt._BT_STOP_BASE:wt._BT_STOP)},e.prototype._WriteUInt32=function(e){var t=Bt(tt._ToUInt32(e));this._stream._Write(t,0,t.length)},e.prototype._WriteUInt64=function(e){var t=Nt(e);this._stream._Write(t,0,t.length)},e.prototype._WriteUInt8=function(e){this._stream._WriteByte(tt._ToUInt8(e))},e}(),Rt=function(){function e(){}return e.getPayloadBlob=function(e,t){var n,r=!1,o=new i.MemoryStream,s=new Lt(o);for(var a in s._WriteFieldBegin(wt._BT_MAP,3,null),s._WriteMapContainerBegin(t,wt._BT_STRING,wt._BT_LIST),e)if(r)n||(n={}),n[a]=e[a],delete e[a];else if(e.hasOwnProperty(a)){s._WriteString(a);var u=e[a];s._WriteContainerBegin(1,wt._BT_STRUCT),s._WriteFieldBegin(wt._BT_STRING,2,null),s._WriteString("act_default_source"),s._WriteFieldBegin(wt._BT_STRING,5,null),s._WriteString(dt()),s._WriteFieldBegin(wt._BT_INT64,6,null),s._WriteInt64(lt(Date.now())),s._WriteFieldBegin(wt._BT_LIST,8,null);var c=o._GetBuffer().length+1;s._WriteContainerBegin(e[a].length,wt._BT_STRUCT);for(var l=o._GetBuffer().length-c,d=0;d<u.length;++d){var f=o._GetBuffer().length;if(this.writeEvent(u[d],s),o._GetBuffer().length-f>2936012)It.eventsRejected([u[d]],Qe.SizeLimitExceeded),u.splice(d--,1),o._GetBuffer().splice(f),this._addNewDataPackageSize(u.length,o,l,c);else if(o._GetBuffer().length>2936012){o._GetBuffer().splice(f),n||(n={}),e[a]=u.splice(0,d),n[a]=u,this._addNewDataPackageSize(e[a].length,o,l,c),r=!0;break}}s._WriteStructEnd(!1)}return s._WriteStructEnd(!1),{payloadBlob:o._GetBuffer(),remainingRequest:n}},e._addNewDataPackageSize=function(e,t,n,i){for(var o=r._Varint_GetBytes(tt._ToUInt32(e)),s=0;s<n;++s){if(!(s<o.length)){t._GetBuffer().slice(i+s,n-s);break}t._GetBuffer()[i+s]=o[s]}},e.writeEvent=function(e,t){t._WriteFieldBegin(wt._BT_STRING,1,null),t._WriteString(e.id),t._WriteFieldBegin(wt._BT_INT64,3,null),t._WriteInt64(lt(e.timestamp)),t._WriteFieldBegin(wt._BT_STRING,5,null),t._WriteString(e.type),t._WriteFieldBegin(wt._BT_STRING,6,null),t._WriteString(e.name);var n={},r=0,i={},o=0,s={},a=0,u={},c=0,l={},d=0,f={},h=0,p={},v=0;for(var g in e.properties){if(e.properties.hasOwnProperty(g))if((y=e.properties[g]).cc>0)p[g]=y,v++;else if(y.pii>0)f[g]=y,h++;else switch(y.type){case je.String:n[g]=y.value,r++;break;case je.Int64:i[g]=y.value,o++;break;case je.Double:s[g]=y.value,a++;break;case je.Boolean:u[g]=y.value,c++;break;case je.Date:l[g]=y.value,d++}}if(r)for(var g in t._WriteFieldBegin(wt._BT_MAP,13,null),t._WriteMapContainerBegin(r,wt._BT_STRING,wt._BT_STRING),n)if(n.hasOwnProperty(g)){var m=n[g];t._WriteString(g),t._WriteString(m.toString())}if(h)for(var g in t._WriteFieldBegin(wt._BT_MAP,30,null),t._WriteMapContainerBegin(h,wt._BT_STRING,wt._BT_STRUCT),f)if(f.hasOwnProperty(g)){var y=f[g];t._WriteString(g),t._WriteFieldBegin(wt._BT_INT32,1,null),t._WriteInt32(1),t._WriteFieldBegin(wt._BT_INT32,2,null),t._WriteInt32(y.pii),t._WriteFieldBegin(wt._BT_STRING,3,null),t._WriteString(y.value.toString()),t._WriteStructEnd(!1)}if(c)for(var g in t._WriteFieldBegin(wt._BT_MAP,31,null),t._WriteMapContainerBegin(c,wt._BT_STRING,wt._BT_BOOL),u)if(u.hasOwnProperty(g)){m=u[g];t._WriteString(g),t._WriteBool(m)}if(d)for(var g in t._WriteFieldBegin(wt._BT_MAP,32,null),t._WriteMapContainerBegin(d,wt._BT_STRING,wt._BT_INT64),l)if(l.hasOwnProperty(g)){m=l[g];t._WriteString(g),t._WriteInt64(lt(m))}if(o)for(var g in t._WriteFieldBegin(wt._BT_MAP,33,null),t._WriteMapContainerBegin(o,wt._BT_STRING,wt._BT_INT64),i)if(i.hasOwnProperty(g)){m=i[g];t._WriteString(g),t._WriteInt64(lt(m))}if(a)for(var g in t._WriteFieldBegin(wt._BT_MAP,34,null),t._WriteMapContainerBegin(a,wt._BT_STRING,wt._BT_DOUBLE),s)if(s.hasOwnProperty(g)){m=s[g];t._WriteString(g),t._WriteDouble(m)}if(v)for(var g in t._WriteFieldBegin(wt._BT_MAP,36,null),t._WriteMapContainerBegin(v,wt._BT_STRING,wt._BT_STRUCT),p)if(p.hasOwnProperty(g)){y=p[g];t._WriteString(g),t._WriteFieldBegin(wt._BT_INT32,1,null),t._WriteInt32(y.cc),t._WriteFieldBegin(wt._BT_STRING,2,null),t._WriteString(y.value.toString()),t._WriteStructEnd(!1)}t._WriteStructEnd(!1)},e.base64Encode=function(e){return r._Base64_GetString(e)},e}(),Ut=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(4,e)*n,Math.min(t,12e4)},e}(),Wt=function(){function e(){this._killedTokenDictionary={}}return e.prototype.setKillSwitchTenants=function(e,t){if(e&&t)try{var n=e.split(",");if("this-request-only"===t)return n;for(var r=1e3*parseInt(t,10),i=0;i<n.length;++i)this._killedTokenDictionary[n[i]]=Date.now()+r}catch(e){return[]}return[]},e.prototype.isTenantKilled=function(e){return void 0!==this._killedTokenDictionary[e]&&this._killedTokenDictionary[e]>Date.now()||(delete this._killedTokenDictionary[e],!1)},e}(),jt=function(){function e(e){this.clockSkewRefreshDurationInMins=e,this._reset()}return e.prototype.allowRequestSending=function(){return this._isFirstRequest&&!this._clockSkewSet?(this._isFirstRequest=!1,this._allowRequestSending=!1,!0):this._allowRequestSending},e.prototype.shouldAddClockSkewHeaders=function(){return this._shouldAddClockSkewHeaders},e.prototype.getClockSkewHeaderValue=function(){return this._clockSkewHeaderValue},e.prototype.setClockSkew=function(e){this._clockSkewSet||(e?this._clockSkewHeaderValue=e:this._shouldAddClockSkewHeaders=!1,this._clockSkewSet=!0,this._allowRequestSending=!0)},e.prototype._reset=function(){var e=this;this._isFirstRequest=!0,this._clockSkewSet=!1,this._allowRequestSending=!0,this._shouldAddClockSkewHeaders=!0,this._clockSkewHeaderValue="use-collector-delta",this.clockSkewRefreshDurationInMins>0&&setTimeout((function(){return e._reset()}),6e4*this.clockSkewRefreshDurationInMins)},e}(),Ht=function(){function e(e,t,n,r,i){var o=this;this._requestQueue=e,this._queueManager=n,this._httpInterface=r,this._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version=AWT-Web-JS-1.8.6",this._killSwitch=new Wt,this._paused=!1,this._useBeacons=!1,this._activeConnections=0,this._clockSkewManager=new jt(i),vt()||(this._urlString+="&content-encoding=base64"),this._urlString=t+this._urlString,this._httpInterface||(this._useBeacons=!St(),this._httpInterface={sendPOST:function(e,t,n,r,i,s){try{if(_t())fetch(e,{body:t,method:"POST"}).then((function(e){var t={};e.headers&&e.headers.forEach((function(e,n){t[n]=e})),i(e.status,t)})).catch((function(e){r(0,{})}));else if(function(){if(null===ct){var e=new XMLHttpRequest;ct=void 0===e.withCredentials&&"undefined"!=typeof XDomainRequest}return ct}()){var a=new XDomainRequest;a.open("POST",e),a.onload=function(){i(200,null)},a.onerror=function(){r(400,null)},a.ontimeout=function(){n(500,null)},a.send(t)}else{var u=new XMLHttpRequest;u.open("POST",e,!s),u.onload=function(){i(u.status,o._convertAllHeadersToMap(u.getAllResponseHeaders()))},u.onerror=function(){r(u.status,o._convertAllHeadersToMap(u.getAllResponseHeaders()))},u.ontimeout=function(){n(u.status,o._convertAllHeadersToMap(u.getAllResponseHeaders()))},u.send(t)}}catch(e){r(400,null)}}})}return e.prototype.hasIdleConnection=function(){return this._activeConnections<2},e.prototype.sendQueuedRequests=function(){for(;this.hasIdleConnection()&&!this._paused&&this._requestQueue.length>0&&this._clockSkewManager.allowRequestSending();)this._activeConnections++,this._sendRequest(this._requestQueue.shift(),0,!1);this.hasIdleConnection()&&En.scheduleTimer()},e.prototype.isCompletelyIdle=function(){return 0===this._activeConnections},e.prototype.teardown=function(){for(;this._requestQueue.length>0;)this._sendRequest(this._requestQueue.shift(),0,!0)},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1,this.sendQueuedRequests()},e.prototype.removeQueuedRequests=function(){this._requestQueue.length=0},e.prototype.sendSynchronousRequest=function(e,t){this._paused&&(e[t][0].priority=Ve.High),this._activeConnections++,this._sendRequest(e,0,!1,!0)},e.prototype._sendRequest=function(e,t,n,r){var i=this;void 0===r&&(r=!1);try{if(this._paused)return this._activeConnections--,void this._queueManager.addBackRequest(e);var o=0,s="";for(var a in e)e.hasOwnProperty(a)&&(this._killSwitch.isTenantKilled(a)?(It.eventsRejected(e[a],Qe.KillSwitch),delete e[a]):(s.length>0&&(s+=","),s+=a,o++));if(o>0){var u=Rt.getPayloadBlob(e,o);u.remainingRequest&&this._requestQueue.push(u.remainingRequest);var c=this._urlString+"&x-apikey="+s+"&client-time-epoch-millis="+Date.now().toString();this._clockSkewManager.shouldAddClockSkewHeaders()&&(c=c+"&time-delta-to-apply-millis="+this._clockSkewManager.getClockSkewHeaderValue());var l=void 0;for(var a in l=vt()?new Uint8Array(u.payloadBlob):Rt.base64Encode(u.payloadBlob),e)if(e.hasOwnProperty(a))for(var d=0;d<e[a].length;++d)e[a][d].sendAttempt>0?e[a][d].sendAttempt++:e[a][d].sendAttempt=1;if(this._useBeacons&&n&&(null===at&&(at="undefined"!=typeof navigator&&Boolean(navigator.sendBeacon)),at)&&navigator.sendBeacon(c,l))return;this._httpInterface.sendPOST(c,l,(function(a,u){i._retryRequestIfNeeded(a,u,e,o,s,t,n,r)}),(function(a,u){i._retryRequestIfNeeded(a,u,e,o,s,t,n,r)}),(function(a,u){i._retryRequestIfNeeded(a,u,e,o,s,t,n,r)}),n||r)}else n||this._handleRequestFinished(!1,{},n,r)}catch(e){this._handleRequestFinished(!1,{},n,r)}},e.prototype._retryRequestIfNeeded=function(e,t,n,r,i,o,s,a){var u=this,c=!0;if(void 0!==e){if(t){var l=this._killSwitch.setKillSwitchTenants(t["kill-tokens"],t["kill-duration-seconds"]);this._clockSkewManager.setClockSkew(t["time-delta-millis"]);for(var d=0;d<l.length;++d)It.eventsRejected(n[l[d]],Qe.KillSwitch),delete n[l[d]],r--}else this._clockSkewManager.setClockSkew(null);if(200===e)return void this._handleRequestFinished(!0,n,s,a);(!Ut.shouldRetryForStatus(e)||r<=0)&&(c=!1)}if(c)if(a)this._activeConnections--,n[i][0].priority=Ve.High,this._queueManager.addBackRequest(n);else if(o<1){for(var f in n)n.hasOwnProperty(f)&&It.eventsRetrying(n[f]);setTimeout((function(){return u._sendRequest(n,o+1,!1)}),Ut.getMillisToBackoffForRetry(o))}else this._activeConnections--,En.backOffTransmission(),this._queueManager.addBackRequest(n);else this._handleRequestFinished(!1,n,s,a)},e.prototype._handleRequestFinished=function(e,t,n,r){for(var i in e&&En.clearBackOff(),t)t.hasOwnProperty(i)&&(e?It.eventsSent(t[i]):It.eventsDropped(t[i],ze.NonRetryableStatus));this._activeConnections--,r||n||this.sendQueuedRequests()},e.prototype._convertAllHeadersToMap=function(e){var t={};if(e)for(var n=e.split("\n"),r=0;r<n.length;++r){var i=n[r].split(": ");t[i[0]]=i[1]}return t},e}(),qt=function(){function e(e,t){this._outboundQueue=e,this._maxNumberOfEvents=t,this._currentBatch={},this._currentNumEventsInBatch=0}return e.prototype.addEventToBatch=function(e){if(e.priority===Ve.Immediate_sync){var t={};return t[e.apiKey]=[e],t}return this._currentNumEventsInBatch>=this._maxNumberOfEvents&&this.flushBatch(),void 0===this._currentBatch[e.apiKey]&&(this._currentBatch[e.apiKey]=[]),this._currentBatch[e.apiKey].push(e),this._currentNumEventsInBatch++,null},e.prototype.flushBatch=function(){this._currentNumEventsInBatch>0&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentNumEventsInBatch=0)},e.prototype.hasBatch=function(){return this._currentNumEventsInBatch>0},e}(),Vt=function(){function e(e,t,n,r){this._queueSizeLimit=t,this._isCurrentlyUploadingNow=!1,this._uploadNowQueue=[],this._shouldDropEventsOnPause=!1,this._paused=!1,this._queueSize=0,this._outboundQueue=[],this._inboundQueues={},this._inboundQueues[Ve.High]=[],this._inboundQueues[Ve.Normal]=[],this._inboundQueues[Ve.Low]=[],this._addEmptyQueues(),this._batcher=new qt(this._outboundQueue,500),this._httpManager=new Ht(this._outboundQueue,e,this,n,r)}return e.prototype.addEvent=function(e){gt(e.priority)||(e.priority=Ve.Normal),e.priority===Ve.Immediate_sync?this._httpManager.sendSynchronousRequest(this._batcher.addEventToBatch(e),e.apiKey):this._queueSize<this._queueSizeLimit||this._dropEventWithPriorityOrLess(e.priority)?this._addEventToProperQueue(e):It.eventsDropped([e],ze.QueueFull)},e.prototype.sendEventsForPriorityAndAbove=function(e){this._batchEvents(e),this._httpManager.sendQueuedRequests()},e.prototype.hasEvents=function(){return(this._inboundQueues[Ve.High][0].length>0||this._inboundQueues[Ve.Normal][0].length>0||this._inboundQueues[Ve.Low][0].length>0||this._batcher.hasBatch())&&this._httpManager.hasIdleConnection()},e.prototype.addBackRequest=function(e){if(!this._paused||!this._shouldDropEventsOnPause){for(var t in e)if(e.hasOwnProperty(t))for(var n=0;n<e[t].length;++n)e[t][n].sendAttempt<6?this.addEvent(e[t][n]):It.eventsDropped([e[t][n]],ze.MaxRetryLimit);En.scheduleTimer()}},e.prototype.teardown=function(){this._paused||(this._batchEvents(Ve.Low),this._httpManager.teardown())},e.prototype.uploadNow=function(e){var t=this;this._addEmptyQueues(),this._isCurrentlyUploadingNow?this._uploadNowQueue.push(e):(this._isCurrentlyUploadingNow=!0,setTimeout((function(){return t._uploadNow(e)}),0))},e.prototype.pauseTransmission=function(){this._paused=!0,this._httpManager.pause(),this.shouldDropEventsOnPause&&(this._queueSize-=this._inboundQueues[Ve.High][0].length+this._inboundQueues[Ve.Normal][0].length+this._inboundQueues[Ve.Low][0].length,this._inboundQueues[Ve.High][0]=[],this._inboundQueues[Ve.Normal][0]=[],this._inboundQueues[Ve.Low][0]=[],this._httpManager.removeQueuedRequests())},e.prototype.resumeTransmission=function(){this._paused=!1,this._httpManager.resume()},e.prototype.shouldDropEventsOnPause=function(e){this._shouldDropEventsOnPause=e},e.prototype._removeFirstQueues=function(){this._inboundQueues[Ve.High].shift(),this._inboundQueues[Ve.Normal].shift(),this._inboundQueues[Ve.Low].shift()},e.prototype._addEmptyQueues=function(){this._inboundQueues[Ve.High].push([]),this._inboundQueues[Ve.Normal].push([]),this._inboundQueues[Ve.Low].push([])},e.prototype._addEventToProperQueue=function(e){this._paused&&this._shouldDropEventsOnPause||(this._queueSize++,this._inboundQueues[e.priority][this._inboundQueues[e.priority].length-1].push(e))},e.prototype._dropEventWithPriorityOrLess=function(e){for(var t=Ve.Low;t<=e;){if(this._inboundQueues[t][this._inboundQueues[t].length-1].length>0)return It.eventsDropped([this._inboundQueues[t][this._inboundQueues[t].length-1].shift()],ze.QueueFull),!0;t++}return!1},e.prototype._batchEvents=function(e){for(var t=Ve.High;t>=e;){for(;this._inboundQueues[t][0].length>0;){var n=this._inboundQueues[t][0].pop();this._queueSize--,this._batcher.addEventToBatch(n)}t--}this._batcher.flushBatch()},e.prototype._uploadNow=function(e){var t=this;this.hasEvents()&&this.sendEventsForPriorityAndAbove(Ve.Low),this._checkOutboundQueueEmptyAndSent((function(){t._removeFirstQueues(),null!=e&&e(),t._uploadNowQueue.length>0?setTimeout((function(){return t._uploadNow(t._uploadNowQueue.shift())}),0):(t._isCurrentlyUploadingNow=!1,t.hasEvents()&&En.scheduleTimer())}))},e.prototype._checkOutboundQueueEmptyAndSent=function(e){var t=this;this._httpManager.isCompletelyIdle()?e():setTimeout((function(){return t._checkOutboundQueueEmptyAndSent(e)}),250)},e}(),zt="MicrosoftApplicationsTelemetryDeviceId",Qt="MicrosoftApplicationsTelemetryFirstLaunchTime",Gt="MSIE",Kt="Chrome",Zt="Firefox",Jt="Safari",Xt="Edge",Yt="Electron",$t="SkypeShell",en="PhantomJS",tn="Opera",nn="Windows",rn="Mac OS X",on="Windows Phone",sn="Windows RT",an="iOS",un="Android",cn="Linux",ln="Chrome OS",dn=/(windows|win32)/i,fn=/ arm;/i,hn=/windows\sphone\s\d+\.\d+/i,pn=/(macintosh|mac os x)/i,vn=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,gn=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,mn=/android/i,yn=/CrOS/i,_n={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},Sn=function(){function e(){}return e.addPropertyStorageOverride=function(e){return!!e&&(this._propertyStorage=e,!0)},e.autoCollect=function(e,t,n){if(this._semanticContext=e,this._disableCookies=t,this._autoCollect(),n||"undefined"==typeof navigator||(n=navigator.userAgent||""),this._autoCollectFromUserAgent(n),this._disableCookies&&!this._propertyStorage)return this._deleteCookie(zt),void this._deleteCookie(Qt);(this._propertyStorage||this._areCookiesAvailable&&!this._disableCookies)&&this._autoCollectDeviceId()},e.checkAndSaveDeviceId=function(e){if(e){var t=this._getData(zt),n=this._getData(Qt);t!==e&&(n=yt(new Date)),this._saveData(zt,e),this._saveData(Qt,n),this._setFirstLaunchTime(n)}},e._autoCollectDeviceId=function(){var e=this._getData(zt);e||(e=dt()),this._semanticContext.setDeviceId(e)},e._autoCollect=function(){"undefined"!=typeof document&&document.documentElement&&this._semanticContext.setAppLanguage(document.documentElement.lang),"undefined"!=typeof navigator&&this._semanticContext.setUserLanguage(navigator.userLanguage||navigator.language);var e=(new Date).getTimezoneOffset(),t=e%60,n=(e-t)/60,r="+";n>0&&(r="-"),n=Math.abs(n),t=Math.abs(t),this._semanticContext.setUserTimeZone(r+(n<10?"0"+n:n.toString())+":"+(t<10?"0"+t:t.toString()))},e._autoCollectFromUserAgent=function(e){if(e){var t=this._getBrowserName(e);this._semanticContext.setDeviceBrowserName(t),this._semanticContext.setDeviceBrowserVersion(this._getBrowserVersion(e,t));var n=this._getOsName(e);this._semanticContext.setDeviceOsName(n),this._semanticContext.setDeviceOsVersion(this._getOsVersion(e,n))}},e._getBrowserName=function(e){return this._userAgentContainsString("OPR/",e)?tn:this._userAgentContainsString(en,e)?en:this._userAgentContainsString(Xt,e)||this._userAgentContainsString("Edg",e)?Xt:this._userAgentContainsString(Yt,e)?Yt:this._userAgentContainsString(Kt,e)?Kt:this._userAgentContainsString("Trident",e)?Gt:this._userAgentContainsString(Zt,e)?Zt:this._userAgentContainsString(Jt,e)?Jt:this._userAgentContainsString($t,e)?$t:"Unknown"},e._setFirstLaunchTime=function(e){if(!isNaN(e)){var t=new Date;t.setTime(parseInt(e,10)),e=yt(t)}this.firstLaunchTime=e},e._userAgentContainsString=function(e,t){return t.indexOf(e)>-1},e._getBrowserVersion=function(e,t){if(t===Gt)return this._getIeVersion(e);if(t===Xt){var n=this._getOtherVersion(t,e);return"Unknown"===n?this._getOtherVersion("Edg",e):n}return this._getOtherVersion(t,e)},e._getIeVersion=function(e){var t=e.match(new RegExp(Gt+" ([\\d,.]+)"));if(t)return t[1];var n=e.match(new RegExp("rv:([\\d,.]+)"));return n?n[1]:void 0},e._getOtherVersion=function(e,t){e===Jt&&(e="Version");var n=t.match(new RegExp(e+"/([\\d,.]+)"));return n?n[1]:"Unknown"},e._getOsName=function(e){return e.match(hn)?on:e.match(fn)?sn:e.match(vn)?an:e.match(mn)?un:e.match(gn)?cn:e.match(pn)?rn:e.match(dn)?nn:e.match(yn)?ln:"Unknown"},e._getOsVersion=function(e,t){return t===nn?this._getGenericOsVersion(e,"Windows NT"):t===un?this._getGenericOsVersion(e,t):t===rn?this._getMacOsxVersion(e):"Unknown"},e._getGenericOsVersion=function(e,t){var n=e.match(new RegExp(t+" ([\\d,.]+)"));return n?_n[n[1]]?_n[n[1]]:n[1]:"Unknown"},e._getMacOsxVersion=function(e){var t=e.match(new RegExp(rn+" ([\\d,_,.]+)"));if(t){var n=t[1].replace(/_/g,".");if(n){var r=this._getDelimiter(n);return r?n.split(r)[0]:n}}return"Unknown"},e._getDelimiter=function(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null},e._saveData=function(e,t){if(this._propertyStorage)this._propertyStorage.setProperty(e,t);else if(this._areCookiesAvailable){var n=new Date;n.setTime(n.getTime()+31536e6);var r="expires="+n.toUTCString();document.cookie=e+"="+t+"; "+r}},e._getData=function(e){if(this._propertyStorage)return this._propertyStorage.getProperty(e)||"";if(this._areCookiesAvailable){e+="=";for(var t=document.cookie.split(";"),n=0;n<t.length;n++){for(var r=t[n],i=0;" "===r.charAt(i);)i++;if(0===(r=r.substring(i)).indexOf(e))return r.substring(e.length,r.length)}}return""},e._deleteCookie=function(e){this._areCookiesAvailable&&(document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},e._disableCookies=!1,e._areCookiesAvailable="undefined"!=typeof document&&void 0!==document.cookie,e}(),bn=function(){function e(e,t){this._allowDeviceFields=e,this._properties=t}return e.prototype.setAppId=function(e){this._addContext("AppInfo.Id",e)},e.prototype.setAppVersion=function(e){this._addContext("AppInfo.Version",e)},e.prototype.setAppLanguage=function(e){this._addContext("AppInfo.Language",e)},e.prototype.setDeviceId=function(e){this._allowDeviceFields&&(Sn.checkAndSaveDeviceId(e),this._addContext("DeviceInfo.Id",e))},e.prototype.setDeviceOsName=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsName",e)},e.prototype.setDeviceOsVersion=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.OsVersion",e)},e.prototype.setDeviceBrowserName=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserName",e)},e.prototype.setDeviceBrowserVersion=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.BrowserVersion",e)},e.prototype.setDeviceMake=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Make",e)},e.prototype.setDeviceModel=function(e){this._allowDeviceFields&&this._addContext("DeviceInfo.Model",e)},e.prototype.setUserId=function(e,t,n){if(!isNaN(n)&&null!==n&&n>=0&&n<=12)this._addContext("UserInfo.IdType",n.toString());else{var r=void 0;switch(t){case He.SipAddress:r=Ge.SipAddress;break;case He.PhoneNumber:r=Ge.PhoneNumber;break;case He.SmtpAddress:r=Ge.EmailAddress;break;default:r=Ge.Unknown}this._addContext("UserInfo.IdType",r.toString())}if(isNaN(t)||null===t||t===He.NotSet||t>13)switch(n){case Ge.Skype:t=He.Identity;break;case Ge.EmailAddress:t=He.SmtpAddress;break;case Ge.PhoneNumber:t=He.PhoneNumber;break;case Ge.SipAddress:t=He.SipAddress;break;default:t=He.NotSet}this._addContextWithPii("UserInfo.Id",e,t)},e.prototype.setUserAdvertisingId=function(e){this._addContext("UserInfo.AdvertisingId",e)},e.prototype.setUserTimeZone=function(e){this._addContext("UserInfo.TimeZone",e)},e.prototype.setUserLanguage=function(e){this._addContext("UserInfo.Language",e)},e.prototype._addContext=function(e,t){"string"==typeof t&&this._properties.setProperty(e,t)},e.prototype._addContextWithPii=function(e,t,n){"string"==typeof t&&this._properties.setPropertyWithPii(e,t,n)},e}(),Tn=function(){function e(){}return e.logManagerContext=new Et,e.sessionEnabled=!0,e.loggingEnabled=!1,e.defaultTenantToken="",e.semanticContext=new bn(!0,e.logManagerContext),e}(),wn=function(){function e(){}return e.initialize=function(e,t){if(void 0===t&&(t={}),!this._isInitialized)return this._isInitialized=!0,Tn.defaultTenantToken=e,this._overrideValuesFromConfig(t),this._config.disableCookiesUsage&&!this._config.propertyStorageOverride&&(Tn.sessionEnabled=!1),Sn.addPropertyStorageOverride(this._config.propertyStorageOverride),Sn.autoCollect(Tn.semanticContext,this._config.disableCookiesUsage,this._config.userAgent),En.initialize(this._config),Tn.loggingEnabled=!0,this._config.enableAutoUserSession&&(this.getLogger().logSession(Ke.Started),window.addEventListener("beforeunload",this.flushAndTeardown)),this.getLogger()},e.getSemanticContext=function(){return Tn.semanticContext},e.flush=function(e){this._isInitialized&&!this._isDestroyed&&En.flush(e)},e.flushAndTeardown=function(){this._isInitialized&&!this._isDestroyed&&(this._config.enableAutoUserSession&&this.getLogger().logSession(Ke.Ended),En.flushAndTeardown(),Tn.loggingEnabled=!1,this._isDestroyed=!0)},e.pauseTransmission=function(){this._isInitialized&&!this._isDestroyed&&En.pauseTransmission()},e.resumeTransmision=function(){this._isInitialized&&!this._isDestroyed&&En.resumeTransmision()},e.setTransmitProfile=function(e){this._isInitialized&&!this._isDestroyed&&En.setTransmitProfile(e)},e.loadTransmitProfiles=function(e){this._isInitialized&&!this._isDestroyed&&En.loadTransmitProfiles(e)},e.setContext=function(e,t,n){void 0===n&&(n=je.Unspecified),Tn.logManagerContext.setProperty(e,t,n)},e.setContextWithPii=function(e,t,n,r){void 0===r&&(r=je.Unspecified),Tn.logManagerContext.setPropertyWithPii(e,t,n,r)},e.setContextWithCustomerContent=function(e,t,n,r){void 0===r&&(r=je.Unspecified),Tn.logManagerContext.setPropertyWithCustomerContent(e,t,n,r)},e.getLogger=function(e){var t=e;return t&&t!==Tn.defaultTenantToken||(t=""),this._loggers[t]||(this._loggers[t]=new In(t)),this._loggers[t]},e.addNotificationListener=function(e){It.addNotificationListener(e)},e.removeNotificationListener=function(e){It.removeNotificationListener(e)},e._overrideValuesFromConfig=function(e){e.collectorUri&&(this._config.collectorUri=e.collectorUri),e.cacheMemorySizeLimitInNumberOfEvents>0&&(this._config.cacheMemorySizeLimitInNumberOfEvents=e.cacheMemorySizeLimitInNumberOfEvents),e.httpXHROverride&&e.httpXHROverride.sendPOST&&(this._config.httpXHROverride=e.httpXHROverride),e.propertyStorageOverride&&e.propertyStorageOverride.getProperty&&e.propertyStorageOverride.setProperty&&(this._config.propertyStorageOverride=e.propertyStorageOverride),e.userAgent&&(this._config.userAgent=e.userAgent),e.disableCookiesUsage&&(this._config.disableCookiesUsage=e.disableCookiesUsage),e.canSendStatEvent&&(this._config.canSendStatEvent=e.canSendStatEvent),e.enableAutoUserSession&&"undefined"!=typeof window&&window.addEventListener&&(this._config.enableAutoUserSession=e.enableAutoUserSession),e.clockSkewRefreshDurationInMins>0&&(this._config.clockSkewRefreshDurationInMins=e.clockSkewRefreshDurationInMins)},e._loggers={},e._isInitialized=!1,e._isDestroyed=!1,e._config={collectorUri:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",cacheMemorySizeLimitInNumberOfEvents:1e4,disableCookiesUsage:!1,canSendStatEvent:function(e){return!0},clockSkewRefreshDurationInMins:0},e}(),En=function(){function e(){}return e.setEventsHandler=function(e){this._eventHandler=e},e.getEventsHandler=function(){return this._eventHandler},e.scheduleTimer=function(){var e=this,t=this._profiles[this._currentProfile][2];this._timeout<0&&t>=0&&!this._paused&&(this._eventHandler.hasEvents()?(0===t&&this._currentBackoffCount>0&&(t=1),this._timeout=setTimeout((function(){return e._batchAndSendEvents()}),t*(1<<this._currentBackoffCount)*1e3)):this._timerCount=0)},e.initialize=function(e){var t=this;this._newEventsAllowed=!0,this._config=e,this._eventHandler=new Vt(e.collectorUri,e.cacheMemorySizeLimitInNumberOfEvents,e.httpXHROverride,e.clockSkewRefreshDurationInMins),this._initializeProfiles(),Ct.initialize((function(e,n){if(t._config.canSendStatEvent("awt_stats")){var r=new Et("awt_stats");for(var i in r.setEventPriority(Ve.High),r.setProperty("TenantId",n),e)e.hasOwnProperty(i)&&r.setProperty(i,e[i].toString());wn.getLogger(st).logEvent(r)}}))},e.setTransmitProfile=function(e){this._currentProfile!==e&&void 0!==this._profiles[e]&&(this.clearTimeout(),this._currentProfile=e,this.scheduleTimer())},e.loadTransmitProfiles=function(e){for(var t in this._resetTransmitProfiles(),e)if(e.hasOwnProperty(t)){if(3!==e[t].length)continue;for(var n=2;n>=0;--n)if(e[t][n]<0){for(var r=n;r>=0;--r)e[t][r]=-1;break}for(n=2;n>0;--n)if(e[t][n]>0&&e[t][n-1]>0){var i=e[t][n-1]/e[t][n];e[t][n-1]=Math.ceil(i)*e[t][n]}this._profiles[t]=e[t]}},e.sendEvent=function(e){this._newEventsAllowed&&(this._currentBackoffCount>0&&e.priority===Ve.Immediate_sync&&(e.priority=Ve.High),this._eventHandler.addEvent(e),this.scheduleTimer())},e.flush=function(e){var t=(new Date).getTime();!this._paused&&this._lastUploadNowCall+3e4<t&&(this._lastUploadNowCall=t,this._timeout>-1&&(clearTimeout(this._timeout),this._timeout=-1),this._eventHandler.uploadNow(e))},e.pauseTransmission=function(){this._paused||(this.clearTimeout(),this._eventHandler.pauseTransmission(),this._paused=!0)},e.resumeTransmision=function(){this._paused&&(this._paused=!1,this._eventHandler.resumeTransmission(),this.scheduleTimer())},e.flushAndTeardown=function(){Ct.teardown(),this._newEventsAllowed=!1,this.clearTimeout(),this._eventHandler.teardown()},e.backOffTransmission=function(){this._currentBackoffCount<4&&(this._currentBackoffCount++,this.clearTimeout(),this.scheduleTimer())},e.clearBackOff=function(){this._currentBackoffCount>0&&(this._currentBackoffCount=0,this.clearTimeout(),this.scheduleTimer())},e._resetTransmitProfiles=function(){this.clearTimeout(),this._initializeProfiles(),this._currentProfile="REAL_TIME",this.scheduleTimer()},e.clearTimeout=function(){this._timeout>0&&(clearTimeout(this._timeout),this._timeout=-1,this._timerCount=0)},e._batchAndSendEvents=function(){var e=Ve.High;this._timerCount++,this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][0]?(e=Ve.Low,this._timerCount=0):this._timerCount*this._profiles[this._currentProfile][2]===this._profiles[this._currentProfile][1]&&(e=Ve.Normal),this._eventHandler.sendEventsForPriorityAndAbove(e),this._timeout=-1,this.scheduleTimer()},e._initializeProfiles=function(){this._profiles={},this._profiles.REAL_TIME=[4,2,1],this._profiles.NEAR_REAL_TIME=[12,6,3],this._profiles.BEST_EFFORT=[36,18,9]},e._newEventsAllowed=!1,e._currentProfile="REAL_TIME",e._timeout=-1,e._currentBackoffCount=0,e._paused=!1,e._timerCount=0,e._lastUploadNowCall=0,e}(),In=function(){function e(e){this._apiKey=e,this._contextProperties=new Et,this._semanticContext=new bn(!1,this._contextProperties),this._sessionStartTime=0,this._createInitId()}return e.prototype.setContext=function(e,t,n){void 0===n&&(n=je.Unspecified),this._contextProperties.setProperty(e,t,n)},e.prototype.setContextWithPii=function(e,t,n,r){void 0===r&&(r=je.Unspecified),this._contextProperties.setPropertyWithPii(e,t,n,r)},e.prototype.setContextWithCustomerContent=function(e,t,n,r){void 0===r&&(r=je.Unspecified),this._contextProperties.setPropertyWithCustomerContent(e,t,n,r)},e.prototype.getSemanticContext=function(){return this._semanticContext},e.prototype.logEvent=function(t){if(Tn.loggingEnabled){this._apiKey||(this._apiKey=Tn.defaultTenantToken,this._createInitId());var n=!0;ft(t)?t={name:t}:t instanceof Et&&(t=t.getEvent(),n=!1),Ct.eventReceived(this._apiKey),e._logEvent(e._getInternalEvent(t,this._apiKey,n),this._contextProperties)}},e.prototype.logSession=function(t,n){if(Tn.sessionEnabled){var r={name:"session",type:"session",properties:{}};if(e._addPropertiesToEvent(r,n),r.priority=Ve.High,t===Ke.Started){if(this._sessionStartTime>0)return;this._sessionStartTime=(new Date).getTime(),this._sessionId=dt(),this.setContext("Session.Id",this._sessionId),r.properties["Session.State"]="Started"}else{if(t!==Ke.Ended)return;if(0===this._sessionStartTime)return;var i=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);r.properties["Session.Id"]=this._sessionId,r.properties["Session.State"]="Ended",r.properties["Session.Duration"]=i.toString(),r.properties["Session.DurationBucket"]=e._getSessionDurationFromTime(i),this._sessionStartTime=0,this.setContext("Session.Id",null),this._sessionId=void 0}r.properties["Session.FirstLaunchTime"]=Sn.firstLaunchTime,this.logEvent(r)}},e.prototype.getSessionId=function(){return this._sessionId},e.prototype.logFailure=function(t,n,r,i,o){if(t&&n){var s={name:"failure",type:"failure",properties:{}};e._addPropertiesToEvent(s,o),s.properties["Failure.Signature"]=t,s.properties["Failure.Detail"]=n,r&&(s.properties["Failure.Category"]=r),i&&(s.properties["Failure.Id"]=i),s.priority=Ve.High,this.logEvent(s)}},e.prototype.logPageView=function(t,n,r,i,o,s){if(t&&n){var a={name:"pageview",type:"pageview",properties:{}};e._addPropertiesToEvent(a,s),a.properties["PageView.Id"]=t,a.properties["PageView.Name"]=n,r&&(a.properties["PageView.Category"]=r),i&&(a.properties["PageView.Uri"]=i),o&&(a.properties["PageView.ReferrerUri"]=o),this.logEvent(a)}},e.prototype._createInitId=function(){!e._initIdMap[this._apiKey]&&this._apiKey&&(e._initIdMap[this._apiKey]=dt())},e._addPropertiesToEvent=function(e,t){if(t)for(var n in t instanceof Et&&(t=t.getEvent()),t.name&&(e.name=t.name),t.priority&&(e.priority=t.priority),t.properties)t.properties.hasOwnProperty(n)&&(e.properties[n]=t.properties[n])},e._getSessionDurationFromTime=function(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"},e._logEvent=function(e,t){e.name&&ft(e.name)?(e.name=e.name.toLowerCase(),e.name=e.name.replace(it,"_"),e.type&&ft(e.type)?e.type=e.type.toLowerCase():e.type="custom",rt.test(e.name)&&rt.test(e.type)?((!ht(e.timestamp)||e.timestamp<0)&&(e.timestamp=(new Date).getTime()),e.properties||(e.properties={}),this._addContextIfAbsent(e,t.getPropertyMap()),this._addContextIfAbsent(e,Tn.logManagerContext.getPropertyMap()),this._setDefaultProperty(e,"EventInfo.InitId",this._getInitId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.Sequence",this._getSequenceId(e.apiKey)),this._setDefaultProperty(e,"EventInfo.SdkVersion","AWT-Web-JS-1.8.6"),this._setDefaultProperty(e,"EventInfo.Name",e.name),this._setDefaultProperty(e,"EventInfo.Time",new Date(e.timestamp).toISOString()),gt(e.priority)||(e.priority=Ve.Normal),this._sendEvent(e)):It.eventsRejected([e],Qe.InvalidEvent)):It.eventsRejected([e],Qe.InvalidEvent)},e._addContextIfAbsent=function(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e.properties[n]||(e.properties[n]=t[n]))},e._setDefaultProperty=function(e,t,n){e.properties[t]={value:n,pii:He.NotSet,type:je.String}},e._sendEvent=function(e){En.sendEvent(e)},e._getInternalEvent=function(e,t,n){if(e.properties=e.properties||{},n)for(var r in e.properties)e.properties.hasOwnProperty(r)&&(e.properties[r]=mt(r,e.properties[r]),null===e.properties[r]&&delete e.properties[r]);var i=e;return i.id=dt(),i.apiKey=t,i},e._getInitId=function(t){return e._initIdMap[t]},e._getSequenceId=function(t){return void 0===e._sequenceIdMap[t]&&(e._sequenceIdMap[t]=0),(++e._sequenceIdMap[t]).toString()},e._sequenceIdMap={},e._initIdMap={},e}(),Cn=(function(){function e(){}e.setEventsHandler=function(e){En.setEventsHandler(e)},e.getEventsHandler=function(){return En.getEventsHandler()},e.scheduleTimer=function(){En.scheduleTimer()}}(),/\./g),kn=0;function On(e,t,n){t&&t.forEach((function(t){if(!t.classification||t.classification===We.SystemMetadata){var r=["","",t.name],i=r[0],o=r[1],s=r[2],a=t.name.indexOf(".");a>0&&"zC"===t.name.substr(0,a)&&(i=t.name.substring(0,a+1),s=t.name.substring(a+1)),n&&(o="Data.");var u=i+o+s;e.properties[u]={value:t.value,type:Dn(t.dataType)}}}))}function Dn(e){switch(e){case ce.String:return je.String;case ce.Boolean:return je.Boolean;case ce.Int64:return je.Int64;case ce.Double:return je.Double;default:throw new Error(e)}}var An,Bn,Nn,xn,Pn,Fn=!1;function Mn(e,t,n){var r;if(Ln(),!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Unable to find ariaTenantToken for namespace.");r=function(e,t,n){var r,i,o={name:(r=e.eventName,r.toLowerCase().replace(Cn,"_")),properties:{}};if(!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Unable to find ariaTenantToken for namespace.");return o.properties["Event.Sequence"]={value:++kn,type:je.Int64},o.properties["Event.Name"]=e.eventName,o.properties["Event.Source"]="OTelJS",i=n?new Date(n):new Date,o.properties["Event.Time"]={value:i,type:je.Date},e.eventContract&&(o.properties["Event.Contract"]=e.eventContract.name,On(o,e.eventContract.dataFields,!1)),On(o,t,!1),On(o,e.dataFields,!0),o}(e,t,n),wn.getLogger(e.telemetryProperties.ariaTenantToken).logEvent(r)}function Ln(e){Fn||(wn.addNotificationListener({eventsSent:function(e){he(oe.Info,se.Transport,(function(){return"Successfully sent "+e.length+" event(s)"})),he(oe.Verbose,se.Transport,(function(){return"Sent event(s) details : "+JSON.stringify(e,null,2)})),e.length},eventsDropped:function(e,t){he(oe.Error,se.Transport,(function(){return"Dropped "+e.length+" event(s) because "+t})),he(oe.Verbose,se.Transport,(function(){return"Dropped event(s) details : "+JSON.stringify(e,null,2)})),e.length},eventsRejected:function(e,t){he(oe.Error,se.Transport,(function(){return"Rejected "+e.length+" event(s) because "+t})),he(oe.Verbose,se.Transport,(function(){return"Rejected event(s) details : "+JSON.stringify(e,null,2)})),e.length},eventsRetrying:function(e){he(oe.Warning,se.Transport,(function(){return"Retrying "+e.length+" event(s)"})),he(oe.Verbose,se.Transport,(function(){return"Retrying event(s) details : "+JSON.stringify(e,null,2)})),e.length}}),wn.initialize("cd836626611c4caaa8fc5b2e728ee81d-3b6d6c45-6377-4bf5-9792-dbf8e1881088-7521",e),Fn=!0)}!function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"}(An||(An={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(Bn||(Bn={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(Nn||(Nn={})),function(e){e[e.NotSet=0]="NotSet",e[e.SoftwareSetup=1]="SoftwareSetup",e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance",e[e.DeviceConfiguration=8]="DeviceConfiguration",e[e.InkingTypingSpeech=16]="InkingTypingSpeech"}(xn||(xn={})),function(e){e[e.ReservedDoNotUse=0]="ReservedDoNotUse",e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.NecessaryServiceDataEvent=110]="NecessaryServiceDataEvent",e[e.AlwaysOnNecessaryServiceDataEvent=120]="AlwaysOnNecessaryServiceDataEvent"}(Pn||(Pn={}));var Rn=function(){function e(){this._fullEventsEnabled=!1}return e.prototype.processEvent=function(e){return this._fullEventsEnabled||!!e.eventFlags&&(e.eventFlags.diagnosticLevel===Pn.BasicEvent||e.eventFlags.diagnosticLevel===Pn.NecessaryServiceDataEvent||e.eventFlags.diagnosticLevel===Pn.AlwaysOnNecessaryServiceDataEvent)},e.prototype.setFullEventsEnabled=function(e){this._fullEventsEnabled=e},e}(),Un=function(){function e(e,t){void 0===e&&(e=[]),this._preprocessors=[],this._additionalDataFields=e,this._fullEventProcessor=new Rn,this.addPreprocessor(this._fullEventProcessor),Ln({cacheMemorySizeLimitInNumberOfEvents:t})}return e.prototype.sendTelemetryEvent=function(e,t){try{for(var n=0;n<this._preprocessors.length;n++)if(!this._preprocessors[n].processEvent(e))return;Mn(e,this._additionalDataFields,t)}catch(e){he(oe.Error,se.Sink,(function(){return"AriaSink caught an error : "+(e instanceof Error?e.message:JSON.stringify(e))}))}},e.prototype.addPreprocessor=function(e){this._preprocessors.push(e)},e.prototype.setFullEventsEnabled=function(e){this._fullEventProcessor.setFullEventsEnabled(e)},e.prototype.disableBeaconsApiAvailabilityForAriaSdk=function(){return function(){var e=En.getEventsHandler();if(e instanceof Vt){var t=e._httpManager;if(t&&t.hasOwnProperty("_useBeacons"))return t._useBeacons=!1,!0}return!1}()},e.prototype.shutdown=function(){wn.flushAndTeardown()},e}(),Wn=function(){function e(e,t,n,r){var i=this;void 0===n&&(n=!1),void 0===r&&(r=new Ye),this.aggregateStream=n,this.telemetryLogger=r,this.name=function(){return"OTelSink"},this.writeEntry=function(e){(e?e.messageData:null)&&i.sendTraceMessage(e),(e?e.eventActionData:null)&&i.sendEventEntry(e)},this.flush=function(){return function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];S.apply(void 0,Object(s.g)(["color:black",e],t))}("OTelSink flush")},this.beginEvent=function(e,t){var n=i.getOTelActivityName(e||"EventError"),r=t&&t.context,o=r&&r.activityScope,s={activityScope:i.createOTelEvent(n,void 0,o),aggregatedScope:i.aggregateStream?i.createOTelEvent("Aggregated",n,o):void 0};return E(0===n.indexOf(i.eventNamePrefix),"eventName prefix not expected",n),{context:s}},this.endEvent=function(e,t){var n=t&&t.context;if(t){i.endEventScope(e,n.activityScope),n.aggregatedScope&&i.endEventScope(e,n.aggregatedScope);var r=e&&e.eventActionData;r&&T("OTelSink: 0x"+r.eventTagId.toString(16)+" "+r.eventActionType)}else E(n,"activityInfo not defined",t)},this.sendOTelEvent=function(e){E(e,"telemetryEvent not defined",e),e&&i.telemetryLogger.sendTelemetryEvent(e)},this.sendOTelActivity=function(e){E(e,"activityScope not defined",e),e&&e.endNow()},this.endEventScope=function(e,t){var n=e&&e.eventActionData;if(n){var r=e.eventFlags;H(Object(s.f)(e,["eventFlags"]),(function(e,n){t.addDataField(i.getDataField(e,n))})),t.setEventFlags(r);var o=n.responseCode,a=n.resultType;t.setSuccess("Failure"!==a&&"Timeout"!==a),void 0===o?t.setResult(0,"HRESULT"):t.setResult(o,"ResponseCode",n.eventTagId),i.sendOTelActivity(t)}else E(n,"eventActionData not defined",e)},this.getDataField=function(e,t){switch(typeof t){case"number":return{classification:We.SystemMetadata,dataType:isFinite(t)&&Math.floor(t)===t?ce.Int64:ce.Double,name:e,value:t};case"boolean":return{classification:We.SystemMetadata,dataType:ce.Boolean,name:e,value:t};default:return{classification:We.SystemMetadata,dataType:ce.String,name:e,value:t.toString()}}},E(e.ariaTenantToken&&e.nexusTenantToken,"must supply tokens");var o,a,u,c,l,d,f,h=(c=(o=e).ariaTenantToken,l=o.feature,d=o.nexusTenantToken,(f=o.project)&&l&&c&&d&&{Office:(a={},a[f]=(u={},u[l]={},u.ariaTenantToken=c,u.nexusTenantToken=d,u),a)}||void 0);E(h,"unable to create subnamespaceTml"),this.eventNamePrefix=function(e){var t=e.eventNamePrefix,n=e.feature;return"Office."+e.project+"."+n+"."+(t||"")}(e),r.addSink(t),r.setTenantTokens(h)}return e.prototype.sendTraceMessage=function(e){var t=this,n=e?e.messageData:null;if(n){var r={correlationId:e.metadata.correlationId,eventTagId:n.eventTagId,logLevel:n.logLevel,message:n.message,messageDetails:n.messageDetails,sessionId:e.metadata.sessionId},i=[];j(r,(function(e,n){return i.push(t.getDataField(e,n))})),this.sendEvent("Message",e.eventFlags,i),T("OTelSink: 0x"+n.eventTagId.toString(16)+" "+n.message+","+r)}},e.prototype.sendEventEntry=function(e){var t=this,n=e?e.eventActionData:null;if(n){var r=[],i=e.eventFlags;H(Object(s.f)(e,["eventFlags"]),(function(e,n){r.push(t.getDataField(e,n))}));var o=function(e){var t=null;return e?(e.eventActionData?t=e.eventActionData.eventActionType:e.messageData&&(t="Message"),t):(E(e,"Invalid logEntry"),t)}(e)||"EventError";if(this.sendEvent(o,i,r),o&&"message"!==o.toLowerCase())r.push({classification:We.SystemMetadata,dataType:ce.String,name:"SourceEvent",value:o}),this.sendEvent("Aggregated",i,r);T("OTelSink: 0x"+n.eventTagId.toString(16)+" "+n.eventActionType+","+r)}},e.prototype.sendEvent=function(e,t,n){E(e,"eventName not defined",e,n),E(n&&n.length>0,"dataFieldInfo not valid",e,n);var r={dataFields:n,eventFlags:t,eventName:this.getOTelActivityName(e)};this.sendOTelEvent(r)},e.prototype.createOTelEvent=function(e,t,n){var r=De.createNew(this.telemetryLogger,e);return t&&r.addDataField(this.getDataField("SourceEvent",t)),r},e.prototype.getOTelActivityName=function(e){return""+this.eventNamePrefix+e},e}();function jn(e){void 0===e&&(e=!1);var t=e,n=function(e){return e&&-1!==e.indexOf("owsclg")};t||(t=!!n("undefined"!=typeof window&&window.location.search));t||(t=!!n("undefined"!=typeof document&&document.referrer));t&&(l=!0,Q.removeSinks(re.name),Q.addSink(new re))}function Hn(e,t){var n=t.customMetadata,r=t.customSessionId,i=t.contentStorageUrl,o=t.enableFullEvents;Q.clearSinks(),function(e,t,n){var r={BuildTimeStamp:"2020-04-10T19:14:13.101Z",CustomMetadata:e,CustomSessionId:t,Environment:C(ie(n))};return k.setConfiguration(r),Q.setConfiguration(r),r}(n,r,i).Environment===y.Prod&&function(e,t,n){void 0===n&&(n=!0);var r=new Un([ve("Session.Id",t)]);r.setFullEventsEnabled(n),Q.addSink(new Wn(e,r))}(e,r,o),jn()}var qn=function(e,t,n,r,i,o,s){return void 0===s&&(s=-1),Q.userActionEvent(e,t,{customData:{button:n,elapsedTime:Date.now()-i,itemCount:s,renderIndex:r,surfaceId:o}})},Vn=function(e,t,n){return void 0===t&&(t=!1),Object(s.b)(void 0,void 0,void 0,(function(){return Object(s.e)(this,(function(n){switch(n.label){case 0:return K=e||{},Z=t,function(e){var t={ariaTenantToken:"cf7a002ba9374401bace61695550f784-d6d47427-ea71-43a3-ac3d-e25a6b4df199-6870",eventNamePrefix:"",feature:"Web",nexusTenantToken:1783,project:"ProgrammableSurfaces"};t&&t.ariaTenantToken&&t.nexusTenantToken||console.log("FG-OWS-OTEL config not valid",t),t&&Hn(t,{customSessionId:e.logSessionId||A()}),e.logSettings&&e.logSettings.consoleLog&&jn(!0);var n=e.telemetryGroup||{};Q.event(593602525,"Init",{customData:Object(s.a)({buildTime:"2020-04-10T19:14:13.101Z",hostAppId:e.appId,hostBuild:e.build,hostEnv:e.env,hostLocale:e.originalLocale,surfaceId:e.surfaceId,hostAudience:n.audienceGroup,hostFlights:n.flights,hostPlatform:n.platform,loadDelay:R(),loadTime:e.surfaceInitTime?Date.now()-e.surfaceInitTime:void 0},U())})}(e),e.preloadFabricPackage?[4,ne()]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},zn=function(e){var t=e.attributes,n=void 0===t?{}:t,r=e.classNames,i=void 0===r?[]:r,o=e.id,s=void 0===o?"":o,a=e.parentElement,u=void 0===a?document.body||document:a,c=document.createElement("div");return Object.keys(n).forEach((function(e){return c.setAttribute(e,n[e])})),i.forEach((function(e){return c.classList.add(e)})),s&&(c.id=s),u.appendChild(c),c},Qn=function(e,t){return document.getElementById(e)||zn({id:e,parentElement:t})},Gn=function(e){if(e)for(var t=0,n=e;t<n.length;t++){var r=n[t];try{var i=document.querySelector(r);if(i)return{selector:r,targetElement:i}}catch(e){Q.local("query selector error",e)}}},Kn=function(e){e.parentElement?e.parentElement.removeChild(e):e.remove&&e.remove()},Zn=0,Jn=Date.now(),Xn=function(){return"MS-OWS-id-"+Jn+"-"+ ++Zn},Yn=function(e,t){window&&window.removeEventListener(e,t)};function $n(e){return null!=e}var er,tr,nr,rr=function(e){return Object(s.b)(void 0,void 0,void 0,(function(){return Object(s.e)(this,(function(t){return[2,new Promise((function(t,n){if(document.querySelector('script[src="'+e+'"]'))t(e);else{var r=document.createElement("script");r.src=e,r.onload=function(){return t(e)},r.onerror=function(e,t,i,o,s){r.remove();var a=s&&s.stack;Q.error(594366469,"error loading script "+t+", "+i+", "+o+", "+a),n(null)},document.head.appendChild(r)}}))]}))}))},ir=function(e,t,n){try{if(e&&t){var r=Y();if(r&&r.beaconCallback)r.beaconCallback({actionName:e,actionUrl:t});else!function(e,t){t?window&&window.fetch?window.fetch(t).then((function(e){e.ok||Q.error(595656793,"fetching url was not successful with status "+e.status)})).catch((function(t){return Q.error(595687457,"error fetching url "+e,t&&t.message)})):Q.error(595687456,"fetch not available"):Q.error(595687455,"invalid url")}(e,(n.actionUrl||"https://messaging.office.com/lifecycle/setcampaignaction")+"?actionUrl="+encodeURIComponent(t)+"&actionName="+encodeURIComponent(e))}else Q.error(593504403,"actionName or actionUrl were undefined for beacon callback",e,t)}catch(e){Q.error(593504404,"failed to perform beacon callback",e)}},or=function(e,t){return ir(e,t.actionBeaconUrl,t)},sr=function(e,t){var n=function(e){switch(e){case"isAA":case"isControl":return"SHOWED";case"auto dismiss":case"close":return"dismiss";case"primary":return"click1";case"secondary":return"click2";case"error":default:return}}(e);if(n)return ir(n,t.actionBeaconUrl,t)},ar=function(e){return"sequence"===e.surfaceType},ur=function(e){var t=e.surfaceParams,n=e.isAlternateTrigger,r=void 0!==n&&n,i=e.shouldRemoveSurface,o=void 0===i||i,s=e.targetElementInfo,a=s.selector,u=s.targetElement,c=Date.now(),l=function(){Q.userActionEvent(593504401,"TargetElementClicked",{customData:{isAlternateTrigger:r,selector:a,timeToClick:Date.now()-c}}),or("conversion",t);var e=t&&t.targetAction;e&&"function"==typeof e&&e(),o&&dr(),u.removeEventListener("click",l)};u.addEventListener("click",l)},cr=function(){return ee()+"-App"},lr=function(){qn(Q.reserve(593504402),"SurfaceUnload","unload",0,X(),Y().surfaceId),Yn("beforeunload",lr)},dr=function(e){void 0===e&&(e=!1),e&&Yn("beforeunload",lr),function(){var e,t=document.getElementById(cr());t&&(null===(e=te())||void 0===e||e.unmountComponentAtNode(t));var n=t&&t.parentElement;n&&n.getAttribute("data-ows")&&Kn(n)}()},fr=["anchorHint","closeButtonAriaLabel","backgroundColor","imageFetchCorsMode","position","preventAutoDismiss","smallHeadline"],hr=function(e,t){return{alias:t,defaultValue:e}},pr=hr(0),vr=hr(!1),gr=hr({}),mr=hr(""),yr={backgroundColor:mr,beaconColor:mr,buttonHoverColor:mr,primaryButtonHoverColor:mr,textColor:mr,creativeId:mr,payloadId:mr,surfaceName:mr,actionBeaconUrl:mr,actionUrl:mr,impressionBeaconUrl:mr,isAA:vr,isControl:vr,telemetryEventName:mr,delayLoad:pr,eventDispatchDelay:pr,preFetchDelay:pr,timeout:pr,version:mr,alternativeTriggerSelectors:hr([]),anchorElementSelectors:hr([]),anchorValidation:mr,customTheme:hr({}),primaryButtonAction:mr,primaryButtonActionParams:hr({}),secondaryButtonAction:mr,secondaryButtonActionParams:hr({}),surfaceType:hr("teaching"),targetAction:mr,useNativeRender:vr,customProperties:hr({}),alertAriaText:mr,anchorHint:hr("bottomCenter"),closeButtonAriaLabel:mr,description:mr,footer:mr,illustrationImage:mr,imageAriaLabel:mr,imageFetchCorsMode:hr("no-cors"),position:hr("top"),preventAutoDismiss:vr,primaryButton:mr,primaryButtonAriaDescription:mr,primaryButtonText:hr("","primaryButton"),secondaryButton:mr,secondaryButtonAriaDescription:mr,secondaryButtonText:hr("","secondaryButton"),smallHeadline:vr,title:mr,itemCount:pr,customStyles:gr,hasCoachMark:vr,localizedStyles:hr({})},_r=function(e,t){void 0===t&&(t=!0);var n=function(e,t){return function(n){var r=t[n.trim().toLowerCase()];if(r){var i=e[n],o="string"==typeof i&&i.trim();if(o?e[r]=o:r!==n&&(e[r]=i),o)try{var s=yr[r];switch(s&&typeof s.defaultValue){case"boolean":var a=o.toLowerCase();e[r]="true"===a||"y"===a;break;case"number":e[r]=parseInt(o,10);break;default:"["!==o[0]&&"{"!==o[0]||(e[r]=JSON.parse(o))}}catch(e){Q.error(593504394,"error parsing surface param",n,i,e)}}}}(e,(er||(er={},Object.keys(yr).forEach((function(e){er[e.toLowerCase()]=e}))),er));Object.keys(e).forEach(n),t&&!e.surfaceType&&(e.surfaceType=e.hasCoachMark?"coachmark":"teaching");var r=function(t){t&&(_r(t,!1),Object.keys(t).forEach((function(n){e[n]=t[n]})))};r(e.customStyles),r(e.customProperties),Object.keys(yr).forEach((function(t){var n=t,r=yr[n],i=r&&r.alias;i&&void 0===e[n]&&void 0!==e[i]&&(e[n]=e[i])}))},Sr=function(e,t){for(var n=e.toString(),r={},i=0,o=Object.keys(t);i<o.length;i++){var s=o[i];if(s.endsWith(n)){var a=s.substring(0,s.length-1);r[a]=t[s]}}return _r(r),r.surfaceType=r.surfaceType||"teaching",fr.forEach((function(e){void 0===r[e]&&void 0!==t[e]&&(r[e]=t[e])})),t.itemCount>1&&"teaching"===r.surfaceType&&void 0===r.footer&&(r.footer=e+" of "+t.itemCount),r},br=!1,Tr=function(e){var t,n;br||(n={disableWarnings:!0},void 0===(t=void 0)&&(t="https://static2.sharepointonline.com/files/fabric/assets/icons/"),(0,e.registerIcons)({fontFace:{fontFamily:'"FabricMDL2Icons"',src:"url('"+t+"fabric-icons-a13498cf.woff') format('woff')"},icons:{Cancel:""},style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"}},n),br=!0)},wr=function(e,t){e.startsWith("data:image")||(window.fetch?window.fetch(e,{mode:t||"no-cors"}).catch((function(e){return Q.error(593504400,"failed to pre fetch image",e&&e.message)})):(new Image).src=e)},Er=function(e){!function(e){if(ar(e))for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];r.startsWith("illustrationImage")&&wr(e[r],e.imageFetchCorsMode)}else e.illustrationImage&&wr(e.illustrationImage,e.imageFetchCorsMode)}(e);var t=te();t&&Tr(t)};!function(e){e[e.coachmark=0]="coachmark",e[e.teaching=1]="teaching",e[e.sequence=2]="sequence"}(tr||(tr={})),function(e){e[e.backgroundColor=0]="backgroundColor",e[e.beaconColor=1]="beaconColor",e[e.buttonHoverColor=2]="buttonHoverColor",e[e.primaryButtonHoverColor=3]="primaryButtonHoverColor",e[e.textColor=4]="textColor"}(nr||(nr={}));var Ir=function(e,t){return e?e.startsWith(".")?function(e){var t=e.split(" ").filter((function(e){return e.startsWith(".")})).reduce((function(e,t){var n=e[0],r=e[1],i=zn({classNames:t.split(".").filter((function(e){return e})),parentElement:r});return[n||i,i]}),[]),n=t[0],r=t[1],i=getComputedStyle(r).color;return Kn(n),i}(e)||t:e:t},Cr=window&&window.navigator&&(-1!==window.navigator.userAgent.indexOf("MSIE")||-1!==window.navigator.appVersion.indexOf("Trident/")),kr=Cr?"15px":"10px",Or=function(e,t){return{ariaDescribedBy:Xn()+"-TD",ariaLabelledBy:Xn()+"-TL",calloutProps:{directionalHint:t.anchorHint&&e.DirectionalHint[t.anchorHint],id:"obf-DynamicWebSurfaces"},closeButtonAriaLabel:t.closeButtonAriaLabel,footerContent:t.footer,hasCloseIcon:!0,hasSmallHeadline:t.smallHeadline||!0,headline:t.title,illustrationImage:{"aria-label":t.imageAriaLabel,onLoadingStateChange:t.onImageLoaded,src:t.illustrationImage,styles:Cr?Ar():void 0},isWide:Dr(t),onDismiss:t.onCalloutDismiss,primaryButtonProps:{ariaDescription:t.primaryButtonAriaDescription,ariaLabel:t.primaryButtonText,onClick:t.onPrimaryButtonClick,text:t.primaryButtonText},secondaryButtonProps:t.secondaryButtonText?{ariaDescription:t.secondaryButtonAriaDescription,ariaLabel:t.secondaryButtonText,onClick:t.onSecondaryButtonClick,text:t.secondaryButtonText}:void 0,styles:{content:{marginLeft:Dr(t)?kr:void 0}},target:t.targetElement}},Dr=function(e){return e&&"left"===e.position},Ar=function(){return{image:{objectFit:"contain",height:"100%",width:"100%"}}},Br=function(e){return e.styled(function(e){return function(t){var n=e.createElement,r=e.Coachmark,i=e.DirectionalHint,o=e.TeachingBubbleContent,a=e.useEffect,u=e.useRef,c=e.useState,l=u(),d=c(!0),f=d[0],h=d[1];a((function(){var e=function(){return document.removeEventListener("keyup",t)},t=function(t){try{t&&9!==t.keyCode&&"Tab"!==t.key&&117!==t.keyCode&&"F6"!==t.key||(e(),h(!1))}catch(e){Q.error(594882954,"error opening coachmark",e)}};return e(),document.addEventListener("keyup",t),setTimeout((function(){var e,t;try{var n=null===(t=null===(e=l.current)||void 0===e?void 0:e._entityHost)||void 0===t?void 0:t.current;n&&!n.id&&(n.id="obf-DynamicWebSurfaces")}catch(e){Q.error(594882953,"error setting coachmark id",e)}}),1e3),e}),[]);var p=t.anchorHint||"bottomCenter";return n(r,{ariaAlertText:t.alertAriaText,ariaDescribedByText:t.description,ariaLabelledByText:t.title,color:t.theme&&t.theme.palette.themePrimary,componentRef:l,isCollapsed:f,isPositionForced:!1,onAnimationOpenEnd:t.onExpand,persistentBeak:!0,positioningContainerProps:{directionalHint:i[p]},preventFocusOnMount:!0,target:t.targetElement},n(o,Object(s.a)({},Or(e,t),{styles:t.styles}),t.description))}}(e),{},void 0,{scope:"TeachingBubble"})},Nr=["description","primaryButtonText","selector","surfaceType","targetElement"],xr=function(e,t){if(!e)return"none";if("function"==typeof e)return e(),"callback";var n,r=e.toLowerCase();if(0===r.indexOf("http"))return window.open(r)||Q.error(593504389,"window.open reference is null for url button click action"),"url";if(!t)return"none";if(0===r.indexOf("event")){var i=t.eventName;if(!i)return Q.error(594366470,"Invalid event name"),"error";var o={detail:t};return document.dispatchEvent(new CustomEvent(i,o)),"event"}if(0===r.indexOf("script")){var a=function(){var e=t&&t.globalMethod&&window[t.globalMethod];e&&e(t)};return t.script?(n=t.script,Object(s.b)(void 0,void 0,void 0,(function(){return Object(s.e)(this,(function(e){return[2,Array.isArray(n)?Promise.all(n.map(rr)):rr(n)]}))}))).then((function(){a()})).catch((function(e){Q.error(594366471,"Script error "+t.script+" "+e)})):a(),"script"}return"unhandled"},Pr=function(e,t,n,r,i,o,s){return function(){var a="error";try{a=xr(i,o)}catch(e){Q.error(594366472,"error invoking input action")}Q.userActionEvent(e,"SurfaceButtonClicked",{customData:{action:a,button:t,eventType:s||"",selector:n.selector,surfaceType:n.surfaceType}}),r(!0),n.onClosed&&n.onClosed(t)}},Fr=function(e,t){return function(n){if(n&&n.currentTarget&&n.currentTarget.className&&-1!==n.currentTarget.className.indexOf("ms-TeachingBubble-closebutton"))Pr(Q.reserve(595858951),"close",e,t,void 0,void 0,n.type)();else{if(e.preventAutoDismiss)return void(n&&"click"===n.type&&Q.userActionEvent(593504390,"SurfaceDismissPrevented",{customData:{autoDismiss:!0,eventType:"click",surfaceType:e.surfaceType}}));Pr(Q.reserve(595858950),"auto dismiss",e,t,void 0,void 0,n&&n.type)()}}},Mr=function(e,t){return function(){Q.userActionEvent(593504391,"SurfaceExpanded",{customData:{elapsedTime:Date.now()-e}}),null==t||t()}},Lr=function(e){return function(t){return Q.userActionEvent(593504392,"ImageLoaded",{customData:{elapsedTime:Date.now()-e,imageLoadedState:t}})}},Rr=function(e,t){return Pr(Q.reserve(595858952),"primary",e,t,e.primaryButtonAction,e.primaryButtonActionParams)},Ur=function(e,t){return Pr(Q.reserve(595858953),"secondary",e,t,e.secondaryButtonAction,e.secondaryButtonActionParams)},Wr=function(e){return function(t){var n=e.createElement,r=e.Customizer,i=(0,e.useState)(!1),o=i[0],a=i[1];if(o||!function(e){var t=Nr.filter((function(t){return!$n(e[t])}));return!t.length||(Q.error.apply(Q,Object(s.g)([593504388,"Invalid props passed to OfficeWebServiceContainer"],t)),!1)}(t))return null;var u=Date.now(),c=Object(s.a)(Object(s.a)({},t),{onCalloutDismiss:Fr(t,a),onExpand:Mr(u,t.onUpdated),onImageLoaded:Lr(u),onPrimaryButtonClick:Rr(t,a),onSecondaryButtonClick:Ur(t,a)}),l=function(){switch(t.surfaceType){case"coachmark":return n(Br(e),c);case"teaching":return n(function(e){return function(t){return(0,e.createElement)(e.TeachingBubble,Object(s.a)({},Or(e,t)),t.description)}}(e),c);default:return Q.error(593504393,"attempted to render unknown surface",t.surfaceType),null}}();if(!l)return null;var d=function(e,t,n){var r=e.createTheme;if(t||N(nr).some((function(e){return $n(n[e])}))){var i=t||{},o=i.scopedSettings,a=void 0===o?{}:o,u=i.settings,c=void 0===u?{}:u,l=c.theme,d=void 0===l?r({}):l,f=d.palette||{};return Object(s.a)(Object(s.a)({},t),{scopedSettings:a,settings:Object(s.a)(Object(s.a)({},c),{theme:Object(s.a)(Object(s.a)({},d),{palette:Object(s.a)(Object(s.a)({},f),{themeDarkAlt:Ir(n.buttonHoverColor,f.themeDarkAlt),themeLighter:Ir(n.primaryButtonHoverColor,f.themeLighter),themePrimary:Ir(n.backgroundColor,f.themePrimary),themeTertiary:Ir(n.beaconColor,f.themeTertiary),white:Ir(n.textColor,f.white)})})})})}}(e,t.customTheme,t);return d?n(r,Object(s.a)({},d),l):l}},jr=function(e,t,n,r,i){var o=t.selector,a=t.targetElement;return Object(s.b)(void 0,void 0,void 0,(function(){var t,u,c,l,d,f,h,p,v;return Object(s.e)(this,(function(g){switch(g.label){case 0:return g.trys.push([0,2,,3]),(t=document.getElementById(ee()))||(t=zn({attributes:(v={},v["data-ows"]="true",v.style="all: initial",v),id:ee()})),u=Qn(cr(),t),[4,ne()];case 1:return c=g.sent(),l=c.createElement,d=c.render,f=c.setDefaultTarget,Tr(c),f&&(h=Qn(ee()+"-Layer",t),f("#"+h.id)),d(l(Wr(c),Object(s.a)(Object(s.a)({},e),{onClosed:i,onUpdated:r,selector:o,targetElement:a})),u,n),[3,3];case 2:if(p=g.sent(),Q.error(593504384,"error thrown in renderInternal",o,p),i&&i("error"),$())throw p;return[3,3];case 3:return[2]}}))}))},Hr=function(e,t,n){var r=Gn(e.anchorElementSelectors);if(r){var i=r.selector,o=r.targetElement,s=o&&o.getBoundingClientRect()||{},a=s.bottom,u=s.left,c=s.right,l=s.top;Q.event(593504385,"SurfaceSelectorMatched",{customData:{anchorHint:e.anchorHint,selector:i,bottom:a,left:u,right:c,top:l}})}else Q.error(593504386,"Couldn't find element",e.anchorElementSelectors);return e.isAA?(e.anchorElementSelectors&&!r||t&&t("SurfaceAATriggered"),void(n&&n("isAA"))):e.isControl?(e.anchorElementSelectors&&!r||t&&t("SurfaceControlTriggered"),void(n&&n("isControl"))):r||void(n&&n("error"))},qr=function(e,t,n,r,i,o,a){return void 0===n&&(n=!0),Object(s.b)(void 0,void 0,void 0,(function(){var u;return Object(s.e)(this,(function(c){switch(c.label){case 0:return J=t,u=function(e,t,n,r,i,o){return void 0===t&&(t=!0),function(){return Object(s.b)(void 0,void 0,void 0,(function(){var a;return Object(s.e)(this,(function(s){switch(s.label){case 0:return(a=Hr(e,r,o))?(ur({shouldRemoveSurface:t,surfaceParams:e,targetElementInfo:a}),e.alternativeTriggerSelectors&&e.alternativeTriggerSelectors.map((function(e){return Gn([e])})).filter($n).forEach((function(t){return ur({isAlternateTrigger:!0,surfaceParams:e,targetElementInfo:t})})),e.useNativeRender||!n?[3,2]:[4,Gr(o,i,n,r,e,a)]):[2];case 1:return s.sent(),[3,4];case 2:return[4,jr(e,a,r,i,o)];case 3:s.sent(),s.label=4;case 4:return[2]}}))}))}}(e,n,r,i,o,a),void 0!==e.delayLoad&&e.delayLoad>0?(B(e.delayLoad).then(u).catch((function(e){Q.error(593504387,"failed to render delay loaded surface",e),a&&a("error")})),[3,3]):[3,1];case 1:return[4,u()];case 2:c.sent(),c.label=3;case 3:return[2]}}))}))},Vr=function(e,t,n,r,i,o,a,u){return Object(s.b)(void 0,void 0,void 0,(function(){return Object(s.e)(this,(function(c){switch(c.label){case 0:return n>e.itemCount?(Q.assert(n<=e.itemCount,"inconsistent state"),[2]):[4,qr(Sr(n,e),r,!1,t,i,a,(function(i){return Object(s.b)(void 0,void 0,void 0,(function(){return Object(s.e)(this,(function(s){switch(s.label){case 0:return dr(!0),"error"===i&&n<=1?(u&&u(i),[2]):(qn(Q.reserve(593504395),"SurfaceDismissed",i,n,X(),Y().surfaceId,e.itemCount),sr(i,e),n<e.itemCount&&("primary"===i||"error"===i)?[4,Vr(e,t,n+1,r,void 0,o,a,u)]:[3,2]);case 1:return s.sent(),o&&o(i,n),[3,3];case 2:u&&u(i),s.label=3;case 3:return[2]}}))}))}))];case 1:return c.sent(),[2]}}))}))},zr=function(e,t,n,r,i,o){for(var a=function(t,r){void 0===r&&(r=!1);var i=r?void 0:t+1,o=n();try{o&&t>=0&&t<o.length&&o.slice(t,i).reverse().forEach((function(e){e&&e()}))}catch(n){Q.error(593602519,"failed to dismiss surface "+(t+1)+" of "+e.itemCount+(r?"plus all remaining surfaces":void 0),n)}},u=function(e){return function(t){return c(t,e)}},c=function(n,r){"error"===n&&r<1?t&&t(n):(qn(Q.reserve(593602520),"SurfaceDismissed",n,r+1,i,o,e.itemCount),sr(n,e),r<e.itemCount-1&&("primary"===n||"error"===n)?a(r):(t&&t(n),a(r,!0)))},l=[],d=function(t){var n,i=Sr(t,e),o=(n=i.anchorElementSelectors,Gn(n)||{selector:null==n?void 0:n[0]}),a=t-1;l.push(Object(s.a)(Object(s.a)(Object(s.a)({},i),o),{onClosed:function(){return c("close",a)},onUnsupportedSurfaceType:r(i,u(a)),primaryButtonAction:i.primaryButtonText&&function(){return c("primary",a)},secondaryButtonAction:i.secondaryButtonText&&function(){return c("secondary",a)}}))},f=1;f<=e.itemCount;f++)d(f);return l},Qr=function(e,t,n,r,i,o,a,u){return Object(s.b)(void 0,void 0,void 0,(function(){var c,l,d;return Object(s.e)(this,(function(f){switch(f.label){case 0:l=zr(u,t,(function(){return c}),(function(e,t){return function(){return Object(s.b)(void 0,void 0,void 0,(function(){var r;return Object(s.e)(this,(function(i){switch(i.label){case 0:return(r=Hr(e,a,t))?[4,jr(e,r,a,n,t)]:[2];case 1:return i.sent(),[2]}}))}))}}),e,o),f.label=1;case 1:return f.trys.push([1,3,,5]),[4,r(l)];case 2:return c=f.sent(),Q.info(593602521,"host render succeeded (multi-surface)"),null==a||a(),[3,5];case 3:return d=f.sent(),Q.error(593602522,"error with host rendering (multi-surface), falling back to internal renderer",d),[4,Vr(u,r,1,i,a,n,n,t)];case 4:return f.sent(),[3,5];case 5:return[2]}}))}))},Gr=function(e,t,n,r,i,o){return Object(s.b)(void 0,void 0,void 0,(function(){var a,u,c;return Object(s.e)(this,(function(l){switch(l.label){case 0:u=function(t){var n;null==e||e(t),null===(n=null==a?void 0:a[0])||void 0===n||n.call(a)},l.label=1;case 1:return l.trys.push([1,3,,5]),[4,n([Object(s.a)(Object(s.a)(Object(s.a)({},i),o),{onClosed:function(){u("close")},onUnsupportedSurfaceType:function(){return jr(i,o,r,t,u)},primaryButtonAction:i.primaryButtonText&&function(){u("primary")},secondaryButtonAction:i.secondaryButtonText&&function(){u("secondary")}})])];case 2:return a=l.sent(),Q.info(593602523,"host render succeeded"),null==r||r(),[3,5];case 3:return c=l.sent(),Q.error(593602524,"error with host rendering, falling back to internal renderer",c),[4,jr(i,o,r,t,e)];case 4:return l.sent(),[3,5];case 5:return[2]}}))}))},Kr=function(e,t,n,r){return function(i,o,a){var u;void 0===i&&(i="SurfaceLaunched"),void 0===o&&(o=!0),u=Date.now(),G=u,Q.event(593504396,i,{customData:Object(s.a)(Object(s.a)(Object(s.a)({creativeId:r.creativeId,payloadId:r.payloadId,surfaceId:n,surfaceName:r.surfaceName,elapsedTime:X()-t,error:a||"",result:o,surfaceType:r.surfaceType},{browserLang:navigator?navigator.language:"Error",browserOnline:!!navigator&&navigator.onLine,browserUserAgent:navigator?navigator.userAgent:"Error",colorDepth:screen?screen.colorDepth:-1,pixelDepth:screen?screen.pixelDepth:-1,screenHeight:screen?screen.height:-1,screenWidth:screen?screen.width:-1}),U()),{isAA:r.isAA,isControl:r.isControl,telemetryEventName:r.telemetryEventName})}),Zr("Opened",e,n,r),a||(or("SHOWED",r),function(e){ir("impression",e.impressionBeaconUrl,e)}(r))}},Zr=function(e,t,n,r,i){void 0===i&&(i=!0);var o={detail:{action:e,creativeId:r.creativeId,id:n,isAA:r.isAA,isControl:r.isControl,payloadId:r.payloadId,success:i,surfaceType:r.surfaceType,telemetryEventName:r.telemetryEventName,renderTargetId:t}},s=r.eventDispatchDelay||1e3;B(s).then((function(){return document.dispatchEvent(new CustomEvent("FGWebSurfaceEvent",o))})).catch((function(e){Q.error(593602575,"failed to dispatch event",e)}))},Jr=function(e,t,n){return Object(s.b)(void 0,void 0,void 0,(function(){var r,i,o,a,u,c,l,d;return Object(s.e)(this,(function(s){switch(s.label){case 0:if(r=t||"obf-WebSurfacesContainer",!e)return Q.error(593504397,"surface params are not provided"),[2];_r(e),i=Kr(r,Date.now(),n,e),s.label=1;case 1:return s.trys.push([1,9,,10]),e.isControl||e.isAA||(f="beforeunload",h=lr,window&&window.addEventListener(f,h),o=e.preFetchDelay||10,B(o).then((function(){Er(e)})).catch((function(e){return Q.error(593504398,"failed to pre-load resources",e)}))),a=function(t){qn(Q.reserve(593504399),"SurfaceCompleted",t,0,X(),n),Yn("beforeunload",lr),sr(t,e),Zr("Dismissed",r,n,e)},u=function(){return Zr("Updated",r,n,e)},c=Y().renderCallback,ar(e)?e.useNativeRender||!c?[3,3]:[4,Qr(X(),a,u,c,r,n,i,e)]:[3,6];case 2:return s.sent(),[3,5];case 3:return[4,Vr(e,c,1,r,i,u,u,a)];case 4:s.sent(),s.label=5;case 5:return[3,8];case 6:return[4,qr(e,r,!0,c,i,u,a)];case 7:s.sent(),s.label=8;case 8:return[3,10];case 9:if(l=s.sent(),d="SurfaceLaunched",e.isControl?d="SurfaceControlTriggered":e.isAA&&(d="SurfaceAATriggered"),i(d,!1,l&&l.message),$())throw l;return[3,10];case 10:return[2]}var f,h}))}))}}]);
//# sourceMappingURL=officewebsurfaces.core.min.js.map