Type.registerNamespace("_Ewa");_Ewa.InstantaneousSupportInformationManager=function(n,t){this.bg=Function.createDelegate(this,this.bA);this.bh=Function.createDelegate(this,this.bB);this.bi=Function.createDelegate(this,this.bC);this.bk=Function.createDelegate(this,this.bH);this.U=Function.createDelegate(this,this.bD);this.bf=Function.createDelegate(this,this.by);this.Z=Function.createDelegate(this,this.bz);this.bj=Function.createDelegate(this,this.bo);this.bb=Function.createDelegate(this,this.bF);this.Y=Function.createDelegate(this,this.bx);this.bc=Function.createDelegate(this,this.bG);this.ba=Function.createDelegate(this,this.bE);_Ewa.InstantaneousSupportInformationManager.initializeBase(this,[!1]);Diag.a.a(35985034,0,50,"InstantaneousSupportInformationManager ctor start");this.G=n;this.F=t;this.M=null;this.R=null;this.I=null;this.E=null;this.L=new($$sc.r.$$(_Ewa.zA));this.J=new($$sc.r.$$($$sc.a));this.H=new Array(0);this.V=new($$sc.r.$$(String));this.Q={};this.G.g(this.ba);this.F.E(this.bc);_Ewa.b.a(this.F).a().i(this.Y);this.F.a(407)&&this.G.t(this.bb);this.N(100);Diag.a.a(35985035,0,50,"InstantaneousSupportInformationManager ctor end")};_Ewa.InstantaneousSupportInformationManager.c=function(n,t){var u,i,f,o,s,r,c,v,y;if(!n||!n.length)return new Array(0);if(!t||!t.length){for(u=new Array(n.length),i=0;i<n.length;++i)u[i]=n[i].IfmtIndex;return u}f=new($$sc.r.$$(_Ewa.InstantaneousSupportInformationManager.b));for(var l=n,p=l.length,e=0;e<p;++e)o=l[e],f.c(o.IfmtIndex,new _Ewa.InstantaneousSupportInformationManager.b(o));s=new($$sc.u.$$(Number));for(var a=t,w=a.length,h=0;h<w;++h)r=a[h],(y=f.e(r.IfmtIndex,v={val:c}),c=v.val,y)&&c.a.FormatString===r.FormatString||s.b(r.IfmtIndex);return s.f()};_Ewa.InstantaneousSupportInformationManager.d=function(n,t){if(!t||t===n.length-1)return!1;var i=n.charAt(t-1),r=n.charAt(t+1);return!(i==="#"||i==="0"||i==="?")||!(r==="#"||r==="0"||r==="?")?!1:!0};_Ewa.InstantaneousSupportInformationManager.a=function(n,t,i){_Ewa.e.b(t,i,!1)||(n[t]=i)};_Ewa.InstantaneousSupportInformationManager.prototype={G:null,F:null,M:null,R:null,I:null,E:null,W:-1,P:null,T:null,L:null,J:null,S:!1,O:!1,H:null,V:null,Q:null,bd:null,be:null,e:function(n){this.dv("isim0",n)},h:function(n){this.dw("isim0",n)},o:function(n){this.dv("isim1",n)},C:function(n){this.dw("isim1",n)},j:function(n){this.dv("isim2",n)},g:function(n){this.dw("isim2",n)},a:function(){return this.E?this.E.LocaleInformation:null},d:function(){return this.E?this.E.NumberFormats:new Array(0)},c:function(){return this.H&&this.H.length||this.bn(),this.H},b:function(){return this.T},v:function(){return this.E?this.E.InstantaneousCalcMaxSupportedRangeSize:100},w:function(){return this.E?this.E.InstantaneousCalcWebWorkerPrecisionSamplingRate:.001},l:function(){return this.E?this.E.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:50},r:function(){return this.E?this.E.InstantaneousCalcBulkRendering:5},t:function(){return this.E?this.E.InstantaneousCalcDelayTreeBuilding:500},u:function(){return this.E?this.E.InstantaneousCalcDepTreeFormulasLimit:100},k:function(){return isNull(this.P)?this.E?this.E.InstantaneousCalcManualMode:!1:this.P},s:function(){return this.E?this.E.InstantaneousCalcCalculationTime:20},m:function(){return this.E?this.E.InstantaneousMaxSupportedCellsCalcCount:40},D:function(n,t,i){var r,u,f,e;if(!n)return t.val="General",!0;if(t.val="",e=(f=this.i(n,u={val:r},i),r=u.val,f),!e)return!1;switch(r){case 0:t.val="General";break;case 1:t.val="Number";break;case 2:t.val="Currency";break;case 3:t.val="Accounting";break;case 4:t.val="Date";break;case 5:t.val="Time";break;case 6:t.val="Percentage";break;case 8:t.val="Scientific";break;case 9:t.val="Text";break;case 10:t.val="Special";break;case 11:t.val="Custom"}return!0},i:function(n,t,i){var r=this.L.e(n,t);return!r&&n>0&&this.F&&(Diag.a.a(40468576,0,50,"InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache {0}",n),this.bv(n),i&&(t.val=this.bu(n),r=!0),_Ewa.oE.a(n,this.F.Q())&&(t.val=6)),r},A:function(n){var t=0,i,r;return(r=this.i(n,i={val:t},!0),t=i.val,r)?t===6:(Diag.a.a(23156486,0,50,"InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index {0}",n),!1)},f:function(n){var t=0,i,r;return(r=this.i(n,i={val:t},!0),t=i.val,r)?t===9:(Diag.a.a(39134882,0,50,"InstantaneousSupportInformationManager.isFormatInTextCategory: failed to get category from format index {0}",n),!1)},p:function(n){Diag.a.a(37855392,0,50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions");var t={};t.FilterType=0;this.I=_Ewa.i.c(this.F.d().a(),t,_Ewa.n.a(this.bj,n),this.Z,null,null)},q:function(){this.N(100)},bx:function(){var i=_Ewa.b.a(this.F),n,t,r,u;i&&(n=i.e(null),n&&(t=0,u=this.i(n.a().c(),r={val:t},!0),t=r.val,u))},B:function(n){this.P=n},bv:function(n){var t,r,u,i;if(!this.J||!this.F){Diag.a.a(25747617,0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping");return}((u=this.J.e(n,r={val:t}),t=r.val,!u)||t.b>3)&&(Diag.a.a(24417758,0,50,"Getting number format category for format index: {0}",n),i=_Ewa.LF.a(this.F.d().a(),n,this.bf,null,null,null),i&&this.J.c(n,i))},bu:function(n){return n>=1&&n<=8?1:n>=9&&n<=12?2:n===13||n===14?6:n===15?8:!(n===17|n===18)?n===19?4:n===16||n>=20&&n<=29||n===31?11:n===30?9:n>=32&&n<=35||n===37&&this.F&&this.F.a(548)?3:0:7},K:function(){var n=isNullOrUndefined(this.G),t=!n&&this.G.a();return Diag.a.a(36227294,0,50,"InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:{0} - sessionStateManager IsNullOrUndefined: {1}",t,n),t},by:function(n){if(this.K()){if(_Ewa.h.e(n.Errors)||!n.Result){Diag.a.a(24417759,0,50,"GetCategoryFromServer failed, ignoring - server errors: {0}",n.Errors?n.Errors.join(","):"None");return}var t=n.Result;Diag.a.a(24417760,0,50,"Updating number format category cache, format index = {0}, category = {1}",t.Index,t.Category);this.bI(t.Index,t.Category);this.dt("isim1",new _Ewa.nT(t.Index,t.Category),this)}},n:function(n){for(var i=new($$sc.u.$$(Number)),r=this.L.$$ge(),t;r.$$mn();)t=r.$$cu(),t.a===n&&i.b(t.b);return i.f()},bI:function(n,t){this.L.c(n,t)},x:function(n){return _Ewa.u.a(this.Q,n,null)},y:function(n){var t,i,r;return(r=this.V.e(n,i={val:t}),t=i.val,r)?t:null},dispose:function(){var t,i,n;for(System.a.a(this.M),this.M=null,this.bl(),t=this.J.$$ge();t.$$mn();)(i=t.$$cu(),n=i.a,!n||n.b>3)||Common.a.d.b(n.d);this.J=null;this.G&&(this.G.h(this.ba),this.O&&this.G.k(this.U),this.O=!1,this.G.v(this.bb));this.G=null;this.F&&_Ewa.b.a(this.F)&&_Ewa.b.a(this.F).a()&&(_Ewa.b.a(this.F).a().j(this.Y),this.F.G(this.bc));this.F=null;_Ewa.cp.prototype.dispose.call(this)},z:function(n){try{switch(n){case"LocaleLongDateFormat":return this.F.a(262);case"GetLocaleDayNames":return this.F.a(263);case"CalculateTextWidthIgnoreLetterSpacing":return this.F.a(370);case"NoEscapeSpacesOnInstantaneousRenderingCanvas":return this.F.a(824);case"OfficeVSO:3657744_CalcFixForDateFormat":return this.F.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");case"OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return this.F.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");case"CalcNewFunctions":return this.F.a(316);case"CalcContractChecks":return this.F.a(317);case"CalcSupportDynamicArrays":return this.F.a(318);case"CalcFormatCalculations":return this.F.a(319);case"CalcFormulaCacheAPIChanges":return this.F.a(320);case"CalcStrictFormulaChecking":return this.F.a(321);case"CalcSupportStructuredReference":return this.F.a(335);case"CalcSupportRowReference":return this.F.a(336);case"CalcParserUsesPledges":return this.F.a(421);case"CalcWebWorker":return _Ewa.r.c(this.F);case"CalcWebWorkerTest":return this.F.a(420);case"CalcLookupFunctions":return this.F.a(422);case"CalcLogStopWatch":return this.F.a(543);case"CalcPreventSpillingHack":return this.F.a(322);case"CalcDynamicArrayOperators":return this.F.a(128);default:return this.F.isChangeGateEnabled("OfficeVSO:3714994_EnableUseOfCGsInCallback2")&&n.startsWith("OfficeVSO:")?this.F.isChangeGateEnabled(n):!1}}catch(t){return Diag.a.a(22374148,0,15,"InstantaneousSupportInformation.IsFeatureEnabled({0}): feature parsing failed, returning false. Exception: {1}.",n,t.toString()),!1}},N:function(n){if(!this.K()||!this.G.d().g()){Diag.a.a(36227295,0,50,"InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits {0}, IsEditMode {1}",this.G.d().g(),this.F.c().x());return}System.a.a(this.M);this.M=null;this.M=_Ewa.x.a().a(this.bk,n,_Ewa.m.bk,!0,!1)},bH:function(){Diag.a.a(36227296,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");this.bl();this.K()&&this.G.d().g()&&(!this.O&&(!this.E||this.G.e()>this.W)?(Diag.a.a(34719488,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),this.R=_Ewa.GZ.a(this.F.d().a(),this.E?this.E.Digest:"",this.bi,this.bh,null,null)):this.X(),Diag.a.a(34719489,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info."),this.bn())},bn:function(){if(Diag.a.a(34719490,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called."),this.I){Diag.a.a(34719491,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping.");return}if(!this.K()){Diag.a.a(37089857,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.");return}if(!this.H||!this.H.length){var n={};n.FilterType=0;this.I=_Ewa.i.c(this.F.d().a(),n,this.bg,this.Z,null,null)}},bz:function(n){Diag.a.a(34719492,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = {0}, HTTP status = {1}.",n.b.b,n.b.c);this.I=null},bD:function(){this.O=!1;this.G.k(this.U);this.N(this.S?1e3:3e5)},bE:function(n,t){Diag.a.a(37492506,0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");_Ewa.ln.a(t)&&this.N(1e3)},bF:function(){Diag.a.a(40703904,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");this.F.l().CalcMode!==3&&(this.P=!this.F.l().CalcMode)},bG:function(){Diag.a.a(37492507,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");this.N(1e3);this.F.a(407)&&this.F.l().CalcMode!==3&&(this.P=!this.F.l().CalcMode)},bA:function(n,t,i){if(Diag.a.a(34719493,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called."),this.I=null,!this.K()){Diag.a.a(34719494,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.");return}if(n.StateId===-1){Diag.a.a(34719495,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session.");this.X();return}!n.Result||this.H&&this.H.length?this.N(3e5):this.bo(n,t,i)},bo:function(n){var i,t;if(this.H=n.Result,Diag.a.a(34719496,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned {0} functions.",this.H?this.H.length:-1),i=!1,this.H){for(var u=this.H,f=u.length,r=0;r<f;++r)(t=u[r],t)&&(this.Q[t.NameUI.toLocaleUpperCase()]=t.FunctionIndex.toString(),t.NameUI!==t.NameData&&(this.Q[t.NameData.toLocaleUpperCase()]=t.FunctionIndex.toString(),i=!0),this.V.c(t.FunctionIndex,t.NameUI));this.dt("isim2",Sys.EventArgs.Empty,this)}i&&Diag.a.a(36569610,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameData functions names were used.")},bC:function(n){var f,e,i,t,u;if(this.K()){if(f=this.F,Diag.a.b(21311552,0,!!f,"null ewaControl"),this.S=!1,this.W=n.StateId,this.W===-1){this.S=!0;this.X();return}if(n.Result){e=n.Result;i=this.E;this.E=e;Diag.a.a(21311553,0,50,"InstantaneousSupportInformation updated, new result digest: {0}.",this.E.Digest);t=[];i&&(t=_Ewa.InstantaneousSupportInformationManager.c(i.NumberFormats,this.E.NumberFormats));for(var o=t,s=o.length,r=0;r<s;++r)u=o[r],this.L.d(u)&&this.L.i(u);this.bJ(t);this.dt("isim0",new _Ewa.LG(t),this)}this.N(3e5)}},X:function(){this.O||(this.O=!0,this.G.m(this.U))},bB:function(n){if(this.K()){if(n.b.b===10){Diag.a.a(21311554,0,50,"Instantaneous support information request cancelled.");return}Diag.a.a(21311555,0,10,"Failed to update instantaneous support information, status = {0}, HTTP status = {1}.",n.b.b,n.b.c);this.S=!0;this.X()}},bl:function(){this.bp(this.R);this.bp(this.I);this.R=null;this.I=null},bp:function(n){!n||n.b>3||this.F.d().a().h(n.d)},bJ:function(n){var t,i,r,u,e;if(this.T)n.length>0&&(Diag.a.a(22374147,0,50,"InstantaneousSupportInformation: Updating number formatting calculator formats. IFMTs to update: {0}",n.toString()),e=this.bm(n),this.T.updateFormats(e,!0));else{Diag.a.a(22374146,0,50,"InstantaneousSupportInformation: Creating number formatting calculator");t=this.br();i=this.bm(null);try{r=new _Ewa.nx;u=this;this.T=numFmtCalc.initializeNumberFormatingCalculator(r,t,i,function(n){return u.z(n)},this.F)}catch(f){Diag.a.a(24379932,0,10,"NumberFormattingCalculator creation failed, exception = {0}. Stack error = {1}",f,f.stack)}}},bm:function(n){var h=this.E.NumberFormats.length,r=null,f,e,o,t,i;if(n){h=n.length;r=new($$sc.r.$$(Number));for(var c=n,a=c.length,u=0;u<a;++u)f=c[u],r.c(f,f)}e=new Array(h);this.bd=this.bs();this.be=this.bt();o=0;for(var l=this.E.NumberFormats,v=l.length,s=0;s<v;++s)(t=l[s],!r||r.d(t.IfmtIndex))&&(i={},i.index=t.IfmtIndex,i.formatString=this.bq(t.FormatString),i.isPredefined=t.Builtin,e[o]=i,++o);return e},bq:function(n){var o=this.bw(n),u=o?this.bd:this.be,f,r,t,e,i,s;if(Common.S.a(u))return n;for(f=new Sys.StringBuilder,r=!1,t=0;t<n.length;t++)e=!1,i=n.charAt(t).toString(),_Ewa.e.b(i,'"',!1)?r=!r:e=i in u,s=o||_Ewa.InstantaneousSupportInformationManager.d(n,t),f.append(e&&!r&&s?u[i]:i);return f.toString()},bt:function(){var n={};return _Ewa.InstantaneousSupportInformationManager.a(n,this.E.LocaleInformation.ThousandSeperator.toString(),","),_Ewa.InstantaneousSupportInformationManager.a(n,this.E.LocaleInformation.DecimalSeperator.toString(),"."),n},bs:function(){var n={};return isNullOrUndefined(this.E.LocaleInformation.DayIndicator)||isNullOrUndefined(this.E.LocaleInformation.MonthIndicator)||isNullOrUndefined(this.E.LocaleInformation.YearIndicator)||(_Ewa.InstantaneousSupportInformationManager.a(n,this.E.LocaleInformation.DayIndicator.toString(),"d"),_Ewa.InstantaneousSupportInformationManager.a(n,this.E.LocaleInformation.MonthIndicator.toString(),"m"),_Ewa.InstantaneousSupportInformationManager.a(n,this.E.LocaleInformation.YearIndicator.toString(),"y")),_Ewa.InstantaneousSupportInformationManager.a(n,this.E.LocaleInformation.DateAlternativeSeperator.toString(),"-"),_Ewa.InstantaneousSupportInformationManager.a(n,this.E.LocaleInformation.DateSeperator.toString(),"/"),n},bw:function(n){return n.indexOf(this.E.LocaleInformation.DayIndicator)>-1||n.indexOf(this.E.LocaleInformation.MonthIndicator)>-1||n.indexOf(this.E.LocaleInformation.YearIndicator)>-1},br:function(){var n={};n.lcid=this.E.LocaleInformation.Lcid;n.amAlternativeString=this.E.LocaleInformation.AmAltString;n.amPmSeparatedBySpace=this.E.LocaleInformation.AmPmSeperatedBySpace;n.amString=this.E.LocaleInformation.AmString;n.currencyAlternativeString="";n.currencyFormat=this.E.LocaleInformation.CurrencyFormat;n.currencySeparatedBySpace=this.E.LocaleInformation.CurrencySeperatedBySpace;n.currencyString="";n.dateAlternativeSeparator=this.E.LocaleInformation.DateAlternativeSeperator.toString();n.dateOrder=this.E.LocaleInformation.DateOrder;n.dateSeparator=this.E.LocaleInformation.DateSeperator.toString();n.decimalSeparator=this.E.LocaleInformation.DecimalSeperator.toString();n.digitsCurrency=this.E.LocaleInformation.DigitsCurrency;n.digitsNumber=this.E.LocaleInformation.DigitsNumber;n.expSeparatedBySpace=this.E.LocaleInformation.ExpSeperatedBySpace;n.fractionSeparator=this.E.LocaleInformation.FractionSeperator.toString();n.hour2Digits=this.E.LocaleInformation.Hour2Digits;n.longDateFormat=this.E.LocaleInformation.LongDateFormat;n.month2Digits=this.E.LocaleInformation.Month2Digits;n.percentSeparatedBySpace=this.E.LocaleInformation.PercentSeperatedBySpace;n.pmString=this.E.LocaleInformation.PmString;n.pmAlternativeString=this.E.LocaleInformation.PmAltString;n.thousandSeparator=this.E.LocaleInformation.ThousandSeperator.toString();n.timeSeparator=this.E.LocaleInformation.TimeSeperator.toString();n.use24HourClock=this.E.LocaleInformation.Use24HourClock;n.year4Digits=this.E.LocaleInformation.Year4Digits;n.listSeparator=this.E.LocaleInformation.ListSeparator.toString();n.columnSeparator=this.E.LocaleInformation.ColumnSeparator.toString();n.rowSeparator=this.E.LocaleInformation.RowSeparator.toString();n.trueValueString=this.E.LocaleInformation.TrueValueString;n.falseValueString=this.E.LocaleInformation.FalseValueString;var t=!isNullOrUndefined(this.E.LocaleInformation.DayIndicator),i=!isNullOrUndefined(this.E.LocaleInformation.MonthIndicator),r=!isNullOrUndefined(this.E.LocaleInformation.YearIndicator);return t&&i&&r?(n.dayIndicator=this.E.LocaleInformation.DayIndicator.toString(),n.monthIndicator=this.E.LocaleInformation.MonthIndicator.toString(),n.yearIndicator=this.E.LocaleInformation.YearIndicator.toString()):Diag.a.a(34349726,0,15,"Date indicators not initialized: DayIndicator is {0}, MonthIndicator is {1}, YearIndicator is {2}",t?"not null":"null",i?"not null":"null",r?"not null":"null"),n}};_Ewa.InstantaneousSupportInformationManager.b=function(n){this.a=n};_Ewa.InstantaneousSupportInformationManager.b.prototype={a:null};_Ewa.ZP=function(){};_Ewa.ZP.a=function(){_Ewa.j.a(_Ewa.vj.a)};_Ewa.vj=function(n){_Ewa.vj.initializeBase(this);this.h=n;this.j()};_Ewa.vj.a=function(n){if(!n)throw Error.argumentNull("ewaControl");n.b().b(_Ewa.baj.$$(_Ewa.cg),246,new _Ewa.vj(n))};_Ewa.vj.prototype={h:null,b:function(){if(this.h){Diag.a.a(35985040,0,50,"InstantaneousSupportInformationManagerFactory.Create: Start loading script");var n=this;_Ewa.f.cw(_Ewa.s.c(42,4,!1,!1,246,this.m),function(){n.i(n.h.b().a(_Ewa.cg,268,!1)||new _Ewa.InstantaneousSupportInformationManager(n.h.c(),n.h))},this.du(),3)}}};_Ewa.InstantaneousSupportInformationManager.registerClass("_Ewa.InstantaneousSupportInformationManager",_Ewa.cp,_Ewa.cg,Sys.IDisposable);_Ewa.InstantaneousSupportInformationManager.b.registerClass("_Ewa.InstantaneousSupportInformationManager.b");_Ewa.vj.registerClass("_Ewa.vj",_Ewa.pU.$$(_Ewa.cg));_Ewa.ZP.a();Type.registerNamespace("_Ewa");_Ewa.hM=function(n){this.s=Function.createDelegate(this,this.bd);this.n=Function.createDelegate(this,this.bc);this.y=-1;this.b=-1;this.g=-1;this.j=-1;this.a=n;this.q=this.a?n.f().CalcWebWorkerSmokeTestPingIntervalMS:this.q;this.c=new($$sc.r.$$(_Ewa.hM.d));this.a.isChangeGateEnabled("OfficeVSO:4067058_TestDefaultNumberFormats")&&this.O();this.bl()};_Ewa.hM.e=function(n){var t=Sys.Serialization.JavaScriptSerializer.serialize(n.getRowNumbers()),i=Sys.Serialization.JavaScriptSerializer.serialize(n.getColumnNumbers());return t+i};_Ewa.hM.b=function(n){var i=null,t,r;if(n.length>1)for(t=1;t<n.length;t++)for(r=0;n[t-1]+1+r<n[t];)i=i||[],Array.add(i,n[t-1]+r),r++;return i};_Ewa.hM.prototype={a:null,q:500,p:null,x:!1,A:!1,w:!1,z:0,m:"TRUE",o:"FALSE",k:null,f:null,e:null,i:"",h:null,c:null,d:null,dispose:function(){this.e&&this.e.h(this.n);this.S()},r:function(n){if(!this.f)return Diag.a.a(595072546,0,100,"CalcAsyncEngine::UpdateData() for StateId:{0} failed - Calc Engine not active, UpdateDataTrigger:{1}",this.a.y().e(),_Ewa.hM.c.toString(n)),!1;if(!this.e&&(this.e=this.a.b().a(_Ewa.cg,268,!1),!this.e))return Diag.a.a(42812304,0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),!1;this.a.isChangeGateEnabled("OfficeVSO:3973825_UseLatestSuccessfulStateId")?n!==2&&(this.b=this.a.y().cG(),this.b===-1&&(this.b=this.a.y().e())):this.b=this.a.y().e();this.bf();n&&(!this.a.isChangeGateEnabled("OfficeVSO:3884073_EnsureRecalcEngineInitialization")||this.A)||(this.bg(),this.bh(),this.I(),this.a.isChangeGateEnabled("OfficeVSO:3884073_EnsureRecalcEngineInitialization")&&(this.e.e(this.n),this.a.E(this.s),this.A=!0));this.be();var t=!1;return n||(t=this.Y()),(n||t)&&(this.bi()?(this.bk(n),this.a.a(315)&&this.bj(),this.g=this.b,this.Q()):Diag.a.a(595072545,0,15,"CalcAsyncEngine::UpdateData() for StateId:{0} failed - no Sheets information",this.b)),this.a.isChangeGateEnabled("OfficeVSO:3973825_UseLatestSuccessfulStateId")&&n===2||this.H(),!0},P:function(n,t,i){var v,y;if(!this.f||!n){Diag.a.a(51513233,0,15,"CalcAsyncEngine::CalculateFormula() recalc engine is null:{0}, modifiedCell is null:{1}",!this.f,!n);return}var h=this.a.e().a().f,o=n.a().k()-1,s=n.a().j()-1,u=-1;if(n.a().d())if(this.a.isChangeGateEnabled("OfficeVSO:3973825_UseLatestSuccessfulStateId")){if(u=n.a().d().A(),u===-1){Diag.a.a(593503619,0,15,"CalcAsyncEngine::CalculateFormula() BlockRevision unknown for block:{0}",n.a().d().e());return}}else u=n.a().d().k();else if(this.a.isChangeGateEnabled("OfficeVSO:3973825_UseLatestSuccessfulStateId")){Diag.a.a(593503618,0,15,"CalcAsyncEngine::CalculateFormula() GridBlockModelProxy is null cell:({0},{1})",n.a().k(),n.a().j());return}if(this.a.isChangeGateEnabled("OfficeVSO:3973825_UseLatestSuccessfulStateId")&&u<this.g){Diag.a.a(593503617,0,50,"CalcAsyncEngine::CalculateFormula() Can't calc edit in cell:({0},{1}) - blockRevision:{2} < lastUpdatedStateId:{3}",o,s,u,this.g);return}if(this.x||(this.f.setOnRecalcResults(i),this.x=!0),n.a().f().length>0){if(this.a.isChangeGateEnabled("OfficeVSO:3973825_UseLatestSuccessfulStateId")&&this.bm()&&!this.r(2)){Diag.a.a(593503616,0,15,"CalcAsyncEngine.CalculateFormula: UpdateData failed");return}var e=null,f=null,c=this.a.b().a(_Ewa.cg,268,!1);this.a.isChangeGateEnabled("OfficeVSO:3941721_SendTextToCalc")&&c&&c.f(n.a().t())?(e=this.a.isChangeGateEnabled("OfficeVSO:3952443_ForceTextValue")?n.a().f():this.E(n.a().f()),f=this.F(n,t,e),f.startsWith("'")||(f="'"+f)):_Ewa.bG.b(n.a().f())&&t&&!t.startsWith("'")?(f=n.a().f(),e=null):(e=this.E(n.a().f()),f=this.F(n,t,e));var p=o,w=s,b=excelOnlineCalc.calc.sheetRangeLocation(h,o,s,p,w),l=[],a=_Ewa.b.a(this.a),r=a.q();_Ewa.b.a(this.a).i().e()&&(r=a.n(1).q(),r.U(1,1),r.U(3,1));v=excelOnlineCalc.calc.sheetRangeLocation(h,r.a-1,r.b-1,r.d-1,r.c-1);y=excelOnlineCalc.calc.rangeFormulaEdit(b,f,e,null,v);Array.add(l,y);Diag.a.a(51513232,0,50,"CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",h,o,s,_Ewa.e.j(n.a().f()),u,r.a-1,r.b-1,r.d-1,r.c-1);this.f.editRangeFormulas(u,l);this.H()}},D:function(n){var t=null,u,i,r;try{if(!n){Diag.a.b(50671750,0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null");return}if(this.i=_Ewa.b.a(this.a).b().z(n),this.b=this.a.isChangeGateEnabled("OfficeVSO:3973825_UseLatestSuccessfulStateId")?n.P:n.u.Information.Revision,this.b<this.g||this.a.isChangeGateEnabled("OfficeVSO:3973825_UseLatestSuccessfulStateId")&&this.b===-1){Diag.a.a(594884824,0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:{0} blockRevision:{1} < lastUpdatedStateId:{2}",this.i,this.b,this.g);return}if(this.ba(),this.N(n))return;if(u=String.format("CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:{0} StateId:{1}",this.i,this.b),t=this.a.o().a("ModelUpdate",u),this.j=this.u(n.x.e()),this.j===-1){Diag.a.a(50671751,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets {0}",!this.c.d(this.b)||!this.c.b(this.b).a?0:this.c.b(this.b).a.length);return}if(!_Ewa.b.a(this.a).b().u().a(n.F))return;if(i=n.f(),!i){Diag.a.a(50671752,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:{0}",this.i);return}if(r=i.getCalcBlockModel(),!r){Diag.a.a(50671753,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block");return}this.c.b(this.b).b[this.i]=new _Ewa.hM.g(r,n.x.e());this.a.a(315)&&this.J()}finally{t&&t.a()}},F:function(n,t,i){return t&&t.startsWith("'")?t:n.a().s()||i.toString()},W:function(n,t,i){var r=null,e=!1,u,o,f,s;this.f&&this.g!==-1&&(e=this.f.stateIdAvailable(this.g));e&&this.c.d(this.g)&&this.c.b(this.g).b&&this.g<this.b&&(u=this.c.b(this.g).b[n],u&&u.a&&(r=u.b));r||Diag.a.a(595072543,0,100,"CalcAsyncEngine::CreateRangeUpdateCommands() Previous StateId:{0} unavailable - sending full update",this.g);o=this.bb(n,r,t,i);this.U(r,t,o,s={val:f});f=s.val;Diag.a.a(50671754,0,50,"CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:{0} StateId:{1} number of formulas {2}",n,this.b,f)},bb:function(n,t,i,r){var u=!1,e=_Ewa.hM.e(i),f;return t?(f=_Ewa.hM.e(t),_Ewa.e.b(f,e,!1)?(Diag.a.a(50671755,0,100,"CalcAsyncEngine::BlockRangeChanged Block Hash:{0} StateId:{1} - Same row/col headers",n,this.b),u=!0):Diag.a.a(50671756,0,100,"CalcAsyncEngine::BlockRangeChanged Block Hash:{0} StateId:{1} - row/col headers changed",n,this.b)):Diag.a.a(50671757,0,100,"CalcAsyncEngine::BlockRangeChanged Block Hash:{0} StateId:{1} - no previous model to compare",n,this.b),u?this.K(t,this.g,r):this.M(i,r),u},U:function(n,t,i,r){r.val=0;var u=null,f=null;for(t.reset();u=t.getNextCell();)_Ewa.bG.b(u.formula)&&r.val++,f=i?n.getCell(u.row,u.col):null,f?(Diag.a.a(50671758,0,100,"CalcAsyncEngine::CompareModels Cell({0},{1}) found in both models",u.row,u.col),this.T(t,u,f)):(Diag.a.a(50671759,0,100,"CalcAsyncEngine::CompareModels Cell({0},{1}) new cell in model",u.row,u.col),this.L(t,u));if(i)for(n.reset();f=n.getNextCell();)u=t.getCell(f.row,f.col),u||(Diag.a.a(50671760,0,100,"CalcAsyncEngine::CompareModels() Cell({0},{1}) remove cell from model",f.row,f.col),this.t(n,f))},bh:function(){var n=this;this.f.setOnUpdateRequest(function(){})},S:function(){this.f.close()},R:function(){this.f.clearCache()},H:function(){this.f.resumeRecalc()},E:function(n){var r,i,t,u,f;if(this.e){if(r=this.e.b(),i=r.toNumber(n),!isNaN(i))return i;if(n.toUpperCase()===this.m||n.toUpperCase()===this.o)return n.toUpperCase()===this.m;if(!n.length)return excelOnlineCalc.calc.blankValue;if(t=-1,f=this.X(n,u={val:t}),t=u.val,f)return excelOnlineCalc.calc.errorValue(t)}return n},bg:function(){this.f.setA1ReferenceStyle(!0)},be:function(){var n,t;this.e&&(n=this.e.w(),n!==this.y&&(t=excelOnlineCalc.calc.recalcServiceConfig(null,n,null,null),this.f.reconfigure(t),this.y=n))},bk:function(n){var i=null,r,t;if(!this.c.d(this.b)){Diag.a.a(595072542,0,15,"CalcAsyncEngine::SetUpdatedRanges StateId:{0} does not exist in GridCache",this.b);return}try{this.h=[];r=String.format("CalcAsyncEngine::SetUpdatedRanges() StateId:{0} UpdateTriggerData:{1}",this.b,_Ewa.hM.c.toString(n));i=this.a.o().a("ModelUpdate",r);t=this;Common.S.c(this.c.b(this.b).b,function(n,i){i.a||(t.W(n,i.b,i.c),i.a=!0,t.a.isChangeGateEnabled("OfficeVSO:3889280_FixEmptyStringValue")||t.f.updateRanges(t.b,t.h))},null);this.a.isChangeGateEnabled("OfficeVSO:3889280_FixEmptyStringValue")&&this.f.updateRanges(this.b,this.h)}finally{i&&i.a()}},bj:function(){var t=[],n;for(this.C(this.c.b(this.b).a[0].b,null,t),n=1;n<this.c.b(this.b).a.length;n++)this.C(this.c.b(this.b).a[n].b,this.c.b(this.b).a[n].a.sheetId,t);this.f.updateNamedObjects(this.b,t)},C:function(n,t,i){var r=null,u,f;isNullOrUndefined(t)||(r=excelOnlineCalc.calc.undefinedNamesWrite(t),Array.add(i,r));n&&(u=[],f=this,Common.S.c(n,function(n,t){Array.add(u,t)},null),r=excelOnlineCalc.calc.namedObjectsWrite(t,u),Array.add(i,r))},N:function(){return this.c.b(this.b).b[this.i]?(Diag.a.a(50671763,0,50,"CalcAsyncEngine::BlockPreviouslyHandled Block Hash:{0} StateId:{1} previously handled",this.i,this.b),!0):!1},Y:function(){var n=!1,t=this;return _Ewa.b.a(this.a).b().Y(function(i){i.v&1&&t.a.c().e()===i.u.Information.Revision&&(t.D(i),n=!0)}),n},B:function(n,t){var i=n.getRowNumbers(),r=n.getColumnNumbers(),f=i[0]-1,e=i[i.length-1]-1,o=r[0]-1,s=r[r.length-1]-1,u;return u=this.u(t),u===-1&&Diag.a.a(594581026,0,15,"CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets {0}",!this.c.d(this.b)||!this.c.b(this.b).a?0:this.c.b(this.b).a.length),excelOnlineCalc.calc.sheetRangeLocation(u,f,o,e,s)},K:function(n,t,i){var r=this.B(n,i);if(r){var u=_Ewa.hM.b(n.getRowNumbers()),f=_Ewa.hM.b(n.getColumnNumbers()),e=excelOnlineCalc.calc.rangePromote(r,t,u,f);this.h[this.h.length]=e}},M:function(n,t){var i=this.B(n,t);if(i){var r=_Ewa.hM.b(n.getRowNumbers()),u=_Ewa.hM.b(n.getColumnNumbers()),f=excelOnlineCalc.calc.rangeWrite(i,null,r,u);this.h[this.h.length]=f}},T:function(n,t,i){var r=null,f=0,e=0,u=!1,s=null,h,c,o;switch(t.valueType){case 2:this.a.isChangeGateEnabled("OfficeVSO:3889280_FixEmptyStringValue")?(r=this.v(t),s=this.v(i)):(r=t.value||t.text||t.formula,s=i.value||i.text||i.formula);u=_Ewa.e.b(s,r,!1);break;case 1:this.a.isChangeGateEnabled("OfficeVSO:3889280_FixEmptyStringValue")&&isNull(t.value)&&isNull(i.value)||!this.a.isChangeGateEnabled("OfficeVSO:3889280_FixEmptyStringValue")&&!t.value&&!i.value?u=!0:(f=parseFloat(t.value),h=parseFloat(i.value),u=h===f);break;default:this.a.isChangeGateEnabled("OfficeVSO:3889280_FixEmptyStringValue")&&isNull(t.value)&&isNull(i.value)||!this.a.isChangeGateEnabled("OfficeVSO:3889280_FixEmptyStringValue")&&!t.value&&!i.value?u=!0:(e=parseFloat(t.value),c=parseFloat(i.value),u=e===c)}if(u&&t.valueType===i.valueType&&t.ifmt===i.ifmt&&t.formulaType===i.formulaType&&(o=!1,this.a.isChangeGateEnabled("OfficeVSO:3889280_FixEmptyStringValue")&&isNull(t.formula)&&isNull(i.formula)||!this.a.isChangeGateEnabled("OfficeVSO:3889280_FixEmptyStringValue")&&!t.formula&&!i.formula?o=!0:(this.a.isChangeGateEnabled("OfficeVSO:3889280_FixEmptyStringValue")&&!isNull(t.formula)&&!isNull(i.formula)||!this.a.isChangeGateEnabled("OfficeVSO:3889280_FixEmptyStringValue")&&t.formula&&i.formula)&&(o=_Ewa.e.b(i.formula,t.formula,!1)),o)){Diag.a.a(51127569,0,100,"CalcAsyncEngine::CompareCellsAndAddUpdateCommand Cell({0},{1}) identical. ValueType={2}",t.row,t.col,t.valueType);return}this.a.isChangeGateEnabled("OfficeVSO:3889280_FixEmptyStringValue")?isNull(t.formula)&&isNull(t.value)&&isNull(t.text)?this.t(n,t):this.l(n,t,r,f,e):t.valueType===2&&r||t.value?this.l(n,t,r,f,e):this.t(n,t);this.a.isChangeGateEnabled("OfficeVSO:3952611_CalcFormulaTypeEnabled")?Diag.a.a(50671764,0,100,"CalcAsyncEngine::CompareCellsAndAddUpdateCommand Cell({0},{1}) ValueTypes:{2}->{3} Ifmt:{4}->{5} FormulaTypes: {6}->{7}",t.row,t.col,i?i.valueType.toString():"no prev cell",t.valueType.toString(),i?i.ifmt.toString():"no prev cell",t.ifmt,i?i.formulaType.toString():"no prev cell",t.formulaType.toString()):Diag.a.a(593825992,0,100,"CalcAsyncEngine::CompareCellsAndAddUpdateCommand Cell({0},{1}) ValueTypes:{2}->{3} Ifmt:{4}->{5}",t.row,t.col,i?i.valueType.toString():"no prev cell",t.valueType.toString(),i?i.ifmt.toString():"no prev cell",t.ifmt)},J:function(){var u,n,i,f,s,r;if(this.a.n()&&this.a.n().j())for(u=0;u<this.a.n().d();u++)if(n=this.a.n().j()[u],n.c===2||n.c===3){var e=0,t=n.a,o=t.lastIndexOf("!");if(o>0){if(i=t.substr(0,o),i.charAt(0)==="'"&&(i=i.substr(1,i.length-2)),e=this.G(i),e===-1){Diag.a.a(595096334,0,15,"CalcAsyncEngine::AddNamedRangesCommand SheetName not found. Number of existing sheets {0}",!this.c.d(this.b)||!this.c.b(this.b).a?0:this.c.b(this.b).a.length);continue}t=t.substr(o+1)}if(f=null,f=this.c.b(this.b).a[e].b,!(t in f)){if(s=this.u(n.d),s===-1){Diag.a.a(595096333,0,15,"CalcAsyncEngine::AddNamedRangesCommand SheetName not found. Number of existing sheets {0}",!this.c.d(this.b)||!this.c.b(this.b).a?0:this.c.b(this.b).a.length);continue}r=n.b;n.c===2&&(r=_Ewa.bW.a(n,!1));var h=excelOnlineCalc.calc.sheetRangeLocation(s,r.a-1,r.b-1,r.d-1,r.c-1),c=excelOnlineCalc.calc.namedRangeData(h),l=excelOnlineCalc.calc.namedObject(t,c);f[t]=l}}},l:function(n,t,i,r,u){var h,c,l,a,v,f,e,s,o,y;this.a.isChangeGateEnabled("OfficeVSO:3950189_SendAbsoluteCellPosition")?(a=n.getRowNumbers()[t.row]-1,v=n.getColumnNumbers()[t.col]-1,h=excelOnlineCalc.calc.sheetRangeLocation(this.j,a,v,a,v)):(c=n.getRowNumbers()[0]-1,l=n.getColumnNumbers()[0]-1,h=excelOnlineCalc.calc.sheetRangeLocation(this.j,t.row+c,t.col+l,t.row+c,t.col+l));f=null;e=t.formula||t.text;switch(t.valueType){case 2:isNull(i)||(this.a.isChangeGateEnabled("OfficeVSO:3952611_CalcFormulaTypeEnabled")?(t.formulaType||(f=excelOnlineCalc.calc.valueCellData(e,i,t.ifmt)),t.formulaType===1&&(f=excelOnlineCalc.calc.cellFormulaCellData(e,i,t.ifmt)),t.formulaType===2&&(f=excelOnlineCalc.calc.arrayFormulaCellData(e,i,t.ifmt))):f=excelOnlineCalc.calc.cellData(e,i,t.ifmt));break;case 1:isNaN(r)?Diag.a.a(50857250,0,50,"CalcAsyncEngine::AddRangeUpdateCommand Cell({0},{1}) invalid numeric value",t.row,t.col):this.a.isChangeGateEnabled("OfficeVSO:3952611_CalcFormulaTypeEnabled")?(t.formulaType||(f=excelOnlineCalc.calc.valueCellData(e,r,t.ifmt)),t.formulaType===1&&(f=excelOnlineCalc.calc.cellFormulaCellData(e,r,t.ifmt)),t.formulaType===2&&(f=excelOnlineCalc.calc.arrayFormulaCellData(e,r,t.ifmt))):f=excelOnlineCalc.calc.cellData(e,r,t.ifmt);break;case 3:isNaN(u)?Diag.a.a(50857251,0,15,"CalcAsyncEngine::AddRangeUpdateCommand Cell({0},{1}) invalid boolean value",t.row,t.col):this.a.isChangeGateEnabled("OfficeVSO:3952611_CalcFormulaTypeEnabled")?(s=u===1?!0:!1,t.formulaType||(f=excelOnlineCalc.calc.valueCellData(e,s,t.ifmt)),t.formulaType===1&&(f=excelOnlineCalc.calc.cellFormulaCellData(e,s,t.ifmt)),t.formulaType===2&&(f=excelOnlineCalc.calc.arrayFormulaCellData(e,s,t.ifmt))):f=excelOnlineCalc.calc.cellData(e,u===1?!0:!1,t.ifmt);break;case 4:isNaN(u)?Diag.a.a(50857280,0,15,"CalcAsyncEngine::AddRangeUpdateCommand Cell({0},{1}) invalid error value",t.row,t.col):(o=excelOnlineCalc.calc.errorValue(u),this.a.isChangeGateEnabled("OfficeVSO:3952611_CalcFormulaTypeEnabled")?(t.formulaType||(f=excelOnlineCalc.calc.valueCellData(e,o,t.ifmt)),t.formulaType===1&&(f=excelOnlineCalc.calc.cellFormulaCellData(e,o,t.ifmt)),t.formulaType===2&&(f=excelOnlineCalc.calc.arrayFormulaCellData(e,o,t.ifmt))):f=excelOnlineCalc.calc.cellData(e,o,t.ifmt))}f&&(y=excelOnlineCalc.calc.rangeWrite(h,f,null,null),this.h[this.h.length]=y)},L:function(n,t){switch(t.valueType){case 2:var i;i=this.a.isChangeGateEnabled("OfficeVSO:3889280_FixEmptyStringValue")?this.v(t):t.value||t.text||t.formula;this.l(n,t,i,null,0);break;case 1:this.l(n,t,null,parseFloat(t.value),0);break;default:this.l(n,t,null,null,parseFloat(t.value))}},t:function(n,t){var i,r,u,f,e;this.a.isChangeGateEnabled("OfficeVSO:3950189_SendAbsoluteCellPosition")?(f=n.getRowNumbers()[t.row]-1,e=n.getColumnNumbers()[t.col]-1,i=excelOnlineCalc.calc.sheetRangeLocation(this.j,f,e,f,e)):(r=n.getRowNumbers()[0]-1,u=n.getColumnNumbers()[0]-1,i=excelOnlineCalc.calc.sheetRangeLocation(this.j,t.row+r,t.col+u,t.row+r,t.col+u));var o=excelOnlineCalc.calc.blankValue,s=this.a.isChangeGateEnabled("OfficeVSO:3952611_CalcFormulaTypeEnabled")?excelOnlineCalc.calc.valueCellData("",o,t.ifmt):excelOnlineCalc.calc.cellData("",o,t.ifmt),h=excelOnlineCalc.calc.rangeWrite(i,s,null,null);this.h[this.h.length]=h},u:function(n){var t=this.G(n);return t>0?this.c.b(this.b).a[t].a.sheetId:-1},G:function(n){var i,t;if(!this.c.d(this.b))return Diag.a.a(595072538,0,15,"CalcAsyncEngine.GetSheetInternalIndex StateId:{0} does not exist in GridCache",this.b),-1;if(!this.c.b(this.b).a)return Diag.a.a(595072537,0,15,"CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:{0}",this.b),-1;for(i=this.c.b(this.b).a,t=1;t<i.length;t++)if(_Ewa.e.b(i[t].a.sheetName,n,!1))return t;return-1},bi:function(){var n,t,i;if(!this.c.d(this.b)||!this.c.b(this.b).a.length)return Diag.a.a(595072536,0,15,"CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:{0} or StateId does not exist in GridCache",this.b),!1;for(n=[],t=1;t<this.c.b(this.b).a.length;t++)i=this.c.b(this.b).a[t],i&&Array.add(n,i.a);return this.a.a(315)?(this.f.updateSheetNames(this.b,n),this.f.updateUnusedCells(this.b,this.c.b(this.b).c)):this.f.setSheetNames(n),!0},I:function(){var f,o,r,u,t,l;if(this.e){if(this.a.isChangeGateEnabled("OfficeVSO:4067058_TestDefaultNumberFormats")&&!this.d){Diag.a.b(593273157,0,!1,"CalcAsyncEngine::SetNumberFormat() defaultNumberFormats is null");return}f=[];o=new RegExp("0.(0+)*");for(var s=this.e.d(),a=s.length,e=0;e<a;++e){var n=s[e],i="",h,c,v=(c=this.e.D(n.IfmtIndex,h={val:i},!0),i=h.val,c);v&&i.length?(r=0,u=o.exec(n.FormatString),!isNullOrUndefined(u)&&u.length>=2&&(r=isNullOrUndefined(u[1])?0:u[1].length),this.a.isChangeGateEnabled("OfficeVSO:4067058_TestDefaultNumberFormats")&&n.IfmtIndex<=35&&(this.d.d(n.IfmtIndex)?(t=this.d.b(n.IfmtIndex),t.c||t.b===i&&t.a===r||(t.c=!0,Diag.a.a(593273155,0,15,"CalcAsyncEngine.SetNumberFormat ifmt:{0}, default values:({1},{2}), server values:({3},{4}),  UILocale:{5}, DataLocale:{6}",n.IfmtIndex,t.b,t.a,i,r,this.a.cc(),this.a.ca()))):Diag.a.a(593273156,0,15,"CalcAsyncEngine.SetNumberFormat no entry for ifmt:{0}, UILocale:{1}, DataLocale:{2}",n.IfmtIndex,this.a.cc(),this.a.ca())),l=excelOnlineCalc.calc.numberFormat(n.IfmtIndex,i,r),Array.add(f,l)):Diag.a.a(42812305,0,50,"CalcAsyncEngine.SetNumberFormat Failed to get category for ifmt {0}",n.IfmtIndex)}this.f.setNumberFormats(f,!0)}},bf:function(){var n;if(this.e&&this.e.a()&&(n=this.Z(),!this.w||n)){this.V();this.e.a().TrueValueString&&(this.m=this.e.a().TrueValueString);this.e.a().FalseValueString&&(this.o=this.e.a().FalseValueString);var t=this.e.a().DecimalSeperator.toString(),i=this.e.a().ListSeparator.toString(),r=this.e.a().ColumnSeparator.toString(),u=this.e.a().RowSeparator.toString(),f=excelOnlineCalc.calc.localeData(n,this.k,this.m,this.o,"R","C","{","}","[","]",t,i,r,u);this.f.setLocale(f);this.w=!0}},bc:function(){this.I()},bd:function(){Diag.a.a(595072535,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");this.c=new($$sc.r.$$(_Ewa.hM.d));this.g=-1;this.b=-1;this.i="";this.j=-1;this.f&&this.R()},bl:function(){var t,i,n;this.a.a(420)&&(t=0,i=this,$$sc.h.a(Boolean,excelOnlineCalc.worker.runSmokeTest(1/t,this.q,!0)).CW(function(n){n.c?Diag.a.a(40768413,0,15,"CalcAsyncEngine.TryInitialize: calc smoke test failed: {0}",n.c.toString()):Diag.a.a(40768412,0,50,"CalcAsyncEngine.TryInitialize: calc smoke test ended - a new one should start")}));_Ewa.r.c(this.a)&&(this.p=$$sc.h.a(Object,excelOnlineCalc.calc.createRecalcService()),n=this,this.p.CW(function(t){if(t.c)Diag.a.a(42321621,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker failed: {0}",t.c.toString());else if(Diag.a.a(42321620,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),n.f=n.p.a(),n.f){if(!n.r(0)){Diag.a.a(594884823,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize");return}n.a.isChangeGateEnabled("OfficeVSO:3884073_EnsureRecalcEngineInitialization")||(n.e.e(n.n),n.a.isChangeGateEnabled("OfficeVSO:3863292_RefactorCalcAsyncEngine")&&n.a.E(n.s))}else Diag.a.a(42812306,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null")}))},Z:function(){var u=[],n=this.e.c(),i,r;if(!n||this.z===n.length)return null;this.z=n.length;for(var f=n,e=f.length,t=0;t<e;++t)i=f[t],r=excelOnlineCalc.calc.worksheetFunctionName(i.FunctionIndex,i.NameUI),r&&Array.add(u,r);return u},V:function(){var t,n,i;for(this.k=[],t=Object.keys(_Ewa.dU.a),n=0;n<t.length;n++)i=excelOnlineCalc.calc.errorTypeName(n+1,t[n]),i&&Array.add(this.k,i)},X:function(n,t){t.val=0;for(var i=0;i<this.k.length;i++)if(this.k[i].errorName===n.toUpperCase())return t.val=this.k[i].errorType,!0;return!1},ba:function(){var i,n,t,r;if(!this.c.d(this.b)||!(this.c.b(this.b).a.length>0))for(this.c.c(this.b,new _Ewa.hM.d),this.c.b(this.b).a[0]=new _Ewa.hM.f(null),i=this.a.e(),n=0;n<i.d();n++)if(t=$$as(_Ewa.E,i.g(n)),t){r=excelOnlineCalc.calc.sheetName(t.f,t.a);this.c.b(this.b).a[n+1]=new _Ewa.hM.f(r);var u=t.b.t(),f=excelOnlineCalc.calc.rangeLocation(0,0,u.LastRow,u.LastColumn),e=excelOnlineCalc.calc.unusedCellsUpdate(t.f,f);Array.add(this.c.b(this.b).c,e)}else Diag.a.a(595072534,0,15,"CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:{0} sheet-index:{1}",this.b,n)},Q:function(){for(var t=this.c.$$ge(),n;t.$$mn();)n=t.$$cu(),n.b<this.g&&this.c.i(n.b)},v:function(n){var t=n.value||n.text;return isNull(t)&&(isNull(n.formula)||(t="")),t},bm:function(){if(!this.c.d(this.b))return!1;var n=!1,t=this;return Common.S.c(this.c.b(this.b).b,function(t,i){i.a||(n=!0)},null),n},O:function(){var t="Number",i="Currency",u="Percentage",n="Custom",r="Accounting";this.d=new($$sc.r.$$(_Ewa.hM.a));this.d.a(0,new _Ewa.hM.a("General",0));this.d.a(1,new _Ewa.hM.a(t,0));this.d.a(2,new _Ewa.hM.a(t,2));this.d.a(3,new _Ewa.hM.a(t,0));this.d.a(4,new _Ewa.hM.a(t,2));this.d.a(5,new _Ewa.hM.a(t,0));this.d.a(6,new _Ewa.hM.a(t,0));this.d.a(7,new _Ewa.hM.a(t,2));this.d.a(8,new _Ewa.hM.a(t,2));this.d.a(9,new _Ewa.hM.a(i,0));this.d.a(10,new _Ewa.hM.a(i,0));this.d.a(11,new _Ewa.hM.a(i,2));this.d.a(12,new _Ewa.hM.a(i,2));this.d.a(13,new _Ewa.hM.a(u,0));this.d.a(14,new _Ewa.hM.a(u,2));this.d.a(15,new _Ewa.hM.a("Scientific",2));this.d.a(16,new _Ewa.hM.a(n,1));this.d.a(19,new _Ewa.hM.a("Date",0));this.d.a(20,new _Ewa.hM.a(n,0));this.d.a(21,new _Ewa.hM.a(n,0));this.d.a(22,new _Ewa.hM.a(n,0));this.d.a(23,new _Ewa.hM.a(n,0));this.d.a(24,new _Ewa.hM.a(n,0));this.d.a(25,new _Ewa.hM.a(n,0));this.d.a(26,new _Ewa.hM.a(n,0));this.d.a(27,new _Ewa.hM.a(n,0));this.d.a(28,new _Ewa.hM.a(n,0));this.d.a(29,new _Ewa.hM.a(n,0));this.d.a(30,new _Ewa.hM.a("Text",0));this.d.a(31,new _Ewa.hM.a(n,0));this.d.a(32,new _Ewa.hM.a(r,0));this.d.a(33,new _Ewa.hM.a(r,0));this.d.a(34,new _Ewa.hM.a(r,2));this.d.a(35,new _Ewa.hM.a(r,2))}};_Ewa.hM.a=function(n,t){this.b=n;this.a=t;this.c=!1};_Ewa.hM.a.prototype={b:null,a:0,c:!1};_Ewa.hM.d=function(){this.a=[];this.c=[];this.b={}};_Ewa.hM.d.prototype={a:null,c:null,b:null};_Ewa.hM.g=function(n,t){this.b=n;this.c=t;this.a=!1};_Ewa.hM.g.prototype={b:null,c:null,a:!1};_Ewa.hM.f=function(n){this.a=n;this.b={}};_Ewa.hM.f.prototype={a:null,b:null};_Ewa.hM.c=function(){};_Ewa.hM.c.prototype={initialization:0,contentReady:1,cellEdit:2};_Ewa.hM.c.registerEnum("_Ewa.hM.c",!1);_Ewa.hN=function(n,t){var i,r,u;this.p=Function.createDelegate(this,this.l);this.n=Function.createDelegate(this,this.q);this.o=Function.createDelegate(this,this.B);this.b=n;this.a=this.b.b().a(_Ewa.cg,268,!1);this.a||Diag.a.b(34719498,0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");i=this.b.a(825)?_Ewa.s.b.a(51):_Ewa.s.b.a(54);this.g=new _Ewa.nx;this.d=excelOnlineCalc.location.documentLoc("",this.b.l().FullDocumentInfo.BreadcrumbDocName);this.c=new _Ewa.jd(n,this.a);this.e=excelOnlineCalc.config.calcConfig(this.c.a);var f=this,o=this,e=this.a?function(n){return f.a.z(n)}:function(){return!1};excelOnlineCalc.config.initCalc(this.g,e,i);this.j=excelOnlineCalc.calc.createFormatInfo(this.o,t,this.u(),this.t());this.k=excelOnlineCalc.calc.formulaCacheGlobals(this.e,excelOnlineCalc.runtime.fastMathpack,this.j);r=this;u=this;this.m=excelOnlineCalc.calc.mapperContext(this.a?this.a.v():100,!1,!1,!1,!1,!1,function(){return r.d},this.n,this.p,function(n,t){return u.x(t)})};_Ewa.hN.a=function(n){var i=n,t;if(!i)return 4;if(t=excelOnlineCalc.runtime.getEvalFailureReason(n),isNullOrUndefined(t))return Diag.a.b(34388126,0,!1,"CalcHelper.GetEvalFailureReason() - result is not a failure, function should not be called"),4;switch(t){case"Stopped":case"Timeout":return 2;case"Unavailable":return 5;case"NameCycle":case"CellCycle":return 6;case"NotImplemented":return 7;default:return 4}};_Ewa.hN.prototype={b:null,d:null,e:null,m:null,k:null,g:null,a:null,j:null,c:null,B:function(n){var t=0,i,r;return this.a&&(r=this.a.i(n,i={val:t},!0),t=i.val,r),t},u:function(){var n={},i,t;return this.a&&this.a.b()?(i=this.a.n(6),t=this.a.b().findMatchingFormat("0.00%","",0,i),isNaN(t)||(n.Percentage=t)):Diag.a.a(38576399,0,50,"CalcHelper.BuildKnownFormatsObject() - not all formats were initialized successfully"),n.General=0,n},t:function(){var n={};return n.General=0,n.Number=1,n.Currency=2,n.Accounting=3,n.Date=4,n.Time=5,n.Percentage=6,n.Fraction=7,n.Scientific=8,n.Text=9,n.Special=10,n.Custom=11,n},q:function(){var n=this.b.e().a();return n.f},A:function(n,t){return _Ewa.e.b(t,this.d.name,!0)?this.d:excelOnlineCalc.location.documentLoc(n,t)},s:function(n,t){var r=n.name,i;if(r){if(i=this.b.n(),i)return t.val=!0,i.b(r)}else Diag.a.a(38573216,0,50,"CalcHelper.GetNameItem: input name is null");return t.val=!1,null},C:function(n,t){var i=this.l(n,t);return excelOnlineCalc.util.success(i)},l:function(n,t){var i=this.b.e().b(t);return i?i.f:null},i:function(){return excelOnlineCalc.calc.formulaCache(this.k)},f:function(){return excelOnlineCalc.calc.recalcMapper(this.g)},v:function(){var n={};return n.config=this.e,excelOnlineCalc.parse.createParser(n)},w:function(n,t,i){var r=excelOnlineCalc.location.gridCell(t,i),u=excelOnlineCalc.location.sheetIndex(this.d,n);return excelOnlineCalc.location.sheetGridCell(u,r)},x:function(n){var i,r,u,t=(u=this.s(n,r={val:i}),i=r.val,u);if(t)switch(t.c){case 3:return this.y(t)}return null},r:function(n,t,i,r){var u=excelOnlineCalc.runtime.extractResultValue(n),f;if(isNullOrUndefined(u))return Diag.a.a(34388127,0,15,"CalcHelper.EvalResultToString() - null or undefined oper"),r.val=8,"";r.val=excelOnlineCalc.util.operKind(u);switch(r.val){case 4:return u?this.c.a.trueName:this.c.a.falseName;case 1:return this.b.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.h(this.c.e(u),t,i):this.c.e(u);case 2:return this.b.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.h(u.toString(),t,i):u.toString();case 128:return"";case 8:f=u;switch(f.type){case 1:return"#NULL!";case 2:return"#DIV/0!";case 3:return"#VALUE!";case 4:return"#REF!";case 5:return"#NAME?";case 6:return"#NUM!";case 7:return"#N/A!";case 8:return"#GETTING_DATA";default:return _Ewa.hN.b}case 16:return"##UNSUPPORTED: RANGE";case 32:return this.b.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.h(this.z(u,t,i),t,i):"##UNSUPPORTED: ARRAY";case 256:return"##UNSUPPORTED: RICH";default:return"##UNSUPPORTED: "+OperKind.toString(r.val)}},h:function(n,t,i){return!t||n.length<=i?n:n.substring(0,i-3)+"..."},z:function(n,t,i){for(var r,u=this.c.a.leftBrace,f=0;f<n.rows;++f){for(r=0;r<n.cols;++r)u+=n.opers[f][r],r<n.cols-1&&(u+=this.c.a.columnSeparator);f<n.rows-1&&(u+=this.c.a.rowSeparator)}return this.h(u,t,i-1)+this.c.a.rightBrace},y:function(n){var t=n.b,i;if(!t||(i=this.l(this.d,n.e()),!i))return null;var r=excelOnlineCalc.location.sheetIndex(this.d,i),u=t.d-t.a+1,f=t.c-t.b+1,e=excelOnlineCalc.location.gridRange(t.a-1,t.b-1,u,f);return excelOnlineCalc.location.sheetGridRange(r,e)}};_Ewa.jd=function(n,t){var e,o;this.g=Function.createDelegate(this,this.k);this.i=Function.createDelegate(this,this.m);this.h=Function.createDelegate(this,this.l);this.f=Function.createDelegate(this,this.e);this.j=Function.createDelegate(this,this.n);this.b=null;this.d=n;var i=".",r=",",u=",",f=";";t&&(this.b=t.b(),t.a()?(i=t.a().DecimalSeperator.toString(),r=t.a().ListSeparator.toString(),u=t.a().ColumnSeparator.toString(),f=t.a().RowSeparator.toString()):Diag.a.b(34445250,0,!1,"LocaleHolder constructor - locale information is not available"));this.c=["0","1","2","3","4","5","6","7","8","9"];!!this.b;o=(e=[""]).concat.apply(e,Object.keys(_Ewa.dU.a));this.a=excelOnlineCalc.config.localeInfo(this.j,this.f,this.h,this.i,_Ewa.jd.d,_Ewa.jd.a,this.g,_Ewa.jd.c,_Ewa.jd.stringCompareCI,o,t&&t.a()&&t.a().TrueValueString?t.a().TrueValueString:"TRUE",t&&t.a()&&t.a().FalseValueString?t.a().FalseValueString:"FALSE","R","C","{","}","[","]",i,r,u,f)};_Ewa.jd.b=function(n){switch(n){case"COUNT":return 0;case"IF":return 1;case"ISNA":return 2;case"ISERROR":return 3;case"SUM":return 4;case"AVERAGE":return 5;case"MIN":return 6;case"MAX":return 7;case"ROW":return 8;case"COLUMN":return 9;case"NA":return 10;case"NPV":return 11;case"STDEV":return 12;case"DOLLAR":return 13;case"FIXED":return 14;case"SIN":return 15;case"COS":return 16;case"TAN":return 17;case"ATAN":return 18;case"PI":return 19;case"SQRT":return 20;case"EXP":return 21;case"LN":return 22;case"LOG10":return 23;case"ABS":return 24;case"INT":return 25;case"SIGN":return 26;case"ROUND":return 27;case"LOOKUP":return 28;case"INDEX":return 29;case"REPT":return 30;case"MID":return 31;case"LEN":return 32;case"VALUE":return 33;case"TRUE":return 34;case"FALSE":return 35;case"AND":return 36;case"OR":return 37;case"NOT":return 38;case"MOD":return 39;case"DCOUNT":return 40;case"DSUM":return 41;case"DAVERAGE":return 42;case"DMIN":return 43;case"DMAX":return 44;case"DSTDEV":return 45;case"VAR":return 46;case"DVAR":return 47;case"TEXT":return 48;case"LINEST":return 49;case"TREND":return 50;case"LOGEST":return 51;case"GROWTH":return 52;case"GOTO":return 53;case"HALT":return 54;case"RETURN":return 55;case"PV":return 56;case"FV":return 57;case"NPER":return 58;case"PMT":return 59;case"RATE":return 60;case"MIRR":return 61;case"IRR":return 62;case"RAND":return 63;case"MATCH":return 64;case"DATE":return 65;case"TIME":return 66;case"DAY":return 67;case"MONTH":return 68;case"YEAR":return 69;case"WEEKDAY":return 70;case"HOUR":return 71;case"MINUTE":return 72;case"SECOND":return 73;case"NOW":return 74;case"AREAS":return 75;case"ROWS":return 76;case"COLUMNS":return 77;case"OFFSET":return 78;case"ABSREF":return 79;case"RELREF":return 80;case"ARGUMENT":return 81;case"SEARCH":return 82;case"TRANSPOSE":return 83;case"ERROR":return 84;case"STEP":return 85;case"TYPE":return 86;case"ECHO":return 87;case"SET.NAME":return 88;case"CALLER":return 89;case"DEREF":return 90;case"WINDOWS":return 91;case"SERIES":return 92;case"DOCUMENTS":return 93;case"ACTIVE.CELL":return 94;case"SELECTION":return 95;case"RESULT":return 96;case"ATAN2":return 97;case"ASIN":return 98;case"ACOS":return 99;case"CHOOSE":return 100;case"HLOOKUP":return 101;case"VLOOKUP":return 102;case"LINKS":return 103;case"INPUT":return 104;case"ISREF":return 105;case"GET.FORMULA":return 106;case"GET.NAME":return 107;case"SET.VALUE":return 108;case"LOG":return 109;case"EXEC":return 110;case"CHAR":return 111;case"LOWER":return 112;case"UPPER":return 113;case"PROPER":return 114;case"LEFT":return 115;case"RIGHT":return 116;case"EXACT":return 117;case"TRIM":return 118;case"REPLACE":return 119;case"SUBSTITUTE":return 120;case"CODE":return 121;case"NAMES":return 122;case"DIRECTORY":return 123;case"FIND":return 124;case"CELL":return 125;case"ISERR":return 126;case"ISTEXT":return 127;case"ISNUMBER":return 128;case"ISBLANK":return 129;case"T":return 130;case"N":return 131;case"FOPEN":return 132;case"FCLOSE":return 133;case"FSIZE":return 134;case"FREADLN":return 135;case"FREAD":return 136;case"FWRITELN":return 137;case"FWRITE":return 138;case"FPOS":return 139;case"DATEVALUE":return 140;case"TIMEVALUE":return 141;case"SLN":return 142;case"SYD":return 143;case"DDB":return 144;case"GET.DEF":return 145;case"REFTEXT":return 146;case"TEXTREF":return 147;case"INDIRECT":return 148;case"REGISTER":return 149;case"CALL":return 150;case"ADD.BAR":return 151;case"ADD.MENU":return 152;case"ADD.COMMAND":return 153;case"ENABLE.COMMAND":return 154;case"CHECK.COMMAND":return 155;case"RENAME.COMMAND":return 156;case"SHOW.BAR":return 157;case"DELETE.MENU":return 158;case"DELETE.COMMAND":return 159;case"GET.CHART.ITEM":return 160;case"DIALOG.BOX":return 161;case"CLEAN":return 162;case"MDETERM":return 163;case"MINVERSE":return 164;case"MMULT":return 165;case"FILES":return 166;case"IPMT":return 167;case"PPMT":return 168;case"COUNTA":return 169;case"CANCEL.KEY":return 170;case"FOR":return 171;case"WHILE":return 172;case"BREAK":return 173;case"NEXT":return 174;case"INITIATE":return 175;case"REQUEST":return 176;case"POKE":return 177;case"EXECUTE":return 178;case"TERMINATE":return 179;case"RESTART":return 180;case"HELP":return 181;case"GET.BAR":return 182;case"PRODUCT":return 183;case"FACT":return 184;case"GET.CELL":return 185;case"GET.WORKSPACE":return 186;case"GET.WINDOW":return 187;case"GET.DOCUMENT":return 188;case"DPRODUCT":return 189;case"ISNONTEXT":return 190;case"GET.NOTE":return 191;case"NOTE":return 192;case"STDEVP":return 193;case"VARP":return 194;case"DSTDEVP":return 195;case"DVARP":return 196;case"TRUNC":return 197;case"ISLOGICAL":return 198;case"DCOUNTA":return 199;case"DELETE.BAR":return 200;case"UNREGISTER":return 201;case"USDOLLAR":return 204;case"FINDB":return 205;case"SEARCHB":return 206;case"REPLACEB":return 207;case"LEFTB":return 208;case"RIGHTB":return 209;case"MIDB":return 210;case"LENB":return 211;case"ROUNDUP":return 212;case"ROUNDDOWN":return 213;case"ASC":return 214;case"DBCS":return 215;case"RANK":return 216;case"ADDRESS":return 219;case"DAYS360":return 220;case"TODAY":return 221;case"VDB":return 222;case"ELSE":return 223;case"ELSE.IF":return 224;case"END.IF":return 225;case"FOR.CELL":return 226;case"MEDIAN":return 227;case"SUMPRODUCT":return 228;case"SINH":return 229;case"COSH":return 230;case"TANH":return 231;case"ASINH":return 232;case"ACOSH":return 233;case"ATANH":return 234;case"DGET":return 235;case"CREATE.OBJECT":return 236;case"VOLATILE":return 237;case"LAST.ERROR":return 238;case"CUSTOM.UNDO":return 239;case"CUSTOM.REPEAT":return 240;case"FORMULA.CONVERT":return 241;case"GET.LINK.INFO":return 242;case"TEXT.BOX":return 243;case"INFO":return 244;case"GROUP":return 245;case"GET.OBJECT":return 246;case"DB":return 247;case"PAUSE":return 248;case"RESUME":return 251;case"FREQUENCY":return 252;case"ADD.TOOLBAR":return 253;case"DELETE.TOOLBAR":return 254;case"RESET.TOOLBAR":return 256;case"EVALUATE":return 257;case"GET.TOOLBAR":return 258;case"GET.TOOL":return 259;case"SPELLING.CHECK":return 260;case"ERROR.TYPE":return 261;case"APP.TITLE":return 262;case"WINDOW.TITLE":return 263;case"SAVE.TOOLBAR":return 264;case"ENABLE.TOOL":return 265;case"PRESS.TOOL":return 266;case"REGISTER.ID":return 267;case"GET.PROJECT":return 268;case"AVEDEV":return 269;case"BETADIST":return 270;case"GAMMALN":return 271;case"BETAINV":return 272;case"BINOMDIST":return 273;case"CHIDIST":return 274;case"CHIINV":return 275;case"COMBIN":return 276;case"CONFIDENCE":return 277;case"CRITBINOM":return 278;case"EVEN":return 279;case"EXPONDIST":return 280;case"FDIST":return 281;case"FINV":return 282;case"FISHER":return 283;case"FISHERINV":return 284;case"FLOOR":return 285;case"GAMMADIST":return 286;case"GAMMAINV":return 287;case"CEILING":return 288;case"HYPGEOMDIST":return 289;case"LOGNORMDIST":return 290;case"LOGINV":return 291;case"NEGBINOMDIST":return 292;case"NORMDIST":return 293;case"NORMSDIST":return 294;case"NORMINV":return 295;case"NORMSINV":return 296;case"STANDARDIZE":return 297;case"ODD":return 298;case"PERMUT":return 299;case"POISSON":return 300;case"TDIST":return 301;case"WEIBULL":return 302;case"SUMXMY2":return 303;case"SUMX2MY2":return 304;case"SUMX2PY2":return 305;case"CHITEST":return 306;case"CORREL":return 307;case"COVAR":return 308;case"FORECAST":return 309;case"FTEST":return 310;case"INTERCEPT":return 311;case"PEARSON":return 312;case"RSQ":return 313;case"STEYX":return 314;case"SLOPE":return 315;case"TTEST":return 316;case"PROB":return 317;case"DEVSQ":return 318;case"GEOMEAN":return 319;case"HARMEAN":return 320;case"SUMSQ":return 321;case"KURT":return 322;case"SKEW":return 323;case"ZTEST":return 324;case"LARGE":return 325;case"SMALL":return 326;case"QUARTILE":return 327;case"PERCENTILE":return 328;case"PERCENTRANK":return 329;case"MODE":return 330;case"TRIMMEAN":return 331;case"TINV":return 332;case"MOVIE.COMMAND":return 334;case"GET.MOVIE":return 335;case"CONCATENATE":return 336;case"POWER":return 337;case"SPREADBASE.DATA.FIELD":return 338;case"GET.VIEW":return 339;case"GET.FIELD":return 340;case"GET.ITEM":return 341;case"RADIANS":return 342;case"DEGREES":return 343;case"SUBTOTAL":return 344;case"SUMIF":return 345;case"COUNTIF":return 346;case"COUNTBLANK":return 347;case"SCENARIO.GET":return 348;case"OPTIONS.LISTS":return 349;case"ISPMT":return 350;case"DATEDIF":return 351;case"DATESTRING":return 352;case"NUMBERSTRING":return 353;case"ROMAN":return 354;case"OPENDIALOG":return 355;case"SAVEDIALOG":return 356;case"VIEW.GET":return 357;case"GETPIVOTDATA":return 358;case"HYPERLINK":return 359;case"FURIGANA":return 360;case"AVERAGEA":return 361;case"MAXA":return 362;case"MINA":return 363;case"STDEVPA":return 364;case"VARPA":return 365;case"STDEVA":return 366;case"VARA":return 367;case"BAHTTEXT":return 368;case"THAIDOW":return 369;case"THAIDIGIT":return 370;case"THAIMOY":return 371;case"THAINUMSOUND":return 372;case"THAINUMSTRING":return 373;case"THAISTRINGLENGTH":return 374;case"ISTHAIDIGIT":return 375;case"ROUNDBAHTDOWN":return 376;case"ROUNDBAHTUP":return 377;case"THAIYEAR":return 378;case"RTD":return 379;case"CUBEVALUE":return 380;case"CUBEMEMBER":return 381;case"CUBEMEMBERPROPERTY":return 382;case"CUBERANKEDMEMBER":return 383;case"HEX2BIN":return 384;case"HEX2DEC":return 385;case"HEX2OCT":return 386;case"DEC2BIN":return 387;case"DEC2HEX":return 388;case"DEC2OCT":return 389;case"OCT2BIN":return 390;case"OCT2HEX":return 391;case"OCT2DEC":return 392;case"BIN2DEC":return 393;case"BIN2OCT":return 394;case"BIN2HEX":return 395;case"IMSUB":return 396;case"IMDIV":return 397;case"IMPOWER":return 398;case"IMABS":return 399;case"IMSQRT":return 400;case"IMLN":return 401;case"IMLOG2":return 402;case"IMLOG10":return 403;case"IMSIN":return 404;case"IMCOS":return 405;case"IMEXP":return 406;case"IMARGUMENT":return 407;case"IMCONJUGATE":return 408;case"IMAGINARY":return 409;case"IMREAL":return 410;case"COMPLEX":return 411;case"IMSUM":return 412;case"IMPRODUCT":return 413;case"SERIESSUM":return 414;case"FACTDOUBLE":return 415;case"SQRTPI":return 416;case"QUOTIENT":return 417;case"DELTA":return 418;case"GESTEP":return 419;case"ISEVEN":return 420;case"ISODD":return 421;case"MROUND":return 422;case"ERF":return 423;case"ERFC":return 424;case"BESSELJ":return 425;case"BESSELK":return 426;case"BESSELY":return 427;case"BESSELI":return 428;case"XIRR":return 429;case"XNPV":return 430;case"PRICEMAT":return 431;case"YIELDMAT":return 432;case"INTRATE":return 433;case"RECEIVED":return 434;case"DISC":return 435;case"PRICEDISC":return 436;case"YIELDDISC":return 437;case"TBILLEQ":return 438;case"TBILLPRICE":return 439;case"TBILLYIELD":return 440;case"PRICE":return 441;case"YIELD":return 442;case"DOLLARDE":return 443;case"DOLLARFR":return 444;case"NOMINAL":return 445;case"EFFECT":return 446;case"CUMPRINC":return 447;case"CUMIPMT":return 448;case"EDATE":return 449;case"EOMONTH":return 450;case"YEARFRAC":return 451;case"COUPDAYBS":return 452;case"COUPDAYS":return 453;case"COUPDAYSNC":return 454;case"COUPNCD":return 455;case"COUPNUM":return 456;case"COUPPCD":return 457;case"DURATION":return 458;case"MDURATION":return 459;case"ODDLPRICE":return 460;case"ODDLYIELD":return 461;case"ODDFPRICE":return 462;case"ODDFYIELD":return 463;case"RANDBETWEEN":return 464;case"WEEKNUM":return 465;case"AMORDEGRC":return 466;case"AMORLINC":return 467;case"CONVERT":return 468;case"ACCRINT":return 469;case"ACCRINTM":return 470;case"WORKDAY":return 471;case"NETWORKDAYS":return 472;case"GCD":return 473;case"MULTINOMIAL":return 474;case"LCM":return 475;case"FVSCHEDULE":return 476;case"CUBEKPIMEMBER":return 477;case"CUBESET":return 478;case"CUBESETCOUNT":return 479;case"IFERROR":return 480;case"COUNTIFS":return 481;case"SUMIFS":return 482;case"AVERAGEIF":return 483;case"AVERAGEIFS":return 484;case"AGGREGATE":return 485;case"BINOM.DIST":return 486;case"BINOM.INV":return 487;case"CONFIDENCE.NORM":return 488;case"CONFIDENCE.T":return 489;case"CHISQ.TEST":return 490;case"F.TEST":return 491;case"COVARIANCE.P":return 492;case"COVARIANCE.S":return 493;case"EXPON.DIST":return 494;case"GAMMA.DIST":return 495;case"GAMMA.INV":return 496;case"MODE.MULT":return 497;case"MODE.SNGL":return 498;case"NORM.DIST":return 499;case"NORM.INV":return 500;case"PERCENTILE.EXC":return 501;case"PERCENTILE.INC":return 502;case"PERCENTRANK.EXC":return 503;case"PERCENTRANK.INC":return 504;case"POISSON.DIST":return 505;case"QUARTILE.EXC":return 506;case"QUARTILE.INC":return 507;case"RANK.AVG":return 508;case"RANK.EQ":return 509;case"STDEV.S":return 510;case"STDEV.P":return 511;case"T.DIST":return 512;case"T.DIST.2T":return 513;case"T.DIST.RT":return 514;case"T.INV":return 515;case"T.INV.2T":return 516;case"VAR.S":return 517;case"VAR.P":return 518;case"WEIBULL.DIST":return 519;case"NETWORKDAYS.INTL":return 520;case"WORKDAY.INTL":return 521;case"ECMA.CEILING":return 522;case"ISO.CEILING":return 523;case"BETA.DIST":return 525;case"BETA.INV":return 526;case"CHISQ.DIST":return 527;case"CHISQ.DIST.RT":return 528;case"CHISQ.INV":return 529;case"CHISQ.INV.RT":return 530;case"F.DIST":return 531;case"F.DIST.RT":return 532;case"F.INV":return 533;case"F.INV.RT":return 534;case"HYPGEOM.DIST":return 535;case"LOGNORM.DIST":return 536;case"LOGNORM.INV":return 537;case"NEGBINOM.DIST":return 538;case"NORM.S.DIST":return 539;case"NORM.S.INV":return 540;case"T.TEST":return 541;case"Z.TEST":return 542;case"ERF.PRECISE":return 543;case"ERFC.PRECISE":return 544;case"GAMMALN.PRECISE":return 545;case"CEILING.PRECISE":return 546;case"FLOOR.PRECISE":return 547;case"ACOT":return 548;case"ACOTH":return 549;case"COT":return 550;case"COTH":return 551;case"CSC":return 552;case"CSCH":return 553;case"SEC":return 554;case"SECH":return 555;case"IMTAN":return 556;case"IMCOT":return 557;case"IMCSC":return 558;case"IMCSCH":return 559;case"IMSEC":return 560;case"IMSECH":return 561;case"BITAND":return 562;case"BITOR":return 563;case"BITXOR":return 564;case"BITLSHIFT":return 565;case"BITRSHIFT":return 566;case"PERMUTATIONA":return 567;case"COMBINA":return 568;case"XOR":return 569;case"PDURATION":return 570;case"BASE":return 571;case"DECIMAL":return 572;case"DAYS":return 573;case"BINOM.DIST.RANGE":return 574;case"GAMMA":return 575;case"SKEW.P":return 576;case"GAUSS":return 577;case"PHI":return 578;case"RRI":return 579;case"UNICHAR":return 580;case"UNICODE":return 581;case"MUNIT":return 582;case"ARABIC":return 583;case"ISOWEEKNUM":return 584;case"NUMBERVALUE":return 585;case"SHEET":return 586;case"SHEETS":return 587;case"FORMULATEXT":return 588;case"ISFORMULA":return 589;case"IFNA":return 590;case"CEILING.MATH":return 591;case"FLOOR.MATH":return 592;case"IMSINH":return 593;case"IMCOSH":return 594;case"FILTERXML":return 595;case"WEBSERVICE":return 596;case"ENCODEURL":return 597;case"FORECAST.ETS":return 598;case"FORECAST.ETS.CONFINT":return 599;case"FORECAST.ETS.SEASONALITY":return 600;case"FORECAST.LINEAR":return 601;case"FORECAST.ETS.STAT":return 602;case"MAXIFS":return 603;case"MINIFS":return 604;case"TEXTJOIN":return 605;case"CONCAT":return 606;case"IFS":return 607;case"SWITCH":return 608}return null};_Ewa.jd.d=function(n){return isNullOrUndefined(n)?!1:n>="0"&&n<="9"};_Ewa.jd.a=function(n){return parseInt(n.toString())};_Ewa.jd.c=function(n){return isNullOrUndefined(n)?!1:_Ewa.e.n(n.toString().charCodeAt(0))};_Ewa.jd.stringCompareCI=function(n,t){return _Ewa.e.e(n,t,!0)};_Ewa.jd.prototype={c:null,d:null,b:null,a:null,n:function(n){return this.b?this.b.toNumber(n):Number.parse(n,Sys.CultureInfo.CurrentCulture)},e:function(n){return n.toString().replace(".",this.a.decimalSeparator)},l:function(n){var i,r,t;return!n||!n.length?null:(i=this.d.b().a(_Ewa.cg,268,!1),!i)?(Diag.a.b(34445251,0,!1,"CalcHelper.GetWorksheetFuncId() - failed to get the instantaneousSupportInformationManager"),null):(r=i.x(n.toLocaleUpperCase()),r)?Number.parse(r.toString(),Sys.CultureInfo.InvariantCulture):(t=_Ewa.jd.b(n),!t)?(Diag.a.a(34445252,0,50,"CalcHelper.GetWorksheetFuncId() - function index by name was not found. This can happen for user defined functions"),null):(Diag.a.a(36706337,0,50,"CalcHelper.GetWorksheetFuncId() - function name was not found by dynamic list but found by static list. id={0}.",t.toString()),t)},m:function(n){var i=this.d.b().a(_Ewa.cg,268,!1),t;return i?(t=i.y(n),!t||!t.length)?(Diag.a.a(34445254,0,15,"CalcHelper.GetWorksheetFuncId() - function name was not found by id {0}",n),null):t:(Diag.a.b(34445253,0,!1,"CalcHelper.GetWorksheetFuncName() - failed to get the instantaneousSupportInformationManager"),null)},k:function(n){return n<0||n>this.c.length-1?new String:this.c[n]}};_Ewa.CalcManager=function(n){this.S=Function.createDelegate(this,this.j);this.D=Function.createDelegate(this,this.V);this.E=Function.createDelegate(this,this.bt);this.N=Function.createDelegate(this,this.br);this.M=Function.createDelegate(this,this.bq);this.O=Function.createDelegate(this,this.bs);Diag.a.a(34936847,0,50,"Creating CalcManager");this.F=!1;this.x=!0;this.q=n;this.m=_Ewa.b.a(n);this.n=null;this.o=null;this.t=null;this.r={};this.y=new($$sc.r.$$(Array));this.u=null;this.B=0;this.p=0;this.m.t(this.O);this.m.b().b(this.M);_Ewa.r.c(this.q)&&this.m.b().w(this.N);var t=this;this.q.b().c(_Ewa.cg,268,function(n){n.e(t.E)})};_Ewa.CalcManager.g=function(n,t){return t.length>n.span.end&&t.charAt(n.span.end)==="#"};_Ewa.CalcManager.e=function(n){var t,u;Diag.a.a(37835456,0,50,"CalcManager.ConvertToRangeArray() - dependent cells = {0}",n?n.length:0);t=[];for(var r=n,f=r.length,i=0;i<f;++i)u=r[i],Array.add(t,_Ewa.CalcManager.b(u));return t};_Ewa.CalcManager.b=function(n){return _Ewa.o.a(n.range.row+1,n.range.col+1,!1)};_Ewa.CalcManager.prototype={n:null,s:null,u:null,m:null,q:null,B:0,L:!1,o:null,t:null,r:null,y:null,K:null,p:0,A:0,z:null,G:null,C:!1,w:!0,P:!1,F:!1,i:function(){return this.F},x:!1,dispose:function(){Diag.a.a(34445255,0,50,"CalcManager.Dispose called");System.a.a(this.z);this.z=null;System.a.a(this.G);this.G=null;var n=this;this.q.b().c(_Ewa.cg,268,function(t){t.h(n.E);t.g(n.D)});this.m&&(this.m.w(this.O),this.m.b()&&(this.m.b().a(this.M),_Ewa.r.c(this.q)&&this.m.b().J(this.N)),this.m=null);this.n=null;this.C=!0},l:function(n,t){if(!n){Diag.a.b(25215075,0,!1,"CalcManager.NotifyCellUpdate: invalid arguments");return}var i=n.b();if(!i){Diag.a.b(25215104,0,!1,"CalcManager.NotifyCellUpdate: formatted cell must be single cell");return}if(!this.Z()){Diag.a.a(34445256,0,15,"CalcManager.NotifyCellUpdate() - calc not initialized, skipping");return}this.bc(i,t,this.o,null,this.t,!0,"Formula calculation",this.J(n.a().c()))},b:function(n,t,i){this.s?this.s.P(n,t,i):Diag.a.a(595072533,0,100,"CalcManager.CalculateFormulaWebWorker() - calc engine not initialized, skipping")},d:function(n,t){var r,e,u,f,i;return!n||!t?(Diag.a.b(25215105,0,!1,"CalcManager.Calc: invalid arguments"),$$sc.a.a(_Ewa.dX,new _Ewa.CalcManager.a(8))):(r=n.b(),!r)?(Diag.a.b(25215106,0,!1,"CalcManager.Calc: formatted cell must be single cell"),$$sc.a.a(_Ewa.dX,new _Ewa.CalcManager.a(8))):this.n?this.p>=this.A?(Diag.a.a(34997774,0,50,"CalcManager.Calc() - calc skipped due to task queue size = {0}",this.p),$$sc.a.a(_Ewa.dX,new _Ewa.CalcManager.a(2))):(e=new $$sc.j,u=this.g(r),Diag.a.a(34445264,0,50,"CalcManager.Calc() - triggering calc for cell {0} {1}",u.range.row,u.range.col),f=this.Y([u],e),this.p++,i=this,_Ewa.f.tg(_Ewa.dX,f,function(){var t,n,u,e;return Diag.a.b(38045060,0,i.p>0,"CalcManager.Calc queue size is less than or equal 0 ({0})",i.p),i.p--,Diag.a.a(34445258,0,50,"CalcManager.Calc() - processing result. calcTasksQueueSize = {0}",i.p),t=f.a()[0],n=null,excelOnlineCalc.util.isSuccess(t)?(e=new _Ewa.CalcManager.a(0),i.bb(e,r),n=e):(u=_Ewa.hN.a(t),Diag.a.a(34445259,0,50,"CalcManager.Calc() - calc failed, result = {0}",u),n=new _Ewa.CalcManager.a(u)),i.x||i.X(),$$sc.a.a(_Ewa.dX,n)},this.u.d.a,3,$$sc.c.a)):(Diag.a.a(34445257,0,15,"CalcManager.Calc() - calc not initialized, skipping"),$$sc.a.a(_Ewa.dX,new _Ewa.CalcManager.a(9)))},e:function(n){var r,i;if(!this.n)return Diag.a.a(34445260,0,15,"CalcManager.CalcDependent() - calc not initialized, skipping"),$$sc.a.a(_Ewa.dX,new _Ewa.CalcManager.a(9));if(!n||!n.y())return $$sc.a.a(_Ewa.dX,null);if(r=this.g(n),!this.t.haveDependents(r))return Diag.a.a(34445261,0,50,"CalcManager.CalcDependent() - cell has no dependencies, skipping"),$$sc.a.a(_Ewa.dX,new _Ewa.CalcManager.a(11));if(this.p>=this.A)return Diag.a.a(34997775,0,50,"CalcManager.CalcDependent() - calc skipped due to task queue qouta = {0}",this.p),$$sc.a.a(_Ewa.dX,new _Ewa.CalcManager.a(2));if(Diag.a.a(34445262,0,50,"CalcManager.CalcDependent() - triggering. calcTasksQueueSize = {0}",this.p),i=this.t.rootDependents(r),this.p+i.length>=this.A)return Diag.a.a(34997776,0,50,"CalcManager.CalcDependent() - calc skipped due to task queue qouta = {0}, dependets number {1}",this.p,i.length),$$sc.a.a(_Ewa.dX,new _Ewa.CalcManager.a(2));this.p+=1;var f=new $$sc.j,u=this.Y(i,f),t=this;return _Ewa.f.tg(_Ewa.dX,u,function(){var f,r,o,i,c,a;Diag.a.b(38045061,0,t.p>0,"CalcManager.CalcDependent queue size is less than or equal 0 ({0})",t.p);t.p-=1;Diag.a.a(34445263,0,50,"CalcManager.CalcDependent() - processing results Tasks queue size: {0}",t.p);f=u.a();r=[];for(var h=f,v=h.length,e=0;e<v;++e)o=h[e],excelOnlineCalc.util.isSuccess(o)||Array.add(r,_Ewa.hN.a(o));if(r.length===f.length)i=new _Ewa.CalcManager.a(3),i.j(r);else{i=new _Ewa.CalcManager.a(0);c=t.bd(n);for(var l=c,y=l.length,s=0;s<y;++s)a=l[s],t.bb(i,a)}return $$sc.a.a(_Ewa.dX,i)},this.u.d.a,3,$$sc.c.a)},h:function(n){var r,t,i;if(!this.K)return this.L||Diag.a.a(37826832,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),null;if(r=this.g(_Ewa.o.a(1,1,!1)),t=this.K.parseFormula(2,r,1,n),!excelOnlineCalc.parse.parseResultHelper.isSuccess(t))return Diag.a.a(37826833,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{return i=excelOnlineCalc.parse.parseResultHelper.extractReferences(t),this.m.c().a(128)&&this.bw(i,n),i}catch(u){return Diag.a.a(39396449,0,10,"CalcManager.ExtractReferenceWrappers - exception: {0}",u.message),null}},c:function(n,t,i){var r;if(!t)return Diag.a.a(38576192,0,10,"CalcManager.ExtractReferences - sheetName is null"),null;if(!i)return Diag.a.a(38576193,0,10,"CalcManager.ExtractReferences - documentName is null"),null;if(r=this.h(n),!r)return Diag.a.a(39396450,0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),null;try{return this.bk(r,t,i,n)}catch(u){return Diag.a.a(37826834,0,10,"CalcManager.ExtractReferences - exception: {0}",u.message),null}},k:function(n,t,i,r){if(!n)return Diag.a.a(42473290,0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - range is null"),null;if(!t||t.length<=0)return Diag.a.a(42473291,0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - formula is null/empty"),null;var u=this.R(new $$sc.j);return u.r(this.g(n),t,i,r)},f:function(n,t,i,r){if(!n)return Diag.a.a(41756244,0,10,"CalcManager.CalcPartialResultsForFormula - range is null"),null;var u=this.R(new $$sc.j);return u.q(this.g(n),t,i,r)},g:function(n){if(!n)return null;return this.n.w(this.n.q(),n.a-1,n.b-1)},j:function(n){var t=null,i,r,u,f=(u=this.Q(n,r={val:i}),i=r.val,u);return f&&(t=this.J(f.c())),t},bu:function(n,t){var i=this.Q(n,t),r;return!i&&!t.val?!1:t.val||i.o()&&(i.b().e().a!==n.range.row+1||i.b().e().b!==n.range.col+1)?(this.o.updateEvalResult(n,excelOnlineCalc.util.success(excelOnlineCalc.value.blankOper)),!0):(r=i.s(),r&&r.length||(r=i.u()),!r||!r.length)?(this.o.updateEvalResult(n,excelOnlineCalc.util.success(excelOnlineCalc.value.blankOper)),!0):(this.o.updateCellValue(n,r,null,null,this.J(i.c())),!0)},J:function(n){return n===-1?0:n},bk:function(n,t,i,r){var o={},s,e,f,c,h,u,l;for(o.Items=new Array(0),s=0;s<n.length;s++)(e=n[s],this.bl(e,t,i))&&(f=new _Ewa.CalcManager.c,c=this.bm(e,t,f,r),c&&(h={},h.Start=e.span.start,h.End=e.span.end,u={},u.Span=h,u.Range=c,u.IsRangeRef=f.e,u.IsAbsoluteFirstRow=f.b,u.IsAbsoluteFirstColumn=f.a,u.IsAbsoluteSecondRow=f.d,u.IsAbsoluteSecondColumn=f.c,Array.add(o.Items,u)));return l=this,o.Items.sort(function(n,t){return n.Span.Start-t.Span.Start}),o},bm:function(n,t,i,r){var f,u,e;return n.kind==="range"?(i.e=!0,this.bj(n,t,i,r)):n.kind==="namedRange"?(f=n.ref,u=this.q.n().b(f.name),u||(u=this.q.n().b(t+"!"+f.name)),!u||!u.e()||!u.b)?null:_Ewa.e.b(u.e(),t,!0)?(e=u.c===2?_Ewa.bW.a(u,!1):u.b,_Ewa.g.j(e,u)):null:null},bj:function(n,t,i,r){var u=n.ref,k,c;if(u.type){if(u.type==="col"){var p=u,w=p.startIndex,b=p.endIndex;return i.a=w.kind==="Abs",i.c=b.kind==="Abs",this.I(0,w.index,1048576,b.index,t)}if(u.type==="row"){var f=u,d=f.startIndex,g=f.endIndex;return i.b=d.kind==="Abs",i.d=g.kind==="Abs",this.I(f.startIndex.index,0,f.endIndex.index,16384,t)}if(u.type==="cell"){var h=u,e=h.row,o=h.col;return(i.b=i.d=e.kind==="Abs",i.a=i.c=o.kind==="Abs",this.a(h.span.end,r)&&(k=_Ewa.o.a(e.index+1,o.index+1,!1),c=this.m.g().s(k),c))?_Ewa.g.w(c,t):this.I(e.index,o.index,e.index,o.index,t)}if(u.type==="range"){var s=u,l=s.top,a=s.left,v=s.bottom,y=s.right,nt=Math.min(l.index,v.index),tt=Math.min(a.index,y.index),it=Math.max(l.index,v.index),rt=Math.max(a.index,y.index);return i.b=l.kind==="Abs",i.d=v.kind==="Abs",i.a=a.kind==="Abs",i.c=y.kind==="Abs",this.I(nt,tt,it,rt,t)}return Diag.a.a(37826835,0,10,"CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '{0}'",u.type),null}return Diag.a.a(38082381,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null"),null},a:function(n,t){return t.length>=n&&n>0&&t.charAt(n-1)==="#"},bw:function(n,t){var i,u;if(n)for(var f=n,e=f.length,r=0;r<e;++r)(i=f[r],i.ref.type&&i.ref.type==="cell")&&(u=i.ref,_Ewa.CalcManager.g(u,t)&&(u.span.end+=1,i.span.end+=1))},I:function(n,t,i,r,u){var f={};return f.FirstRow=n,f.FirstColumn=t,f.LastRow=i,f.LastColumn=r,f.SheetName=u,f},bl:function(n,t,i){var r=n.ref.qualifier,f,e,l,a,h;if(!r)return!0;switch(n.ref.qualifier.type){case"Sheet":return f=r,e=f.document,_Ewa.e.b(f.sheet,t,!0)&&(!e||_Ewa.e.b(e.document,i,!0));case"SheetRange":var c=r,u=this.q.e().b(t),o=this.q.e().b(c.sheet1),s=this.q.e().b(c.sheet2);return!!u&&!!o&&!!s&&(o.f<=u.f&&u.f<=s.f||s.f<=u.f&&u.f<=o.f);case"Document":return l=r,_Ewa.e.b(l.document,i,!0);case"Ident":return a=r,h=a.name,_Ewa.e.b(h,t,!0)||_Ewa.e.b(h,i,!0);default:return Diag.a.a(38113474,0,10,"CalcManager.GetQualifierData: Unsupported formula qualifier type '{0}'",r.type),!1}},Z:function(){if(this.n)return!0;if(Diag.a.a(34936848,0,50,"CalcManager.TryInitialize: trying to initialize calc"),!this.m||!this.m.c())return Diag.a.a(51505118,0,15,"CalcManager.TryInitialize: this.gridView == null:{0}, this.gridView.EwaControl == null:{1}",!this.m,this.m?!this.m.c():!0),!1;var n=this.m.c().b().a(_Ewa.cg,268,!1);return n?this.ba(n):(Diag.a.a(34936849,0,15,"CalcManager.TryInitialize: IInstantaneousSupportInformationManager service not available, cannot initialize calc"),!1)},bo:function(){var n=!0;try{n=excelOnlineCalc!==undefined}catch(t){return!1}try{n=excelOnlineCalc.location!==undefined}catch(i){return!1}return!0},ba:function(n){if(!n.d().length||!n.c().length)return Diag.a.a(34936850,0,15,"CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = {0}, functions info count = {1}",n.d().length,n.c().length.toString()),!1;if(!this.bo())return Diag.a.b(40939861,0,this.L,"CalcManager.TryInitializeInternal: ExcelOnlineCalc is not loaded, any usage of it causes JS crash. Aborting calc initialization."),this.L=!0,!1;if(this.n=new _Ewa.hN(this.m.c(),this.S),this.X(),this.K=this.n.v(),this.A=n.m(),this.W(),this.F=!0,Diag.a.a(34936851,0,50,"CalcManager.TryInitializeInternal: calc initialized"),this.q.a(420)||_Ewa.r.c(this.q)){if(this.q.isChangeGateEnabled("OfficeVSO:3245476_SkipUnsupportedBrowsersAndIE")&&!this.P){try{this.w=typeof Worker!="undefined"}catch(t){this.w=!1}this.P=!0;(Common.c.n()||!this.w)&&(Diag.a.a(41497041,0,15,"CalcManager.TryInitializeInternal: browser type does not support web-worker or isIE (isIE = {0})",Common.c.n()),this.w=!1)}!this.s&&this.w&&(Diag.a.a(40768414,0,50,"CalcManager creating calc engine"),this.s=new _Ewa.hM(this.q))}return!0},bt:function(n){Diag.a.a(34936852,0,50,"CalcManager.OnLocaleInformationAvailable() called");var t=n;if(t.h(this.E),!t.c().length){Diag.a.a(34936853,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information");t.j(this.D);return}this.V(n,Sys.EventArgs.Empty)},V:function(n){Diag.a.a(34936854,0,50,"CalcManager.OnFunctionsInfoReady called");var t=n;t.g(this.D);this.ba(t)},Y:function(n,t){Diag.a.a(37007694,0,50,"CalcManager.TriggerCellsEvaluator() - triggering calc for {0} cells",n.length);var i=this.R(t);return $$sc.h.a(Array,i.k(n))},R:function(n){var t=this.u,i;return t||(Diag.a.a(34936855,0,50,"CalcManager.LazyInitEvalSession initializing new eval session"),i=this.m.c().b().a(_Ewa.cg,268,!1),t=new _Ewa.rJ(this,n,i?i.s():20),this.u=t),t},bb:function(n,t){var r,u,f,s,e,i,h,c,o;for(Diag.a.a(37835426,0,50,"CalcManager.UpdateCalcResult() for range Top:{0} Bottom:{1} Left:{2} Right{3}",t.a,t.d,t.b,t.c),r=0,u=t.a;u<=t.d;u++)for(f=t.b;f<=t.c;f++){if(s=this.g(t),e=this.o.getEvalResult(s),isNullOrUndefined(e)){Diag.a.a(34415001,0,50,"CalcManager.UpdateCalcResult() - return value is undefined");n.f=1;n.i(t);continue}o=(c=this.n.r(e,!1,0,h={val:i}),i=h.val,c);i===8?(Diag.a.a(34415002,0,50,"CalcManager.UpdateCalcResult() - return value is an error: {0}",o),n.f=1,n.i(t)):(r++,n.k(t,o,i))}Diag.a.a(37835427,0,50,"CalcManager.UpdateCalcResult() - Added values for {0} cells",r)},bd:function(n){var t=this.g(n),i=this.t.allDependents(t);return _Ewa.CalcManager.e(i)},be:function(n){var i,r,u;if(n.length!==Common.S.d(this.r))return!0;for(var f=n,e=f.length,t=0;t<e;++t)if(i=f[t],r=this.m.b().z(i),r in this.r){if(u=this.r[r],!u||u.f!==i.G)return!0}else return!0;return!1},X:function(){this.t=this.n.f();this.o=this.n.i()},W:function(){var r,u,n,t,i,f;if(_Ewa.r.v(this.q)&&!_Ewa.r.c(this.q)&&this.x){if(this.C){Diag.a.a(41009859,0,50,"CalcManager.RefreshDependencyGraph: CalcManager is already disposed.");return}if(this.m&&this.m.bc()&&!_Ewa.bk.a(this.q)){if(!this.Z()){Diag.a.a(34445265,0,15,"CalcManager.RefreshDependencyGraph() - calc not initialized, skipping");return}if(this.q.isChangeGateEnabled("OfficeVSO:3068668_DependencyGraphNotBuilt")&&!this.be(this.m.b().o())){Diag.a.a(40130700,0,50,"CalcManager.RefreshDependencyGraph() - all sections are consistent with block cache, skipping");return}r=this.m.c().o().a("UserAction","CreateDependencyTreesCalc");u=this.m.c().o().a("UserAction","BuildAllSectionsStopwatch");this.B+=1;n=this.B;Diag.a.a(24699408,0,50,"CalcManager.RefreshDependencyGraph() - triggering cache processing, iteration = {0}",n);t=[];i=_Ewa.dH.a(Boolean,_Ewa.y.a(),this.m.c().i(),"Task",null);this.H(n,this.m.b().o(),0,t,i);f=this;i.a.CW(function(){u.a();Diag.a.a(37586189,0,50,"CalcManager.RefreshDependencyGraph() - Number of sections found = {0}",t.length);i.a.a()&&f.bg(t,n,r)})}}},bp:function(n,t){var e=this.t.stats(),o=Common.bm.a().toString(),u={},i,r;u.a=this.o.size();u.b=e.nodes;u.c=e.arcs;u.d=$$sc.g.a(this.r).length;u.e=t;u.f=o;u.g=this.v(t,"LogDependencyGraphStat");_Ewa.y.a().a(10,u,!0);for(var s=n,h=s.length,f=0;f<h;++f)(i=s[f],i)&&(r={},r.n=o,r.a=t,r.b=i.b,r.o=i.e,i.a&&!isNullOrUndefined(i.a.a)&&(r.c=JSON.stringify(i.a.a.functionsCount),r.d=JSON.stringify(i.a.a.operatorsCount),r.e=i.a.a.crossDocRefs,r.f=i.a.a.crossSheetRefs,r.g=i.a.a.errRefs,r.h=i.a.a.largeRanges,r.i=i.a.a.nameRefs,r.j=i.a.a.parserErrors+i.c,r.k=i.a.a.rowRefs,r.l=i.a.a.columnRefs,r.m=i.a.a.tableRefs),_Ewa.y.a().a(11,r,!0))},bs:function(){var i,n,t,r;_Ewa.r.c(this.q)?this.s?this.m.c().isChangeGateEnabled("OfficeVSO:3947862_UpdateModelInTask")?(i=this,$$sc.a.b(0).CWCT(function(){i.s.r(1)},null,0,$$sc.c.a)):this.s.r(1):Diag.a.a(595072532,0,100,"CalcManager.OnContentReady() - calc engine not initialized, skipping"):(this.T(),System.a.a(this.z),n=500,t=this.m.c().b().a(_Ewa.cg,268,!1),t&&(n=t.t()),r=this,this.z=_Ewa.x.a().a(function(){r.W()},n,_Ewa.m.x,!0,!1))},bq:function(n,t){t.c||this.T()},br:function(n,t){this.s?this.s.D(t.a.a):Diag.a.a(595072531,0,100,"CalcManager.OnBlockPresent() - calc engine not initialized, skipping")},T:function(){this.u&&(Diag.a.a(34936856,0,50,"CalcManager.Abort: aborting current eval session"),this.u.j(),this.u=null,this.p=0)},bg:function(n,t,i){var c,rt,o,ut,r,w,et,k,f,d;if(this.C){Diag.a.a(41009860,0,50,"CalcManager.AssembleDependencyGraph: CalcManager is already disposed.");return}if(!n||!n.length){Diag.a.a(24699410,0,50,"CalcManager.AssembleDependencyGraph: Graph sections building returned no sections, skipping dependency graph update.");return}if(!this.v(t,"AssembleDependencyGraphAsync - precheck")){Diag.a.a(37003416,0,50,"CalcManager.AssembleDependencyGraphAsync - starting to assemble graph for iterationID {0}",t);var s=null,e={},g=n[0].g,ct=this.m.c().o().a("UserAction","MergeDependencyGraphCalc"),nt,tt;if(tt=this.y.e(g,nt={val:s}),s=nt.val,tt)for(var it=s,lt=it.length,h=0;h<lt;++h)c=it[h],e[c]=c;var l=[],a=[],v={},at=this.m.c().o().a("UserAction","CreateFormulaCacheStopwatch"),y=this.n.i();at.a();rt=this.m.c().o().a("UserAction","CreateRecalcMapperStopwatch");o=this.n.f();rt.a();ut=this.m.c().o().a("UserAction","MergeDependencyGraphCalcResponseBlocksStopwatch");for(var ft=n,vt=ft.length,p=0;p<vt;++p)(r=ft[p],r)&&(Array.add(a,r.b),r.b in e&&delete e[r.b],v[r.b]=r,w=new($$sc.C.$$(Boolean)),w.b(this.U(r,y,o,t)),Array.add(l,w.a));ut.a();et=this.m.c().o().a("UserAction","MergeDependencyGraphCalcOtherBlocksStopwatch");for(var ot=Object.keys(e),yt=ot.length,b=0;b<yt;++b)(k=ot[b],k in this.r)&&(f=this.r[k],v[f.b]=f,Array.add(a,f.b),d=new($$sc.C.$$(Boolean)),d.b(this.U(f,y,o,t)),Array.add(l,d.a));et.a();var pt=this.m.c().o().a("UserAction","FinalStepsDependencyGraphCalcStopwatch"),wt=this.m.c().o().a("UserAction","FinalStepsDependencyGraphCalcFirstPartStopwatch"),st=this.m.c().o().b("UserAction","FinalStepsDependencyGraphCalcSecondPartStopwatch"),ht=new $$sc.j,u=this,bt=this;_Ewa.f.tc(_Ewa.f.tc($$sc.a.WAA.apply(null,l),function(){return(wt.a(),st.d(),u.v(t,"AssembleDependencyGraphAsync - finished merge"))?$$sc.a.a(Boolean,!1):(u.o=y,u.t=o,u.r=v,u.y=new($$sc.r.$$(Array)),u.y.c(g,a),$$sc.a.a(Boolean,!0))},ht.a),function(){return bt.bp(n,t),st.a(),pt.a(),ct.a(),i.a(),$$sc.a.a(Boolean,!0)},ht.a);Diag.a.a(37003417,0,50,"CalcManager.AssembleDependencyGraphAsync - finished to assemble graph for iterationID {0}",t)}},U:function(n,t,i,r){var u,f;return this.v(r,"MergeAnalyzedBlock after building dep graphs")?!1:(u=this.m.c().o().a("UserAction","MergeDependencyTreesFormulaCalc"),t.merge(n.h,!1),u.a(),f=this.m.c().o().a("UserAction","MergeDependencyTreesRecalcMapperCalc"),i.merge(n.d),f.a(),!0)},H:function(n,t,i,r,u){var f,e;if(this.v(n,"BuildDependencyGraphSectionAsync")){u.b(!1);return}if(i>=t.length){u.b(!0);return}if(f=$$as(_Ewa.de,t[i]),f.w<=0||!this.m.b().u().a(f.F)){this.H(n,t,i+1,r,u);return}if(!f){this.H(n,t,i+1,r,u);return}e=this;this.G=_Ewa.x.a().a(function(){var o=e.bi(f,n);(o&&Array.add(r,o),e.x)&&e.H(n,t,i+1,r,u)},0,_Ewa.m.w,!0,!0)},bi:function(n,t){var r,u,s,i,f,e,c;if(this.C)return Diag.a.a(41009861,0,50,"CalcManager.BuildDependencyGraphSectionInternal: CalcManager is already disposed."),null;if(!this.m||this.v(t,"BuildDependencyGraphSection"))return null;if(r=this.m.b().z(n),Diag.a.a(37003418,0,50,"CalcManager.BuildDependencyGraphSectionInternal - starting to build dependency graph for block hash {0} iterationId {1}",r,t),r in this.r){if(u=this.r[r],!u)return Diag.a.a(34914820,0,50,"CalcManager.BuildDependencyGraphSectionInternal - section is null"),null;if(u.f===n.G)return u.g=n.u.Information.Revision,Diag.a.a(37003419,0,50,"CalcManager.BuildDependencyGraphSectionInternal - finished to build dependency graph for block hash {0} iterationId {1} - no change in block",r,t),u}if(s=this.m.c().e().b(n.x.e()),!s)return Diag.a.a(37586190,0,50,"CalcManager.BuildDependencyGraphSectionInternal - sheet name is null for block hash {0} iterationId {1}",r,t),null;if(f=(i=new _Ewa.CalcManager.f,i.f=n.G,i.b=r,i.g=n.u.Information.Revision,i.d=this.n.f(),i.h=this.n.i(),i.e=0,i.c=0,i.a=new _Ewa.CalcManager.d,i),e=n.u,!e)return Diag.a.a(34914821,0,50,"CalcManager.BuildDependencyGraphSectionInternal - response is null"),null;if(isNullOrUndefined(e.Content))return Diag.a.a(34914822,0,50,"CalcManager.BuildDependencyGraphSectionInternal - response.Content is null"),null;var l=this.m.c().o().a("UserAction","CreateGraphSectionCalc"),o=100,h=this.m.c().b().a(_Ewa.cg,268,!1);return(h&&(o=h.u()),c=this.bh(n,r,o,t,f),o===-1)?null:(Diag.a.a(37003420,0,50,"CalcManager.BuildDependencyGraphSectionInternal - finished to build dependency graph for block hash {0} iterationId {1} number of formulas {2}",r,t,c),l.a(),f)},bv:function(n,t,i){var f=_Ewa.o.a(n.row,n.col,!1),u=this.n.f(),e=n.ifmt,r=this.bc(f,n.formula,i.h,this.o,u,!1,"Tree building",this.J(e));return r?this.v(t,"BuildDependencyGraphSection - analyzing block")?!1:this.bf(r.dependents,i)?(i.d.merge(u),i.a.b(r),!0):(i.e=i.e+1,!0):(i.c=i.c+1,!0)},bh:function(n,t,i,r,u){var h=!0,s=0,c=n.f(),o,e;if(c){o=c.getCalcBlockModel();o.reset();for(var f=null,l=o.getRowNumbers(),a=o.getColumnNumbers();(f=o.getNextCell())&&h;)if(_Ewa.bG.b(f.formula)){if(i&&s>i){Diag.a.a(51233567,0,50,"CalcManager.BuildDependencyGraphSectionFromModel - Reached the maximum number of supported formulas to parse - {0}",s);h=!1;break}if(s++,e=new _Ewa.Bm,e.formula=f.formula,e.ifmt=f.ifmt,e.row=l[f.row],e.col=a[f.col],!this.bv(e,r,u))return-1}}return s},bc:function(n,t,i,r,u,f,e,o){var s=this.g(n),c=null,h;return(f&&(c=u.allDependents(s)),i.updateCellValue(s,t,r,c,o),!_Ewa.bG.b(t))?null:(h=i.getFormula(s,!1,e),isNullOrUndefined(h))?(Diag.a.a(34388130,0,50,"CalcManager.UpdateCell() - Formula parsing failed, formula = {0}",t?_Ewa.e.h(t):"empty formula"),null):u.add(this.n.m,s,h)},v:function(n,t){var i=n!==this.B;return i&&Diag.a.a(34936857,0,50,"CalcManager.ShouldAbortDependencyGraphRefresh: should abort dependency graph iteration {0} == true ({1})",n,t),i},bf:function(n,t){for(var i,r,e,o,s,f=n,h=f.length,u=0;u<h;++u)if((i=f[u],!t||!this.t.haveDependents(i)&&!t.d.haveDependents(i))&&(r=!1,s=(o=this.Q(i,e={val:r}),r=e.val,o),!s&&!r))return!1;return!0},Q:function(n,t){var r,u,i;return(t.val=!1,!n)?null:(r=this.bn(n.sheet.index),!r)?(Diag.a.a(37789893,0,50,"CalcManager.GetCellFromBlockCache: No sheet index {0}",n.sheet.index),null):(u=_Ewa.CalcManager.b(n),i=this.m.bJ(r,u.a,u.b),!i)?(Diag.a.a(37789894,0,50,"CalcManager.GetCellFromBlockCache: cellProxy is null for cell {0} {1}",n.range.row,n.range.col),null):i.bl()?i:(Diag.a.a(37789895,0,50,"CalcManager.GetCellFromBlockCache: cell {0} {1} is empty",n.range.row,n.range.col),t.val=!0,null)},bn:function(n){var t=this.m.c().e().g(n);return t?t.e():(Diag.a.a(37789896,0,50,"CalcManager.GetSheetName - no sheet in index {0}",n),null)}};_Ewa.CalcManager.c=function(){};_Ewa.CalcManager.c.prototype={e:!1,b:!1,a:!1,d:!1,c:!1};_Ewa.CalcManager.d=function(){};_Ewa.CalcManager.d.prototype={a:null,b:function(n){this.a?this.a.merge(n):this.a=n}};_Ewa.CalcManager.f=function(){};_Ewa.CalcManager.f.prototype={f:null,b:null,g:0,d:null,h:null,e:0,c:0,a:null};_Ewa.CalcManager.a=function(n){this.f=n;this.h={};this.g=new Array(0);this.e={}};_Ewa.CalcManager.a.prototype={f:0,b:function(){return this.f},h:null,c:function(){return this.h},g:null,d:function(){return this.g},e:null,a:function(){return this.e},k:function(n,t,i){var r,u=(r=new _Ewa.CalcManager.a.a,r.f=n,r.d=t,r.e=i,r);this.h[n.toString()]=u},i:function(n){Array.add(this.g,n)},j:function(n){for(var t,r,u=n,f=u.length,i=0;i<f;++i)t=u[i],r=0,_Ewa.cz.toString(t)in this.e&&(r=this.e[_Ewa.cz.toString(t)]),this.e[_Ewa.cz.toString(t)]=r+1}};_Ewa.CalcManager.a.a=function(){};_Ewa.CalcManager.a.a.prototype={f:null,c:function(){return this.f},d:null,a:function(){return this.d},e:0,b:function(){return this.e}};_Ewa.rJ=function(n,t,i){var r;this.a=n;this.b=this.a.n.e;this.h=excelOnlineCalc.runtime.fastMathpack;r={};this.d=t;r.yieldIntervalMs=i;var u=this,f=this,e=this,o=this,s=this,h=this,c=this,l=this,a=this,v=this,p=this,w=this,y=this;this.e=excelOnlineCalc.runtime.evalGlobals(this.b,this.h,function(n,t){return u.a.n.A(n,t)},function(n,t){return f.a.n.C(n,t)},function(n){return e.m(n)},function(n){return o.n(n)},function(n){return s.o(n)},function(n){return h.p(n)},function(n){return c.l(n)},function(n,t){l.i(n,t)},function(n,t){a.u(n,t)},function(n,t){v.t(n,t)},function(){},function(n){return _Ewa.rJ.a(n)},r,function(n){return y.s(n)});this.f=excelOnlineCalc.runtime.createEvaluator(this.e);this.a.m.c().a(547)&&(this.c=excelOnlineCalc.runtime.createFormulaInspector(this.e))};_Ewa.rJ.a=function(){return Promise.resolve(!1)};_Ewa.rJ.prototype={d:null,a:null,b:null,h:null,e:null,f:null,c:null,k:function(n){return this.f.evalCellsAsync(n)},j:function(){this.e.interruptToken[0]=2;this.d&&(this.d.C(),this.d=null)},m:function(n){var t,i,r,u=(r=this.g(n,i={val:t}),t=i.val,r);return t?excelOnlineCalc.util.success(u):excelOnlineCalc.util.failure(u)},r:function(n,t,i,r){if(!this.c||!n||!t||t.length<=0)return null;var u=excelOnline.utils.getCharIndexInTextFromPoint(i,r);return u<0?null:(this.c.setCellAndFormula(n,t),this.c.getSubExpressionSpanFromFormulaCharacterIndex(u))},q:function(n,t,i,r){var u=null;if(!this.c||!n||!t||t.length<=0)return Promise.resolve(u);r&&(t=t.substring(r.start,r.end));t.startsWith("=")||(t="="+t);this.c.setCellAndFormula(n,t);var f=this,e=function(n){var o,s,h,t=(h=f.a.n.r(n,!0,i,s={val:o}),o=s.val,h),e;return o!==8||t.length&&t!==_Ewa.hN.b?e=0:(Diag.a.a(41756250,0,50,"EvalSession.GetPartialResultValueForFormula - EvalResultToString error"),e=_Ewa.hN.a(n)),u=r?new _Ewa.kp(t,r.start,r.end,e):new _Ewa.kp(t,-1,-1,e)},o=this;return this.c.evaluateSubExpression().then(e,function(n){return Diag.a.a(41756251,0,10,"EvalSession.GetPartialResultValueForFormula - exception: {0}",n),Promise.resolve(u)})},g:function(n,t){var f,e,c,i,o,l,a,s,u,h,r;if(t.val=!0,f=this.a.o.getEvalResult(n),!isNullOrUndefined(f))return(e=excelOnlineCalc.runtime.extractResultValue(f),isNullOrUndefined(e))?(Diag.a.a(37789897,0,50,"CalcManager.GetCellResultValue: no value for cell {0} {1}",n.range.row,n.range.col),t.val=!1,excelOnlineCalc.runtime.previousFailure(n)):(Diag.a.a(37789898,0,50,"CalcManager.GetCellResultValue: final value was created for cell {0} {1}",n.range.row,n.range.col),excelOnlineCalc.runtime.finalValue(e));if(c=this.a.o.getCompiledFormula(n,!1),!isNullOrUndefined(c))return Diag.a.a(37789899,0,50,"CalcManager.GetCellResultValue: formula exist but not evaluated. return pending value for cell {0} {1}",n.range.row,n.range.col),excelOnlineCalc.runtime.pendingValue(n);if(i=this.a.o.getValue(n),isNullOrUndefined(i))return(a=this.a.bu(n,l={val:o}),o=l.val,a)?o?(Diag.a.a(37789901,0,50,"CalcManager.GetCellResultValue: cell {0} {1} is blank",n.range.row,n.range.col),excelOnlineCalc.runtime.finalValue(excelOnlineCalc.value.blankOper)):(Diag.a.a(37789900,0,50,"CalcManager.GetCellResultValue: cell {0} {1} was loaded from grid",n.range.row,n.range.col),this.g(n,t)):(Diag.a.a(37789902,0,50,"CalcManager.GetCellResultValue: cell {0} {1} is not in grid",n.range.row,n.range.col),t.val=!1,s=excelOnlineCalc.runtime.previousFailure(n),this.a.o.updateEvalResult(n,excelOnlineCalc.util.failure(s)),s);if(u=this.b.localeInfo.parseNumber(i),!isNaN(u))return this.a.o.updateEvalResult(n,excelOnlineCalc.util.success(u)),excelOnlineCalc.runtime.finalValue(u);if(i===this.b.localeInfo.trueName||i===this.b.localeInfo.falseName)return h=this.b.localeInfo.trueName===i,this.a.o.updateEvalResult(n,excelOnlineCalc.util.success(h)),excelOnlineCalc.runtime.finalValue(h);if(i==="")return this.a.o.updateEvalResult(n,excelOnlineCalc.util.success(excelOnlineCalc.value.blankOper)),excelOnlineCalc.runtime.finalValue(excelOnlineCalc.value.blankOper);if(i.toUpperCase()in _Ewa.dU.a){r=null;switch(i.toUpperCase()){case"#NULL!":r=excelOnlineCalc.value.nullErrorOper;break;case"#DIV/0!":r=excelOnlineCalc.value.div0ErrorOper;break;case"#VALUE!":r=excelOnlineCalc.value.valueErrorOper;break;case"#REF!":r=excelOnlineCalc.value.refErrorOper;break;case"#NAME?":r=excelOnlineCalc.value.nameErrorOper;break;case"#NUM!":r=excelOnlineCalc.value.numErrorOper;break;case"#N/A":r=excelOnlineCalc.value.naErrorOper;break;case"#GETTING_DATA":r=excelOnlineCalc.value.gettingDataErrorOper;break;default:return Diag.a.b(39076613,0,!1,"CalcManager.GetCellResultValue: unknown error oper: "+_Ewa.e.h(i)),t.val=!1,excelOnlineCalc.runtime.previousFailure(n)}return this.a.o.updateEvalResult(n,excelOnlineCalc.util.success(r)),excelOnlineCalc.runtime.finalValue(r)}return this.a.o.updateEvalResult(n,excelOnlineCalc.util.success(i)),excelOnlineCalc.runtime.finalValue(i)},n:function(n){var t,u,i,f,r,o,e,s,h,c;if(n.range.cols*n.range.rows>1e3)return excelOnlineCalc.util.failure(excelOnlineCalc.runtime.previousFailure(n));for(t=!0,u=[],i=n.range.row;i<n.range.row+n.range.rows;i++){for(f=[],r=n.range.col;r<n.range.col+n.range.cols;r++)o=excelOnlineCalc.location.sheetGridCell(n.sheet,excelOnlineCalc.location.gridCell(i,r)),c=(h=this.g(o,s={val:e}),e=s.val,h),t=t&&e,Array.add(f,c);Array.add(u,f)}return t?excelOnlineCalc.util.success(u):excelOnlineCalc.util.failure(excelOnlineCalc.runtime.previousFailure(n))},o:function(n){var t,i,r;if(Object.getType(n)===String){if(i=this.b.localeInfo.getWorksheetFuncId(n),!i)return excelOnlineCalc.util.success(null);t=i}else t=n;return t===63||t===464||t===221||t===74||t===78||t===125||t===148||t===244||t===29||t===76||t===77||t===75?excelOnlineCalc.util.failure(excelOnlineCalc.runtime.unavailable([t])):(r=excelOnlineCalc.runtime.getBasicFirstOrderFunc(t),!r)?excelOnlineCalc.util.failure(excelOnlineCalc.runtime.unavailable([t])):excelOnlineCalc.util.success(r)},p:function(n){var r,u,f,t=(f=this.a.n.s(n,u={val:r}),r=u.val,f),i;if(r){if(Diag.a.a(37857409,0,50,"EvalSession.GetNameFormula: NamedObjectType: "+(t?t.c.toString():"NotFound")+"; Name: "+_Ewa.e.h(n.name)),!t)return excelOnlineCalc.util.success(null);i="";switch(t.c){case 3:t.b&&(i="="+t.e()+"!"+t.b.C(!0))}if(i.length>0)return this.a.o.parseCompileNameFormula(i)}return excelOnlineCalc.util.failure(excelOnlineCalc.runtime.unavailable([""]))},l:function(n){return excelOnlineCalc.util.success(excelOnlineCalc.runtime.cellFormula(n,1,this.a.o.getCompiledFormula(n,!1)))},s:function(n){var u=this.a.m.c(),i=n.index,r;if(i<0||i>=u.e().d())return excelOnlineCalc.util.success(null);if(r=$$as(_Ewa.E,u.e().g(i)),!r||!r.b)return excelOnlineCalc.util.failure(excelOnlineCalc.runtime.unavailable([i]));if(this.a.m.cN()||this.a.m.cM())return excelOnlineCalc.util.success(excelOnlineCalc.location.gridRange(0,0,1048575,16383));var t=r.b,o=t.a,s=t.b,f=Math.abs(t.d-t.a)+1,e=Math.abs(t.c-t.b)+1;return!f||!e?excelOnlineCalc.util.success(null):excelOnlineCalc.util.success(excelOnlineCalc.location.gridRange(o-1,s-1,f,e))},i:function(n,t){this.a.o.updateEvalResult(n,excelOnlineCalc.util.success(t))},u:function(n,t){for(var r,u,f,i=n.range.row;i<n.range.row+n.range.rows;i++)for(r=n.range.col;r<n.range.col+n.range.cols;r++)u=t[i-n.range.row][r-n.range.col],f=excelOnlineCalc.location.sheetGridCell(n.sheet,excelOnlineCalc.location.gridCell(i,r)),this.i(f,u)},t:function(n,t){for(var r,u,i=n.range.row;i<n.range.row+n.range.rows;i++)for(r=n.range.col;r<n.range.col+n.range.cols;r++)u=excelOnlineCalc.location.sheetGridCell(n.sheet,excelOnlineCalc.location.gridCell(i,r)),this.a.o.updateEvalResult(u,excelOnlineCalc.util.failure(t))}};_Ewa.rH=function(n){_Ewa.rH.initializeBase(this);this.h=n;this.j()};_Ewa.rH.a=function(n){n&&n.b()&&n.b().b(_Ewa.baj.$$(_Ewa.dK),265,new _Ewa.rH(n))};_Ewa.rH.prototype={h:null,b:function(){var t,n;if(!this.h){Diag.a.a(38082339,0,50,"CalcManagerFactory.Create: ewaControl is null, cann't create the service");return}Diag.a.a(38082369,0,50,"CalcManagerFactory.Create: Start loading script");t=this.h.a(825)?51:54;n=this;_Ewa.f.cw(_Ewa.s.c(t,4,!1,!1,265,this.m),function(){Diag.a.a(38082370,0,50,"CalcManagerFactory.Create: Raised create service event");var t=n.h.b().a(_Ewa.dK,266,!1);t||(Diag.a.a(39982036,0,50,"CalcManagerFactory.Create: CalcManager is not registered, creating new CalcManager"),t=new _Ewa.CalcManager(n.h));n.i(t)},this.du(),3)}};_Ewa.ColoredReferencesManager=function(n,t){this.j=["rgba(95, 140, 237, {0})","rgba(235, 94, 96, {0})","rgba(141, 97, 194, {0})","rgba(45, 150, 57, {0})","rgba(191, 76, 145, {0})","rgba(227, 130, 34, {0})","rgba(55, 127, 158, {0})"];this.g=n;this.f=_Ewa.b.a(n);this.h=t};_Ewa.ColoredReferencesManager.prototype={f:null,g:null,h:null,m:!1,b:function(n){var t,i,e,v,o,y;if(!this.m)if(t=n.b(),this.h&&t.length>1&&_Ewa.bG.b(t)){if(!_Ewa.e.a(n.a().k()))return;var p=this.o(),w=this.q(),b=this.p(),s=this.h.c(t,w,b);if(!s){Diag.a.a(37859356,0,50,"ColoredReferencesManager.UpdateColoredReferences: extractReferences is null (might be an invalid formula)");return}for(var h=new Array(0),r=new Array(0),k=new Array(0),c=new Array(0),u=0,l=new _Ewa.u(!1),a=s.Items,d=a.length,f=0;f<d;++f)i=a[f],i.Range&&(e=_Ewa.g.b(i.Range),v=this.k(e,l,1),this.i(r,t,u,i.Span.Start,null),this.i(r,t,i.Span.Start,i.Span.End,v),Array.add(h,new _Ewa.cT(e,p)),u=i.Span.End,Array.add(k,i.Span),o=r.length-1,Array.add(c,new _Ewa.ko(o,r[o].text,i)));if(this.i(r,t,u,t.length,null),this.r(n,r),!_Ewa.e.b(n.a().c(),t,!1)){Diag.a.b(38114182,0,!1,"ColoredReferencesManager.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back.");y=n.a().b();n.a().d(t);n.a().f(y);return}this.l(h,l,c)}else this.l(null,null,null)},d:function(n){n.a().d(n.b())},a:function(n,t,i){var r,s,c,h,f,e;if(!n||!t||!i)return Diag.a.b(38926101,0,!!n,"ColoredReferencesManager.MoveMarqueeRange: cellContentEditor is null"),Diag.a.b(38926102,0,!!t,"ColoredReferencesManager.MoveMarqueeRange: highlightState is null"),Diag.a.b(38926103,0,!!i,"ColoredReferencesManager.MoveMarqueeRange: newRange is null"),!1;if(r=$$as(_Ewa.ko,t.i),!r)return Diag.a.b(38621456,0,!1,"ColoredReferencesManager.MoveMarqueeRange: marqueeMetadata is null"),!1;var l=r.g,o=r.c,u=this.f.g().m(i)?i.bl(r.a,r.b):i.T(r.a,r.b,r.d,r.e);if(!u)return Diag.a.b(38926104,0,!1,"ColoredReferencesManager.MoveMarqueeRange: newText is null"),!1;if(s=o.indexOf("!"),s!==-1&&(u=o.substring(0,s+1)+u),c=n.a().bh(l,o,u),!c)return Diag.a.b(38926105,0,!1,"ColoredReferencesManager.MoveMarqueeRange: failed to change the text part"),!1;for(r.c=u,h=!0,f=1;f<=4;f++){if(e=_Ewa.b.a(this.g).k().e(3,f,t.f),!e){Diag.a.b(38926106,0,!1,"ColoredReferencesManager.MoveMarqueeRange: highlightStateInPane is null");h=!1;continue}e.b=i;e.i=r}return this.f.k().f(!1,!1),this.f.l().o()&&this.f.l().a().d(n.b()),this.f.l().D(new _Ewa.jp(!0)),h},c:function(n){if(n.a!==3)return Diag.a.b(38847496,0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: not HighlightDivIndex.Marquee."),!1;var t=$$as(_Ewa.ko,n.i);return t?t.f:(Diag.a.b(38847497,0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: marqueeMetadata is null."),!1)},e:function(n,t){if(Diag.a.a(42767445,0,50,"ColoredReferencesManager.SuspendResumeColoredReferences: "+(t?"suspending":"resuming")+" colored references"),t){this.l(null,null,null);var i=n.a().b(),r=n.a().k().length;n.a().d(n.a().c());n.a().l(i,i+r)}return this.m=t,!1},k:function(n,t,i){var r=t.b[n.toString()]||null,u;return r||(u=t.a.length%this.j.length,r=this.j[u],t.c(n.toString(),r)),String.format(r,i)},i:function(n,t,i,r,u){if(Diag.a.b(37859357,0,i<=r,"ColoredReferencesManager.AddTextPart: startIndex cannot be larger than endIndex"),i<r){var e=t.substring(i,r),f;Array.add(n,(f=new _Ewa.yz,f.text=e,f.color=u,f))}},l:function(n,t,i){var u,r;if(!n||!n.length){u=this.g.o().a("UserAction","HideRangesHighlightsStopwatch");this.f.k().a([3]);this.f.k().j(new _Ewa.cT(null,this.o()),[3],!0);u.a();return}Diag.a.a(41492675,0,50,"ColoredReferencesManager.HighlightRanges: number of ranges to highlight: "+n.length);n.reverse();i.reverse();r=this;this.f.k().d(n,[3],!0,function(n,u){if(!n||!n.b||!u){Diag.a.b(37859358,0,!!n,"ColoredReferencesManager.HighlightRanges: state is null");Diag.a.b(37859359,0,!!n.b,"ColoredReferencesManager.HighlightRanges: state.Range is null");Diag.a.b(37859360,0,!!u,"ColoredReferencesManager.HighlightRanges: div is null");return}Diag.a.b(37859361,0,t.d(n.b.toString()),"ColoredReferencesManager.HighlightRanges: The range '{0}' doesn't exist in the range to color dictionary",n.b.toString());var f=r.k(n.b,t,.1),e=r.k(n.b,t,1),o=!!r.g.v()&&!!r.g.v().bb()&&r.g.v().bb().a();o||(u.style.background=f);u.style.borderColor=e;i&&(u.setAttribute("IndexInMarqueeCollection",n.f),n.i=i[n.f])},!0)},r:function(n,t){var i=n.a().b();n.a().bm(t);n.a().f(i)},o:function(){return this.n().j},q:function(){return this.n().a},p:function(){return this.g.l().WorkbookFileName},n:function(){return this.f.E()&&this.f.E().c()?this.f.E().c():this.g.j()}};_Ewa.rI=function(n){_Ewa.rI.initializeBase(this);this.h=n;this.j()};_Ewa.rI.a=function(n){n.b().b(_Ewa.baj.$$(_Ewa.ff),282,new _Ewa.rI(n))};_Ewa.rI.prototype={h:null,b:function(){var n=this;this.h.b().c(_Ewa.dK,266,function(t){n.i(new _Ewa.ColoredReferencesManager(n.h,t))})}};_Ewa.ko=function(n,t,i){if(this.g=n,this.c=t,!i){Diag.a.b(39856346,0,!1,"MarqueeMetadata.Ctor: parseResultItem is null");return}this.f=i.IsRangeRef;this.b=i.IsAbsoluteFirstRow;this.a=i.IsAbsoluteFirstColumn;this.e=i.IsAbsoluteSecondRow;this.d=i.IsAbsoluteSecondColumn};_Ewa.ko.prototype={g:0,c:null,f:!1,b:!1,a:!1,e:!1,d:!1};_Ewa.RelativeAndAbsoluteReferencesManager=function(n){this.b=n};_Ewa.RelativeAndAbsoluteReferencesManager.d=function(n,t){return n.index<=t.index?n:t};_Ewa.RelativeAndAbsoluteReferencesManager.e=function(n,t){return t||n?t&&n?2:!t&&n?3:0:1};_Ewa.RelativeAndAbsoluteReferencesManager.prototype={b:null,a:function(n,t,i,r,u){var h;if(r.val=t,u.val=i,!n||!n.length||!_Ewa.bG.b(n))return n;if(h=this.b.h(n),!h)return Diag.a.a(39396451,0,15,"RelativeAndAbsoluteReferencesManager.CycleThroughRelativeAndAbsoluteReferences: Couldn't extract references (might be invalid formula)"),null;for(var e=this.e(h,n,t,i),c=0,o=new Sys.StringBuilder,s=0,f=0;f<e.length;f++)if(this.c(e[f],t,i)){c=e[f].f();r.val=e[f].c;break}for(;f<e.length;f++){if(!this.c(e[f],t,i))break;o.append(n.substring(s,e[f].c));e[f].g(c,o);s=e[f].a}return s&&(u.val=o.toString().length),o.append(n.substring(s,n.length)),o.toString()},e:function(n,t,i,r){for(var ft,f,et,d,l,lt,u,e,y,at,g,a,vt,nt,v,yt,ot,tt,p,h,w,st,it,ht,rt,b,c,k,ct,ut,s=[],o=0;o<n.length;o++)if(ft=n[o],ft.kind==="range")if(f=ft.ref,f.type==="cell")et=f,lt=(l=new _Ewa.RelativeAndAbsoluteReferencesManager.b,l.c=f.span.start,l.a=f.span.end,l.b=[(d=new _Ewa.RelativeAndAbsoluteReferencesManager.a,d.a=et.col,d.b=et.row,d)],l.d=this.b.a(f.span.end,t),l),s.push(lt);else if(f.type==="range")u=f,this.d(u.topLeftSpan,i,r)&&this.d(u.bottomRightSpan,i,r)?(e=new _Ewa.RelativeAndAbsoluteReferencesManager.h,u.top.index<=u.bottom.index?(e.b=u.top,e.c=u.bottom):(e.c=u.top,e.b=u.bottom),u.left.index<=u.right.index?(e.a=u.left,e.d=u.right):(e.d=u.left,e.a=u.right),at=(y=new _Ewa.RelativeAndAbsoluteReferencesManager.i,y.c=u.topLeftSpan.start,y.a=u.bottomRightSpan.end,y.b=[e],y),s.push(at)):(vt=(a=new _Ewa.RelativeAndAbsoluteReferencesManager.b,a.c=u.topLeftSpan.start,a.a=u.topLeftSpan.end,a.b=[(g=new _Ewa.RelativeAndAbsoluteReferencesManager.a,g.a=u.left,g.b=u.top,g)],a.d=this.b.a(u.topLeftSpan.end,t),a),yt=(v=new _Ewa.RelativeAndAbsoluteReferencesManager.b,v.c=u.bottomRightSpan.start,v.a=u.bottomRightSpan.end,v.b=[(nt=new _Ewa.RelativeAndAbsoluteReferencesManager.a,nt.a=u.right,nt.b=u.bottom,nt)],v.d=this.b.a(u.topLeftSpan.end,t),v),s.push(vt),s.push(yt));else if(f.type==="col"){for(ot=f,h=(p=new _Ewa.RelativeAndAbsoluteReferencesManager.g,p.c=f.span.start,p.a=f.span.end,p.b=[(tt=new _Ewa.RelativeAndAbsoluteReferencesManager.c,tt.a=ot.startIndex,tt.b=ot.endIndex,tt)],p);h.a<t.length-1&&t.charAt(h.a)===":"&&o<n.length-1;)if(w=n[o+1].ref,w.type==="col"&&w.span.start===h.a+1)st=w,h.b.push((it=new _Ewa.RelativeAndAbsoluteReferencesManager.c,it.a=st.startIndex,it.b=st.endIndex,it)),h.a=w.span.end,o++;else break;s.push(h)}else if(f.type==="row"){for(ht=f,c=(b=new _Ewa.RelativeAndAbsoluteReferencesManager.j,b.c=f.span.start,b.a=f.span.end,b.b=[(rt=new _Ewa.RelativeAndAbsoluteReferencesManager.f,rt.a=ht.startIndex,rt.b=ht.endIndex,rt)],b);c.a<t.length-1&&t.charAt(c.a)===":"&&o<n.length-1;)if(k=n[o+1].ref,k.type==="row"&&k.span.start===c.a+1)ct=k,c.b.push((ut=new _Ewa.RelativeAndAbsoluteReferencesManager.f,ut.a=ct.startIndex,ut.b=ct.endIndex,ut)),c.a=k.span.end,o++;else break;s.push(c)}return s},c:function(n,t,i){return!(n.c>i||t>n.a)},d:function(n,t,i){return!(n.start>i||t>n.end)}};_Ewa.RelativeAndAbsoluteReferencesManager.k=function(){};_Ewa.RelativeAndAbsoluteReferencesManager.k.prototype={c:0,a:0,b:null,g:function(n,t){for(var r,i=0;i<this.b.length;i++)r=this.e(n,this.b[i]),t.append(r),i<this.b.length-1&&t.append(":")}};_Ewa.RelativeAndAbsoluteReferencesManager.b=function(){_Ewa.RelativeAndAbsoluteReferencesManager.b.initializeBase(this)};_Ewa.RelativeAndAbsoluteReferencesManager.b.prototype={d:!1,f:function(){var n=this.b[0],t=n.b.kind==="Abs",i=n.a.kind==="Abs";return _Ewa.RelativeAndAbsoluteReferencesManager.e(t,i)},e:function(n,t){var i=t,u=i.b.index+1,f=i.a.index+1,r=_Ewa.o.a(u,f,!1);return this.d?r.bl(n===1||n===3,n===1||n===2):r.T(n===1||n===3,n===1||n===2,!0,!0)}};_Ewa.RelativeAndAbsoluteReferencesManager.i=function(){_Ewa.RelativeAndAbsoluteReferencesManager.i.initializeBase(this)};_Ewa.RelativeAndAbsoluteReferencesManager.i.prototype={f:function(){var n=this.b[0],t=n.b.kind==="Abs",i=n.a.kind==="Abs";return _Ewa.RelativeAndAbsoluteReferencesManager.e(t,i)},e:function(n,t){var i=t,f=i.b.index+1,e=i.c.index+1,o=i.a.index+1,s=i.d.index+1,h=new _Ewa.o(f,o,e,s,!1,!1),r=n===1||n===3,u=n===1||n===2;return h.T(r,u,r,u)}};_Ewa.RelativeAndAbsoluteReferencesManager.g=function(){_Ewa.RelativeAndAbsoluteReferencesManager.g.initializeBase(this)};_Ewa.RelativeAndAbsoluteReferencesManager.g.prototype={f:function(){var n=this.b[0],t=_Ewa.RelativeAndAbsoluteReferencesManager.d(n.a,n.b),i=t.kind==="Abs";return i?2:3},e:function(n,t){var i=t,r=i.a.index+1,u=i.b.index+1,f=_Ewa.o.e(r,u,!1);return f.T(n===1||n===3,!0,n===1||n===3,!0)}};_Ewa.RelativeAndAbsoluteReferencesManager.j=function(){_Ewa.RelativeAndAbsoluteReferencesManager.j.initializeBase(this)};_Ewa.RelativeAndAbsoluteReferencesManager.j.prototype={f:function(){var n=this.b[0],t=_Ewa.RelativeAndAbsoluteReferencesManager.d(n.a,n.b),i=t.kind==="Abs";return i?0:1},e:function(n,t){var i=t,r=i.a.index+1,u=i.b.index+1,f=_Ewa.o.f(r,u,!1);return f.T(!0,n===1||n===2,!0,n===1||n===2)}};_Ewa.RelativeAndAbsoluteReferencesManager.a=function(){};_Ewa.RelativeAndAbsoluteReferencesManager.a.prototype={b:null,a:null};_Ewa.RelativeAndAbsoluteReferencesManager.h=function(){};_Ewa.RelativeAndAbsoluteReferencesManager.h.prototype={b:null,c:null,a:null,d:null};_Ewa.RelativeAndAbsoluteReferencesManager.c=function(){};_Ewa.RelativeAndAbsoluteReferencesManager.c.prototype={a:null,b:null};_Ewa.RelativeAndAbsoluteReferencesManager.f=function(){};_Ewa.RelativeAndAbsoluteReferencesManager.f.prototype={a:null,b:null};_Ewa.rK=function(n){_Ewa.rK.initializeBase(this);this.h=n;this.j()};_Ewa.rK.a=function(n){n.b().b(_Ewa.baj.$$(_Ewa.jc),295,new _Ewa.rK(n))};_Ewa.rK.prototype={h:null,b:function(){var n=this;this.h.b().c(_Ewa.dK,266,function(t){n.i(new _Ewa.RelativeAndAbsoluteReferencesManager(t))})}};_Ewa.hM.registerClass("_Ewa.hM",null,Sys.IDisposable);_Ewa.hM.a.registerClass("_Ewa.hM.a");_Ewa.hM.d.registerClass("_Ewa.hM.d");_Ewa.hM.g.registerClass("_Ewa.hM.g");_Ewa.hM.f.registerClass("_Ewa.hM.f");_Ewa.hN.registerClass("_Ewa.hN");_Ewa.CalcManager.registerClass("_Ewa.CalcManager",null,_Ewa.dK,Sys.IDisposable);_Ewa.CalcManager.d.registerClass("_Ewa.CalcManager.d");_Ewa.CalcManager.f.registerClass("_Ewa.CalcManager.f");_Ewa.CalcManager.a.registerClass("_Ewa.CalcManager.a",null,_Ewa.dX);_Ewa.CalcManager.a.a.registerClass("_Ewa.CalcManager.a.a",null,_Ewa.UM);_Ewa.rJ.registerClass("_Ewa.rJ");_Ewa.rH.registerClass("_Ewa.rH",_Ewa.pU.$$(_Ewa.dK));_Ewa.ColoredReferencesManager.registerClass("_Ewa.ColoredReferencesManager",null,_Ewa.ff);_Ewa.rI.registerClass("_Ewa.rI",_Ewa.pU.$$(_Ewa.ff));_Ewa.ko.registerClass("_Ewa.ko");_Ewa.RelativeAndAbsoluteReferencesManager.registerClass("_Ewa.RelativeAndAbsoluteReferencesManager",null,_Ewa.jc);_Ewa.RelativeAndAbsoluteReferencesManager.k.registerClass("_Ewa.RelativeAndAbsoluteReferencesManager.k");_Ewa.RelativeAndAbsoluteReferencesManager.b.registerClass("_Ewa.RelativeAndAbsoluteReferencesManager.b",_Ewa.RelativeAndAbsoluteReferencesManager.k);_Ewa.RelativeAndAbsoluteReferencesManager.i.registerClass("_Ewa.RelativeAndAbsoluteReferencesManager.i",_Ewa.RelativeAndAbsoluteReferencesManager.k);_Ewa.RelativeAndAbsoluteReferencesManager.g.registerClass("_Ewa.RelativeAndAbsoluteReferencesManager.g",_Ewa.RelativeAndAbsoluteReferencesManager.k);_Ewa.RelativeAndAbsoluteReferencesManager.j.registerClass("_Ewa.RelativeAndAbsoluteReferencesManager.j",_Ewa.RelativeAndAbsoluteReferencesManager.k);_Ewa.RelativeAndAbsoluteReferencesManager.c.registerClass("_Ewa.RelativeAndAbsoluteReferencesManager.c");_Ewa.RelativeAndAbsoluteReferencesManager.f.registerClass("_Ewa.RelativeAndAbsoluteReferencesManager.f");_Ewa.rK.registerClass("_Ewa.rK",_Ewa.pU.$$(_Ewa.jc));_Ewa.hN.b="##ERR##";Type.registerNamespace("_Ewa");_Ewa.UJ=function(){};_Ewa.UJ.a=function(){_Ewa.j.a(_Ewa.rH.a);_Ewa.j.a(_Ewa.rI.a);_Ewa.j.a(_Ewa.rK.a)};_Ewa.UJ.a();