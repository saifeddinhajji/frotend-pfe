var __extends,OfficeExtension;try{Type.registerNamespace("Common.App.AppsForOffice");Common.App.AppsForOffice.s=function(){};Common.App.AppsForOffice.s.registerInterface("Common.App.AppsForOffice.s");Common.App.AppsForOffice.t=function(){};Common.App.AppsForOffice.t.registerInterface("Common.App.AppsForOffice.t");Common.App.AppsForOffice.r=function(){};Common.App.AppsForOffice.v=function(){};Common.App.AppsForOffice.q=function(){};Common.App.AppsForOffice.q.registerInterface("Common.App.AppsForOffice.q");Common.App.AppsForOffice.u=function(){};Common.App.AppsForOffice.u.registerInterface("Common.App.AppsForOffice.u");Common.App.AppsForOffice.d=function(n,t,i){this.e=n;this.b=t;this.d=i;this.c=OfficeExt.CommandInvokeMode.Default};Common.App.AppsForOffice.d.prototype={e:0,b:null,d:null,c:0,a:function(n,t,i){i=i||{};i.commandMode=this.c;var r=this;t.a(this.b,this.d,i,function(t,i){n.a(r.e,r.b,t,i)})}};Common.App.AppsForOffice.j=function(){};Common.App.AppsForOffice.j.prototype={b:function(n,t){var i=null;switch(n){case 1:i=new Common.App.AppsForOffice.k(t,this.a().getNativeActionName(n));break;case 2:i=new Common.App.AppsForOffice.d(2,t,this.a().getNativeActionName(n));break;case 3:i=new Common.App.AppsForOffice.d(3,t,this.a().getNativeActionName(n))}return i},a:function(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}};Common.App.AppsForOffice.k=function(n,t){Common.App.AppsForOffice.k.initializeBase(this,[1,n,t]);this.c=OfficeExt.CommandInvokeMode.ExclusiveForNew};Common.App.AppsForOffice.b=function(){};Common.App.AppsForOffice.b.b=function(){return Common.App.AppsForOffice.b.a||(Common.App.AppsForOffice.b.a=new Common.App.AppsForOffice.b),Common.App.AppsForOffice.b.a};Common.App.AppsForOffice.b.prototype={a:function(n,t,i,r){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(n,t,i,r)}};Common.App.AppsForOffice.l=function(n,t,i){this.R=new Common.T;this.ba=new Common.App.AppsForOffice.j;Common.App.AppsForOffice.l.initializeBase(this,[!1,!1,!1,!1]);this.g(5);this.c=i;this.m=i;this.e=n;this.d=t};Common.App.AppsForOffice.l.prototype={b:null,bn:"WACDialogTitleText",bm:"0",bd:"15px",bl:"0px",bb:"calc(100% - 30px)",bc:"100%",e:0,d:0,c:null,Z:0,bo:function(n){this.R.l("OnDialogClosedEventKey",n)},E:function(){CommonUI.b.prototype.E.call(this);this.v.style.width="100%";this.v.style.height=this.bM?this.bb:this.bc;this.v.style.marginTop=this.bM?this.bd:this.bl;this.v.style.padding=this.bm},A:function(){CommonUI.b.prototype.A.call(this);this.f.style.width=String.format("{0}px",this.e*window.innerWidth/100);this.f.style.height=String.format("{0}px",this.d*window.innerHeight/100);this.f.style.minWidth="0px";this.b=document.getElementById(this.n+this.bn);this.b.style.position="absolute";this.b.style.whiteSpace="nowrap";this.b.style.textOverflow="ellipsis";Common.a.g?(this.b.style.right="14px",this.b.style.left="44px"):(this.b.style.right="44px",this.b.style.left="14px")},u:function(n){CommonUI.b.prototype.u.call(this,n);this.b&&this.b.setAttribute("title",n)},ev:function(){this.f.style.width=String.format("{0}px",this.e*window.innerWidth/100);this.f.style.height=String.format("{0}px",this.d*window.innerHeight/100);this.f.style.overflowY="hidden";this.f.style.overflowX="hidden";this.f.style.marginTop="";this.f.style.top="";Common.c.g()&&Common.a.g?(this.f.style.right="",this.f.style.marginRight=""):(this.f.style.left="",this.f.style.marginLeft="")},i:function(){var t=this.ba.b(3,this.c),n;t.a(this,Common.App.AppsForOffice.b.b(),{});n=this;this.Z=window.setTimeout(function(){n.R.k("OnDialogClosedEventKey",n.c,null);CommonUI.c.prototype.i.call(n)},500)},a:function(n){n===3&&(window.clearTimeout(this.Z),this.R.k("OnDialogClosedEventKey",this.c,null),CommonUI.c.prototype.i.call(this))}};Common.App.AppsForOffice.AppsForOfficeDialogManager=function(n){this.i=Function.createDelegate(this,this.l);this.h=new Common.T;this.g=n};Common.App.AppsForOffice.AppsForOfficeDialogManager.getInstance=function(n){return Common.App.AppsForOffice.AppsForOfficeDialogManager.b||(Common.App.AppsForOffice.AppsForOfficeDialogManager.b=new Common.App.AppsForOffice.AppsForOfficeDialogManager(n)),Common.App.AppsForOffice.AppsForOfficeDialogManager.b};Common.App.AppsForOffice.AppsForOfficeDialogManager.prototype={g:null,b:function(n){this.h.l("OnMessageParentEventKey",n)},a:function(n){this.h.l("OnMessageDialogEventKey",n)},f:function(n,t,i,r){var f,h,u,o,e;if(Common.App.AppsForOffice.AppsForOfficeDialogManager.a.b(t)){Diag.a.a(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control.");i(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return}try{if(f=JSON.parse(n),h=f.url,!this.g.getOsfControl(t).checkAppDomains(h)){Diag.a.a(19940611,344,10,"ShowDialog: dialog url not in app domains list.");i(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains);return}u=new Common.App.AppsForOffice.m;u.e=f.width;u.c=f.height;u.d=h;u.g=f.displayInIframe;u.f=f.hideTitle;u.a=t;u.b=Common.F.a().a;Diag.a.a(18371103,344,50,"ShowDialog: asset id {0}, url hash code {1}",this.g.getOsfControl(t).getMarketplaceID(),Common.e.e(u.d));o=new Common.App.AppsForOffice.g;o.b=u.b;var c=this.g.getOsfControl(u.a).getManifest().getDefaultDisplayName(),l=this.g.getOsfControl(u.a).getStoreType().toLowerCase(),s=null;s=Common.a.b().a().c()===4&&l==="hardcodedpreinstall"&&u.f?this.createAndShowAppsForOfficeDialog(u.e,u.c,u.b,!0,c):this.createAndShowAppsForOfficeDialog(u.e,u.c,u.b,!1,c);e=this.k(this.g.getOsfControl(u.a).getManifest(),u.b,u.d);e.agaveName=c;e.div=s.v;this.g.insertDialogControl(e);s.bo(this.i);o.a=s;Common.App.AppsForOffice.AppsForOfficeDialogManager.a.c(u.a,o);r&&r(e);i(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(a){Diag.a.a(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",a.message);i(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}},d:function(n,t){try{var i=this.j(n);i&&this.h.k("OnMessageParentEventKey",new Common.App.AppsForOffice.h(i,OSF.DialogMessageType.DialogMessageReceived,t),null)}catch(r){return Diag.a.a(18371105,344,10,"MessageParent: action failed. Exception message: {0}",r.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess},c:function(n,t){if(!Common.App.AppsForOffice.AppsForOfficeDialogManager.a.b(n)){Diag.a.a(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control.");t(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return}try{var i=Common.App.AppsForOffice.AppsForOfficeDialogManager.a.a(n);i.a&&i.a.i();this.g.purgeDialogControl(i.b);Common.App.AppsForOffice.AppsForOfficeDialogManager.a.d(n);t(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(r){Diag.a.a(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",r.message);t(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}},e:function(n,t){if(Common.App.AppsForOffice.AppsForOfficeDialogManager.a.b(n)){var i=Common.App.AppsForOffice.AppsForOfficeDialogManager.a.a(n);if(i.a)try{this.h.k("OnMessageDialogEventKey",new Common.App.AppsForOffice.n(i.b,OSF.DialogMessageType.DialogParentMessageReceived,t),null)}catch(r){Diag.a.a(20289179,344,10,"SendMessage: action failed. Exception message: {0}",r.message)}}},j:function(n){for(var i=null,r=Common.App.AppsForOffice.AppsForOfficeDialogManager.a.$$ge(),t;r.$$mn();)if(t=r.$$cu(),t.a.b===n){i=t.b;break}return i},l:function(n,t){var i=this.j(t);i&&(this.g.purgeDialogControl(t),Common.App.AppsForOffice.AppsForOfficeDialogManager.a.d(i),this.h.k("OnMessageParentEventKey",new Common.App.AppsForOffice.h(i,OSF.DialogMessageType.DialogClosed,null),null))},createAndShowAppsForOfficeDialog:function(n,t,i,r,u){var f=new Common.App.AppsForOffice.l(n,t,i),e=r?"":String.format($a.gL,u);return r&&(f.bM=!1,f.I=!1),f.j(e,null,null),f.bi=null,f},k:function(n,t,i){var r={};return r.id=t,r.marketplaceID=t,r.marketplaceVersion=n.getMarketplaceVersion(),r.appDomains=n.getAppDomains(),r.store="developer",r.storeType=OSF.StoreType.InMemory,r.dialogUrl=i,r.osfControlType=OSF.OsfControlTarget.TaskPane,r}};Common.App.AppsForOffice.e=function(){Common.App.AppsForOffice.e.initializeBase(this,[!1,!1,!1,!1]);this.g(5);this.m="AppsForOfficeInsertionDialog"};Common.App.AppsForOffice.e.prototype={ba:"WACDialogBodyPanel",R:"695px",c:"calc(100% - 46px)",d:"15px",e:"0",bb:"WACDialogPanel",b:695,bc:462,Z:"80%",E:function(){CommonUI.b.prototype.E.call(this);this.a=document.getElementById(this.ba);this.a.style.width=this.R;this.a.style.height=this.c;this.a.style.marginTop=this.d;this.a.style.padding=this.e},bx:function(){this.a&&(this.a.style.width=this.R,this.a.style.height=this.c,this.a.style.marginTop=this.d,this.a.style.padding=this.e,this.b>window.document.documentElement.clientWidth?(this.f.style.width=String.format("{0}px",window.document.documentElement.clientWidth),this.f.style.overflowX="scroll",this.f.style.left="0"):(this.f.style.width=String.format("{0}px",this.b),this.f.style.overflowX="hidden"),this.f.offsetHeight>window.document.documentElement.clientHeight||this.bc+50>window.document.documentElement.clientHeight?(this.f.style.height=String.format("{0}px",window.document.documentElement.clientHeight),this.f.style.overflowY="scroll",this.f.style.top="0",this.f.style.left="0",this.f.style.marginTop="-48px"):(this.f.style.overflowY="hidden",this.f.style.top="10%",this.f.style.height=this.Z),this.ci())},ci:function(){var t,n;if(!this.f){Diag.a.a(19976784,306,10,"_divMessageBox is null in CenterDialog()");return}t=this.f.style.zIndex;this.f.style.zIndex=-9999;this.b>window.document.documentElement.clientWidth?Common.c.g()&&Common.a.g?this.f.style.marginRight="0":this.f.style.marginLeft="0":(n=String.format("{0}px",Math.floor(-this.f.offsetWidth/2)),Common.c.g()&&Common.a.g?this.f.style.marginRight=n:this.f.style.marginLeft=n,Common.c.g()&&Common.a.g?this.f.style.right="50%":this.f.style.left="50%");this.f.style.zIndex=t},A:function(){CommonUI.b.prototype.A.call(this);var n=document.getElementById(this.n+this.bb);n.style.width=String.format("{0}px",this.b);n.style.height=this.Z},a:null};Common.App.AppsForOffice.i=function(){};Common.App.AppsForOffice.i.prototype={b:null,a:function(){return this.b},c:0};Common.App.AppsForOffice.p=function(){};Common.App.AppsForOffice.p.prototype={c:null,b:null,a:0,d:null};Common.App.AppsForOffice.a=function(n,t){this.l=Function.createDelegate(this,this.t);this.k=Function.createDelegate(this,this.s);this.h=new($$sc.v.$$(DiagUse.a));this.e=new($$sc.v.$$(Number));this.f=new($$sc.v.$$(Number));this.j=new($$sc.v.$$(DiagUse.a));this.c=n;this.d=t;this.d.c("PostAccessToken");this.d.c("PostPrimaryIdentityInfo");this.d.b("PostAccessToken",this.k);this.d.b("PostPrimaryIdentityInfo",this.l);this.g=Common.a.b().d()};Common.App.AppsForOffice.a.c=function(n,t){return Common.App.AppsForOffice.a.b||(Common.App.AppsForOffice.a.b=new Common.App.AppsForOffice.a(n,t)),Common.App.AppsForOffice.a.b};Common.App.AppsForOffice.a.prototype={c:null,d:null,g:null,p:function(n,t,i,r,u,f,e,o){var w,v,a,p,h;try{w=!!i&&i!=="";v=-1;this.e&&(this.e.c(n,this.m()),v=this.e.a(n));var s=this.c.getOsfControl(n),c=s.getStoreType()||"",l=s.getOwnerAddinStoreType()||"",y=s.getMarketplaceID()||"",nt=s.getMarketplaceVersion()||"";c=c.toLowerCase();l=l.toLowerCase();y=y.toLowerCase();var tt=Common.k.i(t)||"",it=Common.k.i(s.getIframeUrl())||"",rt=tt.toLowerCase()===it.toLowerCase(),b={callInstanceId:v.toString(),controlId:n.toString(),controlAssetId:y.toString(),controlVersion:nt.toString(),storeType:c.toString(),ownerStoreType:l.toString(),allowConsentPrompt:r.toString(),forMSGraphAccess:u.toString(),allowSignInPrompt:f.toString(),hasAddinAuthChallenge:w.toString(),securityOriginEqualsSourceLocation:rt.toString()};if(Diag.a.a(51401115,344,50,"{0}",b),Otel.a.b((a=new Otel.c,a.name="Office.Online.Extensibility.SSO.GetAccessTokenV2Start",a.dataFields=Common.H.a(b,null,null),a)),Common.App.AppsForOffice.a.a.b(n)){this.i();Diag.a.a(22402394,344,100,"GetAccessToken: addinCallbackMap already has the callback info for this addin.");this.b(n,e,OSF.DDA.ErrorCodeManager.errorCodes.ooeAddinIsAlreadyRequestingToken,null,null);return}var k=s.getManifest().isSSOAddin(),d=this.n(n),g=this.q(n,o);if(d&&!g){Diag.a.a(36827535,344,10,"GetAccessToken: Specified resource not allowed for first party SSO.");this.b(n,e,OSF.DDA.ErrorCodeManager.errorCodes.ooeResourceNotAllowed,null,null);return}if(k){if(p=!0,h=c,c===OSF.StoreType.InMemory&&(h=l),h===OSF.StoreType.OMEX&&(p=!1),h===OSF.StoreType.SPApp||h===OSF.StoreType.SPCatalog){Diag.a.a(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported.");this.b(n,e,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null);return}if(u&&!p){Diag.a.a(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access.");this.b(n,e,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null);return}u&&h===OSF.StoreType.Exchange&&(r=!1)}if(k||d&&g)this.o(n,t,i,r,f,e,o);else{Diag.a.a(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin.");this.b(n,e,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null);return}}catch(ut){this.i();Diag.a.a(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",ut.message);this.b(n,e,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}},a:function(n,t,i,r,u,f,e){this.p(n,t,i,r,u,!0,f,e)},o:function(n,t,i,r,u,f,e){var a=e?e:this.c.getOsfControl(n).getManifest().getWebApplicationResource().split(",")[0],s=Common.k.i(a),h=Common.k.i(t),c=this.n(n),o,l,v;if(c||s&&h)if(c||s.toLowerCase()===h.toLowerCase())Common.App.AppsForOffice.a.a.c(n,f),o={},o.AddinControlId=n,o.AddinApplicationResource=a,o.AddinSSOAuthChallenge=i,o.AddinIsFirstParty=c,o.AllowConsentPrompt=r,o.AllowSignInPrompt=u,this.g&&(l=n+"GetAccessToken",v=this.g.a("ComponentAttach",l),this.h.c(l,v)),this.f&&this.f.c(n,this.e.a(n)),this.d.a("GetAccessToken",o,"");else{if(s.toLowerCase()===h.toLowerCase()||c){Diag.a.a(36292512,344,10,"GetAccessToken: current Addin is not a first party Addin.");this.b(n,f,OSF.DDA.ErrorCodeManager.errorCodes.ooeAccessDenied,null,null);return}Diag.a.a(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource.");this.b(n,f,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null);return}else s||Diag.a.a(594118746,344,10,"Invalid resource URL for SSO."),h||Diag.a.a(594118745,344,10,"Invalid page URL for SSO."),this.b(n,f,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)},s:function(n){var t,e,o,l,f;try{var i=n.Values.AddinControlId,r=n.Values.AccessToken,a=n.Values.HostApplicationType,s=i+"GetAccessToken",u,h,c;(c=this.h.e(s,h={val:u}),u=h.val,c)&&(u.a(),u=null,this.h.d(s));t={};isNullOrUndefined(n.Values.GetTokenSilentTime)||(t.getTokenSilentTime=n.Values.GetTokenSilentTime.toString());isNullOrUndefined(n.Values.GetTokenPopupTime)||(t.getTokenPopupTime=n.Values.GetTokenPopupTime.toString());isNullOrUndefined(n.Values.GetIDTokenTime)||(t.getIDTokenTime=n.Values.GetIDTokenTime.toString());isNullOrUndefined(n.Values.TokenCached)||(t.tokenCached=n.Values.TokenCached.toString());e=0;r&&typeof r!="undefined"&&r.length||(e=this.r(n),o=this.u(n),o&&(t.detailedError=o));l=Common.App.AppsForOffice.a.a.a(i);Common.App.AppsForOffice.a.a.d(i);f=new Common.App.AppsForOffice.i;f.b=r;f.c=a;this.b(i,l,e,f,t)}catch(v){this.i();Diag.a.a(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",v.message)}},t:function(n){var u,i,r,f,e,t,o;try{u=n.Values.AddinControlId;i=u+"GetPrimaryIdentityInfo";(e=this.j.e(i,f={val:r}),r=f.val,e)&&(r.a(),r=null,this.j.d(i));t=new Common.App.AppsForOffice.p;t.c=n.Values.UserEmail;t.b=n.Values.UserName;t.d=n.Values.FederationProvider;switch(n.Values.HostApplicationType){case"OnedriveWOPI":t.a=1;break;case"SharepointOnline":case"ExchangeOnline":default:t.a=0}o=Common.App.AppsForOffice.a.a.a(i);Common.App.AppsForOffice.a.a.d(i);o(0,t)}catch(s){this.i();Diag.a.a(36766039,344,10,"ReceivedPrimaryIdentityInfoHandler: exception message: {0}",s.message)}},u:function(n){var t="",u=n.Values.HostApplicationType,r=n.Values.AddinSSOError,f,i;return u&&u.toLowerCase()==="SharepointOnline".toLowerCase()&&(r==="Environment not supported"?t="EnvironmentNotSupported":r==="adal.js load failed"?t="AdalJSFailed":t==="Popup Window is null"?t="PopupWindowNull":(f=new RegExp("AADSTS(\\d+)"),i=f.exec(r),i&&i.length>1&&(t=i[1]))),t},r:function(n){var r=n.Values.HostApplicationType,t=n.Values.AddinSSOError,i;return Diag.a.a(23859717,344,10,"MapErrorMessageToErrorCode: host application type: {0}, error message: {1}",r,t),i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,r&&r.toLowerCase()==="OnedriveWOPI".toLowerCase()?t==="login_required"?i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserNotSignedIn:t==="13002"||t==="access_denied"?i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:t==="consent_required"&&(i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant):t.indexOf("AADSTS50058")>-1?i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:t.indexOf("Popup Window is null")>-1?i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:t.indexOf("AADSTS50001")>-1?i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:t.indexOf("13002")>-1||t.indexOf("AADSTS65004")>-1||t.indexOf("Popup Window closed")>-1?i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:t.indexOf("AADSTS70011")>-1||t.indexOf("AADSTS65001")>-1?i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:t.indexOf("13001")>-1&&(i=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserNotSignedIn),i},n:function(n){return this.c.getOsfControl(n).isFirstParty()},q:function(n,t){var u,i,e,o;if(this.c._enableFirstPartySSOResourceCheck){u=this.c.getOsfControl(n).getManifest().getWebApplicationResource().split(",");i=!1;for(var f=u,s=f.length,r=0;r<s;++r)if(e=f[r],o=e.trim(),o===t){i=!0;break}return i}return!0},i:function(){var n=window.navigator.userAgent;Diag.a.a(39068820,344,50,"Browser information: {0}",{UserAgent:n})},b:function(n,t,i,r,u){var f=-1,l=0,e,s,h,c,o;if(this.e&&(f=this.e.a(n)),r&&this.f&&(f=this.f.a(n)),f>0&&(l=this.m()-f),e={callInstanceId:f.toString(),controlId:n.toString(),callDuration:l.toString(),errorCode:i.toString()},u){s=u;for(h in s)c={key:h,value:s[h]},e[c.key]=c.value}Diag.a.a(51401116,344,50,"{0}",e);Otel.a.b((o=new Otel.c,o.name="Office.Online.Extensibility.SSO.GetAccessTokenV2End",o.dataFields=Common.H.a(e,null,null),o));t(i,r)},m:function(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(n){}return Date.now()}};Common.App.AppsForOffice.g=function(){};Common.App.AppsForOffice.g.prototype={b:null,a:null};Common.App.AppsForOffice.m=function(){};Common.App.AppsForOffice.m.prototype={e:0,c:0,d:null,a:null,b:null,g:!1,f:!1};Common.App.AppsForOffice.h=function(n,t,i){Common.App.AppsForOffice.h.initializeBase(this);this.a=n;this.b=t;this.c=i};Common.App.AppsForOffice.h.prototype={a:null,b:0,c:null};Common.App.AppsForOffice.n=function(n,t,i){Common.App.AppsForOffice.n.initializeBase(this);this.a=n;this.c=t;this.b=i};Common.App.AppsForOffice.n.prototype={a:null,c:0,b:null};Common.App.AppsForOffice.f=function(n){this.b=n};Common.App.AppsForOffice.f.prototype={b:null,tryAuthenticate:function(n,t){var i=this;this.a("identitytoken",function(){n()},t)},tryAuthorize:function(n,t){this.a("authcode",n,t)},getSignInUrl:function(n,t){this.a("signinurl",n,t)},signOut:function(n,t){this.a("signout",n,t)},a:function(n,t,i){var u=new Common.bu("AuthenticationProxyHandler.aspx"),f,r;u.a("responseType",n);Common.a.bQ(u);f=String.format("{0}{1}&{2}",this.b,u.toString(),Common.a.j);r=document.createElement("iframe");r.setAttribute("id","privateCatalogIframe");r.setAttribute("name","privateCatalogIframe");r.setAttribute("style","display: none");$$sc.e.a().a(n,"signinurl")||r.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Common.App.AppsForOffice.f.a.a(r,t,i);r.setAttribute("src",f);document.body.appendChild(r)}};Common.App.AppsForOffice.f.a=function(n,t,i){this.b=Function.createDelegate(this,this.f);this.a=n;this.d=t;this.c=i;$addHandler(window,"message",this.b)};Common.App.AppsForOffice.f.a.a=function(n,t,i){new Common.App.AppsForOffice.f.a(n,t,i)};Common.App.AppsForOffice.f.a.prototype={d:null,c:null,a:null,f:function(n){var i,r,t;try{if(Common.a.a.a("AuthenticationProxySandboxIsEnabled"))if(n&&n.rawEvent&&n.rawEvent.origin&&this.a&&this.a.id){if(i=this.e(n.rawEvent.origin),r=this.e(document.domain),!$$sc.e.a().a(r,i)){Diag.a.a(51451613,344,15,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.");return}if(!n.rawEvent.source||!n.rawEvent.source.frameElement||!n.rawEvent.source.frameElement.id||!$$sc.e.a().a(n.rawEvent.source.frameElement.id,this.a.id)){Diag.a.a(51451614,344,15,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");return}}else{Diag.a.a(51418200,344,15,"AuthenticationProxy ResponseHandler skipped processing for event.");return}t=null;try{t=JSON.parse(n.rawEvent.data)}catch(u){Diag.a.a(39112971,344,15,"AuthenticationProxy.HandleResponse: Exception when calling Json.Parse on domEvent.RawEvent.Data: {0}",u.message)}t&&t.statusCode===200?(Diag.a.a(23705827,344,100,"Received response from authentication proxy."),this.d(t.authorizationCode?t.authorizationCode:t.signInUrl)):(Diag.a.a(23707648,344,50,"Authentication proxy returned a result but the operation failed."),this.c());$removeHandler(window,"message",this.b);this.a?document.body.contains(this.a)?document.body.removeChild(this.a):Diag.a.a(24978499,344,15,"The iframe is not a child of Body."):Diag.a.a(24978500,344,15,"The iframe is null.")}catch(f){Diag.a.a(23707649,344,15,"Exception in authentication proxy message handler: {0}.",f.message)}},e:function(n){var t="";try{n&&(t=n.indexOf("//")>-1?n.split("/")[2]:n.split("/")[0],t&&(t=t.split(":")[0],t=t.split("?")[0]))}catch(i){Diag.a.a(51451615,344,15,"Failed to parse host name from url: {0}",i.message)}return t}};Common.App.AppsForOffice.c=function(){};Common.App.AppsForOffice.c.prototype={getUserId:function(n,t){var i,r=(i=new($$sc.u.$$($$sc.d)),i.b(new $$sc.d("corr",n)),i);this.a("getUserId",r,1,t)},getLastStoreUpdate:function(n,t,i){var r,u=(r=new($$sc.u.$$($$sc.d)),r.b(new $$sc.d("lc",n)),r.b(new $$sc.d("corr",t)),r);this.a("laststoreupdate",u,1,i)},getEntitlement:function(n,t,i,r){var u,f=(u=new($$sc.u.$$($$sc.d)),u.b(new $$sc.d("av",t)),u.b(new $$sc.d("corr",i)),u);this.a("getEntitlements",f,1,r)},getEToken:function(n,t,i,r,u,f){var e,o=(e=new($$sc.u.$$($$sc.d)),e.b(new $$sc.d("cmu",n)),e.b(new $$sc.d("cmf",t)),e.b(new $$sc.d("assetid",i)),e.b(new $$sc.d("expver",r)),e.b(new $$sc.d("corr",u)),e);this.a("getEToken",o,1,f)},getManifest:function(n,t,i,r){var u,f=(u=new($$sc.u.$$($$sc.d)),u.b(new $$sc.d("cmu",n)),u.b(new $$sc.d("assetid",t)),u.b(new $$sc.d("corr",i)),u);this.a("getManifest",f,1,r)},getAppState:function(n,t,i){var r,u=(r=new($$sc.u.$$($$sc.d)),r.b(new $$sc.d("ma",n)),r.b(new $$sc.d("corr",t)),r);this.a("getAppState",u,1,i)},getKilledApps:function(n,t){var i,r=(i=new($$sc.u.$$($$sc.d)),i.b(new $$sc.d("corr",n)),i);this.a("getRemovedAddins",r,1,t)},getAppDetails:function(n,t,i,r){var u,f=(u=new($$sc.u.$$($$sc.d)),u.b(new $$sc.d("cmo",n)),u.b(new $$sc.d("corr",i)),u);this.b("getAppDetails",f,t,2,r,!1)},removeApps:function(n,t,i){var r,u=(r=new($$sc.u.$$($$sc.d)),r.b(new $$sc.d("corr",t)),r);this.b("removeAddin",u,n,2,i,!1)},getLastPrivateCatalogUpdate:function(n,t,i,r,u,f){var e,o=(e=new($$sc.u.$$($$sc.d)),e.b(new $$sc.d("catalog","privatecatalog")),e.b(new $$sc.d("clientCode",n)),e.b(new $$sc.d("clientVersion",t)),e.b(new $$sc.d("corr",u)),e),s=String.format("authorizationCode={0}&refreshToken={1}",i?Common.e.a(i):"",r?Common.e.a(r):"");this.b("getLastPrivateCatalogUpdate",o,s,2,f,!0)},getPrivateCatalogAddIns:function(n,t,i,r,u,f){var e,o=(e=new($$sc.u.$$($$sc.d)),e.b(new $$sc.d("catalog","privatecatalog")),e.b(new $$sc.d("clientCode",n)),e.b(new $$sc.d("clientVersion",t)),e.b(new $$sc.d("corr",u)),e),s=String.format("authorizationCode={0}&refreshToken={1}",i?Common.e.a(i):"",r?Common.e.a(r):"");this.b("getAddIns",o,s,2,f,!0)},getPrivateCatalogManifests:function(n,t,i,r,u){var f,e=(f=new($$sc.u.$$($$sc.d)),f.b(new $$sc.d("catalog","privatecatalog")),f.b(new $$sc.d("corr",r)),f),o=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Common.e.a(n),t?Common.e.a(t):"",i?Common.e.a(i):"");this.b("getAppManifests",e,o,2,u,!0)},isStoreDisabled:function(n,t){var i,r=(i=new($$sc.u.$$($$sc.d)),i.b(new $$sc.d("corr",n)),i);this.a("isStoreDisabled",r,2,t)},a:function(n,t,i,r){this.b(n,t,null,i,r,!1)},b:function(n,t,i,r,u,f){var e=new Common.bu("AddinServiceHandler.ashx"),o,s;for(e.a("action",n),e.a("app",Common.bK.toString(Common.a.b().a().c())),o=t.$$ge();o.$$mn();)s=o.$$cu(),e.a(s.b,s.a);var h=Common.a.b().a().m(),c=String.format("{0}{1}&{2}",h,e.toString(),Common.a.j),l=Common.a.d,a=this,v=this;l.a(c,r,i,null,!1,2,function(n){var t=null;n&&n.b&&(n.b.d["X-BlockedForMinor"]&&n.b.d["X-BlockedForMinor"].toString()==="1"&&(n.b.c=451),t=n.b.a);u(n.b.c,t)},function(n){var t=null;f&&n&&n.b&&n.b.a&&(t=n.b.a);u(n.b.c,t);Diag.a.a(18392345,220,50,"S2S web request failed with {0}.",n.b.c)},null,null,!1,null,null,"AddinServiceHandler_"+n,null,!1,null,!1,null)}};Common.App.AppsForOffice.o=function(){};Common.App.AppsForOffice.o.a=function(n){var r=n,i=null,t;i=r;Otel.a.i((t=new Otel.e,t.otelEvent=i,t))};Common.App.AppsForOffice.d.registerClass("Common.App.AppsForOffice.d");Common.App.AppsForOffice.k.registerClass("Common.App.AppsForOffice.k",Common.App.AppsForOffice.d);Common.App.AppsForOffice.l.registerClass("Common.App.AppsForOffice.l",CommonUI.b,Common.App.AppsForOffice.t);Common.App.AppsForOffice.AppsForOfficeDialogManager.registerClass("Common.App.AppsForOffice.AppsForOfficeDialogManager");Common.App.AppsForOffice.e.registerClass("Common.App.AppsForOffice.e",CommonUI.b);Common.App.AppsForOffice.g.registerClass("Common.App.AppsForOffice.g");Common.App.AppsForOffice.h.registerClass("Common.App.AppsForOffice.h",Sys.EventArgs);Common.App.AppsForOffice.n.registerClass("Common.App.AppsForOffice.n",Sys.EventArgs);Common.App.AppsForOffice.f.registerClass("Common.App.AppsForOffice.f");Common.App.AppsForOffice.c.registerClass("Common.App.AppsForOffice.c");Common.App.AppsForOffice.b.a=null;Common.App.AppsForOffice.AppsForOfficeDialogManager.b=null;Common.App.AppsForOffice.AppsForOfficeDialogManager.a=new($$sc.v.$$(Common.App.AppsForOffice.g));Common.App.AppsForOffice.a.a=new($$sc.v.$$(Object));Common.App.AppsForOffice.a.b=null;Type.registerNamespace("Common.App.AppsForOfficeCommon");Common.App.AppsForOfficeCommon.D=function(){};Common.App.AppsForOfficeCommon.D.registerInterface("Common.App.AppsForOfficeCommon.D");Common.App.AppsForOfficeCommon.m=function(n,t,i,r){this.e=n;this.d=t;this.c=i;this.f=r;this.b=Common.a.c()?Common.a.c():null};Common.App.AppsForOfficeCommon.m.prototype={e:null,d:null,c:null,f:null,b:null,a:null};Common.App.AppsForOfficeCommon.f=function(n,t,i,r){this.c=n;this.f=t;this.d=i;this.e=r};Common.App.AppsForOfficeCommon.f.prototype={c:null,f:null,d:null,e:null,a:function(){return this.c},b:function(){return this.d}};Common.App.AppsForOfficeCommon.g=function(){this.a={};this.b={}};Common.App.AppsForOfficeCommon.g.prototype={a:null,b:null};Common.App.AppsForOfficeCommon.b=function(){this.a=Common.a.c()};Common.App.AppsForOfficeCommon.b.b=function(){return Common.App.AppsForOfficeCommon.b.a||(Common.App.AppsForOfficeCommon.b.a=new Common.App.AppsForOfficeCommon.b),Common.App.AppsForOfficeCommon.b.a};Common.App.AppsForOfficeCommon.b.prototype={a:null,b:function(n,t,i,r,u,f){this.d(n,t,i,r,u,f)},d:function(n,t,i,r,u,f){var e={},s,o;e.extId=n;e.ComponentType=t;e.ComponentId=i;e.HostProps=r;e.OptionalProps=u;s=this.a.c(2451283737,2,e,null);s===32?(o=Common.bm.a().toString(),u.a.InstanceToken&&(o=u.a.InstanceToken),f.val=new Common.App.AppsForOfficeCommon.m(n,t,i,o),Common.App.AppsForOfficeCommon.b.c[o]=f.val):f.val=new Common.App.AppsForOfficeCommon.m(n,t,i,null);f.val.a=e},c:function(n){var f=null,t=n,i=t.ExtId,s=t.ComponentType,h=t.ComponentId,r=t.HostProps,e=t.OptionalProps,c=new Common.App.AppsForOfficeCommon.f(i.Id,i.StoreId,i.StoreType,i.AppVersion),l=new Common.App.AppsForOfficeCommon.h(r.HostType,r.FormFactor,r.Locale),u=new Common.App.AppsForOfficeCommon.g,o;u.a=e.OptionalProperties;u.b=e.DevProperties;Common.App.AppsForOfficeCommon.b.b().b(c,s,h,l,u,o={val:f});f=o.val}};Common.App.AppsForOfficeCommon.h=function(n,t,i){this.b=n;this.a=t;this.c=i};Common.App.AppsForOfficeCommon.h.prototype={b:null,a:null,c:null};Common.App.AppsForOfficeCommon.g.registerClass("Common.App.AppsForOfficeCommon.g");Common.App.AppsForOfficeCommon.h.registerClass("Common.App.AppsForOfficeCommon.h");Common.App.AppsForOfficeCommon.b.a=null;Common.App.AppsForOfficeCommon.b.c={};Type.registerNamespace("Common.App.WopiIdentity");Common.App.WopiIdentity.a=function(){};Common.App.WopiIdentity.a.prototype={generalException:0,invalidArgument:1,notAllowed:2,apiNotAvailable:3,unresolvedPendingRequest:4,timeout:5,adalTimeout:6,userNotSignedIn:7,userAborted:8,silentSignInFailed:9,invalidResourceUrl:10,invalidGrant:11,connectionLost:12,clientError:13,serverError:14};Common.App.WopiIdentity.a.registerEnum("Common.App.WopiIdentity.a",!1);Common.App.WopiIdentity.j=function(){};Common.App.WopiIdentity.k=function(){};Common.App.WopiIdentity.k.registerInterface("Common.App.WopiIdentity.k");Common.App.WopiIdentity.e=function(){};Common.App.WopiIdentity.e.registerInterface("Common.App.WopiIdentity.e");Common.App.WopiIdentity.l=function(){};Common.App.WopiIdentity.l.registerInterface("Common.App.WopiIdentity.l");Common.App.WopiIdentity.i=function(){};Common.App.WopiIdentity.i.registerInterface("Common.App.WopiIdentity.i");Common.App.WopiIdentity.c=function(){this.e="";this.f="";this.b="";this.a=0;this.d="";this.c=!0};Common.App.WopiIdentity.c.a=function(n){switch(n){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}};Common.App.WopiIdentity.c.prototype={e:null,get_upn:function(){return this.e},set_upn:function(n){return this.e=n,n},f:null,get_userId:function(){return this.f},set_userId:function(n){return this.f=n,n},b:null,get_authority:function(){return this.b},set_authority:function(n){return this.b=n,n},a:0,get_authorityType:function(){return this.a},set_authorityType:function(n){return this.a=n,n},d:null,get_tenantId:function(){return this.d},set_tenantId:function(n){return this.d=n,n},c:!1,get_isAnonymous:function(){return this.c},set_isAnonymous:function(n){return this.c=n,n}};Common.App.WopiIdentity.f=function(){this.b="";this.c="";this.a=""};Common.App.WopiIdentity.f.prototype={b:null,get_displayName:function(){return this.b},set_displayName:function(n){return this.b=n,n},c:null,get_email:function(){return this.c},set_email:function(n){return this.c=n,n},a:null,get_authority:function(){return this.a},set_authority:function(n){return this.a=n,n}};Common.App.WopiIdentity.h=function(n,t,i){this.a=n;this.b=t;this.c=i};Common.App.WopiIdentity.h.prototype={a:null,get_accessToken:function(){return this.a},set_accessToken:function(n){return this.a=n,n},b:null,get_authority:function(){return this.b},set_authority:function(n){return this.b=n,n},c:null,get_expiration:function(){return this.c},set_expiration:function(n){return this.c=n,n}};Common.App.WopiIdentity.m=function(){this.b=resource;this.c=scope;this.d=silentLogin;this.a=options};Common.App.WopiIdentity.m.prototype={b:null,get_resource:function(){return this.b},set_resource:function(n){return this.b=n,n},c:null,get_scope:function(){return this.c},set_scope:function(n){return this.c=n,n},d:!1,get_silentLogin:function(){return this.d},set_silentLogin:function(n){return this.d=n,n},a:null,get_options:function(){return this.a},set_options:function(n){return this.a=n,n}};Common.App.WopiIdentity.d=function(n,t){this.a=Common.App.WopiIdentity.d.T===Number||Type.isEnum(Common.App.WopiIdentity.d.T)?0:Common.App.WopiIdentity.d.T===Boolean?!1:null;this.b=n;this.a=t};Common.App.WopiIdentity.d.$$=function(n){var u=Common.App.WopiIdentity.__tc=Common.App.WopiIdentity.__tc||{},t="d$"+n.getName().replace(/\./g,"_"),i,o,f,e,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.WopiIdentity.d.apply(this,t)};i.registerClass("Common.App.WopiIdentity.__tc."+t);o={"Common.App.WopiIdentity.d":{T:n},ctor:Common.App.WopiIdentity.d};i.prototype.$$gta=o;f=Common.App.WopiIdentity.d.prototype;for(e in f)r={key:e,value:f[e]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.WopiIdentity.d.prototype={b:null,get_requestParameters:function(){return this.b},set_requestParameters:function(n){return this.b=n,n},get_requestCallback:function(){return this.a},set_requestCallback:function(n){return this.a=n,n}};Common.App.WopiIdentity.b=function(n){this.f=Function.createDelegate(this,this.m);this.a={};this.b={};this.e=Common.a.b().d();this.c=n;this.c.c("PostAccessToken");this.c.b("PostAccessToken",this.f)};Common.App.WopiIdentity.b.prototype={c:null,a:null,b:null,e:null,getAccessToken:function(n,t){this.k(n,t);var i=this;return new Promise(function(r,u){var f=Common.a.a.i.PostMessageOrigin;if(Common.k.i(f).toLowerCase().indexOf(".spoppe.com")>-1){u(Common.App.WopiIdentity.a.toString(3));return}if(i.d(t)){if(t in i.a){u(Common.App.WopiIdentity.a.toString(4));return}window.setTimeout(function(){Diag.a.a(37856032,344,10,JSON.stringify({error:"Request timeout.",callerId:t}));u(Common.App.WopiIdentity.a.toString(5));return},12e4);i.h(n,t,function(n,t){n?r(n):(Diag.a.a(37856033,369,10,JSON.stringify({error:Common.App.WopiIdentity.a.toString(t)})),u(t))})}else Diag.a.a(37856034,344,10,JSON.stringify({error:"Caller is not allowed."})),u(Common.App.WopiIdentity.a.toString(2))})},getPrimaryIdentityInfo:function(n){var t=this;return new Promise(function(i,r){t.d(n)?t.j(function(n,t){n?i(n):(Diag.a.a(37856064,369,10,JSON.stringify({error:t.toString()})),r(t))}):(Diag.a.a(37856065,344,10,JSON.stringify({error:"Caller is not allowed."})),r(Common.App.WopiIdentity.a.toString(2)))})},getAuthContext:function(n){var t=this;return new Promise(function(i,r){var u=t.getAuthContextSync(n);u?i(u):r(Common.App.WopiIdentity.a.toString(2))})},getAuthContextSync:function(n){var t,i;return this.d(n)?(t=new Common.App.WopiIdentity.c,t.e=Common.a.a.i.UserPrincipalName,t.f=Common.a.a.i.LoggableUserId,t.b=Common.a.a.i.HostAuthAuthority,t.d=Common.a.a.i.TenantId,t.c=Common.a.a.a("IsAnonymousUser"),i=Common.a.a.i.HostAuthType,t.a=i.toLowerCase()==="aad"?2:i.toLowerCase()==="msa"?1:0,t):(Diag.a.a(40751647,344,10,JSON.stringify({error:"Caller is not allowed."})),null)},h:function(n,t,i){var u=Common.bm.a().a.a,f="getAccessToken_"+u,o=this.e.a("ComponentAttach",f),r,e;this.b[f]=o;r={};e=n.get_options()&&typeof n.get_options()!="undefined"?n.get_options():{};r.SsoRequestId=u;r.SsoResource=n.get_resource();r.SsoScope=n.get_scope();r.SsoSilentLogin=n.get_silentLogin();r.SsoOptions=n.get_options();r.AddinControlId=u;r.AddinApplicationResource=n.get_resource();r.AddinSSOAuthChallenge=e.authChallenge||"";r.AddinIsFirstParty=!0;this.c.a("GetAccessToken",r,"");this.a[u]=new(Common.App.WopiIdentity.d.$$(Function))(n,i)},j:function(n){var r=Common.a.a.i.UserName,u=Common.a.a.i.UserPrincipalName,f=Common.a.a.i.TenantId,i=Common.a.a.i.LoggableUserIdSpace,t=new Common.App.WopiIdentity.f;t.c=u;t.b=r;switch(i){case"OrgIdPuid":t.a="AzureActiveDirectoryAccount";break;case"MsaCid":case"MsaPuid":t.a="MicrosoftAccount";break;default:t.a=i}n(t,null)},m:function(n){var t=null,u,h,e;try{var i=n.Values.SsoRequestId||n.Values.AddinControlId,r=n.Values.SsoAccessToken||n.Values.AccessToken,l=n.Values.SsoAuthority||this.i(n.Values.HostApplicationType),a=n.Values.SsoTokenExpiration||new Date((new Date).getTime()+51e5),o=null,s=null,f=this.a[i];if(typeof f=="undefined"||!f){Diag.a.a(37856066,344,10,JSON.stringify({error:"No matching outstanding request for request ID.",requestId:i}));return}t=f.a;delete this.a[i];typeof r!="undefined"&&r&&r.length?s=new Common.App.WopiIdentity.h(r,l,a):o=Common.App.WopiIdentity.a.toString(this.l(n));u="getAccessToken_"+i;u in this.b&&(h=this.b[u],h.a(),delete this.b[u]);t(s,o)}catch(c){e=n.Values.SsoRequestId||n.Values.AddinControlId;e in this.a&&delete this.a[e];this.g();Diag.a.a(37856067,344,10,JSON.stringify({error:c.message,stack:c.stack}));t&&t(null,Common.App.WopiIdentity.a.toString(0))}},d:function(n){var w=Common.a.bG,h,c,i,r,l,a,u,f,v,y,e,o,p;n=n.toLowerCase();for(var s=w,b=s.length,t=0;t<b;++t)if(h=s[t],n===h.toLowerCase())return!0;c=Common.a.cv;i=c;for(r in i)if(l={key:r,value:i[r]},n===l.value.toLowerCase())return!0;a=Common.a.cw;u=a;for(f in u)if(v={key:f,value:u[f]},n===v.value.toLowerCase())return!0;y=Common.a.cx;e=y;for(o in e)if(p={key:o,value:e[o]},n===p.value.toLowerCase())return!0;return!1},i:function(n){switch(n){case"OneDriveWOPI":return"MicrosoftAccount";case"SharepointOnline":case"ExchangeOnline":default:return"AzureActiveDirectoryAccount"}},l:function(n){var t=n.Values.SsoError||n.Values.AddinSSOError,i=n.Values.HostApplicationType;return this.g(),Diag.a.a(39068821,344,10,JSON.stringify({error:t,wopiHost:i})),t.indexOf("AADSTS50058")>-1?9:t.indexOf("Popup Window is null")>-1||t.indexOf("Popup Window closed")>-1?12:t.indexOf("AADSTS50001")>-1?10:t.indexOf("13002")>-1?8:t.indexOf("AADSTS70011")>-1||t.indexOf("AADSTS65001")>-1?11:t.indexOf("Token renewal operation failed due to timeout")>-1?6:0},k:function(n,t){var i=this.n(n.get_resource());Diag.a.a(39921882,344,50,JSON.stringify({callerId:t,resource:i}))},g:function(){var n=window.navigator.userAgent;Diag.a.a(39068822,344,50,JSON.stringify({userAgent:n}))},n:function(n){return n=n?n:"",n.replace("://","__").replace(new RegExp("\\.","g"),"_dot_").replace("/","\\")}};Common.App.WopiIdentity.g=function(){};Common.App.WopiIdentity.g.a=function(){Common.App.a.a().a(new Common.App.WopiIdentity.g,0,!1)};Common.App.WopiIdentity.g.prototype={a:function(){return"Common.App.WopiIdentity"},c:function(n){var t=this;n.b(Common.App.WopiIdentity.b).c(Common.App.WopiIdentity.e).a().b(function(){return new Common.App.WopiIdentity.b(n.a(Common.Q))})},b:function(){}};Common.App.WopiIdentity.b.registerClass("Common.App.WopiIdentity.b",null,Common.App.WopiIdentity.e);Common.App.WopiIdentity.g.a();Type.registerNamespace("CommandUI.AddInCommands");CommandUI.AddInCommands.bc=function(){};CommandUI.AddInCommands.bl=function(){};CommandUI.AddInCommands.t=function(){};CommandUI.AddInCommands.t.registerInterface("CommandUI.AddInCommands.t");CommandUI.AddInCommands.be=function(){};CommandUI.AddInCommands.u=function(){};CommandUI.AddInCommands.u.registerInterface("CommandUI.AddInCommands.u");CommandUI.AddInCommands.S=function(){};CommandUI.AddInCommands.S.registerInterface("CommandUI.AddInCommands.S");CommandUI.AddInCommands.n=function(){};CommandUI.AddInCommands.n.registerInterface("CommandUI.AddInCommands.n");CommandUI.AddInCommands.R=function(){};CommandUI.AddInCommands.R.registerInterface("CommandUI.AddInCommands.R");CommandUI.AddInCommands.bm=function(){};CommandUI.AddInCommands.bm.registerInterface("CommandUI.AddInCommands.bm");CommandUI.AddInCommands.bj=function(){};CommandUI.AddInCommands.bh=function(){};CommandUI.AddInCommands.bo=function(){};CommandUI.AddInCommands.bo.registerInterface("CommandUI.AddInCommands.bo");CommandUI.AddInCommands.bd=function(){};CommandUI.AddInCommands.bf=function(){};CommandUI.AddInCommands.bg=function(){};CommandUI.AddInCommands.bi=function(){};CommandUI.AddInCommands.bk=function(){};CommandUI.AddInCommands.bn=function(){};CommandUI.AddInCommands.bn.registerInterface("CommandUI.AddInCommands.bn");CommandUI.AddInCommands.br=function(){};CommandUI.AddInCommands.bq=function(){};CommandUI.AddInCommands.bp=function(){};CommandUI.AddInCommands.bu=function(){};CommandUI.AddInCommands.bu.registerInterface("CommandUI.AddInCommands.bu");CommandUI.AddInCommands.bt=function(){};CommandUI.AddInCommands.bs=function(){};CommandUI.AddInCommands.bv=function(){};CommandUI.AddInCommands.z=function(){this.d=Function.createDelegate(this,this.i)};CommandUI.AddInCommands.z.prototype={e:null,f:null,a:function(){return this.e||(this.e=OfficeExt.DefaultControlActionBinder.retrieveActionContext)},b:function(){return this.f||(this.f=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())},c:function(n,t,i,r,u,f,e){var h,o,s;if(Diag.a.a(17138449,220,50,"Control id: {0}.",n),h=r,o=t.g(u.ownerAddinInfo.storeType,u.ownerAddinInfo.assetId),o&&o.a){if(o.a.getIsUpgrading())return;if(s=null,o.a.getNotificationParams().length>0&&(s=this.g(o.a.getNotificationParams()[0])),o.a.getStatus()!==OSF.OsfControlStatus.Activated&&(o.a.getStatus()!==OSF.OsfControlStatus.NotActivated||s&&s.d===OSF.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE))s&&this.h(o,s,e);else try{i.setOwnerAddinEToken(o.a.getEToken());u.action(i,h.a());f&&f()}catch(c){Diag.a.a(17425949,220,10,String.format("HandleAddinCommandsAction error message : {0}.",c.message));CommandUI.AddInCommands.a.g($a.C+" "+$a.D,null)}}},h:function(n,t,i){var r=n.a;if(r.getNotificationParams().length===1||t.h){var f=t.a,u=this,o=function(){var i,e,o;r.removeFirstNotification();r.getNotificationParams().length>0&&(i=u.g(r.getNotificationParams()[0]),u.h(n,i,null));t.d===OSF.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE&&(e=n.b,CommandUI.AddInCommands.g.b(e,r,u.d),o=n.c,CommandUI.AddInCommands.h.a(o,r,u.d));f&&f()},e=t.b,h=this,s=function(){e&&e();i&&i()};t.a=o;t.b=s;CommandUI.AddInCommands.a.h(t)}},i:function(n,t){var i=null,r=this;i=function(){n.getIsUpgrading()?window.setTimeout(i,1e3):n.getUpgradingFailed()?CommandUI.AddInCommands.g.a(t,!0):Common.a.b().e(!1)};window.setTimeout(i,1e3)},g:function(n){var t=new CommandUI.AddInCommands.l;return t.e=n.infoType,t.i=n.id,t.c=n.title,t.f=n.description,t.g=n.buttonTxt,t.a=n.buttonCallback,t.h=n.highPriority,t.b=n.dismissCallback,t.d=n.errorCode,t.j=n.iframeNotificationUrl,t}};CommandUI.AddInCommands.r=function(){};CommandUI.AddInCommands.r.a=function(n){var t=new CommandUI.AddInCommands.J;return t.a=n.a,t.b=t.a?!0:!1,t};CommandUI.AddInCommands.r.b=function(n,t,i,r,u){var f=document.getElementById(i);if(!f){Diag.a.a(17662423,220,100,String.format("{0} element is not availiable",i));return}n.a===$a.e?CommandUI.AddInCommands.a.m(t,f,r,u):n.a===$a.B&&CommandUI.AddInCommands.a.p(t,f,$a.dz,$a.B)};CommandUI.AddInCommands.U=function(n,t,i,r,u,f,e){this.n=new Common.T;this.e=n;this.i=t;this.g=i;this.h=r;this.d=u;this.m=f;this.f=e};CommandUI.AddInCommands.U.prototype={e:null,i:null,g:null,h:null,d:null,m:null,f:null,a:function(n){this.n.l("ack7",n)},b:function(n,t,i){var u=i.ack2,r=isUndefined(i.ack0)?0:i.ack0;if(!u||!r){Diag.a.a(17638115,220,10,String.format("{0}: parameters are invalid for LaunchAddinCommands.",this.e.a()));this.k(new CommandUI.AddInCommands.f(r,null,null,n,t,null,!0));return}if(u.e.length<=0&&r!==4){this.l(new CommandUI.AddInCommands.f(r,null,null,n,t,null,!0));return}var e=u.e.length,o=new CommandUI.AddInCommands.x(new CommandUI.AddInCommands.g(n)),c=isUndefined(i.ack1)?-1:i.ack1,l=new CommandUI.AddInCommands.p(r,this.g,this.e,o,this.i,this.d,this.f),f=this,a=function(n){return f.h.c(n.assetId,f.f,f.e)},v=this,y=function(n){return v.h.a(n.assetId)},s=this,p=function(i,u,f,h){e--;var c=new CommandUI.AddInCommands.f(r,u,o,n,t,h,e<=0);i&&u?s.l(c):s.k(c)},h=this,w=function(){h.j(null);u.e.length<=0&&r===4&&h.d.h()};l.k(u,a,y,c,p,w)},c:function(n,t,i){var u=i.ack2,r=isUndefined(i.ack0)?0:i.ack0;if(!u||!r){Diag.a.a(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.e.a()));this.k(new CommandUI.AddInCommands.f(r,null,null,null,t,null,!0));return}if(u.e.length<=0&&r!==4){this.l(new CommandUI.AddInCommands.f(r,null,null,null,t,null,!0));return}var e=u.e.length,o=new CommandUI.AddInCommands.x(new CommandUI.AddInCommands.W),c=isUndefined(i.ack1)?-1:i.ack1,l=new CommandUI.AddInCommands.p(r,this.g,this.e,o,this.i,this.d,this.f),f=this,a=function(t){return f.h.b(t.assetId,f.f,f.e,n)},v=this,y=function(n){return v.h.a(n.assetId)},s=this,p=function(n,i,u,f){e--;var h=new CommandUI.AddInCommands.f(r,i,o,null,t,f,e<=0);n&&i?s.l(h):s.k(h)},h=this,w=function(){h.j(null);u.e.length<=0&&r===4&&h.d.h()};l.k(u,a,y,c,p,w)},k:function(n){this.j(null);this.o(!1,n)},l:function(n){var t=n.a,i;this.j(t);t&&(CommandUI.AddInCommands.d.b().a(CommandUI.AddInCommands.j.b(t.currentStoreType.toLowerCase()),!0),t.currentStoreType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog&&(i=this.m.a(t.currentStoreType.toLowerCase(),this.g),i&&i.localCacheAddinCommands(this.g.a(),t.id,t.appVersion,t.storeId)),this.p(n.b.c,t.currentStoreType,n.c,n.d),Common.br.a("ak4","true",CommandUI.AddInCommands.j.b(t.currentStoreType.toLowerCase())));this.o(!0,n)},o:function(n,t){var r,i;n?t.c!==3?t.e&&this.d.h():t.b&&t.b.c&&(r=$$as(CommandUI.h,t.d),t.a.currentStoreType!==OSF.StoreType.HardCodedPreinstall&&CommandUI.AddInCommands.a.o(r,t.g,t.f,t.b.c)):t.c===3?t.a&&t.a.currentStoreType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog?(i=this.f.b(t.a.assetId),CommandUI.AddInCommands.a.g(i?i:$a.C+" "+$a.D,null)):this.d.j(!0,!1):t.e&&this.d.h()},j:function(n){var i=new CommandUI.AddInCommands.T,t;i.a=n;n&&(t=this.d.g(n.currentStoreType,n.assetId),t&&t.b&&(i.b=t.b));this.n.k("ack7",i,null)},p:function(n,t,i,r){var u=$$as(CommandUI.h,r),e,f;n&&u&&(e=n.a().a(0),f=e.a().Id,i===3&&t!==OSF.StoreType.HardCodedPreinstall&&u.D(f,!1),u.ft(f)&&u.fA())}};CommandUI.AddInCommands.T=function(){CommandUI.AddInCommands.T.initializeBase(this)};CommandUI.AddInCommands.T.prototype={a:null,b:null};CommandUI.AddInCommands.f=function(n,t,i,r,u,f,e){this.c=n;this.a=t;this.b=i;this.d=r;this.g=u;this.f=f;this.e=e};CommandUI.AddInCommands.f.prototype={c:0,a:null,b:null,d:null,g:null,f:null,e:!1};CommandUI.AddInCommands.x=function(n){this.d=n};CommandUI.AddInCommands.x.prototype={d:null,c:null,a:function(n){this.d.a(n);this.c=n},b:function(n){this.d.b(n)}};CommandUI.AddInCommands.E=function(){};CommandUI.AddInCommands.E.prototype={a:null,setErrorMessageForAddin:function(n,t){this.a||(this.a={});this.a[n]=t},b:function(n){return this.a&&n in this.a?this.a[n]:null}};CommandUI.AddInCommands.l=function(){};CommandUI.AddInCommands.l.prototype={e:0,i:null,c:null,f:null,g:null,a:null,d:0,h:!1,b:null,j:null};CommandUI.AddInCommands.q=function(){};CommandUI.AddInCommands.q.prototype={a:null,b:null,c:null,d:null,e:function(n,t){return this.a.getStoreType().toLowerCase()===n.toLowerCase()&&this.a.getMarketplaceID().toLowerCase()===t.toLowerCase()}};CommandUI.AddInCommands.AddinCommandsUILessDialog=function(){this.b=this.i;this.c=this.initializeAndShowWithTitle;CommandUI.AddInCommands.AddinCommandsUILessDialog.initializeBase(this,[!1,!1,!1,!0]);this.m=this.bb;this.g(5);this.e=String.format("{0}px",this.Z);this.d=String.format("{0}px",this.R);this.I=!1;this.cy=!1;this.E()};CommandUI.AddInCommands.AddinCommandsUILessDialog.prototype={bb:"AddinCommandsUILessDialog",bc:"WACDialogTitleText",ba:"0",e:null,d:null,Z:380,R:190,E:function(){CommonUI.b.prototype.E.call(this);this.v.style.width=this.e;this.v.style.height=this.d;this.v.style.padding=this.ba},u:function(n){this.A();var t=document.getElementById(this.n+this.bc);t.innerText=n},A:function(){CommonUI.b.prototype.A.call(this);this.f.style.width=String.format("{0}px",this.Z);this.f.style.height=String.format("{0}px",this.R);this.f.removeAttribute("role");this.f.removeAttribute("aria-labelledby")},i:function(){this.dn()},a:function(){return this.v},initializeAndShowWithTitle:function(){this.j($a.ec,null,null)}};CommandUI.AddInCommands.I=function(){};CommandUI.AddInCommands.I.a=function(n){var t={};return t.id=n.assetId,t.assetId=n.assetId,t.appVersion=n.appVersion,t.currentStoreType=n.storeType,t.storeId=n.storeId,t.assetStoreId=n.storeType,t.targetType=n.targetType,t.isAddinCommands=!0,t};CommandUI.AddInCommands.J=function(){};CommandUI.AddInCommands.J.prototype={a:null,b:!1};CommandUI.AddInCommands.j=function(){};CommandUI.AddInCommands.j.a=function(n){var t=null;switch(n){case 0:t=OSF.StoreType.OMEX;break;case 1:t=OSF.StoreType.SPCatalog;break;case 2:t=OSF.StoreType.SPApp;break;case 3:t=OSF.StoreType.FileSystem;break;case 4:t=OSF.StoreType.Exchange;break;case 6:t=OSF.StoreType.Registry;break;case 7:t=OSF.StoreType.InMemory;break;case 8:t=OSF.StoreType.UploadFileDevCatalog;break;case 9:t=OSF.StoreType.HardCodedPreinstall;break;case 10:t=OSF.StoreType.PrivateCatalog}return t};CommandUI.AddInCommands.j.b=function(n){var t=-1;switch(n.toLowerCase()){case"omex":t=0;break;case"spcatalog":t=1;break;case"spapp":t=2;break;case"filesystem":t=3;break;case"exchange":t=4;break;case"registry":t=6;break;case"inmemory":t=7;break;case"uploadfiledevcatalog":t=8;break;case"hardcodedpreinstall":t=9;break;case"excatalog":t=10}return t};CommandUI.AddInCommands.c=function(){};CommandUI.AddInCommands.c.e=function(n){var i=new($$sc.u.$$(String)),e,t,s;if(CommandUI.AddInCommands.c.a)for(var f=CommandUI.AddInCommands.c.a,h=f.length,r=0;r<h;++r)e=f[r],i.b(e);t=null;switch(n){case"Workbook":t=CommandUI.AddInCommands.c.d;break;case"Document":t=CommandUI.AddInCommands.c.b;break;case"Presentation":t=CommandUI.AddInCommands.c.c}if(t)for(var o=t,c=o.length,u=0;u<c;++u)s=o[u],i.b(s);return i};CommandUI.AddInCommands.y=function(n){this.b=n;this.a().Id=this.b};CommandUI.AddInCommands.y.prototype={b:null,i:null,g:null,h:null,d:!1,f:null,e:null,a:function(){return this.i||(this.i={})},c:function(){return this.g||(this.g=new($$sc.u.$$(CommandUI.AddInCommands.s)))},j:function(){return this.h||(this.h=new($$sc.u.$$(CommandUI.AddInCommands.o)))},l:function(){for(var t=new($$sc.u.$$(String)),i=new($$sc.u.$$(String)),r=this.j().$$lge(),u,n,f,e,o;r.$$mn();)u=r.$$cu(),t.b(u.d());for(n=this.c().$$lge();n.$$mn();)f=n.$$cu(),i.b(f.h());return e=this.k("Groups",this.e,i.f()),o=this.k("Scaling",this.f,t.f()),Common.u.f("Tab",this.a(),o,e)},k:function(n,t,i){var r={};return r.Id=t,Common.u.f.apply(null,[n,r].concat(i))}};CommandUI.AddInCommands.s=function(n){if(CommandUI.a.a(n)){Diag.a.a(9041811,220,10,"GroupDefinition id should not be null or undefined.");throw Error.create("GroupDefinition id should not be null or undefined");}this.e=n;this.a().Id=this.e};CommandUI.AddInCommands.s.prototype={e:null,f:null,d:null,c:null,g:function(n){return this.f=n,this.a().Template=this.f,n},a:function(){return this.d||(this.d={})},b:function(){return this.c||(this.c=new($$sc.u.$$(CommandUI.AddInCommands.u)))},h:function(){for(var n=new($$sc.u.$$(String)),t=this.b().$$lge(),i,r;t.$$mn();)i=t.$$cu(),n.b(i.c());return r=Common.u.f.apply(null,["Controls",null].concat(n.f())),Common.u.f("Group",this.a(),r)}};CommandUI.AddInCommands.o=function(n){if(CommandUI.a.a(n)){Diag.a.a(9041813,220,10,"ScalingDefinition type should not be null or undefined.");throw Error.create("ScalingDefinition type should not be null or undefined");}this.c=n};CommandUI.AddInCommands.o.prototype={c:null,b:null,a:function(){return this.b||(this.b={})},d:function(){return Common.u.j(this.c,null,this.a())}};CommandUI.AddInCommands.i=function(n,t){if(CommandUI.a.a(n)||CommandUI.a.a(t)){Diag.a.a(9175312,220,10,"ControlDefinition id or type should not be null or undefined.");throw Error.create("ControlDefinition id or type should not be null or undefined");}this.g=t;this.e=n;this.a().Id=this.e};CommandUI.AddInCommands.i.prototype={e:null,g:null,f:null,d:null,a:function(){return this.f||(this.f={})},b:function(){return this.d||(this.d=new($$sc.u.$$(CommandUI.AddInCommands.S)))},c:function(){return Common.u.j(this.g,this.h(),this.a())},h:function(){var n=null,t,i;if(this.d){for(n=new Sys.StringBuilder('<Menu><MenuSection DisplayMode="Menu16"><Controls>'),t=this.d.$$lge();t.$$mn();)i=t.$$cu(),n.append(i.b());n.append("<\/Controls><\/MenuSection><\/Menu>")}return n?n.toString():""}};CommandUI.AddInCommands.v=function(n){if(CommandUI.a.a(n)){Diag.a.a(9175313,220,10,"MenuItemDefinition id should not be null or undefined.");throw Error.create("MenuItemDefinition id should not be null or undefined");}this.c=n;this.a().Id=this.c};CommandUI.AddInCommands.v.prototype={c:null,d:null,a:function(){return this.d||(this.d={})},b:function(){return Common.u.j("Button",null,this.d)}};CommandUI.AddInCommands.w=function(n){if(CommandUI.a.a(n)){Diag.a.a(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined.");throw Error.create("OfficeMenuDefinition id should not be null or undefined");}this.d=n};CommandUI.AddInCommands.w.prototype={d:null,c:null,b:function(){return this.d},a:function(){return this.c||(this.c=new($$sc.u.$$(CommandUI.AddInCommands.u)))}};CommandUI.AddInCommands.K=function(n){if(CommandUI.a.a(n)){Diag.a.a(9175315,220,10,"The agave key should not be null or undefined.");throw Error.create("The agave key should not be null or undefined");}this.c=n};CommandUI.AddInCommands.K.prototype={c:null,d:null,a:function(){return this.d||(this.d=new($$sc.u.$$(CommandUI.AddInCommands.n)))},b:function(){return this.c}};CommandUI.AddInCommands.k=function(n,t,i){this.a=n;this.b=t;this.c=i};CommandUI.AddInCommands.k.a=function(n){var i=n.c(),t;return i?(t=new Common.AddInDataTransferObject,t.tabs=i.a.f(),t.id=i.b,t.title=i.c,t):null};CommandUI.AddInCommands.k.prototype={a:null,b:null,c:null};CommandUI.AddInCommands.X=function(n,t,i,r){if(CommandUI.a.a(n)&&CommandUI.a.a(t)){Diag.a.a(9041814,220,10,"One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined.");throw Error.create("One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined.");}this.f=n;this.g=t;this.i=i;this.h=r};CommandUI.AddInCommands.X.prototype={g:null,f:null,i:null,h:null,a:function(){return this.f},c:function(){return this.g},b:function(){return this.i},d:function(){for(var n=new Sys.StringBuilder,t=this.f.$$lge(),i;t.$$mn();)i=t.$$cu(),n.append(i.l());return this.j(n.toString())},e:function(){return this.h},j:function(n){var t=new Sys.StringBuilder;return t.append("<Ribbon><Tabs>"),t.append(n),t.append("<\/Tabs><\/Ribbon>"),t.toString()}};CommandUI.AddInCommands.h=function(){this.d=new($$sc.u.$$(CommandUI.AddInCommands.R))};CommandUI.AddInCommands.h.a=function(n,t,i){var r=CommandUI.AddInCommands.h.b(n);r.length>0&&(CommandUI.AddInCommands.h.c(r,!1),i&&i(t,r))};CommandUI.AddInCommands.h.b=function(n){var e=[],r,t,u,i,f,o;if(n&&n.a()&&n.a().e.length>0)for(r=n.a().$$lge();r.$$mn();)if(t=r.$$cu(),t.a()&&t.a().e.length>0)for(u=t.a().$$lge();u.$$mn();)if(i=u.$$cu(),i.b()&&i.b().e.length>0)for(f=i.b().$$lge();f.$$mn();)o=f.$$cu(),Array.add(e,o.c||"");return e};CommandUI.AddInCommands.h.c=function(n,t){var u,f;if(n.length)for(var r=n,e=r.length,i=0;i<e;++i)u=r[i],f=document.querySelector('[id^="'+u+'"]'),CommandUI.b.i(f,t,!1,!1)};CommandUI.AddInCommands.h.prototype={d:null,a:function(n){var t,i,f,r,u;for(Diag.a.a(17306645,220,50,"Context menu id: {0}",n),t=new($$sc.u.$$(CommandUI.AddInCommands.n)),i=this.d.$$lge();i.$$mn();)for(f=i.$$cu(),r=f.a().$$lge();r.$$mn();)u=r.$$cu(),u.b()===n&&t.b(u);return t},b:function(n){this.d.b(n)},c:function(n){for(var i=this.d.$$lge(),t;i.$$mn();)if(t=i.$$cu(),t.b()===n.b()){this.d.d(t);break}}};CommandUI.AddInCommands.W=function(){};CommandUI.AddInCommands.W.prototype={a:function(n){var t=CommandUI.AddInCommands.k.a(n);t&&appChrome.addInApi.dispatchActionsToInstallAddIn(t)},b:function(n){var t=CommandUI.AddInCommands.k.a(n);t&&appChrome.addInApi.dispatchActionsToRemoveAddIn(t)}};CommandUI.AddInCommands.g=function(n){this.c=new CommandUI.bM(n)};CommandUI.AddInCommands.g.b=function(n,t,i){var r=CommandUI.AddInCommands.g.c(n);r.length>0&&(CommandUI.AddInCommands.g.a(r,!1),i&&i(t,r))};CommandUI.AddInCommands.g.c=function(n){var u=[],t,f,e,o,s,h,v,c,i,r,w;if(n)if(t=n.c(),t){if(t.a&&t.a.e.length>0)for(c=t.a.$$lge();c.$$mn();)if(i=c.$$cu(),i.groups&&i.groups.length>0)for(var y=i.groups,b=y.length,l=0;l<b;++l)if(r=y[l],r.controls&&r.controls.length>0)for(var p=r.controls,k=p.length,a=0;a<k;++a)w=p[a],Array.add(u,w.id)}else if(n.a()&&n.a().e.length>0)for(f=n.a().$$lge();f.$$mn();)if(e=f.$$cu(),e.c().e.length>0)for(o=e.c().$$lge();o.$$mn();)if(s=o.$$cu(),s.b().e.length>0)for(h=s.b().$$lge();h.$$mn();)v=h.$$cu(),Array.add(u,v.e||"");return u};CommandUI.AddInCommands.g.a=function(n,t){var u,f;if(n.length)for(var r=n,e=r.length,i=0;i<e;++i)u=r[i],f=document.querySelector('[id^="'+u+'"]'),CommandUI.b.i(f,t,!1,!1)};CommandUI.AddInCommands.g.prototype={c:null,a:function(n){var t=n.d();this.c.c(t,n.e())},b:function(n){var t=n.d();this.c.f(t)}};CommandUI.AddInCommands.d=function(){this.b=new Common.App.AppsForOfficeCommon.e(Common.Utils.c.a())};CommandUI.AddInCommands.d.b=function(){return CommandUI.AddInCommands.d.a||(CommandUI.AddInCommands.d.a=new CommandUI.AddInCommands.d),CommandUI.AddInCommands.d.a};CommandUI.AddInCommands.d.prototype={b:null,a:function(n,t){var i=Common.du.b()+n;Common.Utils.c.a().a(i,t.toString())}};CommandUI.AddInCommands.D=function(n){CommandUI.AddInCommands.D.initializeBase(this);this.a=n};CommandUI.AddInCommands.D.prototype={a:null};CommandUI.AddInCommands.F=function(n,t,i){this.e=new Common.T;this.a=new CommandUI.AddInCommands.G;this.b=n;this.d=t;this.c=i};CommandUI.AddInCommands.F.prototype={b:null,d:null,c:null,g:function(n){this.e.l("ack4",n)},i:function(n){var t,i;null!==n&&(this.a.a=n.ack1,this.a.b=n.ack0,this.a.f=this.a.e=0,t="ak0"in n?n.ak0:0,this.a.a!==-1&&this.a.b&&t>0&&(this.a.c=new CommandUI.F,this.a.d=this.d.a(CommandUI.AddInCommands.j.a(this.a.a),this.b),this.a.d?(i=this,this.a.d.getEntitlementsAsync(this.b.a(),!0,t,function(n){i.h(n)})):Diag.a.a(17638145,220,10,"Create AddinDataProvider fails for {0}",this.a.a)))},h:function(n){var r,u,t,i,f;if((this.a.a||this.a.b!==2)&&(this.a.a!==10||this.a.b!==5)||Common.br.a("ak4","false",this.a.a),r=n,r&&r.length>0)for(this.a.f=r.length,u=0;u<r.length;u++)t=r[u],t&&(t.targetType===OSF.OsfControlTarget.TaskPane||t.targetType===OSF.OsfControlTarget.Undefined)?(i={},i.marketplaceId=t.assetId,i.marketplaceVersion=t.appVersion,i.storeType=t.storeType,i.storeId=t.storeId,i.targetData=t,f=this,this.b.c(i,function(n,t,i){n?t&&f.a.c.e(i.targetData):Diag.a.a(17638146,220,10,"Checking AddinCommands fails for {0} from {1}",i.targetData.id,i.targetData.currentStoreType);f.f()})):this.f();else this.f()},f:function(){var t,i,r,n;if(this.a.e++,this.a.e>=this.a.f){if(this.c.a(this.a.a,!1),t=new($$sc.u.$$(Object)),this.a.c)for(i=this.a.c.getEnumerator();i.moveNext();)r=i.get_current(),t.b(CommandUI.AddInCommands.I.a(r));n={ack2:t};n.ack1=this.a.a;n.ack0=this.a.b;this.e.k("ack4",new CommandUI.AddInCommands.D(n),this)}}};CommandUI.AddInCommands.G=function(){};CommandUI.AddInCommands.G.prototype={a:0,b:0,d:null,f:0,e:0,c:null};CommandUI.AddInCommands.p=function(n,t,i,r,u,f,e){this.i=new($$sc.v.$$(DiagUse.a));this.b=n;this.e=t;this.a=i;this.g=r;this.f=u;this.c=f;this.d=e;this.h=Common.a.b().d()};CommandUI.AddInCommands.p.prototype={e:null,a:null,g:null,f:null,c:null,b:0,d:null,h:null,k:function(n,t,i,r,u,f){var h=this,c=function(n,t,i,r){u(n,t,i,r);var e=Common.cd.toString(h.b)+t.assetId,f,o,s;(s=h.i.e(e,o={val:f}),f=o.val,s)&&(f.a(),f=null,h.i.d(e))},s=n,l,v,e,a,y,o,p;if(this.b&&s)for(Diag.a.a(17326351,220,50,"Addin count {0}.",s.e.length),this.b===4&&(Diag.a.a(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",r)),this.l(s,r),f()),l=s.$$lge();l.$$mn();)if(v=l.$$cu(),e=v,Diag.a.a(17638144,220,50,String.format("{0}: Install addin {1}",this.a.a(),e.assetId)),this.p(e))try{this.h&&(a=Common.cd.toString(this.b)+e.assetId,y=this.h.a("ComponentAttach",a),this.i.c(a,y));o=this.c.g(e.currentStoreType,e.id);o&&(this.j(o),o.a.purge(!1));p=this.e.b(this.o(e,t,i,c));o&&this.e.d(e.assetId,e.currentStoreType)}catch(w){Diag.a.a(17388185,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.a.a(),e.assetId,e.appVersion,e.currentStoreType,e.storeId,w.message));c(!1,e,null,null)}else c(!1,e,null,null)},n:function(n,t,i,r,u,f){if(f)if(f._isAddinCommandsManifest(this.a.a())){var e=!0;try{this.m(n,t,i,u,f)}catch(o){e=!1;Diag.a.a(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.a.a(),n.assetId,n.appVersion,n.currentStoreType,n.storeId,o.message))}r(e,n,f,f.getDefaultDisplayName())}else Diag.a.a(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.a.a(),n.assetId,n.appVersion,n.currentStoreType,n.storeId)),r(!1,n,null,null);else Diag.a.a(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.a.a(),n.assetId,n.appVersion,n.currentStoreType,n.storeId)),r(!1,n,null,null)},o:function(n,t,i,r){var f=this,o=function(u,e){var o=f.c.g(n.currentStoreType,n.id);o&&f.j(o);f.n(n,t,i,r,u,e)},u={},e=document.createElement("div");return e.setAttribute("visible","false"),u.div=e,u.id=n.id,u.marketplaceID=n.id,u.marketplaceVersion=n.appVersion,u.store=n.storeId,u.storeType=n.currentStoreType,u.osfControlType=n.targetType,u.isvirtualOsfControl=!0,u.virtualOsfControlActivationCallback=o,u.reason=this.b===3?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened,u},m:function(n,t,i,r,u){var f={},l,o,s;f.storeType=r.getStoreType();f.storeId=r.getStoreLocator();f.assetId=r.getMarketplaceID();f.appVersion=r.getMarketplaceVersion();f.targetType=r.getOsfControlType();var a=new OfficeExt.Parser.AddinCommandsManifestParser(this.a.a(),this.a.c()),v=a.parseExtensions(f,u,this.d),h=CommandUI.AddInCommands.c.e(this.a.a());if(h&&h.e.length>0){for(var y=t(n),p=i(n),w=!!Common.a.a&&Common.a.a.a("AddinCommandsMultipleCustomTabsEnabled"),e=new CommandUI.AddInCommands.A(y,null,p),c=h.$$lge();c.$$mn();)l=c.$$cu(),e.commandSurface=l,v.apply(e,this.d,w);o=e.f(n.id,u.getDefaultDisplayName());s=e.d(null);o&&this.g.a(o);s&&this.f.b(s);this.c.l(r,o,s,u.getDefaultDisplayName());Diag.a.a(17326353,220,100,"Add-in name: {0}.",u.getDefaultDisplayName())}},j:function(n){n.b&&this.g.b(n.b);n.c&&this.f.c(n.c);this.c.n(n.a.getStoreType(),n.a.getMarketplaceID())},l:function(n,t){for(var s=CommandUI.AddInCommands.j.a(t),e=this.c.b.$$lge(),i,u,f,o,r;e.$$mn();)if(i=e.$$cu(),i.a.getStoreType()===s){for(u=!0,f=n.$$lge();f.$$mn();)if(o=f.$$cu(),r=o,r&&i.e(r.currentStoreType,r.id)){u=!1;break}u&&(this.j(i),i.a.purge(!1))}},p:function(n){return!!n&&!!n.currentStoreType&&!!n.storeId&&!!n.id&&!!n.appVersion}};CommandUI.AddInCommands.a=function(){};CommandUI.AddInCommands.a.j=function(){return CommandUI.AddInCommands.a.c||(CommandUI.AddInCommands.a.c=Common.Utils.a.a().d(Common.Utils.f))};CommandUI.AddInCommands.a.d=function(n,t,i,r,u,f){CommandUI.AddInCommands.a.a&&CommandUI.AddInCommands.a.a.b()&&CommandUI.AddInCommands.a.a.a();CommandUI.AddInCommands.a.a=CommonUI.w.a(t,n,n,u,null);CommandUI.AddInCommands.a.a.e(i);CommandUI.a.b(r)||(CommandUI.AddInCommands.a.a.g(r),CommandUI.AddInCommands.a.a.f(!0));var e=new Sys.UI.Bounds(0,0,Common.m.f(),Common.m.j());CommandUI.AddInCommands.a.a.d(CommandUI.AddInCommands.a.l(e,t,CommandUI.AddInCommands.a.a.c(),f));CommandUI.AddInCommands.a.a.h();CommandUI.AddInCommands.a.j()&&CommandUI.AddInCommands.a.j().b(i.innerText,!0)};CommandUI.AddInCommands.a.e=function(n,t,i,r){Common.UISurfaces.c().then(function(u){var h=null,e,f,c,o,s,l;return CommandUI.AddInCommands.a.b&&(u.removeNotification(CommandUI.AddInCommands.a.b),CommandUI.AddInCommands.a.b=null),c=u.callout((f=new Common.cN,f.target=n,f.title=t,f.content=i,f.showCloseIcon=!0,f.calloutProps=(e=new Common.dm,e.onDismiss=function(){u.removeNotification(h)},e.directionalHint=r!=null?r:null,e),f)),l=(s=new Common.cT,s.expirationOptions=(o=new Common.ej,o.displayTimeoutSeconds=7,o.onExpire=function(){u.removeNotification(CommandUI.AddInCommands.a.b)},o),s),h=CommandUI.AddInCommands.a.b=u.addNotification(c,l),null},function(n){return Diag.a.a(593598289,383,15,"Failed to GetNotificationsAPIAsync: {0}",n),null})};CommandUI.AddInCommands.a.g=function(n,t){CommandUI.AddInCommands.a.a&&CommandUI.AddInCommands.a.a.b()&&CommandUI.AddInCommands.a.a.a();var i=new CommonUI.d;i.ba=!1;i.g(0);i.e(27,$a.d,CommandUI.a.b(n)?CommandUI.AddInCommands.a.k():n,t)};CommandUI.AddInCommands.a.h=function(n){CommandUI.AddInCommands.a.a&&CommandUI.AddInCommands.a.a.b()&&CommandUI.AddInCommands.a.a.a();Diag.a.a(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",n.d));var r=CommandUI.a.b(n.f)?CommandUI.AddInCommands.a.k():n.f,t=new CommonUI.d,i=null;n.a?(t.g(1),t.h(1,n.g),t.H=1):t.g(0);i=function(t){t===1?n.a():n.b&&n.b()};t.ba=!1;n.e===OSF.InfoType.Error?t.e(n.d,n.c?n.c:$a.d,r,i):n.e===OSF.InfoType.Warning?t.bU(n.c?n.c:$a.m,r,i):t.bm(n.c?n.c:$a.h,r,i)};CommandUI.AddInCommands.a.l=function(n,t,i,r){var u=r?4:0,f=t.x-n.x,e=n.x+n.width-t.x-t.width;return f+t.width/2<=i/2?u=r?5:2:e+t.width/2<=i/2&&(u=r?6:3),u};CommandUI.AddInCommands.a.n=function(n,t,i,r,u){var e,f;if(CommandUI.AddInCommands.a.f()){e=CommandUI.AddInCommands.k.a(r);e&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(e,function(n){n&&CommandUI.AddInCommands.a.e(n,u,i,5)});return}if(!n){Diag.a.a(594830283,220,50,"ribbonRoot is null, preventing finding the tab or group to which the callout should point.");return}if(!r||!r.a().e.length){Diag.a.a(17326355,220,50,"There is no tab or group added to ribbon !");return}var o=r.a().a(0),s=o.a().Id,h=o.c().a(0).a().Id;n.D(s,!1)&&(f=o.d?n.w(s,h):n.x(s),f&&(f.x+f.width/2>Common.m.f()&&(f=new Sys.UI.Bounds(Common.m.f(),f.y+f.height,0,0)),CommandUI.AddInCommands.a.d(t,f,CommandUI.AddInCommands.a.i(i),u,2,0)))};CommandUI.AddInCommands.a.o=function(n,t,i,r){CommandUI.AddInCommands.a.n(n,t,r.b()?r.b().description:String.format($a.dM,i),r,r.b()?r.b().title:String.format($a.dN,i))};CommandUI.AddInCommands.a.m=function(n,t,i,r){var o,f,e,u;if(CommandUI.AddInCommands.a.f()){o=String.format($a.ba,String.format($a.Z,i,r,$a.be));CommandUI.AddInCommands.a.e(t,o,$a.e,1);return}var c=Common.g.b(t),s=$a.ba.split("{0}"),h=document.createElement("span");h.innerText=s[0];f=document.createElement("span");f.innerText=String.format($a.Z,i,r,$a.be);f.className="UIFontBold";e=document.createElement("span");e.innerText=s[1];u=document.createElement("div");Sys.UI.DomElement.addCssClass(u,"ModalCalloutControl");u.appendChild(h);u.appendChild(f);u.appendChild(e);CommandUI.AddInCommands.a.d(n,c,u,$a.e,3,1)};CommandUI.AddInCommands.a.p=function(n,t,i,r){if(CommandUI.AddInCommands.a.f()){CommandUI.AddInCommands.a.e(t,i,r,null);return}var u=Common.g.b(t);CommandUI.AddInCommands.a.d(n,u,CommandUI.AddInCommands.a.i(r),i,3,1)};CommandUI.AddInCommands.a.i=function(n){var t=document.createElement("div");return Sys.UI.DomElement.addCssClass(t,"ModalCalloutControl"),t.innerText=n,t};CommandUI.AddInCommands.a.k=function(){return $a.C+" "+$a.D};CommandUI.AddInCommands.a.f=function(){return Common.a.b().a().b()&&Common.a.b().a().g()};CommandUI.AddInCommands.A=function(n,t,i){this.ribbonBuilder=n;this.eventBuilder=t;this.contextMenuBuilder=i};CommandUI.AddInCommands.A.prototype={commandSurface:null,actionBuilder:null,ribbonBuilder:null,contextMenuBuilder:null,eventBuilder:null,a:null,c:function(n){return new CommandUI.AddInCommands.B(n)},b:function(n,t){return OfficeExt.DefaultControlActionBinder.createActionBuilder(n,t.entitlement,t.manifest)},startApplyAddin:function(n){this.a=n;var t=this.c(n);this.actionBuilder=this.b(t,n)},endApplyAddin:function(){},f:function(n,t){return this.ribbonBuilder.b()&&this.ribbonBuilder.b().e.length>0||this.ribbonBuilder.a()&&this.ribbonBuilder.a().e.length>0?new CommandUI.AddInCommands.X(this.ribbonBuilder.b(),this.e(n,t),this.a.startedNode,this.ribbonBuilder.c().g()):null},d:function(n){var t,i,r;if(this.contextMenuBuilder.a()&&this.contextMenuBuilder.a().e.length>0){for(n||(n=this.a.entitlement.assetId),t=new CommandUI.AddInCommands.K(n),i=this.contextMenuBuilder.a().$$lge();i.$$mn();)r=i.$$cu(),t.a().b(r);return t}return null},e:function(n,t){return this.ribbonBuilder.a()&&this.ribbonBuilder.a().e.length>0?new CommandUI.AddInCommands.k(this.ribbonBuilder.a(),n,t):null}};CommandUI.AddInCommands.B=function(n){this.a=n.entitlement};CommandUI.AddInCommands.B.prototype={a:null,createActionContext:function(n,t){var i={};return i.ownerAddinInfo=this.a,i.action=t,i}};CommandUI.AddInCommands.ba=function(){};CommandUI.AddInCommands.C=function(n){CommandUI.AddInCommands.C.initializeBase(this,[!1,!1,!1,!1]);this.m=this.ba;this.g(5);this.R=695;this.e=438;this.d="100%";this.a="408px";this.b="15px";this.c="0";this.Z=n};CommandUI.AddInCommands.C.prototype={R:0,e:0,d:null,a:null,b:null,c:null,Z:null,ba:"AddInCommandsDialog",E:function(){CommonUI.b.prototype.E.call(this);this.v.style.width=this.d;this.v.style.height=this.a;this.v.style.marginTop=this.b;this.v.style.padding=this.c},A:function(){CommonUI.b.prototype.A.call(this);this.f.style.width=String.format("{0}px",this.R);this.f.style.height=String.format("{0}px",this.e)},dispose:function(){CommonUI.b.prototype.dispose.call(this);this.Z()}};CommandUI.AddInCommands.L=function(n,t,i){this.g=n;this.f=t;this.e=i;this.d=new($$sc.u.$$(CommandUI.AddInCommands.n))};CommandUI.AddInCommands.L.prototype={c:null,b:null,g:null,f:null,e:null,addButton:function(n){Diag.a.a(17085952,220,50,"ContextMenu button actiontype: {0}.",n.actionType);this.b=new CommandUI.AddInCommands.i(this.h(n.id),"Button");this.b.a().LabelText=n.label;this.b.a().Alt=n.label;this.b.a().Image16by16=n.icon["16"];this.j(this.b.a().Id,n.action);this.i(this.b.a());this.c.a().b(this.b);this.b=null},startBuildMenu:function(n){if(CommandUI.a.a(this.c))this.c=new CommandUI.AddInCommands.w(n.id);else{var t=this.h(n.id);this.b=new CommandUI.AddInCommands.i(t,"FlyoutAnchor");this.k(this.b.a(),n);this.b.a().Image16by16=n.icon["16"];this.b.a().Command=798637440}},addMenuItem:function(n){Diag.a.a(17085953,220,50,"ContextMenu menu item actiontype: {0}.",n.actionType);var t=new CommandUI.AddInCommands.v(this.h(n.id));this.k(t.a(),n);n.icon&&(t.a().Image16by16=n.icon["16"]);this.j(t.a().Id,n.action);this.i(t.a());this.b.b().b(t)},endBuildMenu:function(){CommandUI.a.a(this.b)?(this.d.b(this.c),this.c=null):(this.c.a().b(this.b),this.b=null)},d:null,a:function(){return this.d},j:function(n,t){this.e.a(n,t)},i:function(n){this.f.a(n)},h:function(n){return this.g.a(n)},k:function(n,t){n.LabelText=t.label;n.Alt=t.label}};CommandUI.AddInCommands.bb=function(){this.d=new($$sc.u.$$(CommandUI.AddInCommands.n))};CommandUI.AddInCommands.bb.prototype={b:null,c:null,d:null,a:function(){return this.d},addButton:function(){},addMenuItem:function(){},startBuildMenu:function(n){CommandUI.a.a(this.b)?this.b=new CommandUI.AddInCommands.w(n.id):this.c=new CommandUI.AddInCommands.i(n.id,"Button")},endBuildMenu:function(){CommandUI.a.a(this.c)?(this.d.b(this.b),this.b=null):this.c=null}};CommandUI.AddInCommands.M=function(n){this.b=n};CommandUI.AddInCommands.M.prototype={b:null,a:function(n){return this.b+n}};CommandUI.AddInCommands.H=function(){this.e=new Common.T;this.b=new($$sc.u.$$(CommandUI.AddInCommands.q))};CommandUI.AddInCommands.H.prototype={a:null,c:0,f:!1,k:function(n){this.e.l("AddinCommandsLoadingMessageChanged",n)},m:function(n){this.e.o("AddinCommandsLoadingMessageChanged",n)},d:function(n){var t=n;return t!==this.a&&(this.a=t,this.e.k("AddinCommandsLoadingMessageChanged",null,null)),n},o:function(){this.c++;this.a||this.d($a.bk)},h:function(){this.c--;this.c<=0&&(this.f?this.a!==$a.e&&this.d($a.e):this.d(null))},j:function(n,t){this.f=!0;n&&this.d(t?$a.B:$a.e)},i:function(){this.f=!1;this.c<=0?this.d(null):this.d($a.bk)},b:null,g:function(n,t){for(var r=this.b.$$lge(),i;r.$$mn();)if(i=r.$$cu(),i.e(n,t))return i;return null},l:function(n,t,i,r){var u=new CommandUI.AddInCommands.q;u.a=n;u.b=t;u.c=i;u.d=r;this.b.b(u)},n:function(n,t){for(var r=0,u=this.b.$$lge(),i;u.$$mn();)i=u.$$cu(),i.a.getStoreType()===n&&i.a.getMarketplaceID()===t?this.b.h(r):r++}};CommandUI.AddInCommands.b=function(n,t,i,r){this.h=n;Common.a.a.a("AddInCommandsMissingTabIsEnabled")?(this.m=i.g(),this.k=i.e(),this.i=i.d()):(this.m=i.f(),this.k=null,this.i=null);this.j=t;this.l=r};CommandUI.AddInCommands.b.prototype={h:null,m:null,j:null,k:null,i:null,l:!1,a:function(n){var t=this.h+this.j+n;return Common.a.a.a("MaskAddinIdsIsEnabled")&&this.l?(t in CommandUI.AddInCommands.b.a||(CommandUI.AddInCommands.b.a[t]="AddinControl"+CommandUI.AddInCommands.b.c++),CommandUI.AddInCommands.b.a[t]):t},c:function(n){var t,i,r;if(Common.a.a.a("MaskAddinIdsIsEnabled")&&this.l){t=CommandUI.AddInCommands.b.a;for(i in t)if(r={key:i,value:t[i]},n===r.value)return r.key.substr(this.h.length+this.j.length)}return n},b:function(n){var t=this.h+this.j+n;return Common.a.a.a("MaskAddinIdsIsEnabled")&&this.l?(t in CommandUI.AddInCommands.b.b||(CommandUI.AddInCommands.b.b[t]="AddinTab"+CommandUI.AddInCommands.b.d++),CommandUI.AddInCommands.b.b[t]):t},f:function(n){return n.toLowerCase()in this.m?(Diag.a.a(17306646,220,50,"Tab id: {0}.",n.toLowerCase()),this.h+this.m[n.toLowerCase()]):null},g:function(){var n,r;if(!this.k)return null;n=[];for(var i=this.k,u=i.length,t=0;t<u;++t)r=i[t],n.push(this.h+r);return n},e:function(n){var t=this.n(n);return null===t?null:t[1]},d:function(n){var t=this.n(n);return null===t?null:t[2]},n:function(n){if(this.i&&n.toLowerCase()in this.i){Diag.a.a(21017039,220,50,"Get attributes for Tab id: {0}.",n.toLowerCase());return this.i[n.toLowerCase()]}return null}};CommandUI.AddInCommands.N=function(n,t){this.d=n;this.c=t};CommandUI.AddInCommands.N.prototype={d:null,c:null,a:function(n,t){return this.c+t},b:function(){return this.d}};CommandUI.AddInCommands.O=function(n,t){this.b=new CommandUI.AddInCommands.N(n,t)};CommandUI.AddInCommands.O.prototype={b:null,a:function(){return this.b}};CommandUI.AddInCommands.Q=function(n){this.c=n};CommandUI.AddInCommands.Q.prototype={c:null,b:function(){return this.c},a:function(n){n.Command=this.c}};CommandUI.AddInCommands.P=function(){};CommandUI.AddInCommands.P.prototype={a:function(n,t){OfficeExt.DefaultControlActionBinder.bindAction(n,t)}};CommandUI.AddInCommands.V=function(n,t,i,r,u,f){this.m=new($$sc.u.$$(Common.AddInTab));this.h=n;this.k=t;this.g=i;this.n=r;this.l=u;this.i=f};CommandUI.AddInCommands.V.prototype={f:null,d:null,e:null,n:null,l:null,i:null,h:null,c:function(){return this.h},a:function(){return this.m},b:function(){return null},k:null,g:null,startBuildTab:function(n){var i=n.isOfficeTab?n.id:this.h.b(n.id),r=n.isOfficeTab?null:n.label,t;this.f=(t=new Common.AddInTab,t.id=i,t.title=r,t.isOfficeTab=n.isOfficeTab,t.visible=n.visible,t.groups=[],t)},startBuildGroup:function(n){var i=this.j(n.id),t;this.d=(t=new Common.AddInGroup,t.id=i,t.title=n.label,t.controls=[],t)},addButton:function(n){var i=this.j(n.id),t,r;i&&(this.p(i,n.action),Diag.a.a(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",n.actionType),r=(t=new Common.AddInControl,t.id=i,t.title=n.label,t.iconLocation=this.o(n),t.enabled=n.enabled,t.controlType=0,t.attributes=this.q(),t),this.i.d(new Common.b(i,this.g.b().toString())),this.d.controls.push(r))},startBuildMenu:function(n){var i=this.j(n.id),t;i&&(this.e=(t=new Common.AddInControl,t.id=i,t.title=n.label,t.iconLocation=this.o(n),t.controlType=1,t.attributes={},t.menuItems=[],t))},addMenuItem:function(n){var i=this.j(n.id),t,r;i&&(this.p(i,n.action),Diag.a.a(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",n.actionType),r=(t=new Common.AddInMenuItem,t.id=i,t.title=n.label,t.iconLocation=this.o(n),t.enabled=n.enabled,t.attributes=this.q(),t),this.i.d(new Common.b(i,this.g.b().toString())),this.e.menuItems.push(r))},endBuildMenu:function(){CommandUI.a.a(this.e.id)||this.d.controls.push(this.e);this.e=null},endBuildGroup:function(){this.s();CommandUI.a.a(this.d.id)||this.f.groups.push(this.d);this.d=null},endBuildTab:function(){CommandUI.a.a(this.f.id)||this.m.b(this.f);this.f=null},q:function(){var n={};return this.r(n),n},o:function(n){return n.icon["80"]?n.icon["80"]:n.icon["32"]},r:function(n){this.g.a(n)},j:function(n){return this.h.a(n)},p:function(n,t){this.k.a(n,t)},s:function(){var n=this.d.controls.length;if(n>6){Diag.a.a(24786645,220,10,"Addin commands does not support {0} controls in a single group",n);this.l.setErrorMessageForAddin(this.n,$a.R);throw Error.create(String.format("AddinManifestError: Addin commands does not support {0} controls in a single group",n));}}};CommandUI.AddInCommands.e=function(){};CommandUI.AddInCommands.e.b=function(){return CommandUI.AddInCommands.e.a||(CommandUI.AddInCommands.e.a=new CommandUI.AddInCommands.e),CommandUI.AddInCommands.e.a};CommandUI.AddInCommands.e.prototype={a:function(n,t){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(n,t.a())}};CommandUI.AddInCommands.m=function(n){this.e=n};CommandUI.AddInCommands.m.prototype={e:null,a:function(){return this.e},b:function(n){return this.e.insertOsfControl(n)},c:function(n,t){this.e.isAddinCommandsAsync(n,t)},d:function(n,t){this.e.ownerAddinControlRecreated(n,t)}};CommandUI.AddInCommands.bw=function(n,t){this.q=new($$sc.u.$$(CommandUI.AddInCommands.y));this.h=n;this.p=t};CommandUI.AddInCommands.bw.prototype={d:null,e:null,a:function(){return null},h:null,c:function(){return this.h},p:null,b:function(){return this.q},startBuildTab:function(n){var t=n.isOfficeTab?this.h.f(n.id):this.h.b(n.id);this.d=new CommandUI.AddInCommands.y(t)},startBuildGroup:function(n){var t=this.j(n.id);this.e=new CommandUI.AddInCommands.s(t)},addButton:function(n){var t=this.j(n.id);this.u(t,n.action)},startBuildMenu:function(){},addMenuItem:function(n){var t=this.j(n.id);this.u(t,n.action)},endBuildMenu:function(){},endBuildGroup:function(){this.d.c().b(this.e);this.e=null},endBuildTab:function(){CommandUI.a.a(this.d.b)||this.q.b(this.d);this.d=null},u:function(n,t){this.p.a(n,t)},j:function(n){return this.h.a(n)}};CommandUI.AddInCommands.Y=function(n,t,i,r,u,f){CommandUI.AddInCommands.Y.initializeBase(this,[n,t]);this.l=i;this.m=r;this.o=u;this.n=f};CommandUI.AddInCommands.Y.prototype={i:null,f:null,g:null,o:null,n:null,m:null,l:null,startBuildTab:function(n){var t,i,r;CommandUI.AddInCommands.bw.prototype.startBuildTab.call(this,n);this.d.d=n.isOfficeTab;this.d.d?this.d.b&&(t=this.h.e(n.id),t&&(this.d.a().Title=t),i=this.h.d(n.id),i&&(this.d.a().Keytip=i)):this.d.a().Title=this.k(n.label);r=this.d.b;this.d.f=r+".Scaling";this.d.e=r+".Groups"},startBuildGroup:function(n){CommandUI.AddInCommands.bw.prototype.startBuildGroup.call(this,n);this.e.a().Title=this.k(n.label)},addButton:function(n){CommandUI.AddInCommands.bw.prototype.addButton.call(this,n);Diag.a.a(17085954,220,50,"RibbonExtensibility button actiontype: {0}.",n.actionType);var t=this.t(n,"Button");this.r(t.a());this.e.b().b(t)},startBuildMenu:function(n){this.i=this.t(n,"FlyoutAnchor")},addMenuItem:function(n){CommandUI.AddInCommands.bw.prototype.addMenuItem.call(this,n);Diag.a.a(17085955,220,50,"RibbonExtensibility menu item actiontype: {0}.",n.actionType);var i=this.j(n.id),t=new CommandUI.AddInCommands.v(i);this.s(t.a(),n);this.r(t.a());this.i.b().b(t)},endBuildMenu:function(){this.e.b().b(this.i);this.i=null},endBuildGroup:function(){this.v();this.d.j().b(this.f);this.g&&(this.d.j().b(this.g),this.g=null);this.f=null;CommandUI.AddInCommands.bw.prototype.endBuildGroup.call(this)},r:function(n){this.l.a(n)},t:function(n,t){var r=this.j(n.id),i=new CommandUI.AddInCommands.i(r,t);return this.s(i.a(),n),i},s:function(n,t){n.LabelText=this.k(t.label);n.Alt=this.k(t.label);n.Image16by16=t.icon["16"];n.Image32by32=t.icon["32"]},v:function(){var i=this.m.a(this.e),n,t;this.e.g(i.b());n=this.e.b().e.length;Diag.a.a(17085956,220,50,"Control count: {0}.",n);t=this.e.a().Id;this.f=new CommandUI.AddInCommands.o("MaxSize");this.f.a().Id=t+".Scaling.MaxSize";this.f.a().GroupId=this.e.a().Id;n>2&&(this.g=new CommandUI.AddInCommands.o("Scale"),this.g.a().Id=t+".Scaling.Scale",this.g.a().GroupId=this.e.a().Id);this.w(n,i)},w:function(n,t){var u=1,i,r;switch(n){case 1:case 2:this.f.a().Size="Large";break;case 3:this.f.a().Size="Large";this.g.a().Size="Medium";break;case 4:this.f.a().Size="MediumTwoRow";this.g.a().Size="SmallTwoRow";break;case 5:case 6:this.f.a().Size="Medium";this.g.a().Size="Small";break;default:Diag.a.a(9041819,220,10,"Addin commands does not support {0} controls.",n);this.n.setErrorMessageForAddin(this.o,$a.R);throw Error.create(String.format("AddinManifestError: Addin commands does not support {0} controls",n));}for(i=this.e.b().$$lge();i.$$mn();)r=i.$$cu(),r.a().TemplateAlias=t.a(r,u),u+=n!==3?1:2},k:function(n){return n?(n=Common.e.i(n,"&","&amp;"),n=Common.e.i(n,"'","&apos;"),n=Common.e.i(n,'"',"&quot;"),n=Common.e.i(n,">","&gt;"),Common.e.i(n,"<","&lt;")):null}};CommandUI.AddInCommands.Z=function(n,t){this.f=n;this.d=new CommandUI.AddInCommands.P;this.e=new CommandUI.AddInCommands.Q(t)};CommandUI.AddInCommands.Z.prototype={f:null,d:null,e:null,a:function(n){var t=new CommandUI.AddInCommands.M(n);return new CommandUI.AddInCommands.L(t,this.e,this.d)},c:function(n,t,i){var r=new CommandUI.AddInCommands.b(this.f,n,i,!0),u=new CommandUI.AddInCommands.O(this.f+"Ribbon.Templates.AddInCommandsControlGroup","addinControl");return new CommandUI.AddInCommands.Y(r,this.d,this.e,u,n,t)},b:function(n,t,i,r){var u=new CommandUI.AddInCommands.b(this.f,n,i,!0);return new CommandUI.AddInCommands.V(u,this.d,this.e,n,t,r)}};CommandUI.AddInCommands.T.registerClass("CommandUI.AddInCommands.T",Sys.EventArgs);CommandUI.AddInCommands.x.registerClass("CommandUI.AddInCommands.x",null,CommandUI.AddInCommands.bo);CommandUI.AddInCommands.l.registerClass("CommandUI.AddInCommands.l");CommandUI.AddInCommands.q.registerClass("CommandUI.AddInCommands.q");CommandUI.AddInCommands.AddinCommandsUILessDialog.registerClass("CommandUI.AddInCommands.AddinCommandsUILessDialog",CommonUI.b);CommandUI.AddInCommands.y.registerClass("CommandUI.AddInCommands.y");CommandUI.AddInCommands.s.registerClass("CommandUI.AddInCommands.s");CommandUI.AddInCommands.o.registerClass("CommandUI.AddInCommands.o");CommandUI.AddInCommands.k.registerClass("CommandUI.AddInCommands.k");CommandUI.AddInCommands.D.registerClass("CommandUI.AddInCommands.D",Sys.EventArgs);CommandUI.AddInCommands.F.registerClass("CommandUI.AddInCommands.F");CommandUI.AddInCommands.ba.registerClass("CommandUI.AddInCommands.ba");CommandUI.AddInCommands.C.registerClass("CommandUI.AddInCommands.C",CommonUI.b);CommandUI.AddInCommands.H.registerClass("CommandUI.AddInCommands.H");CommandUI.AddInCommands.bw.registerClass("CommandUI.AddInCommands.bw");CommandUI.AddInCommands.Y.registerClass("CommandUI.AddInCommands.Y",CommandUI.AddInCommands.bw);CommandUI.AddInCommands.c.a=["PrimaryCommandSurface","ContextMenu"];CommandUI.AddInCommands.c.d=null;CommandUI.AddInCommands.c.b=null;CommandUI.AddInCommands.c.c=null;CommandUI.AddInCommands.d.a=null;CommandUI.AddInCommands.a.a=null;CommandUI.AddInCommands.a.b=null;CommandUI.AddInCommands.a.c=null;CommandUI.AddInCommands.b.a={};CommandUI.AddInCommands.b.b={};CommandUI.AddInCommands.b.d=0;CommandUI.AddInCommands.b.c=0;CommandUI.AddInCommands.e.a=null;Type.registerNamespace("_Ewa");_Ewa.TV=function(){};_Ewa.TV.a=function(){Common.E.a("")};_Ewa.TV.a();Type.registerNamespace("_Ewa");_Ewa.Ub=function(){};_Ewa.Ub.a=function(){Common.E.a(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}")};_Ewa.Ub.a();Type.registerNamespace("Common.App.AppsForOfficeCommon");Common.App.AppsForOfficeCommon.n=function(){};Common.App.AppsForOfficeCommon.F=function(){};Common.App.AppsForOfficeCommon.j=function(n,t,i,r){this.i=Function.createDelegate(this,this.j);this.d=n;this.f=t;this.e=i;this.c=r};Common.App.AppsForOfficeCommon.j.prototype={e:null,d:null,f:null,b:null,a:null,c:null,j:function(n,t){var r,o,s,i,f,l,h,a,e,c;if(n||!t){if(this.a){for(r=0;r<this.a.b();r++)o=this.a.c(r),o(null),o=null;this.a=null}return}if(t.c===200&&t.b){var u=t.b,v=u.lastChild,y=Common.App.AppsForOfficeCommon.d.c(v);for(this.b=new Common.Collections.d(null),s=[],i=u.getElementsByTagName("app"),i&&i.length||(i=u.getElementsByTagName("o:app")),f=0;i&&f<i.length;f++)l=i[f],h=Common.App.AppsForOfficeCommon.d.a(l),this.b.d(h),Array.add(s,h);this.b.b()?(this.l(this.b),a=Sys.Serialization.JavaScriptSerializer.serialize(s),this.d.a(this.e,a,y)):Diag.a.a(6070471,344,50,"Response doesn't contain any preinstalled Apps: {0}",u.xml)}else t.a?Diag.a.a(6070472,344,15,"Error when requesting Apps data: {0}",t.a):Diag.a.a(6070473,344,15,"Error when requesting Apps data, status code: {0}",t.c);if(this.a){for(e=0;e<this.a.b();e++)c=this.a.c(e),c(this.b),c=null;this.a=null}},g:function(n,t){var i,r,f,e,u;return t?(e=this,r=function(){n.iconLoaded32=!0},i=this.c(n.icon32)):(f=this,r=function(){n.iconLoaded16=!0},i=this.c(n.icon16)),i&&(u=this,i.e(function(t,i){u.k(t,i,n,r)})),i},k:function(n,t,i,r){t.a&&i&&r()},l:function(n){for(var t,r=n.a,i=0;i<r.length;i++)t=r[i],this.c&&(!t.iconLoaded16&&t.icon16&&(t.icon16=this.h(t.icon16),this.g(t,0)),!t.iconLoaded32&&t.icon32&&(t.icon32=this.h(t.icon32),this.g(t,1)))},h:function(n){return document.URL.toLowerCase().startsWith("https://")||n.toLowerCase().startsWith("https://")&&(n="http"+n.substring(5,n.length)),n}};Common.App.AppsForOfficeCommon.c=function(){};Common.App.AppsForOfficeCommon.c.prototype={a:null};Common.App.AppsForOfficeCommon.k=function(n,t,i){this.g=Function.createDelegate(this,this.i);this.h=Function.createDelegate(this,this.j);this.d=n;this.e=t;this.f=i};Common.App.AppsForOfficeCommon.k.prototype={d:null,e:null,b:null,c:0,f:null,a:function(n){this.b(this.c,n)},i:function(n){n&&n.b&&n.b.a?(Diag.a.a(6070474,344,15,"Failure request."),this.a(new Common.App.AppsForOfficeCommon.i(n.b.c,n.b.a,null))):(Diag.a.a(6070475,344,15,"Failure request."),this.a(null))},j:function(n){this.a(new Common.App.AppsForOfficeCommon.i(n.b.c,n.b.a,n.b.k))}};Common.App.AppsForOfficeCommon.i=function(n,t,i){this.c=n;this.a=t;this.b=i};Common.App.AppsForOfficeCommon.i.prototype={c:0,a:null,b:null};Common.App.AppsForOfficeCommon.d=function(){};Common.App.AppsForOfficeCommon.d.b=function(n,t){var r=n.prefix+":",i=n.attributes.getNamedItem(r+t);return i?i.nodeValue:""};Common.App.AppsForOfficeCommon.d.d=function(n){var t="0";switch(n){case"1":t="1";break;case"2":t="0";break;case"4":t="1";break;default:Diag.a.a(6850688,344,15,"Omex App SubType is invalid: {0}.",n)}return t};Common.App.AppsForOfficeCommon.d.c=function(n){var t=0;try{t=Number.parseInvariant(Common.App.AppsForOfficeCommon.d.b(n,"rr"))}catch(i){Diag.a.a(6070478,344,15,"Error parsing server response for a preinstalled apps node: {0}.",i.message);t=0}return t===Number.NaN?0:t};Common.App.AppsForOfficeCommon.d.a=function(n){var i=new Common.App.AppsForOfficeCommon.n,r;try{if(n.attributes&&n.attributes.length>0){for(r=0;r<n.attributes.length;r++){var t=n.attributes.item(r),f=t.localName,u=t.baseName?t.baseName:f;if(t&&u)switch(u){case"title":i.title=t.nodeValue;break;case"assetid":i.assetId=t.nodeValue;break;case"cm":i.cm=t.nodeValue;break;case"ver":i.ver=t.nodeValue;break;case"appst":i.appst=Common.App.AppsForOfficeCommon.d.d(t.nodeValue);break;case"defhei":i.defhei=t.nodeValue;break;case"defwid":i.defwid=t.nodeValue;break;case"smallicon":i.icon16=t.nodeValue;break;case"medicon":i.icon32=t.nodeValue;break;case"largeicon":i.icon64=t.nodeValue;break;case"desc":i.desc=t.nodeValue;break;case"ldesc":i.lDesc=t.nodeValue}}i.iconLoaded16=!1;i.iconLoaded32=!1}}catch(e){Diag.a.a(6070479,344,15,"Error parsing server response for a preinstalled app node: {0}.",e.message)}return i};Common.App.AppsForOfficeCommon.n.registerClass("Common.App.AppsForOfficeCommon.n");Common.App.AppsForOfficeCommon.c.a=new Common.App.AppsForOfficeCommon.c;Type.registerNamespace("Common.App.SmartLookup");Common.App.SmartLookup.b=function(){};Common.App.SmartLookup.d=function(){};Common.App.SmartLookup.j=function(){};Common.App.SmartLookup.c=function(){};Common.App.SmartLookup.k=function(){};Common.App.SmartLookup.f=function(){};Common.App.SmartLookup.e=function(){};Common.App.SmartLookup.EntryPoint=function(){};Common.App.SmartLookup.EntryPoint.prototype={other:0,searchBoxSearch:1,searchBoxDictionary:2,searchBoxQuickAnswer:3,smartLookupRibbon:4,smartLookupContextMenu:5,entity:6,dictionary:7,web:8,pictures:9,files:10,bookmarks:11,help:12,chartRecommendation:13,linkSkill:14,searchBoxFindInDocument:15,searchBoxEntity:16,searchSkill:17,controlF:18,ribbonFindButton:19};Common.App.SmartLookup.EntryPoint.registerEnum("Common.App.SmartLookup.EntryPoint",!1);Common.App.SmartLookup.p=function(){};Common.App.SmartLookup.LaunchMode=function(){};Common.App.SmartLookup.LaunchMode.prototype={"default":0,documentsView:1,objectsView:2};Common.App.SmartLookup.LaunchMode.registerEnum("Common.App.SmartLookup.LaunchMode",!1);Common.App.SmartLookup.l=function(){};Common.App.SmartLookup.m=function(){};Common.App.SmartLookup.i=function(){};Common.App.SmartLookup.i.prototype={getId:function(){return"SerpletExecutor"}};Common.App.SmartLookup.o=function(){};Common.App.SmartLookup.o.prototype={a:null,addSearchInvokedListener:function(n){this.a=n},notifySearchInvoked:function(n){this.a&&this.a(n)}};Common.App.SmartLookup.n=function(){};Common.App.SmartLookup.n.prototype={landingTab:null,data:null};Common.App.SmartLookup.q=function(){};Common.App.SmartLookup.q.prototype={imageUrl:null,imageBinaryBase64:null};Common.App.SmartLookup.g=function(n,t,i,r){this.d=Date.now;this.i=n;this.c=t;this.h=i;r&&this.f()};Common.App.SmartLookup.g.prototype={j:9e5,k:3e5,d:null,i:null,c:null,h:!1,b:null,g:"",e:0,a:function(n){var t=this.d();return t<this.e+this.j?(t>this.e+this.k&&this.f(),this.g):(n&&this.f(),"")},f:function(){var n=this;return this.b=this.b||new Promise(function(t){n.l().then(function(i){n.g=i;n.e=n.d();n.b=null;t(i)})}),this.b},l:function(){if(!this.h||!this.c||!this.c.length)return Diag.a.a(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve("");var n=this;return new Promise(function(t){n.i.a("SmartLookup",n.c).then(function(n){n.IsSuccess?n.Token||(t(""),Diag.a.a(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(Diag.a.a(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+n.ErrorCode+": "+n.ErrorMessage),t(""));t(n.Token)}).catch(function(n){var i=JSON.stringify(n);Diag.a.a(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+i);t("")})})}};Common.App.SmartLookup.h=function(n){Diag.a.a(41521353,1313,50,"SmartLookupManager - Initialize");this.c=Common.a.a.a("IsTellMeUpSellEnterpriseEnabled");this.h=Common.a.a.i.SmartLookupApprovedOriginPattern;this.d=Common.a.a.i.SmartLookupShredderServiceEndpoint;this.f=Common.k.j(Common.a.a.i.AppCatalogUrl||"");this.b=new Common.App.SmartLookup.d;this.b.EnableAllTabV2=Common.a.a.a("SmartLookupEnableAllTabV2");this.b.EnableIntentService=Common.a.a.a("SmartLookupEnableIntentService");this.b.EnableInDocumentSearch=Common.a.a.a("SmartLookupEnableInDocumentSearch");this.b.EnableLocalSearch=Common.a.a.a("SmartLookupEnableLocalSearch");this.b.IntentServiceEndpoint=Common.App.SmartLookup.a.b();this.e=new Common.App.SmartLookup.g(n,this.d,!Common.a.a.a("WordEditorSmartLookupAuthIsEnabled"),!0)};Common.App.SmartLookup.h.prototype={e:null,c:!1,h:null,d:null,f:null,b:null,a:function(){return Promise.resolve(this.i())},i:function(){var n=new Common.App.SmartLookup.b,r,i,t;return n.anid="",n.applicationVersion=Common.a.l,n.appCorrelationId=Common.F.a().a,n.themePlatform="web",n.lcid=Common.a.m,n.launchUtcTime=(new Date).toUTCString(),n.featureGates=this.b,r=Common.d.b(Common.a.m),i=r?r.a:null,n.market=this.g(i),n.uiLanguage=i,n.sessionId=Common.a.k,n.themeId=0,n.parentalControl="yes",t=new Common.App.SmartLookup.c,t.CountryCode=this.g(i),t.ServiceEndpoint=this.d,t.IsGoLocal=!1,t.IsEnabled=this.c,t.IsEnterpriseEnabled=this.c,t.TenantRoot=this.f,n.enterpriseUserInfo=t,n.accessToken=this.e.a(!0),n},g:function(n){var t=n.split("-");return t[t.length-1]}};Common.App.SmartLookup.a=function(){};Common.App.SmartLookup.a.a=function(){var i=$$as(String,Common.a.f.AudienceGroup)||"",n,t;switch(i){case"Dogfood":return Common.a.a?(n=Common.a.a.i.UserPrincipalName,n=n.toLowerCase(),t=Common.a.a.e("SmartLookupINTEnabledForSKITeam")?Common.a.a.g("SmartLookupINTEnabledForSKITeam"):new Array(0),Array.indexOf(t,n)>=0?"INT":"EDOG"):"EDOG";case"Microsoft":case"Production":default:return"PROD"}};Common.App.SmartLookup.a.b=function(){var n=Common.a.a.a("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":Common.a.a.a("IntentSvcEnableProdSourceLocationOverride")?"PROD":Common.a.a.a("IntentSvcEnableIntSourceLocationOverride")?"INT":Common.App.SmartLookup.a.a();switch(n){case"INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case"EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";case"PROD":default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}};Common.App.SmartLookup.b.registerClass("Common.App.SmartLookup.b");Common.App.SmartLookup.f.registerClass("Common.App.SmartLookup.f");Type.registerNamespace("Common.App.AppsForOfficeCommon");Common.App.AppsForOfficeCommon.w=function(){};Common.App.AppsForOfficeCommon.r=function(n,t,i,r,u,f,e){this.taskPaneWidth=330;this.id=n;this.marketplaceID=t;this.marketplaceVersion=i;this.store=r;this.storeType=u;this.settings=f;this.ownerAddinStoreType=null;this.ownerAddinAssetId=null;this.isAddinCommands=!1;this.addinCommandsActionType=0;this.virtualOsfControlActivationCallback=null;this.isForUILessAction=!1;this.isToBePersisted=e;this.onTaskPaneClose=null;this.featureGates=null;this.activationStart=0;this.isModernPane=!1;this.isResizable=!1;this.resizeMinWidth=330;this.resizeMaxWidth=920};Common.App.AppsForOfficeCommon.t=function(){};Common.App.AppsForOfficeCommon.v=function(n,t,i,r){this.appName=n;this.appVersion=t;this.clientMode=i;this.formFactor=r||OSF.FormFactor.Default};Common.App.AppsForOfficeCommon.E=function(n,t,i){this.appUILocale=n;this.dataLocale=t;this.lcid=i};Common.App.AppsForOfficeCommon.G=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.osfOmexBaseUrl=n;this.devCatalogUrl=t;this.oneDriveCatalogBaseApiUrl=i;this.spBaseUrl=r;this.docUrl=u;this.pageBaseUrl=f;this.localizedScriptsUrl=e;this.localizedImagesUrl=o;this.localizedStylesUrl=s;this.localizedResourcesUrl=h;this.firstPartyManifestCDNUrl=c;this.sdxCdnUrl=l;this.sdxDmsUrl=a};Common.App.AppsForOfficeCommon.u=function(n,t){this.hostControl=n;this.controlStatusChanged=t.getAppForOfficeStatusChangeHandler();this.notifyHost=t.getAppForOfficeUserActionHandler()};Common.App.AppsForOfficeCommon.H=function(n,t){this.userNameHashCode=n;this.loggableUserId=t};Common.App.AppsForOfficeCommon.y=function(){};Common.App.AppsForOfficeCommon.z=function(){};Common.App.AppsForOfficeCommon.x=function(){};Common.App.AppsForOfficeCommon.A=function(){};Common.App.AppsForOfficeCommon.C=function(){};Common.App.AppsForOfficeCommon.p=function(){this._handlers=new($$sc.v.$$(Function))};Common.App.AppsForOfficeCommon.q=function(){this.d=Function.createDelegate(this,this.k);this.i=parameters;this.a=callback;this.e=additionalParameters;this.c={};this.h=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError};Common.App.AppsForOfficeCommon.q.prototype={i:null,e:null,a:null,b:null,h:0,c:null,f:null,g:null,k:function(){this.j();this.l()},j:function(){},l:function(){this.a&&(this.c[OSF.DDA.Marshaling.ApiResponseKeys.Error]=this.h,this.a(this.c))}};Common.App.AppsForOfficeCommon.s=function(){this.e=Function.createDelegate(this,this.j);this.d=Function.createDelegate(this,this.i);this.f=taskManager;this.a=apiManager;this.b=afoDataManager};Common.App.AppsForOfficeCommon.s.prototype={f:null,a:null,b:null,invokeDdaMethod:function(n,t,i){var u=n.DdaMethod.DispatchId,r=this.a.b().a(u);r?(r.i=n,r.a=t,r.e=i,r.b=n.DdaMethod.ControlId,r.f=this.b.b(r.b),r.g=this.b.a(r.b),this.c(r.d,null)):(Diag.a.a(5902750,341,10,"API Call for method ID {0} does not exist.",u),this.g(t,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))},registerDdaEventAsync:function(n,t,i,r,u){this.c(this.d,new Common.App.AppsForOfficeCommon.l(n,t,i,r,u))},unregisterDdaEventAsync:function(n,t,i,r,u){this.c(this.e,new Common.App.AppsForOfficeCommon.l(n,t,i,r,u))},getThrottleForCall:function(n){return this.a.c().a(n)},c:function(n,t){var i=new Common.O(2,1,0,n,116,null,!1);i.d=t;this.f.a(i)},i:function(n){var t=this;this.h(n.d,function(n,t){n.a(t.b,t.e,t.a,t.d)})},j:function(n){var t=this;this.h(n.d,function(n,t){n.b(t.b,t.a,t.d)})},h:function(n,t){var i=this.a.a().a(n.c);i?t(i,n):(Diag.a.a(5902751,341,10,"Event for dispatch ID {0} does not exist.",n.c),this.g(n.a,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError))},g:function(n,t){if(n){var i={};i[OSF.DDA.Marshaling.ApiResponseKeys.Error]=t;n(i)}}};Common.App.AppsForOfficeCommon.l=function(n,t,i,r,u){this.c=n;this.b=t;this.d=i;this.e=r;this.a=u};Common.App.AppsForOfficeCommon.l.prototype={c:0,b:null,d:null,e:null,a:null};Common.App.AppsForOfficeCommon.a=function(){this.d=330;this.b=null;this.a=null;this.c={};this.f=null;this.i=!1;this.j=!1};Common.App.AppsForOfficeCommon.a.prototype={d:0,b:null,a:null,c:null,e:!1,f:null,g:null,h:null,i:!1,j:!1};Common.App.AppsForOfficeCommon.p.registerClass("Common.App.AppsForOfficeCommon.p");Common.App.AppsForOfficeCommon.q.registerClass("Common.App.AppsForOfficeCommon.q");Common.App.AppsForOfficeCommon.l.registerClass("Common.App.AppsForOfficeCommon.l");Type.registerNamespace("_Ewa");_Ewa.Do=function(n){this.keyPath=n};_Ewa.Dn=function(n,t){this.key=n;this.value=t};_Ewa.sQ=function(){};_Ewa.sQ.a=function(n,t){var u=!1,i,r,f;return n&&n.a(624)&&(i=t.osfControl,r=i.getManifest(),r&&(f=r.getSharedRuntimeForCustomFunctions("Workbook"),f&&!i.getIsUpgrading()&&(u=!0))),u};_Ewa.CustomFunctionsInstaller=function(n,t){this.e={};this.f={};this.d=n;this.g=t;this.p().j()};_Ewa.CustomFunctionsInstaller.c=function(){return _Ewa.bB.cwrtcwithresult(String,Array,_Ewa.CustomFunctionsInstaller.f(_Ewa.dD.c()),function(n){var t=n.a();return $$as(Array,Sys.Serialization.JavaScriptSerializer.deserialize(!t||!t.length?"[]":t))},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")};_Ewa.CustomFunctionsInstaller.u=function(n){return _Ewa.CustomFunctionsInstaller.j(_Ewa.dD.c(),Sys.Serialization.JavaScriptSerializer.serialize(n))};_Ewa.CustomFunctionsInstaller.g=function(n){return _Ewa.bB.cwrtcwithfunc(String,Object,_Ewa.CustomFunctionsInstaller.f(_Ewa.dD.b(n)),function(n){var t=_Ewa.e.a(n.a())?"":n.a();return t.length>0?$$sc.a.a(Object,Sys.Serialization.JavaScriptSerializer.deserialize(t,!0)):$$sc.a.a(Object,null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")};_Ewa.CustomFunctionsInstaller.D=function(n,t){return _Ewa.bB.cwrtcwithfunc(Boolean,Boolean,_Ewa.CustomFunctionsInstaller.q(n),function(){return _Ewa.bB.cwrtcwithfunc(Boolean,Boolean,_Ewa.CustomFunctionsInstaller.j(_Ewa.dD.b(n),Sys.Serialization.JavaScriptSerializer.serialize(t)),function(){return _Ewa.CustomFunctionsInstaller.k("HasCustomFunctionsCache","true")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")};_Ewa.CustomFunctionsInstaller.h=function(n){return _Ewa.bB.cwrtcwithfunc(Boolean,Boolean,_Ewa.CustomFunctionsInstaller.s(n),function(){return _Ewa.bB.cwrtcwithfunc(Boolean,Boolean,_Ewa.CustomFunctionsInstaller.t(_Ewa.dD.b(n)),function(){return _Ewa.bB.cwrtcwithfunc(Array,Boolean,_Ewa.CustomFunctionsInstaller.c(),function(n){var t=n.a();return t.length?$$sc.a.a(Boolean,!0):_Ewa.CustomFunctionsInstaller.k("HasCustomFunctionsCache","false")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};_Ewa.CustomFunctionsInstaller.A=function(n){return _Ewa.CustomFunctionsInstaller.f(_Ewa.dD.a(n))};_Ewa.CustomFunctionsInstaller.E=function(n,t){return _Ewa.bB.cwrtcwithfunc(Boolean,Boolean,_Ewa.CustomFunctionsInstaller.q(n),function(){return _Ewa.CustomFunctionsInstaller.j(_Ewa.dD.a(n),t)},"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")};_Ewa.CustomFunctionsInstaller.i=function(n){return _Ewa.bB.cwrtcwithfunc(Boolean,Boolean,_Ewa.CustomFunctionsInstaller.s(n),function(){return _Ewa.CustomFunctionsInstaller.t(_Ewa.dD.a(n))},"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};_Ewa.CustomFunctionsInstaller.q=function(n){return _Ewa.bB.cwrtcwithfunc(Array,Boolean,_Ewa.CustomFunctionsInstaller.c(),function(t){var i=t.a(),r=n.toLowerCase();return Array.contains(i,r)?$$sc.a.a(Boolean,!0):(i.push(r),_Ewa.CustomFunctionsInstaller.u(i))},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};_Ewa.CustomFunctionsInstaller.s=function(n){return _Ewa.bB.cwrtcwithfunc(Array,Boolean,_Ewa.CustomFunctionsInstaller.c(),function(t){var i=t.a(),r=n.toLowerCase();return Array.contains(i,r)?(i.splice(Array.indexOf(i,r),1),_Ewa.CustomFunctionsInstaller.u(i)):$$sc.a.a(Boolean,!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};_Ewa.CustomFunctionsInstaller.v=function(n,t){var i=new _Ewa.CustomFunctionsInstaller.l(n);return i.d()?_Ewa.CustomFunctionsInstaller.E(i.a,t):$$sc.a.a(Boolean,!0)};_Ewa.CustomFunctionsInstaller.r=function(n){try{return $$sc.a.a(String,localStorage.getItem(n))}catch(t){Diag.a.a(37060758,0,50,"CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: {0}",_Ewa.e.a(t.message)?"Unknown":t.message);throw Error.create("Failed to read from LocalStorage");}};_Ewa.CustomFunctionsInstaller.f=function(n){return _Ewa.db.d()?_Ewa.db.h(n):_Ewa.CustomFunctionsInstaller.r(n)};_Ewa.CustomFunctionsInstaller.k=function(n,t){try{return localStorage.setItem(n,t),$$sc.a.a(Boolean,!0)}catch(i){Diag.a.a(37060759,0,50,"CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: {0}",_Ewa.e.a(i.message)?"Unknown":i.message);throw Error.create("Failed to set into LocalStorage");}};_Ewa.CustomFunctionsInstaller.j=function(n,t){return _Ewa.db.d()?_Ewa.db.i(new _Ewa.Dn(n,t)):_Ewa.CustomFunctionsInstaller.k(n,t)};_Ewa.CustomFunctionsInstaller.B=function(n){try{return localStorage.removeItem(n),$$sc.a.a(Boolean,!0)}catch(t){Diag.a.a(39965665,0,50,"CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: {0}",_Ewa.e.a(t.message)?"Unknown":t.message);throw Error.create("Failed to remove from LocalStorage");}};_Ewa.CustomFunctionsInstaller.t=function(n){return _Ewa.db.d()?_Ewa.db.f(n):_Ewa.CustomFunctionsInstaller.B(n)};_Ewa.CustomFunctionsInstaller.x=function(n){return _Ewa.e.b(n,"registry",!0)||_Ewa.e.b(n,"uploadfiledevcatalog",!0)||Common.a.T||Common.a.z};_Ewa.CustomFunctionsInstaller.z=function(n){if(!n||!n.length)return!1;try{JSON.parse(n)}catch(t){return!1}return!0};_Ewa.CustomFunctionsInstaller.prototype={d:null,g:null,a:function(n,t,i){var u,r,f;if(!_Ewa.e.a(i.invariantNamespace))for(u=0;u<i.invariantNamespace.length;++u)if(r=i.invariantNamespace.charAt(u),r!=="."&&r!=="_"&&r<"a"&&"z"<r&&r<"A"&&"Z"<r&&r<"0"&&"9"<r){Diag.a.a(39375492,0,10,"CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",r,u);throw Error.create("InvariantNamespace validation failed");}return f=this,_Ewa.bB.cwrtcwithfunc(Boolean,Boolean,_Ewa.CustomFunctionsInstaller.v(t,i.manifest),function(){return _Ewa.bB.cwrtcwithfunc(Object,Boolean,_Ewa.CustomFunctionsInstaller.g(n),function(r){var u=r.a();return u&&u.isDynamicMetadata?f.j(n,u,!1,!1,!1):_Ewa.bB.cwrtcwithfunc(String,Boolean,f.v(n,i),function(r){var e;return u=(e=new _Ewa.CustomFunctionsInstaller.y,e.addinId=t,e.locale=i.locale,e.addinInvariantNamespace=i.invariantNamespace,e.addinNamespace=i.namespace,e.addinTitle=i.title,e.isXllCompatible=i.isXllCompatible,e.metadataContent=JSON.stringify(JSON.parse(r.a())),e),f.j(n,u,!1,_Ewa.CustomFunctionsInstaller.x(i.osfControl.getStoreType()),_Ewa.sQ.a(f.d,i))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")},v:function(n,t){var i=new($$sc.C.$$(String)),r=this,u=this;return OSF.OUtil.xhrGet(t.metadataUrl,function(n){n?i.b(n):i.SX(Error.create("Invalid manifest"))},function(t){Diag.a.a(36721665,0,10,"CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",n,t);i.SX(Error.create("Failed to download manifest"))}),i.a},b:function(n,t,i){if(!_Ewa.CustomFunctionsInstaller.z(t)){Diag.a.a(39965660,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON.");throw Error.create("Invalid Metadata JSON");}var r=this;return _Ewa.bB.cwrtcwithfunc(Object,Boolean,_Ewa.CustomFunctionsInstaller.g(n),function(u){var f=u.a();if(!f&&(f=_Ewa.u.a(r.f,n,null),!f)){Diag.a.a(42541837,0,10,String.format("CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId {0} hasn't been installed yet.",n));throw Error.create("Customfunctions dynamic registration failed");}return f.metadataContent=JSON.stringify(JSON.parse(t)),f.isDynamicMetadata=!0,r.j(n,f,!0,!0,i)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")},c:function(n){this.g.c();var t,r=(t=new _Ewa.CustomFunctionsInstaller.C,t.solutionId=n,t),i=this;return _Ewa.bB.cwrtcwithfunc(Boolean,Boolean,_Ewa.CustomFunctionsInstaller.h(n),function(){return _Ewa.bB.cwrtcwithfunc(Boolean,Boolean,_Ewa.CustomFunctionsInstaller.i(n),function(){return i.t(i.g,n,r)},"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed")},String.format("CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",n))},p:function(){var n=this;return _Ewa.bB.cwrtcwithfunc(Array,Boolean,_Ewa.CustomFunctionsInstaller.c(),function(t){var i=t.a(),f,r,u,e;if(!i.length)return $$sc.a.a(Boolean,!0);for(Diag.a.a(37631833,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted."),f=new($$sc.u.$$($$sc.a)),r=[],u=0;u<i.length;u++)e=$$as(String,i[u]),f.b(_Ewa.bB.cwrtcwithresult(Object,Boolean,_Ewa.CustomFunctionsInstaller.g(e),function(t){var i=t.a(),u;return i&&(u=_Ewa.u.a(n.e,i.addinId,null),u&&u===i.metadataContent||(n.e[i.addinId]=i.metadataContent,n.f[e]=i,Array.add(r,i))),!0},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"));return _Ewa.bB.cwrtcfortaskwithfunc(Boolean,$$sc.a.WAE(f),function(){if(r.length){var t,u=(t=new _Ewa.CustomFunctionsInstaller.w,t.registrationInfos=r,t);return n.l(n.g,i,u)}return Diag.a.a(41211920,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),$$sc.a.a(Boolean,!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")},s:function(n){var t=new _Ewa.CustomFunctionsInstaller.l(n),i;return t.d()?(i=this,_Ewa.bB.cwrtcwithresult(String,Boolean,_Ewa.CustomFunctionsInstaller.A(t.a),function(n){var r=n.a();return!r||!r.length||OSF.OsfManifestManager.cacheManifestFromXml(t.a,t.b,r,i.d.f().UICultureTag),!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed")):$$sc.a.a(Boolean,!0)},j:function(n,t,i,r,u){var f=this;return _Ewa.bB.a(Boolean,_Ewa.bB.cwrtcwithresult(Boolean,$$sc.n.$$(Boolean),this.q(this.g,n,t,!1,i,u),function(){return r?_Ewa.CustomFunctionsInstaller.D(n,t):$$sc.a.a(Boolean,!0)},String.format("CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: {0}.",n)))},q:function(n,t,i,r,u,f){var e,o;return!u&&(e=_Ewa.u.a(this.e,i.addinId,null),e&&e===i.metadataContent)?$$sc.a.a(Boolean,!0):(this.e[i.addinId]=i.metadataContent,this.f[t]=i,this.d.isChangeGateEnabled("OfficeVSO:3533552_KeepOsfControlForSharedRuntimeCFRegistration")&&f||n.i(t),n.c(),o=this,_Ewa.bB.cwrtcwithfunc(Boolean,Boolean,this.r(n,t,i),function(){return o.i(i.addinId,r)},"Failed to register functions for customfunction addin"))},r:function(n,t,i){var r=new($$sc.C.$$(Boolean)),u=this,e=function(n){u.d.a(327)&&_Ewa.CustomFunctionsInstaller.a.a(_Ewa.CustomFunctionsInstaller.e,t);var f=n.Result;f&&f.ResponseStatusCode===204?r.b(!0):(delete u.e[i.addinId],delete u.f[t],_Ewa.bB.cwrtcwithaction(Boolean,_Ewa.CustomFunctionsInstaller.h(t),function(){_Ewa.bB.cwrtcwithaction(Boolean,_Ewa.CustomFunctionsInstaller.i(t),function(){u.k()},"Failed to show customfunctions installation error info")},String.format("CustomFunctionsInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",t,f?f.ResponseStatusCode.toString():"Unknown")),r.b(!1))},f=this,o=function(n){var u=_Ewa.V.a(n.b);Diag.a.a(36983963,0,10,"CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",t,_Ewa.h.a(u,","));f.d.a(327)&&_Ewa.CustomFunctionsInstaller.a.a(_Ewa.CustomFunctionsInstaller.d,t);delete f.e[i.addinId];delete f.f[t];r.b(!1)},s=this.n(i);return this.h(e,o,s,r,!0)},l:function(n,t,i){var u=new($$sc.C.$$(Boolean)),e=_Ewa.v.a().b().m,c=this;Array.forEach(t,function(t){var i=$$as(String,t);n.o(i)});n.c();var r=this,o=function(n){var f,l;r.d.a(327)&&_Ewa.CustomFunctionsInstaller.a.a(_Ewa.CustomFunctionsInstaller.e,Sys.Serialization.JavaScriptSerializer.serialize(t));var s=n.Result,o=!0,a=Sys.Serialization.JavaScriptSerializer.deserialize(s.ResponseBody.toString()),h=$$as(Array,a.value),c=new($$sc.u.$$($$sc.a));for(f=0;f<h.length;f++)l=h[f],l||(o=!1,c.b(_Ewa.bB.cwrtcwithfunc(Boolean,Boolean,_Ewa.CustomFunctionsInstaller.h(t[f]),function(){return delete r.e[i.registrationInfos[f].addinId],delete r.f[t[f]],_Ewa.CustomFunctionsInstaller.i(t[f])},String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionId: { 0}. Received status code { 1}.",t[f],s.ResponseStatusCode))));_Ewa.bB.cwrtcfortaskwithaction($$sc.a.WAE(c),function(){_Ewa.bB.cwrtcwithaction(Boolean,r.i("",!1),function(){var n=_Ewa.v.a().b().m;Diag.a.a(42541838,0,50,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes {0} Millisecond.",n-e);o?u.b(o):_Ewa.bB.cwrtcfortaskwithaction(r.k(),function(){u.b(o)},"Failed to show customfunctions installation error info")},String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"))},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},f=this,s=function(n){var o=_Ewa.V.a(n.b),r,e;for(Diag.a.a(40185999,0,10,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds {0}. Errors: {1}.",Sys.Serialization.JavaScriptSerializer.serialize(t),_Ewa.h.a(o,",")),f.d.a(327)&&_Ewa.CustomFunctionsInstaller.a.a(_Ewa.CustomFunctionsInstaller.d,Sys.Serialization.JavaScriptSerializer.serialize(t)),r=0;r<i.registrationInfos.length;r++)e=i.registrationInfos[r],delete f.e[e.addinId],delete f.f[t[r]];u.b(!1)},h=this.m(i);return this.h(o,s,h,u,!0)},t:function(n,t,i){var r=this;return _Ewa.bB.cwrtcwithfunc(Boolean,Boolean,this.u(n,t,i),function(){return r.i(i.solutionId,!1)},"Failed to unregister functions for customfunction addin")},u:function(n,t,i){var r=new($$sc.C.$$(Boolean));n.i(t);var u=this,f=function(){u.d.a(327)&&_Ewa.CustomFunctionsInstaller.a.a(_Ewa.CustomFunctionsInstaller.o,t);r.b(!0)},e=this,o=function(n){var i=_Ewa.V.a(n.b);Diag.a.a(40186001,0,10,"CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",t,_Ewa.h.a(i,","));e.d.a(327)&&_Ewa.CustomFunctionsInstaller.a.a(_Ewa.CustomFunctionsInstaller.n,t);r.b(!1)},s=this.o(i);return this.h(f,o,s,r,!1)},h:function(n,t,i,r,u){var e=this.d.g(),f=this.d.d(),o=null,s=null,h=null,l=this,c=function(){var a=e.i()||f.a().c()>0||f.b().c()>0;if(a)return!1;o&&e.e(o);s&&f.e(s);h&&f.g(h);var r=i.request,v=function(e,o){return l.d.a(327)&&_Ewa.CustomFunctionsInstaller.a.a(u?_Ewa.CustomFunctionsInstaller.m:_Ewa.CustomFunctionsInstaller.p,r.RequestBody),_Ewa.i.a(f.a(),"ExecuteRichApiRequest",i,_Ewa.n.a(e,n),_Ewa.n.b(o,t),null,0,null)},c=0;return l.d.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?r.RequestFlags&1&&(r.RequestFlags&256)!=256||(c=16):c=(r.RequestFlags&1)?0:16,e.d(new _Ewa.bd(507,0,v,c,null)),!0},a,v,y;return c()||(a=this,o=function(){c()},v=this,s=function(){c()},y=this,h=function(){c()},e.c(o),f.d(s),f.f(h)),r.a},n:function(n){var t={},i;return t.HttpMethod="POST",t.PathAndQuery="RegisterCustomFunctions",t.RequestHeaders=null,t.RequestBody=JSON.stringify(n),t.RequestFlags=1,this.d.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(t.RequestFlags=t.RequestFlags|256),i=this.d.d().a().a(1,null),i.request=t,i},m:function(n){var t={},i;return t.HttpMethod="POST",t.PathAndQuery="BatchRegisterCustomFunctions",t.RequestHeaders=null,t.RequestBody=JSON.stringify(n),t.RequestFlags=1,this.d.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(t.RequestFlags=t.RequestFlags|256),i=this.d.d().a().a(1,null),i.request=t,i},o:function(n){var t={},i;return t.HttpMethod="POST",t.PathAndQuery="UnregisterCustomFunctions",t.RequestHeaders=null,t.RequestBody=JSON.stringify(n),t.RequestFlags=1,this.d.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(t.RequestFlags=t.RequestFlags|256),i=this.d.d().a().a(1,null),i.request=t,i},i:function(n,t){var i=_Ewa.k.a(_Ewa.es,this.d.b(),153,this.d.i(),-2),r=this;return _Ewa.bB.cwrtcwithfuncwithcancellationtokenandtaskscheduler(_Ewa.es,Boolean,i,function(){return i.a().a(!1),!n||!n.length||!t?$$sc.a.a(Boolean,!0):r.s(n)},this.d.i(),_Ewa.dH.b(),"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")},k:function(){var n=new _Ewa.T(1949669462,0,this.d.t(),0,null);return this.d.h().b(n,null,null)}};_Ewa.CustomFunctionsInstaller.w=function(){};_Ewa.CustomFunctionsInstaller.y=function(){};_Ewa.CustomFunctionsInstaller.C=function(){};_Ewa.CustomFunctionsInstaller.l=function(n){var t=n.split("|"),i=t[0];this.a=t[1];this.b=t[2];this.c=t[3]};_Ewa.CustomFunctionsInstaller.l.prototype={c:null,a:null,b:null,d:function(){return this.c===OSF.StoreTypeEnum.Registry.toString()}};_Ewa.CustomFunctionsInstaller.b=function(n,t){this.a=n;this.b=t};_Ewa.CustomFunctionsInstaller.b.prototype={a:0,b:null};_Ewa.CustomFunctionsInstaller.a=function(){};_Ewa.CustomFunctionsInstaller.a.a=function(n,t){_Ewa.bB.cwrtcwithresult(String,Boolean,_Ewa.CustomFunctionsInstaller.r("CustomFunctionsRuntimeLogging"),function(i){var u=i.a(),r;if(u&&window.console){r=_Ewa.CustomFunctionsInstaller.a.b(n.a)+" "+n.b+t;switch(n.a){case 2:window.console.log&&window.console.log(r);break;case 0:window.console.info&&window.console.info(r);break;case 1:window.console.error&&window.console.error(r)}}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")};_Ewa.CustomFunctionsInstaller.a.b=function(n){switch(n){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};_Ewa.CustomFunctionsLegacyInstaller=function(n){this.e={};this.d=n;this.m().j()};_Ewa.CustomFunctionsLegacyInstaller.g=function(){return $$as(Array,Sys.Serialization.JavaScriptSerializer.deserialize(_Ewa.CustomFunctionsLegacyInstaller.c(_Ewa.dD.c())||"[]"))||[]};_Ewa.CustomFunctionsLegacyInstaller.s=function(n){_Ewa.CustomFunctionsLegacyInstaller.j(_Ewa.dD.c(),Sys.Serialization.JavaScriptSerializer.serialize(n))};_Ewa.CustomFunctionsLegacyInstaller.f=function(n){var t=_Ewa.CustomFunctionsLegacyInstaller.c(_Ewa.dD.b(n))||"";return t.length>0?Sys.Serialization.JavaScriptSerializer.deserialize(t,!0):null};_Ewa.CustomFunctionsLegacyInstaller.z=function(n,t){_Ewa.CustomFunctionsLegacyInstaller.p(n);_Ewa.CustomFunctionsLegacyInstaller.j(_Ewa.dD.b(n),Sys.Serialization.JavaScriptSerializer.serialize(t))};_Ewa.CustomFunctionsLegacyInstaller.h=function(n){_Ewa.CustomFunctionsLegacyInstaller.q(n);_Ewa.CustomFunctionsLegacyInstaller.r(_Ewa.dD.b(n))};_Ewa.CustomFunctionsLegacyInstaller.x=function(n){return _Ewa.CustomFunctionsLegacyInstaller.c(_Ewa.dD.a(n))};_Ewa.CustomFunctionsLegacyInstaller.A=function(n,t){_Ewa.CustomFunctionsLegacyInstaller.p(n);_Ewa.CustomFunctionsLegacyInstaller.j(_Ewa.dD.a(n),t)};_Ewa.CustomFunctionsLegacyInstaller.i=function(n){_Ewa.CustomFunctionsLegacyInstaller.q(n);_Ewa.CustomFunctionsLegacyInstaller.r(_Ewa.dD.a(n))};_Ewa.CustomFunctionsLegacyInstaller.p=function(n){var t=_Ewa.CustomFunctionsLegacyInstaller.g(),i=n.toLowerCase();Array.contains(t,i)||(t.push(i),_Ewa.CustomFunctionsLegacyInstaller.s(t))};_Ewa.CustomFunctionsLegacyInstaller.q=function(n){var t=_Ewa.CustomFunctionsLegacyInstaller.g(),i=n.toLowerCase();Array.contains(t,i)&&(t.splice(Array.indexOf(t,i),1),_Ewa.CustomFunctionsLegacyInstaller.s(t))};_Ewa.CustomFunctionsLegacyInstaller.t=function(n,t){var i=new _Ewa.CustomFunctionsLegacyInstaller.k(n);i.d()&&_Ewa.CustomFunctionsLegacyInstaller.A(i.a,t)};_Ewa.CustomFunctionsLegacyInstaller.c=function(n){try{return localStorage.getItem(n)}catch(t){return Diag.a.a(42541854,0,50,"CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: {0}",t.message||"Unknown"),null}};_Ewa.CustomFunctionsLegacyInstaller.j=function(n,t){try{localStorage.setItem(n,t)}catch(i){Diag.a.a(42541855,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",i.message||"Unknown")}};_Ewa.CustomFunctionsLegacyInstaller.r=function(n){try{localStorage.removeItem(n)}catch(t){Diag.a.a(42541856,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",t.message||"Unknown")}};_Ewa.CustomFunctionsLegacyInstaller.w=function(n){if(!n||!n.length)return!1;try{JSON.parse(n)}catch(t){return!1}return!0};_Ewa.CustomFunctionsLegacyInstaller.prototype={d:null,a:function(n,t,i){var u=new($$sc.C.$$(Boolean)),e,r,f,o,s;if(!_Ewa.e.a(i.invariantNamespace))for(e=0;e<i.invariantNamespace.length;++e)if(r=i.invariantNamespace.charAt(e),r!=="."&&r!=="_"&&r<"a"&&"z"<r&&r<"A"&&"Z"<r&&r<"0"&&"9"<r)return Diag.a.a(42541841,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",r,e),u.b(!1),u.a;return _Ewa.CustomFunctionsLegacyInstaller.t(t,i.manifest),f=_Ewa.CustomFunctionsLegacyInstaller.f(n),f&&f.isDynamicMetadata?this.h(n,f,u,!1,!1):(o=this,s=this,OSF.OUtil.xhrGet(i.metadataUrl,function(r){var e;f=(e=new _Ewa.CustomFunctionsLegacyInstaller.v,e.addinId=t,e.locale=i.locale,e.addinInvariantNamespace=i.invariantNamespace,e.addinNamespace=i.namespace,e.addinTitle=i.title,e.isXllCompatible=i.isXllCompatible,e.metadataContent=JSON.stringify(JSON.parse(r)),e);o.h(n,f,u,!1,_Ewa.sQ.a(o.d,i))},function(t){Diag.a.a(42541843,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",n,t);u.b(!1)})),u.a},b:function(n,t){var i=new($$sc.C.$$(Boolean)),r;return _Ewa.CustomFunctionsLegacyInstaller.w(t)?(r=_Ewa.CustomFunctionsLegacyInstaller.f(n),!r)?(Diag.a.a(42541845,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),i.b(!1),i.a):(r.metadataContent=JSON.stringify(JSON.parse(t)),r.isDynamicMetadata=!0,this.h(n,r,i,!0,!1),i.a):(Diag.a.a(42541844,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),i.b(!1),i.a)},c:function(n){var t=new($$sc.C.$$(Boolean)),i=_Ewa.k.a(_Ewa.bA,this.d.b(),106,this.d.i(),-2),r=this;return _Ewa.f.cw(i,function(){var f=i.a(),u,e;f.c();e=(u=new _Ewa.CustomFunctionsLegacyInstaller.y,u.solutionId=n,u);_Ewa.CustomFunctionsLegacyInstaller.h(n);_Ewa.CustomFunctionsLegacyInstaller.i(n);_Ewa.f.cw(r.p(f,n,e),function(i){_Ewa.cr.a(i)?t.b(i.a()):(i.b===5?Diag.a.a(42541847,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",n):i.b===4&&Diag.a.a(42541848,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: {0}.",n),t.b(!1))},r.d.i(),0)},this.d.i(),3),t.a},m:function(){var n=new($$sc.C.$$(Boolean)),i=_Ewa.CustomFunctionsLegacyInstaller.g(),t,r,u,f;return(i.length>0&&Diag.a.a(42541849,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted."),t=[],r=this,Array.forEach(i,function(n){var f=$$as(String,n),i=_Ewa.CustomFunctionsLegacyInstaller.f(f),u;i&&(u=_Ewa.u.a(r.e,i.addinId,null),u&&u===i.metadataContent||(r.e[i.addinId]=i.metadataContent,Array.add(t,i)))}),!t.length)?(n.b(!0),Diag.a.a(42541850,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),n.a):(u=_Ewa.k.a(_Ewa.bA,this.d.b(),106,this.d.i(),-2),f=this,_Ewa.f.cw(u,function(){var e=u.a(),r,o=(r=new _Ewa.CustomFunctionsLegacyInstaller.u,r.registrationInfos=t,r);_Ewa.f.cw(f.i(e,i,o),function(t){_Ewa.cr.a(t)?n.b(t.a()):(t.b===5?Diag.a.a(42541852,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):t.b===4&&Diag.a.a(42541853,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),n.b(!1))},f.d.i(),0)},this.d.i(),3),n.a)},o:function(n){var t=new _Ewa.CustomFunctionsLegacyInstaller.k(n),i;t.d()&&(i=_Ewa.CustomFunctionsLegacyInstaller.x(t.a),OSF.OsfManifestManager.cacheManifestFromXml(t.a,t.b,i,this.d.f().UICultureTag))},h:function(n,t,i,r,u){var f=_Ewa.k.a(_Ewa.bA,this.d.b(),106,this.d.i(),-2),e=this;_Ewa.f.cw(f,function(){var o=f.a();_Ewa.f.cw(e.n(o,n,t,!1,r,u),function(r){if(_Ewa.cr.a(r)){var u=r.a();u&&_Ewa.CustomFunctionsLegacyInstaller.z(n,t);i.b(u)}else r.b===5?Diag.a.a(42541858,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: {0}.",n):r.b===4&&Diag.a.a(42541859,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: {0}.",n),i.b(!1)},e.d.i(),0)},this.d.i(),3)},n:function(n,t,i,r,u,f){var s,e;if(!u&&(s=_Ewa.u.a(this.e,i.addinId,null),s&&s===i.metadataContent))return $$sc.a.a(Boolean,!0);this.e[i.addinId]=i.metadataContent;e=new($$sc.C.$$(Boolean));this.d.isChangeGateEnabled("OfficeVSO:3533552_KeepOsfControlForSharedRuntimeCFRegistration")&&f||n.i(t);n.c();var o=this,c=function(n){var f,s,u,h;o.d.a(327)&&_Ewa.CustomFunctionsLegacyInstaller.a.a(_Ewa.CustomFunctionsLegacyInstaller.e,t);f=n.Result;f.ResponseStatusCode===204?_Ewa.f.cw(o.g(e,i.addinId,r),function(n){n.b===5?!t||!t.length?Diag.a.a(42541890,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId {0}.",i.addinId):Diag.a.a(42541889,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}.",t):n.b===4&&(!t||!t.length?Diag.a.a(42541892,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId {0}.",i.addinId):Diag.a.a(42541891,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution {0}.",t));e.b(!1)},o.d.i(),4):(s=function(){delete o.e[i.addinId];_Ewa.CustomFunctionsLegacyInstaller.h(t);_Ewa.CustomFunctionsLegacyInstaller.i(t);Diag.a.a(42541893,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",t,f.ResponseStatusCode);e.b(!1)},h=(u=new CommandUI.AddInCommands.l,u.e=OSF.InfoType.Error,u.c=i.addinTitle,u.f=String.format(_Ewa.ClientStringManager.a().c(103),_Ewa.ClientStringManager.a().a(1582)),u.g=_Ewa.ClientStringManager.a().a(4),u.a=s,u.h=!1,u.b=s,u.d=OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError,u),CommandUI.AddInCommands.a.h(h))},h=this,l=function(n){var r=_Ewa.V.a(n.b);Diag.a.a(42541894,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",t,_Ewa.h.a(r,","));h.d.a(327)&&_Ewa.CustomFunctionsLegacyInstaller.a.a(_Ewa.CustomFunctionsLegacyInstaller.d,t);delete h.e[i.addinId];e.b(!1)},a=this.k(i);return this.f(c,l,a,e,!0)},i:function(n,t,i){var r=new($$sc.C.$$(Boolean)),h=this;Array.forEach(t,function(t){var i=$$as(String,t);n.o(i)});n.c();var u=this,e=function(n){var f,h;u.d.a(327)&&_Ewa.CustomFunctionsLegacyInstaller.a.a(_Ewa.CustomFunctionsLegacyInstaller.e,Sys.Serialization.JavaScriptSerializer.serialize(t));var e=n.Result,o=!0,c=Sys.Serialization.JavaScriptSerializer.deserialize(e.ResponseBody.toString()),s=$$as(Array,c.value);for(f=0;f<s.length;f++)h=s[f],h||(o=!1,delete u.e[i.registrationInfos[f].addinId],_Ewa.CustomFunctionsLegacyInstaller.h(t[f]),_Ewa.CustomFunctionsLegacyInstaller.i(t[f]),Diag.a.a(42541896,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: {0}. Received status code {1}.",t[f],e.ResponseStatusCode));_Ewa.f.cw(u.g(r,"",!1),function(n){n.b===5?Diag.a.a(42541897,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):n.b===4&&Diag.a.a(42541898,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");r.b(!1)},u.d.i(),4);r.b(o)},f=this,o=function(n){var s=_Ewa.V.a(n.b),o;Diag.a.a(42541899,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds {0}. Errors: {1}.",Sys.Serialization.JavaScriptSerializer.serialize(t),_Ewa.h.a(s,","));f.d.a(327)&&_Ewa.CustomFunctionsLegacyInstaller.a.a(_Ewa.CustomFunctionsLegacyInstaller.d,Sys.Serialization.JavaScriptSerializer.serialize(t));for(var e=i.registrationInfos,h=e.length,u=0;u<h;++u)o=e[u],delete f.e[o.addinId];r.b(!1)},s=this.j(i);return this.f(e,o,s,r,!0)},p:function(n,t,i){var r=new($$sc.C.$$(Boolean));n.i(t);var u=this,f=function(){u.d.a(327)&&_Ewa.CustomFunctionsLegacyInstaller.a.a(_Ewa.CustomFunctionsLegacyInstaller.n,t);_Ewa.f.cw(u.g(r,i.solutionId,!1),function(n){n.b===5?!t||!t.length||Diag.a.a(42541901,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}.",t):n.b===4&&(!t||!t.length||Diag.a.a(42541902,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution {0}.",t));r.b(!1)},u.d.i(),4)},e=this,o=function(n){var i=_Ewa.V.a(n.b);Diag.a.a(42541903,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",t,_Ewa.h.a(i,","));e.d.a(327)&&_Ewa.CustomFunctionsLegacyInstaller.a.a(_Ewa.CustomFunctionsLegacyInstaller.m,t);r.b(!1)},s=this.l(i);return this.f(f,o,s,r,!1)},f:function(n,t,i,r,u){var e=this.d.g(),f=this.d.d(),o=null,s=null,h=null,l=this,c=function(){var c=e.i()||f.a().c()>0||f.b().c()>0;if(c)return!1;o&&e.e(o);s&&f.e(s);h&&f.g(h);var r=i.request,a=function(e,o){return l.d.a(327)&&_Ewa.CustomFunctionsLegacyInstaller.a.a(u?_Ewa.CustomFunctionsLegacyInstaller.l:_Ewa.CustomFunctionsLegacyInstaller.o,r.RequestBody),_Ewa.i.a(f.a(),"ExecuteRichApiRequest",i,_Ewa.n.a(e,n),_Ewa.n.b(o,t),null,0,null)},v=(r.RequestFlags&1)?0:16;return e.d(new _Ewa.bd(507,0,a,v,null)),!0},a,v,y;return c()||(a=this,o=function(){c()},v=this,s=function(){c()},y=this,h=function(){c()},e.c(o),f.d(s),f.f(h)),r.a},k:function(n){var t={},i;return t.HttpMethod="POST",t.PathAndQuery="RegisterCustomFunctions",t.RequestHeaders=null,t.RequestBody=JSON.stringify(n),t.RequestFlags=1,i=this.d.d().a().a(1,null),i.request=t,i},j:function(n){var t={},i;return t.HttpMethod="POST",t.PathAndQuery="BatchRegisterCustomFunctions",t.RequestHeaders=null,t.RequestBody=JSON.stringify(n),t.RequestFlags=1,i=this.d.d().a().a(1,null),i.request=t,i},l:function(n){var t={},i;return t.HttpMethod="POST",t.PathAndQuery="UnregisterCustomFunctions",t.RequestHeaders=null,t.RequestBody=JSON.stringify(n),t.RequestFlags=1,i=this.d.d().a().a(1,null),i.request=t,i},g:function(n,t,i){var r=_Ewa.k.a(_Ewa.es,this.d.b(),153,this.d.i(),-2),u=this;return _Ewa.f.cw(r,function(){r.a().a(!1);!t||!t.length||!i||u.o(t);n.b(!0)},this.d.i(),3),r}};_Ewa.CustomFunctionsLegacyInstaller.u=function(){};_Ewa.CustomFunctionsLegacyInstaller.v=function(){};_Ewa.CustomFunctionsLegacyInstaller.y=function(){};_Ewa.CustomFunctionsLegacyInstaller.k=function(n){var t=n.split("|"),i=t[0];this.a=t[1];this.b=t[2];this.c=t[3]};_Ewa.CustomFunctionsLegacyInstaller.k.prototype={c:null,a:null,b:null,d:function(){return this.c===OSF.StoreTypeEnum.Registry.toString()}};_Ewa.CustomFunctionsLegacyInstaller.b=function(n,t){this.a=n;this.b=t};_Ewa.CustomFunctionsLegacyInstaller.b.prototype={a:0,b:null};_Ewa.CustomFunctionsLegacyInstaller.a=function(){};_Ewa.CustomFunctionsLegacyInstaller.a.a=function(n,t){if(_Ewa.CustomFunctionsLegacyInstaller.c("CustomFunctionsRuntimeLogging")&&window.console){var i=_Ewa.CustomFunctionsLegacyInstaller.a.b(n.a)+" "+n.b+t;switch(n.a){case 2:window.console.log&&window.console.log(i);break;case 0:window.console.info&&window.console.info(i);break;case 1:window.console.error&&window.console.error(i)}}};_Ewa.CustomFunctionsLegacyInstaller.a.b=function(n){switch(n){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};_Ewa.sP=function(n){_Ewa.sP.initializeBase(this);this.h=n;this.j()};_Ewa.sP.a=function(n){n.b().b(_Ewa.baj.$$(_Ewa.dE),279,new _Ewa.sP(n))};_Ewa.sP.prototype={h:null,b:function(){var n,t;this.h.a(594)?(t=this,_Ewa.bB.cwrtcwithactionwithcancellationtokenandtaskscheduler(_Ewa.bA,_Ewa.k.a(_Ewa.bA,this.h.b(),106,this.h.i(),-2),function(n){t.i(t.h.b().a(_Ewa.dE,278,!1)||new _Ewa.CustomFunctionsInstaller(t.h,n.a()))},this.du(),_Ewa.dH.b(),"CustomFunctionsInstallerFactory::Create: Failed to create DdaFacadeServiceFactory")):(n=this.h.b().a(_Ewa.dE,278,!1),n||(n=this.h.b().b(_Ewa.dE,278,new _Ewa.CustomFunctionsLegacyInstaller(this.h))),this.i(n))}};_Ewa.bB=function(){};_Ewa.bB.cwrtcwithaction=function(n,t,i,r){return _Ewa.bB.cwrtcwithactionwithcancellationtokenandtaskscheduler(n,t,i,$$sc.f.a,$$sc.c.a,r)};_Ewa.bB.cwrtcwithactionwithcancellationtokenandtaskscheduler=function(n,t,i,r,u,f){var e=t.CWCT(function(){i(t)},r,3,u);return e.CWo(function(){Diag.a.a(42541908,0,10,f)},4),e};_Ewa.bB.cwrtcwithfunc=function(n,t,i,r,u){return _Ewa.bB.cwrtcwithfuncwithcancellationtokenandtaskscheduler(n,t,i,r,$$sc.f.a,$$sc.c.a,u)};_Ewa.bB.cwrtcwithfuncwithcancellationtokenandtaskscheduler=function(n,t,i,r,u,f,e){var o=i.CWRCT($$sc.n.$$(t),function(){return r(i)},u,3,f);return o.CWo(function(){Diag.a.a(42541909,0,10,e)},4),_Ewa.bB.a(t,o)};_Ewa.bB.cwrtcwithresult=function(n,t,i,r,u){return _Ewa.bB.cwrtcwithresultwithcancellationtokenandtaskscheduler(n,t,i,r,$$sc.f.a,$$sc.c.a,u)};_Ewa.bB.cwrtcwithresultwithcancellationtokenandtaskscheduler=function(n,t,i,r,u,f,e){var o=i.CWRCT(t,function(){return r(i)},u,3,f);return o.CWo(function(){Diag.a.a(42541910,0,10,e)},4),o};_Ewa.bB.cwrtcfortaskwithfunc=function(n,t,i,r){return _Ewa.bB.cwrtcfortaskwithfuncwithcancellationtokenandtaskscheduler(n,t,i,$$sc.f.a,$$sc.c.a,r)};_Ewa.bB.cwrtcfortaskwithfuncwithcancellationtokenandtaskscheduler=function(n,t,i,r,u,f){var e=t.CWRCT($$sc.n.$$(n),function(){return i(t)},r,3,u);return e.CWo(function(){Diag.a.a(42541911,0,10,f)},4),_Ewa.bB.a(n,e)};_Ewa.bB.cwrtcfortaskwithaction=function(n,t,i){return _Ewa.bB.cwrtcfortaskwithactionwithcancellationtokenandtaskscheduler(n,t,$$sc.f.a,$$sc.c.a,i)};_Ewa.bB.cwrtcfortaskwithactionwithcancellationtokenandtaskscheduler=function(n,t,i,r,u){var f=n.CWCT(function(){t(n)},i,3,r);return f.CWo(function(){Diag.a.a(42541912,0,10,u)},4),f};_Ewa.bB.a=function(n,t){var i=new($$sc.C.$$(n));return t.CWo(function(){t.a().CWo(function(){i.b(t.a().a())},3);t.a().CWo(function(){i.e()},6);t.a().CWo(function(n){i.SX(n.c)},5)},3),t.CWo(function(){i.e()},6),t.CWo(function(n){i.SX(n.c)},5),i.a};_Ewa.db=function(){};_Ewa.db.d=function(){return!!_Ewa.db.b()&&typeof _Ewa.db.b().open!="undefined"};_Ewa.db.b=function(){var n=null;return window.indexedDB?n=window.indexedDB:window.webkitIndexedDB?n=window.webkitIndexedDB:window.mozIndexedDB?n=window.mozIndexedDB:window.msIndexedDB&&(n=window.msIndexedDB),n};_Ewa.db.a=function(n){n.objectStoreNames.contains("CustomFunction")||n.createObjectStore("CustomFunction",new _Ewa.Do("key"))};_Ewa.db.e=function(){var t=new($$sc.C.$$(Object)),i=_Ewa.db.b(),n=i.open("CustomFunctionCache");return n.onsuccess=function(){var i=n.result;Diag.a.a(42541913,0,50,"OpenIndexedDB {0} success",i.name);t.b(i)},n.onupgradeneeded=function(){var t=n.result;_Ewa.db.a(t)},n.onerror=function(n){Diag.a.a(42541914,0,10,"OpenIndexedDB {0} failed",n);t.SX(Error.create("Failed to open IndexedDB"))},t.a};_Ewa.db.g=function(n,t){var i=new($$sc.C.$$(String));_Ewa.db.a(n);var u=_Ewa.v.a().b().m,f=_Ewa.db.c(n,!0),r=f.get(t);return r.onsuccess=function(n){var t=n.target.result,r;t?(i.b(t.value),r=_Ewa.v.a().b().m,Diag.a.a(42541915,0,50,"IndexedDBUtils.GetFromIndexedDB takes {0} Millisecond.",r-u)):i.b("")},r.onerror=function(){i.SX(Error.create(r.error?r.error.message:"DB error"))},i.a};_Ewa.db.c=function(n,t){var i=n.transaction(["CustomFunction"],t?"readonly":"readwrite");return i.objectStore("CustomFunction")};_Ewa.db.i=function(n){return _Ewa.bB.cwrtcwithresult(Object,Boolean,_Ewa.db.e(),function(t){var i=t.a(),r,u,f;return _Ewa.db.a(i),r=_Ewa.v.a().b().m,u=_Ewa.db.c(i,!1),u.put(n),f=_Ewa.v.a().b().m,Diag.a.a(42541916,0,50,"IndexedDBUtils.SaveToIndexedDB takes {0} Millisecond.",f-r),!0},"IndexedDBUtils::SaveToIndexedDB failed due to OpenIdexedDB failed")};_Ewa.db.f=function(n){return _Ewa.bB.cwrtcwithresult(Object,Boolean,_Ewa.db.e(),function(t){var i=t.a(),r,u,f;return _Ewa.db.a(i),r=_Ewa.v.a().b().m,u=_Ewa.db.c(i,!1),u["delete"](n),f=_Ewa.v.a().b().m,Diag.a.a(42541917,0,50,"IndexedDBUtils.DeleteFromIndexedDB takes {0} Millisecond.",f-r),!0},"IndexedDBUtils::DeleteFromIndexedDB failed due to OpenIdexedDB failed")};_Ewa.db.h=function(n){return _Ewa.bB.cwrtcwithfunc(Object,String,_Ewa.db.e(),function(t){var i=t.a();return _Ewa.db.g(i,n)},"IndexedDBUtils::GetFromIndexedDB failed due to OpenIdexedDB failed")};_Ewa.Dn.registerClass("_Ewa.Dn");_Ewa.CustomFunctionsInstaller.registerClass("_Ewa.CustomFunctionsInstaller",null,_Ewa.dE);_Ewa.CustomFunctionsInstaller.w.registerClass("_Ewa.CustomFunctionsInstaller.w");_Ewa.CustomFunctionsInstaller.y.registerClass("_Ewa.CustomFunctionsInstaller.y");_Ewa.CustomFunctionsInstaller.C.registerClass("_Ewa.CustomFunctionsInstaller.C");_Ewa.CustomFunctionsLegacyInstaller.registerClass("_Ewa.CustomFunctionsLegacyInstaller",null,_Ewa.dE);_Ewa.CustomFunctionsLegacyInstaller.u.registerClass("_Ewa.CustomFunctionsLegacyInstaller.u");_Ewa.CustomFunctionsLegacyInstaller.v.registerClass("_Ewa.CustomFunctionsLegacyInstaller.v");_Ewa.CustomFunctionsLegacyInstaller.y.registerClass("_Ewa.CustomFunctionsLegacyInstaller.y");_Ewa.sP.registerClass("_Ewa.sP",_Ewa.pU.$$(_Ewa.dE));_Ewa.CustomFunctionsInstaller.m=new _Ewa.CustomFunctionsInstaller.b(2,"CustomFunctions [Registration] [Begin] SolutionId=");_Ewa.CustomFunctionsInstaller.e=new _Ewa.CustomFunctionsInstaller.b(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");_Ewa.CustomFunctionsInstaller.d=new _Ewa.CustomFunctionsInstaller.b(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");_Ewa.CustomFunctionsInstaller.p=new _Ewa.CustomFunctionsInstaller.b(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");_Ewa.CustomFunctionsInstaller.o=new _Ewa.CustomFunctionsInstaller.b(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");_Ewa.CustomFunctionsInstaller.n=new _Ewa.CustomFunctionsInstaller.b(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");_Ewa.CustomFunctionsLegacyInstaller.l=new _Ewa.CustomFunctionsLegacyInstaller.b(2,"CustomFunctions [Registration] [Begin] SolutionId=");_Ewa.CustomFunctionsLegacyInstaller.e=new _Ewa.CustomFunctionsLegacyInstaller.b(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");_Ewa.CustomFunctionsLegacyInstaller.d=new _Ewa.CustomFunctionsLegacyInstaller.b(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");_Ewa.CustomFunctionsLegacyInstaller.o=new _Ewa.CustomFunctionsLegacyInstaller.b(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");_Ewa.CustomFunctionsLegacyInstaller.n=new _Ewa.CustomFunctionsLegacyInstaller.b(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");_Ewa.CustomFunctionsLegacyInstaller.m=new _Ewa.CustomFunctionsLegacyInstaller.b(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Type.registerNamespace("_Ewa");_Ewa.Wa=function(){};_Ewa.Wa.a=function(){_Ewa.j.a(function(n){n.a(158)&&_Ewa.sP.a(n)})};_Ewa.Wa.a();Type.registerNamespace("_Ewa");_Ewa.HN=function(n,t,i){this.g=Function.createDelegate(this,this.m);this.f=t;this.e=i;this.b=n;this.b.N()&&this.b.cO(this.g);n.b().b(_Ewa.jO,297,this)};_Ewa.HN.prototype={b:null,d:null,c:null,f:null,e:null,k:function(){return this.b.N()&&this.b.a(12)},a:function(n,t){if(this.b.N()){if(!n||!t){Diag.a.a(40232404,0,10,"MacroRecorderEventHandler.Init failed because the functions passed in are null.");return}this.d=n;this.c=t}},j:function(n){var i,u,f;if(this.i())try{if(this.e.c(n)){i=this.e.d(n);for(var r=i,e=r.length,t=0;t<e;++t)u=r[t],this.h(u)}else this.h(n)}catch(o){f=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Error: {0}, Message: {1}",Enum.toString(_Ewa.fb,n.a()),o.message);Diag.a.a(40232405,0,10,f)}},h:function(n){var t=this.f.e(n,this.k()),i,r;t?(this.c(t.b(),_Ewa.H.a(n.b())),i=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}",t.b()),Diag.a.a(42259009,0,50,i)):_Ewa.bq.b().b(n.a())||(this.c(0,_Ewa.H.a(n.a())),r=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: {0}",Enum.toString(_Ewa.fb,n.a())),Diag.a.a(40232406,0,50,r))},l:function(){return this.d?this.d():!1},m:function(n,t){this.i()&&this.j(t)},i:function(){return!this.b.N()||!this.c||!this.l()?!1:!0}};_Ewa.vz=function(n){_Ewa.vz.initializeBase(this);this.h=n;this.j()};_Ewa.vz.a=function(n){n.b().b(_Ewa.baj.$$(_Ewa.jO),298,new _Ewa.vz(n))};_Ewa.vz.prototype={h:null,b:function(){this.i(this.h.b().a(_Ewa.jO,297,!1)||new _Ewa.HN(this.h,new _Ewa.eT,new _Ewa.HM))}};_Ewa.Hs=function(){_Ewa.Hs.initializeBase(this)};_Ewa.Hs.prototype={b:function(){return 65},c:function(){this.a(516)}};_Ewa.Ht=function(){_Ewa.Ht.initializeBase(this)};_Ewa.Ht.prototype={b:function(){return 118},c:function(){this.a(502)},e:function(){var n=this;this.d(function(n){var t=n,i=t.sharedSheetRange.FirstColumn===t.sharedSheetRange.LastColumn&&t.sharedSheetRange.FirstRow===t.sharedSheetRange.LastRow;return!i})}};_Ewa.HG=function(){_Ewa.HG.initializeBase(this)};_Ewa.HG.prototype={b:function(){return 49},c:function(){this.a(149);this.a(147)}};_Ewa.HH=function(){_Ewa.HH.initializeBase(this)};_Ewa.HH.prototype={b:function(){return 96},c:function(){this.a(122)}};_Ewa.HI=function(){_Ewa.HI.initializeBase(this)};_Ewa.HI.prototype={b:function(){return 93},c:function(){this.a(522)}};_Ewa.HJ=function(){_Ewa.HJ.initializeBase(this)};_Ewa.HJ.prototype={b:function(){return 94},c:function(){this.a(524)}};_Ewa.HK=function(){_Ewa.HK.initializeBase(this)};_Ewa.HK.prototype={b:function(){return 95},c:function(){this.a(523)}};_Ewa.Hu=function(){var n;_Ewa.Hu.initializeBase(this,[84,(n=new($$sc.u.$$(_Ewa.fz)),n.b(348),n.b(349),n.b(350),n.b(351),n.b(352),n.b(353),n.b(354),n.b(355),n.b(356),n.b(357),n.b(372),n.b(373),n.b(374),n.b(375),n)])};_Ewa.Hv=function(){var n;_Ewa.Hv.initializeBase(this,[80,(n=new($$sc.u.$$(_Ewa.fz)),n.b(-104),n.b(-103),n.b(300),n.b(301),n.b(302),n.b(303),n.b(304),n.b(305),n.b(306),n.b(307),n.b(308),n.b(309),n.b(310),n.b(311),n)])};_Ewa.Hw=function(){var n;_Ewa.Hw.initializeBase(this,[82,(n=new($$sc.u.$$(_Ewa.fz)),n.b(200),n.b(201),n.b(202),n.b(203),n.b(204),n.b(205),n.b(206),n.b(207),n.b(208),n.b(209),n.b(210),n)])};_Ewa.Hx=function(){var n;_Ewa.Hx.initializeBase(this,[76,(n=new($$sc.u.$$(_Ewa.fz)),n.b(-100),n)])};_Ewa.Hy=function(){var n;_Ewa.Hy.initializeBase(this,[83,(n=new($$sc.u.$$(_Ewa.fz)),n.b(500),n.b(501),n.b(502),n)])};_Ewa.im=function(){_Ewa.im.initializeBase(this)};_Ewa.im.prototype={b:function(){return 117},i:function(n){return _Ewa.im.a||(_Ewa.im.a=new($$sc.q.$$(String))($$sc.e.a()),_Ewa.im.a.a("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),_Ewa.im.a.a("fa000000014")),_Ewa.im.a.b(n)},c:function(){this.a(507);this.a(10)},e:function(){var n=this;this.d(function(t){if(_Ewa.gd.isInstanceOfType(t)){var i=$$as(_Ewa.gd,t);return i.a()&&n.i(i.source)}return!1})}};_Ewa.Hz=function(){var n;_Ewa.Hz.initializeBase(this,[85,(n=new($$sc.u.$$(_Ewa.fz)),n.b(328),n.b(329),n.b(330),n.b(331),n.b(332),n.b(333),n.b(334),n.b(335),n)])};_Ewa.Ir=function(){_Ewa.Ir.initializeBase(this)};_Ewa.Ir.prototype={b:function(){return 86},c:function(){this.a(150)}};_Ewa.HA=function(){_Ewa.HA.initializeBase(this)};_Ewa.HA.prototype={b:function(){return 66},c:function(){this.a(528)}};_Ewa.HB=function(){var n;_Ewa.HB.initializeBase(this,[81,(n=new($$sc.u.$$(_Ewa.fz)),n.b(100),n.b(101),n.b(102),n.b(103),n.b(104),n.b(105),n.b(106),n)])};_Ewa.baO=function(n,t){_Ewa.baO.initializeBase(this);this.i=n;this.j=t};_Ewa.baO.prototype={i:0,j:null,b:function(){return this.i},c:function(){this.a(529)},e:function(){var n=this;this.d(function(t){return n.j.c(t.operationType)})}};_Ewa.HC=function(){var n;_Ewa.HC.initializeBase(this,[75,(n=new($$sc.u.$$(_Ewa.fz)),n.b(-101),n)])};_Ewa.HD=function(){var n;_Ewa.HD.initializeBase(this,[79,(n=new($$sc.u.$$(_Ewa.fz)),n.b(0),n.b(1),n.b(2),n.b(-102),n)])};_Ewa.HE=function(){var n;_Ewa.HE.initializeBase(this,[78,(n=new($$sc.u.$$(_Ewa.fz)),n.b(-105),n.b(-106),n.b(-107),n.b(-108),n.b(-109),n.b(-110),n.b(-111),n.b(-112),n.b(-113),n.b(-114),n.b(-127),n.b(-116),n.b(-117),n.b(-118),n.b(-119),n.b(-120),n.b(-121),n.b(-122),n.b(-123),n.b(-125),n.b(-124),n.b(-126),n.b(-216),n.b(-217),n.b(-218),n.b(-219),n.b(-221),n.b(-222),n.b(-220),n.b(-129),n.b(-130),n.b(-131),n)])};_Ewa.HF=function(){_Ewa.HF.initializeBase(this)};_Ewa.HF.prototype={b:function(){return 116},c:function(){this.a(507);this.a(10)},e:function(){var n=this;this.d(function(n){if(_Ewa.gd.isInstanceOfType(n)){var t=$$as(_Ewa.gd,n);if(!isNullOrUndefined(t.source)&&!isNullOrUndefined(t.eventId))return Diag.a.a(594105034,0,50,"DefaultRichApiRequestExecutedEvent: valid but unhandled event: source: {0}; eventId: {1}.",t.source,t.eventId),!0}return Diag.a.a(594105033,0,50,"DefaultRichApiRequestExecutedEvent: an invalid event is ignored."),!1})}};_Ewa.HL=function(){_Ewa.HL.initializeBase(this)};_Ewa.HL.prototype={b:function(){return 100},c:function(){this.a(543)}};_Ewa.HO=function(){_Ewa.HO.initializeBase(this)};_Ewa.HO.prototype={b:function(){return 99},c:function(){this.a(174)}};_Ewa.HP=function(){_Ewa.HP.initializeBase(this)};_Ewa.HP.prototype={b:function(){return 112},c:function(){this.a(503)},e:function(){var n=this;this.d(function(n){var t=n;return t.pasteParameters.CopyPasteTargetType===2&&!t.isFromCurrentSession})}};_Ewa.HQ=function(){_Ewa.HQ.initializeBase(this)};_Ewa.HQ.prototype={b:function(){return 52},c:function(){this.a(503)},e:function(){var n=this;this.d(function(n){var t=n;return t.pasteParameters.CopyPasteTargetType===2&&t.isFromCurrentSession})}};_Ewa.HR=function(){_Ewa.HR.initializeBase(this)};_Ewa.HR.prototype={b:function(){return 110},c:function(){this.a(204)}};_Ewa.HS=function(){_Ewa.HS.initializeBase(this)};_Ewa.HS.prototype={b:function(){return 35},c:function(){this.a(506)}};_Ewa.HT=function(){_Ewa.HT.initializeBase(this)};_Ewa.HT.prototype={b:function(){return 111},c:function(){this.a(503)},e:function(){var n=this;this.d(function(n){var t=n;return t.pasteParameters.CopyPasteTargetType===1})}};_Ewa.HU=function(){_Ewa.HU.initializeBase(this)};_Ewa.HU.prototype={b:function(){return 42},c:function(){this.a(180)}};_Ewa.HV=function(){_Ewa.HV.initializeBase(this)};_Ewa.HV.prototype={b:function(){return 98},c:function(){this.a(132)}};_Ewa.HW=function(){_Ewa.HW.initializeBase(this)};_Ewa.HW.prototype={b:function(){return 102},c:function(){this.a(145)}};_Ewa.HX=function(){_Ewa.HX.initializeBase(this)};_Ewa.HX.prototype={b:function(){return 104},c:function(){this.a(50)},e:function(){var n=this;this.d(function(n){return!!n.pivotTableId&&!!n.pivotTableName})}};_Ewa.baR=function(n,t){_Ewa.baR.initializeBase(this);this.i=n;this.j=t};_Ewa.baR.prototype={i:0,j:0,b:function(){return this.i},c:function(){this.a(11)},e:function(){var t=this,n;this.d(function(n){return n.cellFormat.ValidMembers===16});n=this;this.d(function(t){return t.cellFormat.Font.ValidMembers===n.j})}};_Ewa.HY=function(){_Ewa.HY.initializeBase(this)};_Ewa.HY.prototype={b:function(){return 57},c:function(){this.a(517)}};_Ewa.HZ=function(){_Ewa.HZ.initializeBase(this,[3,4])};_Ewa.Ia=function(){_Ewa.Ia.initializeBase(this)};_Ewa.Ia.prototype={b:function(){return 2},c:function(){this.a(11)},e:function(){var n=this;this.d(function(n){return n.cellFormat.ValidMembers===128})}};_Ewa.Ic=function(){_Ewa.Ic.initializeBase(this)};_Ewa.Ic.prototype={b:function(){return 109},c:function(){this.a(106);this.a(105)}};_Ewa.Ib=function(){_Ewa.Ib.initializeBase(this)};_Ewa.Ib.prototype={b:function(){return 113},c:function(){this.a(208)},e:function(){var n=this;this.d(function(n){return n.parameters.FilterType===_Ewa.eS.b})}};_Ewa.Id=function(){_Ewa.Id.initializeBase(this)};_Ewa.Id.prototype={b:function(){return 29},c:function(){this.a(508)},e:function(){var n=this;this.d(function(n){var t=n;return t.command===3||t.command===1||t.command===4})}};_Ewa.Ie=function(){_Ewa.Ie.initializeBase(this)};_Ewa.Ie.prototype={b:function(){return 40},c:function(){this.a(104)}};_Ewa.If=function(){_Ewa.If.initializeBase(this)};_Ewa.If.prototype={b:function(){return 114},c:function(){this.a(209)},e:function(){var n=this;this.d(function(n){return n.parameters.FilterType===_Ewa.eS.b})}};_Ewa.Ig=function(){_Ewa.Ig.initializeBase(this)};_Ewa.Ig.prototype={b:function(){return 106},c:function(){this.a(121)}};_Ewa.Ih=function(){_Ewa.Ih.initializeBase(this,[4,64])};_Ewa.Ij=function(){_Ewa.Ij.initializeBase(this)};_Ewa.Ij.prototype={b:function(){return 1},c:function(){this.a(527);this.a(12)}};_Ewa.Ik=function(){_Ewa.Ik.initializeBase(this)};_Ewa.Ik.prototype={b:function(){return 119},c:function(){this.a(233)}};_Ewa.Il=function(){_Ewa.Il.initializeBase(this)};_Ewa.Il.prototype={b:function(){return 77},c:function(){this.a(553)}};_Ewa.Im=function(){_Ewa.Im.initializeBase(this)};_Ewa.Im.prototype={b:function(){return 5},c:function(){this.a(11)},e:function(){var n=this;this.d(function(n){return n.cellFormat.ValidMembers===64})}};_Ewa.In=function(){_Ewa.In.initializeBase(this)};_Ewa.In.prototype={b:function(){return 59},c:function(){this.a(155)}};_Ewa.Io=function(){_Ewa.Io.initializeBase(this)};_Ewa.Io.prototype={b:function(){return 115},c:function(){this.a(176)},e:function(){var n=this;this.d(function(n){return n.autoFilterOptions.AutoFilterType===_Ewa.eS.b&&!!n.autoFilterOptions.CriteriaType})}};_Ewa.Ip=function(){_Ewa.Ip.initializeBase(this)};_Ewa.Ip.prototype={b:function(){return 58},c:function(){this.a(176)},e:function(){var n=this;this.d(function(n){return n.autoFilterOptions.AutoFilterType===_Ewa.eS.b&&!n.autoFilterOptions.CriteriaType})}};_Ewa.Iq=function(){_Ewa.Iq.initializeBase(this)};_Ewa.Iq.prototype={b:function(){return 41},c:function(){this.a(518)}};_Ewa.Is=function(){_Ewa.Is.initializeBase(this,[6,32])};_Ewa.It=function(){_Ewa.It.initializeBase(this,[7,8])};_Ewa.Iu=function(){_Ewa.Iu.initializeBase(this,[8,1])};_Ewa.Iv=function(){_Ewa.Iv.initializeBase(this,[9,2])};_Ewa.Iw=function(){_Ewa.Iw.initializeBase(this)};_Ewa.Iw.prototype={b:function(){return 74},c:function(){this.a(216)}};_Ewa.Ix=function(){_Ewa.Ix.initializeBase(this)};_Ewa.Ix.prototype={b:function(){return 97},c:function(){this.a(188)}};_Ewa.Iy=function(){_Ewa.Iy.initializeBase(this)};_Ewa.Iy.prototype={b:function(){return 60},c:function(){this.a(11)},e:function(){var n=this;this.d(function(n){return n.cellFormat.ValidMembers===2})}};_Ewa.IB=function(){_Ewa.IB.initializeBase(this)};_Ewa.IB.prototype={b:function(){return 53},c:function(){this.a(156)},e:function(){var n=this;this.d(function(n){var t=n;return t.command===2||t.command===5||t.command===6||t.command===7})}};_Ewa.IC=function(){_Ewa.IC.initializeBase(this)};_Ewa.IC.prototype={b:function(){return 107},c:function(){this.a(217)}};_Ewa.Iz=function(){_Ewa.Iz.initializeBase(this)};_Ewa.Iz.prototype={b:function(){return 43},c:function(){this.a(526)}};_Ewa.IA=function(){_Ewa.IA.initializeBase(this)};_Ewa.IA.prototype={b:function(){return 63},c:function(){this.a(11)},e:function(){var n=this;this.d(function(n){return n.cellFormat.ValidMembers===256})}};_Ewa.ID=function(){_Ewa.ID.initializeBase(this)};_Ewa.ID.prototype={b:function(){return 12},c:function(){this.a(11)},e:function(){var n=this;this.d(function(n){return n.cellFormat.ValidMembers===32})}};_Ewa.IE=function(){_Ewa.IE.initializeBase(this)};_Ewa.IE.prototype={b:function(){return 108},c:function(){this.a(141)}};_Ewa.IF=function(){_Ewa.IF.initializeBase(this,[10,128])};_Ewa.IG=function(){_Ewa.IG.initializeBase(this,[11,16])};_Ewa.IH=function(){_Ewa.IH.initializeBase(this)};_Ewa.IH.prototype={b:function(){return 61},c:function(){this.a(11)},e:function(){var n=this;this.d(function(n){return n.cellFormat.ValidMembers===1})}};_Ewa.II=function(){_Ewa.II.initializeBase(this)};_Ewa.II.prototype={b:function(){return 62},c:function(){this.a(11)},e:function(){var n=this;this.d(function(n){return n.cellFormat.ValidMembers===8})}};_Ewa.Ii=function(){_Ewa.Ii.initializeBase(this)};_Ewa.Ii.prototype={b:function(){return 69},c:function(){this.a(190)}};_Ewa.IJ=function(){_Ewa.IJ.initializeBase(this)};_Ewa.IJ.prototype={b:function(){return 103},c:function(){this.a(51)}};_Ewa.IK=function(){_Ewa.IK.initializeBase(this)};_Ewa.IK.prototype={b:function(){return 47},c:function(){this.a(148)}};_Ewa.IL=function(){_Ewa.IL.initializeBase(this)};_Ewa.IL.prototype={b:function(){return 91},c:function(){this.a(532)}};_Ewa.IM=function(){_Ewa.IM.initializeBase(this)};_Ewa.IM.prototype={b:function(){return 92},c:function(){this.a(531)}};_Ewa.IN=function(){_Ewa.IN.initializeBase(this)};_Ewa.IN.prototype={b:function(){return 13},c:function(){this.a(138)}};_Ewa.IO=function(){_Ewa.IO.initializeBase(this)};_Ewa.IO.prototype={b:function(){return 37},c:function(){this.a(154)},e:function(){var t=this,n;this.d(function(n){return!n.isTableCommand});n=this;this.d(function(n){var t=n;return t.insertDeleteCellRange.DeltaColumn<0&&!t.insertDeleteCellRange.DeltaRow&&(!!t.insertDeleteCellRange.FirstRow||t.insertDeleteCellRange.LastRow!==1048575)||!t.insertDeleteCellRange.DeltaColumn&&t.insertDeleteCellRange.DeltaRow<0&&(!!t.insertDeleteCellRange.FirstColumn||t.insertDeleteCellRange.LastColumn!==16383)})}};_Ewa.IP=function(){_Ewa.IP.initializeBase(this)};_Ewa.IP.prototype={b:function(){return 38},c:function(){this.a(154)},e:function(){var t=this,n;this.d(function(n){return!n.isTableCommand});n=this;this.d(function(n){var t=n;return t.insertDeleteCellRange.DeltaColumn>0&&!t.insertDeleteCellRange.DeltaRow&&(!!t.insertDeleteCellRange.FirstRow||t.insertDeleteCellRange.LastRow!==1048575)||!t.insertDeleteCellRange.DeltaColumn&&t.insertDeleteCellRange.DeltaRow>0&&(!!t.insertDeleteCellRange.FirstColumn||t.insertDeleteCellRange.LastColumn!==16383)})}};_Ewa.IQ=function(){_Ewa.IQ.initializeBase(this)};_Ewa.IQ.prototype={b:function(){return 22},c:function(){this.a(154)},e:function(){var u=this,n,t,i,r;this.d(function(n){return!n.isTableCommand});n=this;this.d(function(n){return n.insertDeleteCellRange.DeltaColumn<0});t=this;this.d(function(n){return!n.insertDeleteCellRange.DeltaRow});i=this;this.d(function(n){return!n.insertDeleteCellRange.FirstRow});r=this;this.d(function(n){return n.insertDeleteCellRange.LastRow===1048575})}};_Ewa.IR=function(){_Ewa.IR.initializeBase(this)};_Ewa.IR.prototype={b:function(){return 21},c:function(){this.a(154)},e:function(){var u=this,n,t,i,r;this.d(function(n){return!n.isTableCommand});n=this;this.d(function(n){return n.insertDeleteCellRange.DeltaColumn>0});t=this;this.d(function(n){return!n.insertDeleteCellRange.DeltaRow});i=this;this.d(function(n){return!n.insertDeleteCellRange.FirstRow});r=this;this.d(function(n){return n.insertDeleteCellRange.LastRow===1048575})}};_Ewa.IS=function(){_Ewa.IS.initializeBase(this)};_Ewa.IS.prototype={b:function(){return 14},c:function(){this.a(137)}};_Ewa.IU=function(){_Ewa.IU.initializeBase(this)};_Ewa.IU.prototype={b:function(){return 15},c:function(){this.a(207)}};_Ewa.IV=function(){_Ewa.IV.initializeBase(this)};_Ewa.IV.prototype={b:function(){return 90},c:function(){this.a(151)}};_Ewa.IW=function(){_Ewa.IW.initializeBase(this)};_Ewa.IW.prototype={b:function(){return 120},c:function(){this.a(227)}};_Ewa.IX=function(){_Ewa.IX.initializeBase(this)};_Ewa.IX.prototype={b:function(){return 64},c:function(){this.a(107);this.a(557)}};_Ewa.IY=function(){_Ewa.IY.initializeBase(this)};_Ewa.IY.prototype={b:function(){return 24},c:function(){this.a(154)},e:function(){var u=this,n,t,i,r;this.d(function(n){return!n.isTableCommand});n=this;this.d(function(n){return!n.insertDeleteCellRange.DeltaColumn});t=this;this.d(function(n){return n.insertDeleteCellRange.DeltaRow<0});i=this;this.d(function(n){return!n.insertDeleteCellRange.FirstColumn});r=this;this.d(function(n){return n.insertDeleteCellRange.LastColumn===16383})}};_Ewa.IZ=function(){_Ewa.IZ.initializeBase(this)};_Ewa.IZ.prototype={b:function(){return 23},c:function(){this.a(154)},e:function(){var u=this,n,t,i,r;this.d(function(n){return!n.isTableCommand});n=this;this.d(function(n){return!n.insertDeleteCellRange.DeltaColumn});t=this;this.d(function(n){return n.insertDeleteCellRange.DeltaRow>0});i=this;this.d(function(n){return!n.insertDeleteCellRange.FirstColumn});r=this;this.d(function(n){return n.insertDeleteCellRange.LastColumn===16383})}};_Ewa.Ja=function(){_Ewa.Ja.initializeBase(this)};_Ewa.Ja.prototype={b:function(){return 39},c:function(){this.a(135)}};_Ewa.Jb=function(){_Ewa.Jb.initializeBase(this)};_Ewa.Jb.prototype={b:function(){return 36},c:function(){this.a(136)}};_Ewa.Jd=function(){_Ewa.Jd.initializeBase(this)};_Ewa.Jd.prototype={b:function(){return 67},c:function(){this.a(184)}};_Ewa.Jc=function(){_Ewa.Jc.initializeBase(this)};_Ewa.Jc.prototype={b:function(){return 68},c:function(){this.a(183)}};_Ewa.Jf=function(){_Ewa.Jf.initializeBase(this)};_Ewa.Jf.prototype={b:function(){return 70},c:function(){this.a(515)}};_Ewa.Jg=function(){_Ewa.Jg.initializeBase(this)};_Ewa.Jg.prototype={b:function(){return 71},c:function(){this.a(157)}};_Ewa.Je=function(){_Ewa.Je.initializeBase(this)};_Ewa.Je.prototype={b:function(){return 89},c:function(){this.a(213)}};_Ewa.Jh=function(){_Ewa.Jh.initializeBase(this)};_Ewa.Jh.prototype={b:function(){return 27},c:function(){this.a(208)},e:function(){var n=this;this.d(function(n){return n.parameters.FilterType===_Ewa.eS.a})}};_Ewa.Ji=function(){_Ewa.Ji.initializeBase(this)};_Ewa.Ji.prototype={b:function(){return 17},c:function(){this.a(154)},e:function(){var i=this,n,t;this.d(function(n){return n.isTableCommand});n=this;this.d(function(n){return n.insertDeleteCellRange.DeltaColumn<0});t=this;this.d(function(n){return!n.insertDeleteCellRange.DeltaRow})}};_Ewa.Jj=function(){_Ewa.Jj.initializeBase(this)};_Ewa.Jj.prototype={b:function(){return 18},c:function(){this.a(154)},e:function(){var i=this,n,t;this.d(function(n){return n.isTableCommand});n=this;this.d(function(n){return n.insertDeleteCellRange.DeltaColumn>0});t=this;this.d(function(n){return!n.insertDeleteCellRange.DeltaRow})}};_Ewa.Jk=function(){_Ewa.Jk.initializeBase(this)};_Ewa.Jk.prototype={b:function(){return 105},c:function(){this.a(193)}};_Ewa.Jl=function(){_Ewa.Jl.initializeBase(this)};_Ewa.Jl.prototype={b:function(){return 16},c:function(){this.a(206)}};_Ewa.Jm=function(){_Ewa.Jm.initializeBase(this)};_Ewa.Jm.prototype={b:function(){return 30},c:function(){this.a(209)},e:function(){var n=this;this.d(function(n){return n.parameters.FilterType===_Ewa.eS.a})}};_Ewa.Jn=function(){_Ewa.Jn.initializeBase(this)};_Ewa.Jn.prototype={b:function(){return 25},c:function(){this.a(187)},e:function(){var n=this;this.d(function(n){return n.options.OperationType===1})}};_Ewa.Jo=function(){_Ewa.Jo.initializeBase(this)};_Ewa.Jo.prototype={b:function(){return 28},c:function(){this.a(176)},e:function(){var t=this,n;this.d(function(n){return n.autoFilterOptions.AutoFilterType===_Ewa.eS.a});n=this;this.d(function(n){return!n.autoFilterOptions.CriteriaType})}};_Ewa.Jp=function(){_Ewa.Jp.initializeBase(this)};_Ewa.Jp.prototype={b:function(){return 32},c:function(){this.a(176)},e:function(){var t=this,n;this.d(function(n){return n.autoFilterOptions.AutoFilterType===_Ewa.eS.a});n=this;this.d(function(n){var i=n,t,r=(t=new($$sc.u.$$(_Ewa.zH)),t.b(1),t.b(2),t.b(8),t.b(9),t.b(10),t.b(11),t.b(12),t.b(13),t.b(14),t.b(15),t.b(16),t.b(17),t.b(18),t.b(19),t.b(20),t.b(21),t.b(22),t.b(23),t.b(24),t.b(25),t.b(26),t.b(27),t.b(28),t.b(29),t.b(30),t.b(31),t.b(32),t.b(33),t.b(34),t.b(35),t.b(36),t.b(37),t.b(38),t.b(39),t);return r.c(i.autoFilterOptions.CriteriaType)})}};_Ewa.Jr=function(){_Ewa.Jr.initializeBase(this)};_Ewa.Jr.prototype={b:function(){return 73},c:function(){this.a(211)}};_Ewa.Jq=function(){_Ewa.Jq.initializeBase(this)};_Ewa.Jq.prototype={b:function(){return 101},c:function(){this.a(218)}};_Ewa.Js=function(){_Ewa.Js.initializeBase(this)};_Ewa.Js.prototype={b:function(){return 44},c:function(){this.a(514)}};_Ewa.Jt=function(){_Ewa.Jt.initializeBase(this)};_Ewa.Jt.prototype={b:function(){return 19},c:function(){this.a(154)},e:function(){var i=this,n,t;this.d(function(n){return n.isTableCommand});n=this;this.d(function(n){return!n.insertDeleteCellRange.DeltaColumn});t=this;this.d(function(n){return n.insertDeleteCellRange.DeltaRow<0})}};_Ewa.Ju=function(){_Ewa.Ju.initializeBase(this)};_Ewa.Ju.prototype={b:function(){return 20},c:function(){this.a(154)},e:function(){var i=this,n,t;this.d(function(n){return n.isTableCommand});n=this;this.d(function(n){return!n.insertDeleteCellRange.DeltaColumn});t=this;this.d(function(n){return n.insertDeleteCellRange.DeltaRow>0})}};_Ewa.Jv=function(){_Ewa.Jv.initializeBase(this)};_Ewa.Jv.prototype={b:function(){return 72},c:function(){this.a(178)}};_Ewa.Jw=function(){_Ewa.Jw.initializeBase(this)};_Ewa.Jw.prototype={b:function(){return 26},c:function(){this.a(177)},e:function(){var n=this;this.d(function(n){return n.autoFilterOptions.AutoFilterType===_Ewa.eS.a})}};_Ewa.Jx=function(){_Ewa.Jx.initializeBase(this)};_Ewa.Jx.prototype={b:function(){return 87},c:function(){this.a(212)}};_Ewa.Jy=function(){_Ewa.Jy.initializeBase(this)};_Ewa.Jy.prototype={b:function(){return 88},c:function(){this.a(196)}};_Ewa.Jz=function(){_Ewa.Jz.initializeBase(this)};_Ewa.Jz.prototype={b:function(){return 31},c:function(){this.a(210)},e:function(){var n=this;this.d(function(n){return n.parameters.FilterType===_Ewa.eS.a})}};_Ewa.IT=function(){_Ewa.IT.initializeBase(this)};_Ewa.IT.prototype={b:function(){return 54},c:function(){this.a(139)}};_Ewa.JA=function(){_Ewa.JA.initializeBase(this)};_Ewa.JA.prototype={b:function(){return 55},c:function(){this.a(197)}};_Ewa.JD=function(){_Ewa.JD.initializeBase(this)};_Ewa.JD.prototype={b:function(){return 56},c:function(){this.a(128)}};_Ewa.JB=function(){_Ewa.JB.initializeBase(this)};_Ewa.JB.prototype={b:function(){return 33},c:function(){this.a(181)},e:function(){var n=this;this.d(function(n){return!n.parentCommentId})}};_Ewa.JC=function(){_Ewa.JC.initializeBase(this)};_Ewa.JC.prototype={b:function(){return 34},c:function(){this.a(181)},e:function(){var n=this;this.d(function(n){return!!n.parentCommentId})}};_Ewa.JF=function(){_Ewa.JF.initializeBase(this)};_Ewa.JF.prototype={b:function(){return 45},c:function(){this.a(170)}};_Ewa.JE=function(){_Ewa.JE.initializeBase(this)};_Ewa.JE.prototype={b:function(){return 46},c:function(){this.a(171)}};_Ewa.eS=function(){};_Ewa.pg=function(){};_Ewa.pg.prototype={h:null,g:null,k:function(){return this.g||(this.g=new($$sc.u.$$(_Ewa.fb)),this.c()),this.g},f:function(){return this.h||(this.h=new($$sc.u.$$(Function)),this.e()),this.h},e:function(){},d:function(n){this.f().b(n)},a:function(n){this.k().c(n)||this.k().b(n)}};_Ewa.eT=function(){};_Ewa.eT.c=function(){if(!_Ewa.eT.a){var n;_Ewa.eT.a=(n=new($$sc.u.$$(_Ewa.pg)),n.b(new _Ewa.im),n)}return _Ewa.eT.a};_Ewa.eT.e=function(n,t){return t.k().c(n.a())};_Ewa.eT.f=function(n,t){var u=t.f(),i,r,f;if(!u.e.length)return!0;for(i=!0,r=u.$$lge();r.$$mn();)if(f=r.$$cu(),!f(n.b())){i=!1;break}return i};_Ewa.eT.d=function(n){for(var t=n.a(0),r=n.$$lge(),i;r.$$mn();)i=r.$$cu(),i.f().e.length>t.f().e.length&&(t=i);return t};_Ewa.eT.prototype={a:null,d:function(){if(!this.a){var n;this.a=(n=new($$sc.u.$$(_Ewa.pg)),n.b(new _Ewa.Ij),n.b(new _Ewa.Ia),n.b(new _Ewa.HZ),n.b(new _Ewa.Ih),n.b(new _Ewa.Im),n.b(new _Ewa.Is),n.b(new _Ewa.It),n.b(new _Ewa.Iu),n.b(new _Ewa.Iv),n.b(new _Ewa.IF),n.b(new _Ewa.IG),n.b(new _Ewa.ID),n.b(new _Ewa.IN),n.b(new _Ewa.IS),n.b(new _Ewa.IU),n.b(new _Ewa.Jl),n.b(new _Ewa.Ji),n.b(new _Ewa.Jj),n.b(new _Ewa.Jt),n.b(new _Ewa.Ju),n.b(new _Ewa.IR),n.b(new _Ewa.IQ),n.b(new _Ewa.IZ),n.b(new _Ewa.IY),n.b(new _Ewa.Jn),n.b(new _Ewa.Jw),n.b(new _Ewa.Jh),n.b(new _Ewa.Jo),n.b(new _Ewa.Id),n.b(new _Ewa.Jm),n.b(new _Ewa.Jz),n.b(new _Ewa.Jp),n.b(new _Ewa.JB),n.b(new _Ewa.JC),n.b(new _Ewa.HS),n.b(new _Ewa.Jb),n.b(new _Ewa.IO),n.b(new _Ewa.IP),n.b(new _Ewa.Ja),n.b(new _Ewa.Ie),n.b(new _Ewa.Iq),n.b(new _Ewa.Iz),n.b(new _Ewa.HU),n.b(new _Ewa.Js),n.b(new _Ewa.JE),n.b(new _Ewa.JF),n.b(new _Ewa.IK),n.b(new _Ewa.HG),n.b(new _Ewa.HQ),n.b(new _Ewa.IB),n.b(new _Ewa.IT),n.b(new _Ewa.JA),n.b(new _Ewa.JD),n.b(new _Ewa.HY),n.b(new _Ewa.Ip),n.b(new _Ewa.In),n.b(new _Ewa.Iy),n.b(new _Ewa.IH),n.b(new _Ewa.II),n.b(new _Ewa.IA),n.b(new _Ewa.IX),n.b(new _Ewa.Hs),n.b(new _Ewa.HA),n.b(new _Ewa.Jd),n.b(new _Ewa.Jc),n.b(new _Ewa.Ii),n.b(new _Ewa.Jg),n.b(new _Ewa.Jf),n.b(new _Ewa.Jv),n.b(new _Ewa.Jr),n.b(new _Ewa.Iw),n.b(new _Ewa.HC),n.b(new _Ewa.Hx),n.b(new _Ewa.Il),n.b(new _Ewa.HE),n.b(new _Ewa.HD),n.b(new _Ewa.Hv),n.b(new _Ewa.HB),n.b(new _Ewa.Hw),n.b(new _Ewa.Hy),n.b(new _Ewa.Hu),n.b(new _Ewa.Hz),n.b(new _Ewa.Ir),n.b(new _Ewa.Jx),n.b(new _Ewa.Jy),n.b(new _Ewa.Je),n.b(new _Ewa.IV),n.b(new _Ewa.IL),n.b(new _Ewa.IM),n.b(new _Ewa.HI),n.b(new _Ewa.HJ),n.b(new _Ewa.HK),n.b(new _Ewa.HH),n.b(new _Ewa.Ix),n.b(new _Ewa.HV),n.b(new _Ewa.HO),n.b(new _Ewa.HL),n.b(new _Ewa.Jq),n.b(new _Ewa.HW),n.b(new _Ewa.IJ),n.b(new _Ewa.HX),n.b(new _Ewa.Jk),n.b(new _Ewa.Ig),n.b(new _Ewa.IC),n.b(new _Ewa.IE),n.b(new _Ewa.Ic),n.b(new _Ewa.HR),n.b(new _Ewa.HT),n.b(new _Ewa.HP),n.b(new _Ewa.Ib),n.b(new _Ewa.If),n.b(new _Ewa.Io),n.b(new _Ewa.Ht),n.b(new _Ewa.Ik),n.b(new _Ewa.IW),n)}return this.a},e:function(n,t){var i=this.b(n,this.d());return!i&&t&&(i=this.b(n,_Ewa.eT.c()),!i&&this.c(n,_Ewa.eT.b)&&(i=_Ewa.eT.b)),i},b:function(n,t){for(var i=new($$sc.u.$$(_Ewa.pg)),u=t.$$lge(),r;u.$$mn();)r=u.$$cu(),this.c(n,r)&&i.b(r);return i.e.length===1?i.a(0):i.e.length>1?_Ewa.eT.d(i):null},c:function(n,t){return _Ewa.eT.e(n,t)&&_Ewa.eT.f(n,t)}};_Ewa.HM=function(){};_Ewa.HM.prototype={a:null,b:function(){if(!this.a){var n;this.a=(n=new($$sc.u.$$(_Ewa.fb)),n.b(12),n.b(11),n)}return this.a},c:function(n){return this.b().c(n.a())},d:function(n){for(var u,i=[],f=n.b(),r=f.batchedOperations,e=r.length,t=0;t<e;++t)u=r[t],i.push(new _Ewa.vy(n.a(),u));return i}};_Ewa.bq=function(){};_Ewa.bq.b=function(){return _Ewa.bq.a||(_Ewa.bq.a=new($$sc.q.$$(_Ewa.fb))(new _Ewa.bq.c),_Ewa.bq.a.a(507),_Ewa.bq.a.a(10),_Ewa.bq.a.a(1),_Ewa.bq.a.a(129),_Ewa.bq.a.a(198),_Ewa.bq.a.a(500),_Ewa.bq.a.a(501),_Ewa.bq.a.a(519),_Ewa.bq.a.a(520),_Ewa.bq.a.a(538),_Ewa.bq.a.a(1e3),_Ewa.bq.a.a(1003),_Ewa.bq.a.a(101),_Ewa.bq.a.a(102),_Ewa.bq.a.a(108),_Ewa.bq.a.a(118),_Ewa.bq.a.a(119),_Ewa.bq.a.a(120),_Ewa.bq.a.a(123),_Ewa.bq.a.a(126),_Ewa.bq.a.a(127),_Ewa.bq.a.a(130),_Ewa.bq.a.a(140),_Ewa.bq.a.a(159),_Ewa.bq.a.a(160),_Ewa.bq.a.a(165),_Ewa.bq.a.a(166),_Ewa.bq.a.a(167),_Ewa.bq.a.a(169),_Ewa.bq.a.a(189),_Ewa.bq.a.a(504),_Ewa.bq.a.a(511),_Ewa.bq.a.a(512),_Ewa.bq.a.a(525),_Ewa.bq.a.a(533),_Ewa.bq.a.a(535),_Ewa.bq.a.a(536),_Ewa.bq.a.a(537),_Ewa.bq.a.a(1002),_Ewa.bq.a.a(542),_Ewa.bq.a.a(554),_Ewa.bq.a.a(144),_Ewa.bq.a.a(502),_Ewa.bq.a.a(505),_Ewa.bq.a.a(179),_Ewa.bq.a.a(552),_Ewa.bq.a.a(205)),_Ewa.bq.a};_Ewa.bq.c=function(){};_Ewa.bq.c.prototype={a:function(n,t){return n===t},b:function(n){return n}};_Ewa.vz.registerClass("_Ewa.vz",_Ewa.pU.$$(_Ewa.jO));_Ewa.pg.registerClass("_Ewa.pg");_Ewa.Hs.registerClass("_Ewa.Hs",_Ewa.pg);_Ewa.Ht.registerClass("_Ewa.Ht",_Ewa.pg);_Ewa.HG.registerClass("_Ewa.HG",_Ewa.pg);_Ewa.HH.registerClass("_Ewa.HH",_Ewa.pg);_Ewa.HI.registerClass("_Ewa.HI",_Ewa.pg);_Ewa.HJ.registerClass("_Ewa.HJ",_Ewa.pg);_Ewa.HK.registerClass("_Ewa.HK",_Ewa.pg);_Ewa.baO.registerClass("_Ewa.baO",_Ewa.pg);_Ewa.Hu.registerClass("_Ewa.Hu",_Ewa.baO);_Ewa.Hv.registerClass("_Ewa.Hv",_Ewa.baO);_Ewa.Hw.registerClass("_Ewa.Hw",_Ewa.baO);_Ewa.Hx.registerClass("_Ewa.Hx",_Ewa.baO);_Ewa.Hy.registerClass("_Ewa.Hy",_Ewa.baO);_Ewa.im.registerClass("_Ewa.im",_Ewa.pg);_Ewa.Hz.registerClass("_Ewa.Hz",_Ewa.baO);_Ewa.Ir.registerClass("_Ewa.Ir",_Ewa.pg);_Ewa.HA.registerClass("_Ewa.HA",_Ewa.pg);_Ewa.HB.registerClass("_Ewa.HB",_Ewa.baO);_Ewa.HC.registerClass("_Ewa.HC",_Ewa.baO);_Ewa.HD.registerClass("_Ewa.HD",_Ewa.baO);_Ewa.HE.registerClass("_Ewa.HE",_Ewa.baO);_Ewa.HF.registerClass("_Ewa.HF",_Ewa.pg);_Ewa.HL.registerClass("_Ewa.HL",_Ewa.pg);_Ewa.HO.registerClass("_Ewa.HO",_Ewa.pg);_Ewa.HP.registerClass("_Ewa.HP",_Ewa.pg);_Ewa.HQ.registerClass("_Ewa.HQ",_Ewa.pg);_Ewa.HR.registerClass("_Ewa.HR",_Ewa.pg);_Ewa.HS.registerClass("_Ewa.HS",_Ewa.pg);_Ewa.HT.registerClass("_Ewa.HT",_Ewa.pg);_Ewa.HU.registerClass("_Ewa.HU",_Ewa.pg);_Ewa.HV.registerClass("_Ewa.HV",_Ewa.pg);_Ewa.HW.registerClass("_Ewa.HW",_Ewa.pg);_Ewa.HX.registerClass("_Ewa.HX",_Ewa.pg);_Ewa.baR.registerClass("_Ewa.baR",_Ewa.pg);_Ewa.HY.registerClass("_Ewa.HY",_Ewa.pg);_Ewa.HZ.registerClass("_Ewa.HZ",_Ewa.baR);_Ewa.Ia.registerClass("_Ewa.Ia",_Ewa.pg);_Ewa.Ic.registerClass("_Ewa.Ic",_Ewa.pg);_Ewa.Ib.registerClass("_Ewa.Ib",_Ewa.pg);_Ewa.Id.registerClass("_Ewa.Id",_Ewa.pg);_Ewa.Ie.registerClass("_Ewa.Ie",_Ewa.pg);_Ewa.If.registerClass("_Ewa.If",_Ewa.pg);_Ewa.Ig.registerClass("_Ewa.Ig",_Ewa.pg);_Ewa.Ih.registerClass("_Ewa.Ih",_Ewa.baR);_Ewa.Ij.registerClass("_Ewa.Ij",_Ewa.pg);_Ewa.Ik.registerClass("_Ewa.Ik",_Ewa.pg);_Ewa.Il.registerClass("_Ewa.Il",_Ewa.pg);_Ewa.Im.registerClass("_Ewa.Im",_Ewa.pg);_Ewa.In.registerClass("_Ewa.In",_Ewa.pg);_Ewa.Io.registerClass("_Ewa.Io",_Ewa.pg);_Ewa.Ip.registerClass("_Ewa.Ip",_Ewa.pg);_Ewa.Iq.registerClass("_Ewa.Iq",_Ewa.pg);_Ewa.Is.registerClass("_Ewa.Is",_Ewa.baR);_Ewa.It.registerClass("_Ewa.It",_Ewa.baR);_Ewa.Iu.registerClass("_Ewa.Iu",_Ewa.baR);_Ewa.Iv.registerClass("_Ewa.Iv",_Ewa.baR);_Ewa.Iw.registerClass("_Ewa.Iw",_Ewa.pg);_Ewa.Ix.registerClass("_Ewa.Ix",_Ewa.pg);_Ewa.Iy.registerClass("_Ewa.Iy",_Ewa.pg);_Ewa.IB.registerClass("_Ewa.IB",_Ewa.pg);_Ewa.IC.registerClass("_Ewa.IC",_Ewa.pg);_Ewa.Iz.registerClass("_Ewa.Iz",_Ewa.pg);_Ewa.IA.registerClass("_Ewa.IA",_Ewa.pg);_Ewa.ID.registerClass("_Ewa.ID",_Ewa.pg);_Ewa.IE.registerClass("_Ewa.IE",_Ewa.pg);_Ewa.IF.registerClass("_Ewa.IF",_Ewa.baR);_Ewa.IG.registerClass("_Ewa.IG",_Ewa.baR);_Ewa.IH.registerClass("_Ewa.IH",_Ewa.pg);_Ewa.II.registerClass("_Ewa.II",_Ewa.pg);_Ewa.Ii.registerClass("_Ewa.Ii",_Ewa.pg);_Ewa.IJ.registerClass("_Ewa.IJ",_Ewa.pg);_Ewa.IK.registerClass("_Ewa.IK",_Ewa.pg);_Ewa.IL.registerClass("_Ewa.IL",_Ewa.pg);_Ewa.IM.registerClass("_Ewa.IM",_Ewa.pg);_Ewa.IN.registerClass("_Ewa.IN",_Ewa.pg);_Ewa.IO.registerClass("_Ewa.IO",_Ewa.pg);_Ewa.IP.registerClass("_Ewa.IP",_Ewa.pg);_Ewa.IQ.registerClass("_Ewa.IQ",_Ewa.pg);_Ewa.IR.registerClass("_Ewa.IR",_Ewa.pg);_Ewa.IS.registerClass("_Ewa.IS",_Ewa.pg);_Ewa.IU.registerClass("_Ewa.IU",_Ewa.pg);_Ewa.IV.registerClass("_Ewa.IV",_Ewa.pg);_Ewa.IW.registerClass("_Ewa.IW",_Ewa.pg);_Ewa.IX.registerClass("_Ewa.IX",_Ewa.pg);_Ewa.IY.registerClass("_Ewa.IY",_Ewa.pg);_Ewa.IZ.registerClass("_Ewa.IZ",_Ewa.pg);_Ewa.Ja.registerClass("_Ewa.Ja",_Ewa.pg);_Ewa.Jb.registerClass("_Ewa.Jb",_Ewa.pg);_Ewa.Jd.registerClass("_Ewa.Jd",_Ewa.pg);_Ewa.Jc.registerClass("_Ewa.Jc",_Ewa.pg);_Ewa.Jf.registerClass("_Ewa.Jf",_Ewa.pg);_Ewa.Jg.registerClass("_Ewa.Jg",_Ewa.pg);_Ewa.Je.registerClass("_Ewa.Je",_Ewa.pg);_Ewa.Jh.registerClass("_Ewa.Jh",_Ewa.pg);_Ewa.Ji.registerClass("_Ewa.Ji",_Ewa.pg);_Ewa.Jj.registerClass("_Ewa.Jj",_Ewa.pg);_Ewa.Jk.registerClass("_Ewa.Jk",_Ewa.pg);_Ewa.Jl.registerClass("_Ewa.Jl",_Ewa.pg);_Ewa.Jm.registerClass("_Ewa.Jm",_Ewa.pg);_Ewa.Jn.registerClass("_Ewa.Jn",_Ewa.pg);_Ewa.Jo.registerClass("_Ewa.Jo",_Ewa.pg);_Ewa.Jp.registerClass("_Ewa.Jp",_Ewa.pg);_Ewa.Jr.registerClass("_Ewa.Jr",_Ewa.pg);_Ewa.Jq.registerClass("_Ewa.Jq",_Ewa.pg);_Ewa.Js.registerClass("_Ewa.Js",_Ewa.pg);_Ewa.Jt.registerClass("_Ewa.Jt",_Ewa.pg);_Ewa.Ju.registerClass("_Ewa.Ju",_Ewa.pg);_Ewa.Jv.registerClass("_Ewa.Jv",_Ewa.pg);_Ewa.Jw.registerClass("_Ewa.Jw",_Ewa.pg);_Ewa.Jx.registerClass("_Ewa.Jx",_Ewa.pg);_Ewa.Jy.registerClass("_Ewa.Jy",_Ewa.pg);_Ewa.Jz.registerClass("_Ewa.Jz",_Ewa.pg);_Ewa.IT.registerClass("_Ewa.IT",_Ewa.pg);_Ewa.JA.registerClass("_Ewa.JA",_Ewa.pg);_Ewa.JD.registerClass("_Ewa.JD",_Ewa.pg);_Ewa.JB.registerClass("_Ewa.JB",_Ewa.pg);_Ewa.JC.registerClass("_Ewa.JC",_Ewa.pg);_Ewa.JF.registerClass("_Ewa.JF",_Ewa.pg);_Ewa.JE.registerClass("_Ewa.JE",_Ewa.pg);_Ewa.im.a=null;_Ewa.eS.a="Table";_Ewa.eS.b="Sheet";_Ewa.eT.a=null;_Ewa.eT.b=new _Ewa.HF;_Ewa.bq.a=null;Type.registerNamespace("_Ewa");_Ewa.baP=function(){};_Ewa.baP.a=function(){_Ewa.j.a(function(n){_Ewa.vz.a(n)})};_Ewa.baP.a();Type.registerNamespace("_Ewa");_Ewa.Aj=function(n,t){this.b=n;this.c=t};_Ewa.Aj.prototype={b:null,c:null,a:function(n){var t,i;if(isNullOrUndefined(n))return null;if(t=null,n==="gridMenuId")t="ContextMenuCell";else return null;return i=this.b.b(),this.e(i,t),i},e:function(n,t){for(var f=this.c.a(t),i=f.$$lge(),u;i.$$mn();)for(var e=i.$$cu(),o=e.a(),r=o.$$lge();r.$$mn();)u=r.$$cu(),this.d(n,u)},d:function(n,t){var r=t.a().Id,o=t.a().Alt,u=t.a().Image16by16,f="Image16by16",e=t.a().Command,i;CommandUI.a.a(u)&&(f="None");t.b().e.length>0?(e=798637440,i=this.b.d(r,r,o,e),i.k(f,u,null),this.f(i.a(),t),Array.add(n.a(),i)):Array.add(n.a(),this.b.g(r,o,e,u,f,null,!1,null))},f:function(n,t){for(var r=null,u=this.b.b(),f=t.b().$$lge();f.$$mn();){var i=f.$$cu(),s=i.a().Id,h=i.a().Alt,e=i.a().Image16by16,o="Image16by16",c=i.a().Command;CommandUI.a.a(e)&&(o="None");r=this.b.g(s,h,c,e,o,null,!1,null);Array.add(u.a(),r)}Array.add(n.a(),u)}};_Ewa.Ak=function(n,t){var i,r;this.f=Function.createDelegate(this,this.n);this.g=Function.createDelegate(this,this.o);this.h=Function.createDelegate(this,this.p);_Ewa.Ak.initializeBase(this,[!1]);this.a=t;this.b=n;this.l=n.m()+"OfficeAddinLabel-Medium14";i=this;this.b.b().c(_Ewa.bN,29,function(n){i.c=n;n.c(i)});this.b.c().g(this.h);this.a.k(this.g);r=this;this.b.b().c(_Ewa.nK,206,function(n){r.e=n;n.a(r.f)})};_Ewa.Ak.prototype={a:null,b:null,l:null,c:null,e:null,k:function(n){this.dv("LAC",n)},j:function(n){this.dw("LAC",n)},d:function(n,t){var i,r;return n!=="QueryAddinLabel"?!1:(t[CommandUI.Controls.c.LabelText]!==this.a.a&&(i=CommandUI.AddInCommands.r.a(this.a),t[CommandUI.Controls.c.LabelText]=i.a,t[CommandUI.Controls.c.Visible]=i.b,r=this,window.setTimeout(function(){r.m()},0)),!0)},i:function(){return!0},m:function(){this.b&&CommandUI.AddInCommands.r.b(this.a,this.b.q(),this.l,_Ewa.ClientStringManager.a().a(286),_Ewa.ClientStringManager.a().a(287))},dispose:function(){this.b.c().h(this.h);this.a.m(this.g);this.e&&(this.e.b(this.f),this.e=null);this.c&&(this.c.b(this),this.c=null);this.b=null;this.a=null;_Ewa.cp.prototype.dispose.call(this)},n:function(){this.a&&this.a.i()},o:function(){this.dt("LAC",null,null)},p:function(n,t){var i=n.a();i||t&&t.a||this.c&&(this.c.b(this),this.c=null)}};_Ewa.rb=function(){this.j={tabhome:"Ribbon.Home",tabinsert:"Ribbon.Insert",tabdata:"Ribbon.Data",tabreview:"Ribbon.Review",tabview:"Ribbon.View"};this.i={tabpagelayoutexcel:["Ribbon.PageLayoutExcel",_Ewa.ClientStringManager.a().a(1397),_Ewa.ClientStringManager.a().a(1401)],tabformulas:["Ribbon.Formulas",_Ewa.ClientStringManager.a().a(1398),_Ewa.ClientStringManager.a().a(1402)],tabdeveloper:["Ribbon.Developer",_Ewa.ClientStringManager.a().a(1399),_Ewa.ClientStringManager.a().a(1403)],tabaddins:["Ribbon.AddIns",_Ewa.ClientStringManager.a().a(1400),_Ewa.ClientStringManager.a().a(1404)]};this.k=["Ribbon.Home","Ribbon.Insert","Ribbon.PageLayoutExcel","Ribbon.Formulas","Ribbon.Data","Ribbon.Review","Ribbon.View","Ribbon.Developer","Ribbon.AddIns"]};_Ewa.rb.prototype={h:null,b:function(){return"SourceControlId"},a:function(){return"Workbook"},c:function(){return"DesktopFormFactor"},f:function(){return this.j},g:function(){var t,r,e;if(this.h)return this.h;this.h={};for(var u=Object.keys(this.j),o=u.length,n=0;n<o;++n)t=u[n],this.h[t]=this.j[t];for(var f=Object.keys(this.i),s=f.length,i=0;i<s;++i)r=f[i],e=this.i[r],this.h[r]=e[0];return this.h},e:function(){return this.k},d:function(){return this.i}};_Ewa.rc=function(){};_Ewa.rc.a=function(n,t,i,r,u){var f=n.a(9,null);return f.sharedInfo=t,_Ewa.i.a(n,"InsertAgaveTaskpane",f,i,r,u,0,null)};_Ewa.Al=function(n,t,i,r,u,f,e){this.m=Function.createDelegate(this,this.y);this.b=n;isNullOrUndefined(t)&&Diag.a.a(34936844,220,10,String.format("AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: {0}",_Ewa.ca.a(!0,null)));this.c=t;this.j=i;this.f=r;this.e=u;this.d=new _Ewa.rb;this.g=f;this.k=e;Common.de.a="WAC_Excel";this.h=new($$sc.u.$$(String))};_Ewa.Al.prototype={j:null,e:null,d:null,f:null,g:null,k:null,i:!1,h:null,b:null,c:null,dispose:function(){isNullOrUndefined(this.g)||(this.g.dispose(),this.g=null);this.b=null;this.c=null;this.i=!0},a:function(n,t,i){var r=!1;switch(t){case 1402209562:if(!this.b.a(647)){r=!1;break}r=this.C(i);break;default:r=!1}return r},w:function(){return!1},u:function(n,t,i){var r=$$sc.a.a(Boolean,!0),u=t.a,f,e;switch(u){case 843847158:break;case-2025863019:f=i.ak1.toString();e=this;CommandUI.AddInCommands.a.g(f,function(){_Ewa.b.a(e.b).p()});break;case-1777565636:_Ewa.eA.d(i.OsfcontrolId.toString());this.c.M(i.OsfcontrolId.toString());break;case 1592314317:_Ewa.eA.c(i.OsfcontrolId.toString());this.c.E(i.OsfcontrolId.toString());break;case 1402209562:r=this.x(i);break;case 407117407:this.o(i);break;case 1782110672:this.p(i);break;case 516359383:this.g.m();break;case 543799107:this.z();break;case 1949669462:this.e.j(!0,!0);break;case-1014260128:if(!this.b.a(647)){r=_Ewa.K.a(u);break}r=this.r(i);break;default:r=_Ewa.K.a(u)}return r},t:function(n,t){var i=!1;switch(t.a){case 843847158:case-2025863019:case-1777565636:case 1592314317:case 1782110672:case 516359383:case 543799107:case 1949669462:i=!0;break;case 1402209562:i=!this.b.bi();break;case 407117407:i=this.b.isChangeGateEnabled("OfficeVSO:4014092_EnableLaunchAddInCommandForProtectedFiles")?!0:!this.b.bi();break;case-1014260128:if(!this.b.a(647)){i=!1;break}i=!0}return i},v:function(){return!1},z:function(){var n,t,i,r;if(this.e.c<=0&&(this.e.i(),n=this.s(),n&&n.e.length>0))for(t=n.$$lge();t.$$mn();)i=t.$$cu(),r={ack1:i,ack0:4,ak0:(new Date).getTime()},this.p(r)},p:function(n){Diag.a.a(17408928,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",n.ack0,n.ack1);this.e.o();var t=this;window.setTimeout(function(){if(isNullOrUndefined(t.c))Diag.a.a(39613472,220,10,String.format("AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: {0}",_Ewa.ca.a(!0,null)));else{var i=new CommandUI.AddInCommands.F(new CommandUI.AddInCommands.m(t.c.a()),CommandUI.AddInCommands.e.b(),CommandUI.AddInCommands.d.b());i&&(i.g(function(n,i){t.o(i.a)}),i.i(n))}},0)},o:function(n){var t,f,i,s,e,c,r,o,u,h;if(!this.i){Diag.a.a(17306637,220,50,"LaunchOperationType {0}.",n.ack0);try{if((this.b.a(250)||!this.b.isChangeGateEnabled("OfficeVSO:4014092_EnableLaunchAddInCommandForProtectedFiles")&&this.b.bi())&&(t=n.ack2,t&&t.e.length>0)){for(f=t.e.length,i=f-1;i>=0;i--)s=t.a(i),s.currentStoreType.toLowerCase()!==OSF.StoreType.FirstParty.toLowerCase()&&t.d(t.a(i));if(t.e.length<f&&(e=_Ewa.k.b(_Ewa.cM,this.b.b(),5,4,-2),c=this,_Ewa.f.cw(e,function(){e.a().a(28,null)},this.b.i(),3)),!t.e.length)return}if(isNullOrUndefined(this.c)){Diag.a.a(34936846,220,10,String.format("LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: {0}",_Ewa.ca.a(!0,null)));return}r=new CommandUI.AddInCommands.U(this.d,this.j,new CommandUI.AddInCommands.m(this.c.a()),new CommandUI.AddInCommands.Z(this.b.m(),1402209562),this.e,CommandUI.AddInCommands.e.b(),new CommandUI.AddInCommands.E);r.a(this.m);o=this.b.b().a(_Ewa.gy,53,!1);o.a()&&(_Ewa.z.a().b()?(u=this,Common.App.AppLifecycleManager.get_instance().a(5,null,3).CW(function(){u.i||r.c(u.k,u.b.q(),n)})):(h=$$as(CommandUI.h,o.a().b()),r.b(h,this.b.q(),n)))}catch(l){Diag.a.a(17651478,220,10,String.format("LaunchAddinCommands error message : {0}.",l.message))}}},x:function(n){var t=$$sc.a.a(Boolean,!0),i=n[this.d.b()],r=this.f.a()(i),u=new _Ewa.eA(this.b,this.c,r.ownerAddinInfo,t,null);return this.n(t,i,r,u)},n:function(n,t,i,r){var o=this,u=function(){n=r.g()},f=this,e=function(){_Ewa.b.a(f.b).p()};return this.f.c(t,this.e,r,new CommandUI.AddInCommands.m(this.c.a()),i,u,e),n},q:function(n){var s=$$sc.a.a(Boolean,!0),i=this.c.e(n.assetId),u,f,r,e,t,a;if((!i||(u=this.c.b(i),!this.b.a(624)||!_Ewa.l.g(u)||!u.SharedRuntime.State))&&(f=this.f.b(),r=n.assetId in f?f[n.assetId]:null,r)){var h=this.f.a()(r),v=new _Ewa.eA(this.b,this.c,h.ownerAddinInfo,s,null),y=this,c=function(t){var i,f,e;if(t){i={};for(var o=t,c=o.length,u=0;u<c;++u)f=o[u],i[f[0]]=f[1];e="Office.AutoShowTaskpaneWithDocument"in i?i["Office.AutoShowTaskpaneWithDocument"]:null;e&&e.toLowerCase()==="true"&&(Diag.a.a(41735503,220,50,"Auto-Show AddinCommands TaskPane, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",n.currentStoreType,n.storeId,n.assetId),y.n(s,r,h,v))}};if(Diag.a.a(41735504,220,50,"Check Auto-Show AddinCommands TaskPane, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",n.currentStoreType,n.storeId,n.assetId),i)c(this.c.b(i).OsfPropertyBag);else if(e=this.b.c().f().WebExtensions,e)for(var l=e,p=l.length,o=0;o<p;++o)if(t=l[o],a=t.WebExtensionType===1?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent,a===n.targetType&&t.PrimaryMarketplace.MarketplaceType.toLowerCase()===n.currentStoreType.toLowerCase()&&t.PrimaryMarketplace.MarketplaceRef.toLowerCase()===n.storeId.toLowerCase()&&t.PrimaryMarketplace.SolutionId.toLowerCase()===n.assetId.toLowerCase()){c(t.OsfPropertyBag);break}}},l:function(n,t){if(n&&n.length){var i=this.h.c(n);i&&t&&this.h.d(n);i||t||this.h.b(n)}},A:function(n){var i=n.c(),r,u,e,t,h;if(i&&i.a)for(r=i.a.$$lge();r.$$mn();)if(u=r.$$cu(),u.groups)for(var c=u.groups,v=c.length,f=0;f<v;++f)if(e=c[f],e.controls)for(var l=e.controls,y=l.length,o=0;o<y;++o)if(t=l[o],this.l(t.id,t.enabled),t.controlType===1&&t.menuItems)for(var a=t.menuItems,p=a.length,s=0;s<p;++s)h=a[s],this.l(h.id,h.enabled)},y:function(n,t){var i=null;t&&(i=t);this.b.a(647)&&i&&i.b&&this.A(i.b);this.b.A();this.b.a(109)&&i&&i.a&&this.q(i.a)},s:function(){var n=new($$sc.u.$$(Common.cJ));return this.b.a(64)&&(this.b.c().c().a(27)&&n.b(0),this.b.c().c().a(33)&&n.b(1),n.b(8)),n},r:function(n){var t=!0;if(isNullOrUndefined(n)||isNullOrUndefined(n.DynamicAddinCommandsMethodDispatchId))return $$sc.a.a(Boolean,!1);switch(n.DynamicAddinCommandsMethodDispatchId){case 1:t=this.D(n);break;case 2:t=this.B(n);break;default:t=!1}return $$sc.a.a(Boolean,t)},C:function(n){if(!n||!(this.d.b()in n))return!1;var t=n[this.d.b()];return!t||!t.length?!1:this.h.c(t)},D:function(n){var t=null,r=null,u=!0;if(isNullOrUndefined(n.SolutionId)||isNullOrUndefined(n[this.d.b()])||isNullOrUndefined(n.MethodData)||(t=n.SolutionId,r=n[this.d.b()],u=n.MethodData),!t||!t.length||!r||!r.length)return Diag.a.a(51515651,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;var e=new CommandUI.AddInCommands.b(this.b.m(),t,this.d,!0),f=e.a(r),i={};return i.DynamicAddinCommandsApiName="UpdateControlEnableState",i.AssetId=t,i.MaskedTabId=f,i.IsToEnable=u,Diag.a.a(51515652,220,15,_Ewa.H.a(i)),this.l(f,u),_Ewa.cK.a().e(!1),!0},B:function(n){var u;if(!this.b.a(689))return!1;var t=null,f=null,e=!0;if(isNullOrUndefined(n.SolutionId)||isNullOrUndefined(n[this.d.b()])||isNullOrUndefined(n.MethodData)||(t=n.SolutionId,f=n[this.d.b()],e=n.MethodData),!t||!t.length||!f||!f.length)return Diag.a.a(51515653,220,15,"SetRibbonTabVisible failed to get solutionId or tabId."),!1;var o=new CommandUI.AddInCommands.b(this.b.m(),t,this.d,!0),i=o.b(f),r={};return r.DynamicAddinCommandsApiName="SetRibbonTabVisible",r.AssetId=t,r.MaskedTabId=i,r.IsToShow=e,Diag.a.a(51515654,220,15,_Ewa.H.a(r)),u=new Array(0),e?appChrome.selectors.getSelectedTabId()!==i&&u.push(appChrome.actions.activateRibbonTab(i)):(appChrome.selectors.getSelectedTabId()===i&&u.push(appChrome.actions.setCurrentTab("Home")),u.push(appChrome.actions.deactivateRibbonTab(i))),appChrome.api.dispatch(u),!0}};_Ewa.rd=function(n){this.q=Function.createDelegate(this,this.t);this.p=Function.createDelegate(this,this.r);_Ewa.rd.initializeBase(this,[n])};_Ewa.rd.a=function(n){_Ewa.ba.a(199,new _Ewa.rd(n))};_Ewa.rd.prototype={n:null,l:function(){Diag.a.a(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");var t,n=this;_Ewa.cm.a(this.h).a((t=new _Ewa.Gg(null,null,null,0),t.g=function(){var t=n.h.c().D()&&n.h.c().a()&&!!(n.h.r()&16384)&&n.h.k();return n.h.c().a()&&Diag.a.a(38410433,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [{0}] IsSessionFullyLoaded [{1}] IsSessionActive [{2}] ShowCommandUI [{3}] IsEditMode [{4}]",t,n.h.c().D(),n.h.c().a(),!!(n.h.r()&16384),n.h.k()),t},t.e=this.p,t.f=this.q,t.h=this.h.isChangeGateEnabled("OfficeVSO:3814949_DontReactivateAddinsOnTotallySilentReopen")?2:1,t))},r:function(){var t,u;Diag.a.a(38410434,0,50,"AddinUICommandHandlerFactory.ActivateFeature, isEditMode [{0}] ShowCommandUI [{1}]",this.h.k(),!!(this.h.r()&16384));t=new($$sc.C.$$(_Ewa.gy));u=this;this.h.b().c(_Ewa.gy,53,function(n){Diag.a.a(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");t.b(n)});var f=t.a,i=new CommandUI.AddInCommands.h,r=new CommandUI.AddInCommands.H,e=new _Ewa.Ak(this.h,r),o=_Ewa.k.a(Sys.IDisposable,this.h.b(),203,this.du(),-2),s=this.u(i),h=_Ewa.k.b(Object,this.h.b(),349,350,-2),n=this;return _Ewa.f.cw(_Ewa.f.ws([f,o,s,h],this.du(),3),function(){Diag.a.a(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");_Ewa.f.cw(_Ewa.k.a(_Ewa.bA,n.h.b(),106,n.du(),-2),function(t){var u=t.a();n.n=new _Ewa.Al(n.h,u,i,new CommandUI.AddInCommands.z,r,e,Common.Utils.a.a().d(Common.cs));Diag.a.a(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");n.k([n.n],null);n.h.b().b(_Ewa.jK,198,n.n)},n.du(),3)},this.du(),3)},t:function(){isNullOrUndefined(this.n)?Diag.a.a(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated."):(this.h.h().d(this.n),this.h.b().e(_Ewa.jK,198),this.n=null);this.h.b().e(_Ewa.of,204);_Ewa.D.b(_Ewa.baj.$$(_Ewa.jK),_Ewa.vq.$$(_Ewa.jK),21,this.h.b(),198)},u:function(n){var t=_Ewa.k.a(_Ewa.dJ,this.h.b(),102,this.du(),-2),i=this;return _Ewa.f.cw(t,function(){Diag.a.a(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");var r=t.a();i.h.b().b(_Ewa.of,204,new _Ewa.Aj(r,n))},this.du(),3)}};_Ewa.eA=function(n,t,i,r,u){_Ewa.eA.initializeBase(this);this.a=n;this.c=t;this.b=i;this.e=u;this.d=r||$$sc.a.a(Boolean,!0)};_Ewa.eA.d=function(n){_Ewa.eA.a.b(n)&&_Ewa.eA.a.a(n).c()};_Ewa.eA.c=function(n){_Ewa.eA.a.b(n)&&_Ewa.eA.a.a(n).b()};_Ewa.eA.b=function(n,t){var i={};return i.AppVersion=n.appVersion,i.StoreId=n.storeId,i.AssetId=n.assetId,i.CurrentStoreType=t.storeType,i.TargetType=1,i.AssetStoreId="omex",i.Width=350,i.OwnerAddinAssetId=t.assetId,i.Id=i.AssetId,i.SharedRuntimeId=null,i};_Ewa.eA.prototype={c:null,a:null,b:null,e:null,d:null,g:function(){var n=this.d;return this.d=$$sc.a.a(Boolean,!0),n},disposeHost:function(n){this.c.s(n)},setOwnerAddinEToken:function(n){this.b.eToken=n},showTaskpane:function(n,t,i){var r,e,o,u,f;(Diag.a.a(17306639,220,50,"ShowTaskpane action called."),r=null,this.a.a(624)&&(e=new CommandUI.AddInCommands.b("m_excelWebRenderer_ewaCtl_",this.b.assetId,new _Ewa.rb,!0),o=e.c(n.assetId.substr(this.b.assetId.length)),r=t.getSharedRuntimeForTaskpane("Workbook",o)),u=!!r&&r.LifeTime===1,this.c.d(u?this.b.assetId:n.assetId,null,u?r:null))||(f=this,this.d=this.f(n,r,function(n,t){if(!n){Diag.a.a(17306640,220,10,"ShowTaskpane: instance id is null.");i(null,t);return}f.a.a(624)&&u&&(n.PrimaryMarketplace.SolutionId=f.b.assetId,n.SharedRuntime=r);n.WebExtensionOsfControlType=3;f.c.g(n);i(n.InstanceId,t)}))},showDialog:function(n,t,i){Diag.a.a(17306641,220,50,"ShowDialog action called.");var u=this.a.d().a(),r=this,f=function(n){var u=n.Result,t=u?u.AgaveData:null,f;t?(f=function(){var i=function(){r.disposeHost(t.InstanceId)},n=new CommandUI.AddInCommands.C(i);return n.j("",null,null),n.v},r.c.p(t,f),i(t.InstanceId,0)):(Diag.a.a(17306642,220,10,"ShowDialog: instance id is null."),i(null,n.Errors?n.Errors[0].ErrorCause:5001))},e=_Ewa.eA.b(n,this.b),s=this,o=function(n,t){return _Ewa.rc.a(u,e,_Ewa.n.a(n,f),t,null)},h=this;this.d=_Ewa.M.a(this.a.g(),o,function(n){return new _Ewa.bd(500,0,n,0,null)},this.e)},createUILessSandbox:function(n,t,i){var r,f,e,u;if(Diag.a.a(17306643,220,50,"UILess action called."),r=null,this.a.a(624)&&(r=t.getSharedRuntimeForAppCmdsExecuteFunction("Workbook")),f=!!r&&r.LifeTime===1,e=this.c.A(f?this.b.assetId:n.assetId,f?r:null),e){i(e,0);return}u=this;this.d=this.f(n,r,function(n,t){if(!n){Diag.a.a(17306644,220,10,"UILess: instance id is null.");i(null,t);return}if(u.a.a(624)&&f)n.PrimaryMarketplace.SolutionId=u.b.assetId,n.SharedRuntime=r,n.TaskpaneVisible=!1,n.WebExtensionOsfControlType=3,u.c.g(n);else{var e=function(){return _Ewa.eA.a.c(n.InstanceId,new CommandUI.AddInCommands.AddinCommandsUILessDialog),_Ewa.eA.a.a(n.InstanceId).a()};n.WebExtensionOsfControlType=4;u.c.p(n,e)}i(n.InstanceId,t)})},f:function(n,t,i){var r=null,e=this.a.d().a(),v=this,o=function(n){var t=n.Result;r=t?t.AgaveData:null;r||i(null,n.Errors?n.Errors[0].ErrorCause:5001)},u=_Ewa.eA.b(n,this.b),l;this.a.a(624)&&t&&(u.SharedRuntimeId=t.Resid);var s=500,y=this,h=function(n,t){return _Ewa.rc.a(e,u,_Ewa.n.a(n,o),t,null)},c=0;isNullOrUndefined(u.IsToBePersisted)||u.IsToBePersisted||(s=538,l=this,h=function(n,t){return Diag.a.a(41760867,220,50,"Web Method ShowAgaveTaskpane is called, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",u.CurrentStoreType,u.StoreId,u.AssetId),_Ewa.nJ.a(e,u,_Ewa.n.a(n,o),t,null,null)},c=16);var p=this,a=_Ewa.M.a(this.a.g(),h,function(n){return new _Ewa.bd(s,0,n,c,null)},this.e),f=this;return _Ewa.f.ts(a,function(){if(!r)return $$sc.a.a(Boolean,!1);var u=function(u,e){var o,s;if(u){for(f.a.a(624)&&t||(r.PrimaryMarketplace.MarketplaceType=n.storeType),r.OwnerAddinAssetId=f.b.assetId,r.OwnerAddinStoreType=f.b.storeType,r.OsfPropertyBag=[],o=0;o<u.Settings.length;o++)s=[],s[0]=u.Settings[o].Name,s[1]=u.Settings[o].Value,r.OsfPropertyBag[o]=s;i(r,0)}else i(null,e.Errors?e.Errors[0].ErrorCause:5001)};return f.h(e,r.InstanceId,u)},$$sc.f.a,3,$$sc.c.a)},h:function(n,t,i){var f=this,r=function(n){var t=n.Result;i(t,n)},e=this,u=function(i,u){return _Ewa.dA.b(n,t,_Ewa.n.a(i,r),u,null)},o=this;return _Ewa.M.a(this.a.g(),u,function(n){return new _Ewa.bd(501,0,n,16,null)},this.e)}};_Ewa.Ak.registerClass("_Ewa.Ak",_Ewa.cp,_Ewa.uU,Common.IRootUser);_Ewa.Al.registerClass("_Ewa.Al",null,_Ewa.uT,_Ewa.jK,Sys.IDisposable);_Ewa.rd.registerClass("_Ewa.rd",_Ewa.ba);_Ewa.eA.registerClass("_Ewa.eA",CommandUI.AddInCommands.ba);_Ewa.eA.a=new($$sc.v.$$(CommandUI.AddInCommands.t));Type.registerNamespace("_Ewa");_Ewa.TT=function(){};_Ewa.TT.a=function(){_Ewa.j.a(function(n){n.a(64)&&_Ewa.rd.a(n)})};_Ewa.TT.a();Type.registerNamespace("_Ewa");_Ewa.gP=function(){};_Ewa.gP.registerInterface("_Ewa.gP");_Ewa.Az=function(){};_Ewa.rn=function(){};_Ewa.rn.prototype={none:0,registerEvent:1,unregisterEvent:2,customFunction:3,showCard:4,createWorkbook:5,openWorkbook:6,enableEvents:7,closeWorkbook:8,setCalculationMode:9};_Ewa.rn.registerEnum("_Ewa.rn",!1);_Ewa.gQ=function(){};_Ewa.gQ.prototype={none:0,testEvent:1,test1Event:2,worksheetDataChangedEvent:10,worksheetActivatedEvent:11,worksheetDeactivatedEvent:12,worksheetAddedEvent:13,worksheetSelectionChangedEvent:14,worksheetDeletedEvent:15,worksheetCalculatedEvent:16,worksheetFilteredEvent:17,worksheetFormatChangedEvent:18,worksheetRowSortedEvent:19,worksheetColumnSortedEvent:20,worksheetSingleClickedEvent:21,worksheetRowHiddenChangedEvent:22,chartAddedEvent:50,chartActivatedEvent:51,chartDeactivatedEvent:52,chartDeletedEvent:53,tableSelectionChangedEvent:100,tableDataChangedEvent:101,tableAddedEvent:102,tableDeletedEvent:103,tableFilteredEvent:104,agaveVisualUpdateEvent:150,customFunctionExecutionBeginEvent:200,customFunctionExecutionEndEvent:201,commentAddedEvent:250,commentDeletedEvent:251,commentChangedEvent:252,invocationMessage:1e3,cancellationMessage:1001,metadataMessage:1002,visualSelectionChangedEvent:2e3,visualChangeEvent:2001,shapeSelectionChangedEvent:2100,shapeActivatedEvent:2101,shapeDeactivatedEvent:2102,workbookAutoSaveSettingChangedEvent:2200,wacOperationEvent:2201,recordingStateChangedEvent:2202,ribbonCommandExecutedEvent:2300,appRuntimeVisibilityChangedEvent:65539};_Ewa.gQ.registerEnum("_Ewa.gQ",!1);_Ewa.TY=function(){};_Ewa.TY.a=function(){_Ewa.j.a(_Ewa.tQ.a);_Ewa.j.a(_Ewa.rk.a)};_Ewa.rk=function(n,t){this.n=Function.createDelegate(this,this.s);_Ewa.rk.initializeBase(this);this.h=n;this.k=t;this.k.b()&&this.k.c(this.n);n.b().b(_Ewa.baj.$$(_Ewa.bA),106,this);this.j()};_Ewa.rk.a=function(n){new _Ewa.rk(n,Common.be.a())};_Ewa.rk.prototype={l:null,o:null,k:null,q:function(){return this.l||(this.l=new _Ewa.Y(this.h,this.o))},h:null,b:function(){if(Diag.a.a(38942484,0,50,"DdaFacadeServiceFactory:Create."),Common.a.V||this.k.a()){Diag.a.a(38537093,0,50,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [{0}] cookieComplianceIsConsentNeeded [{1}]",Common.a.V,this.k.a());return}if(this.h.a(605)&&this.h.isChangeGateEnabled("OfficeVSO:3760466_OepXloCssSwitch")){var n=this;Common.Utils.a.a().c(Common.App.ApplicationFeatureHelper.a).a(function(t){t.a("mso_officeStore",!0).then(function(t){return _Ewa.Y.d=t,n.p(),null})})}else this.p()},p:function(){var i=this.h.b(),t=_Ewa.k.b(_Ewa.lO,i,224,225,this.m),u=this,r=_Ewa.s.g(38,4,function(){return!isNullOrUndefined(window.OSF)},this.h.f().MaxRetriesForLoadingScript,this.h.i(),106,this.m),n=this;_Ewa.f.cw(_Ewa.f.ws([t,r],this.h.i(),3),function(){typeof OfficeExt=="undefined"||typeof OSF=="undefined"?Diag.a.a(40421204,0,15,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: {0}",_Ewa.ca.a(!0,null)):n.r();Diag.a.a(38537094,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");n.o=t.a();n.i(n.q());Diag.a.a(39965575,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.du(),3)},r:function(){this.h.a(83)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Common.App.AppsForOffice.c);this.h.a(580)?this.h.z().a(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Common.App.AppsForOffice.c,new Common.App.AppsForOffice.f(Common.a.a.i.WebServiceBase),this.h.a(91),this.h.a(687)):this.h.c().c().a(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Common.App.AppsForOffice.c,new Common.App.AppsForOffice.f(Common.a.a.i.WebServiceBase),this.h.a(91),this.h.a(687))},dispose:function(){System.a.a(this.l);this.l=null;this.h=null;this.k.b()&&this.k.d(this.n);this.k=null;_Ewa.cp.prototype.dispose.call(this)},s:function(){this.b()}};_Ewa.rh=function(n,t){this.f=Function.createDelegate(this,this.h);this.b=new($$sc.u.$$(_Ewa.rh.a));_Ewa.rh.initializeBase(this,[!1]);this.d=n;this.a=t};_Ewa.rh.b=function(n,t){var f=!1,i,r,u;return n===974713501&&(i=t?t.CommandValueId:null,r=i?i.DdaMethod:null,r&&r.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(u=i.ArrayData,f=!!u&&(u[6]&64)==64)),f};_Ewa.rh.prototype={d:null,a:null,c:!1,e:!1,g:function(n,t){if(!this.e){this.c||(this.a.f().f(this.f),this.c=!0);var i;this.b.b((i=new _Ewa.rh.a,i.b=n,i.a=t,i))}},h:function(){var i,n,t;if(!this.e)for(this.a.f().h(this.f),this.c=!1,i=this.b,this.b=new($$sc.u.$$(_Ewa.rh.a)),n=i.$$lge();n.$$mn();)t=n.$$cu(),this.d.X(t.b,t.a,!0)},dispose:function(){var r,n,t,i;if(!this.e){for(this.e=!0,this.c&&this.a.f().h(this.f),r=this.b,this.b=null,n=r.$$lge();n.$$mn();)t=n.$$cu(),i=t.a?t.a.DdaMethodCallback:null,i&&this.d.R(5004,i,!0);this.a=null;this.d=null;_Ewa.WY.prototype.dispose.call(this)}}};_Ewa.rh.a=function(){};_Ewa.rh.a.prototype={b:0,a:null};_Ewa.iW=function(){};_Ewa.iW.c=function(){return _Ewa.iW.a||(_Ewa.iW.a={"-2002156328":1e3,"-1954750170":1001,"317650254":1002,"-1005263101":1003,"1353664579":1004,"159671765":1005,"1446690022":1008,"1150069548":2e3,"-1409306331":2001,"338507772":2002,"-457159301":2003,"-1037701970":2004,"-1893322318":2005,"965579896":2007,"93287890":2008,"358088857":2009,"-1223650923":2002,"2007306190":2014,"1549955423":3002,"-1275974171":3004,"382101082":3005,"-898776235":3006,"335464256":3007,"1677378049":3008,"-261992848":3009,"-980820954":3002,"-931375837":3010,"929186550":8e3,"-982144310":8001,"-785741187":8010,"2125217573":8011,"299124955":8012,"1669853884":8020,"-1515932330":8021,"314621024":8022,"-300049690":8023,"14766835":4002,"-1251992761":5002,"-2087635043":5012,"2100961153":5012,"-1468309555":5006,"-315732528":5012,"611268539":5012,"1531005923":5006,"1593924569":5006,"299476328":5102,"49173765":5102,"-907155566":5102,"-1201603824":5102,"1541165282":5102,"-1347753427":5102,"134912532":5102})};_Ewa.iW.b=function(n){return _Ewa.u.c(_Ewa.iW.c(),n.toString(),5001)};_Ewa.lM=function(n){this.k=Function.createDelegate(this,this.p);this.i={};this.j={};this.e={};this.g={};this.a=n;this.h=this.k};_Ewa.lM.a=function(n,t){var i=new Array(6);return i[0]=n.Category,i[1]=n.Type,i[2]=n.Target,i[3]=n.Message,i[4]=n.Id,i[5]=t,i};_Ewa.lM.prototype={b:null,h:null,o:function(n){n&&(this.m(),Array.add(this.b,n))},r:function(n){this.b&&(Array.remove(this.b,n),this.b.length||(this.a.bI(!1),this.a.dj(this.h),this.b=null))},a:null,p:function(n,t){for(var u,f,c,i,s,h,o,l,a=this.a.o().a("Task","DdaEventDispatch.HandleServerEvent"),e=t.a,r=0;r<e.length;r++)switch(e[r].EventType){case 2:u=e[r];f={};f.Name=u.Name;f.BindingType=u.BindingType;f.ColCount=u.ColCount;f.RowCount=u.RowCount;this.d(u.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,f,null);break;case 4:c=e[r];this.d(c.InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(i=e[r],_Ewa.e.a(i.InstanceId)){for(this.e={},this.g={},s=0;s<i.Entries.length;s++)this.l(i.Entries[s],i.IsRemoteOverride);Diag.a.a(36444194,0,50,"Number of Fired event: {0}, Number of Not Fired event: {1}, Total Number of Fired event: {2}, Total Number of Not Fired event: {3}",this.e,this.g,this.i,this.j)}else{for(h=new Array(i.Entries.length),o=0;o<i.Entries.length;o++)h[o]=_Ewa.lM.a(i.Entries[o],i.IsRemoteOverride);i.Entries.length>0&&i.Entries[0].Category===1?(l=i.InstanceId,this.q(l,h)):i.InstanceId&&this.d(i.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,h)}}a.a()},q:function(n,t){var i=$$as(_Ewa.Y,_Ewa.cd.a(this.a)),r=this;_Ewa.f.cw(i.cl(n),function(n){var f,u,e;if(_Ewa.cr.a(n)){if(f=n.a(),u=i.Q(f),f)if(u.w)r.d(f,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,t);else if(u.m)for(e=0;e<t.length;e++)Array.add(u.m,t[e]);else u.m=t}else n.b===5?Diag.a.a(38134347,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):n.b===4&&Diag.a.a(38134348,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.a.i(),0)},l:function(n,t){var s=!1,i=parseInt(n.Type),c=n.Target,h=$$as(_Ewa.Y,_Ewa.cd.a(this.a)),r=h.S.h(i,c),u,f,e,o;if(r&&Object.keys(r).length>0){u=new Array(1);u[0]=_Ewa.lM.a(n,t);s=!0;f=r;for(e in f)o={key:e,value:f[e]},h.S.e(o.key)&&this.d(o.key,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u)}s?(this.f(_Ewa.gQ.toString(i),this.e),this.f(_Ewa.gQ.toString(i),this.i)):(this.f(_Ewa.gQ.toString(i),this.g),this.f(_Ewa.gQ.toString(i),this.j))},m:function(){this.b||(this.b=[],this.a.ck(this.h),this.a.bI(!0))},f:function(n,t){n in t||(t[n]=0);t[n]=t[n]+1},c:function(n,t,i){var r={};r.Target=t;r.Category=65536;r.Type=n;r.Message=i;r.Id=-1;this.l(r,!1)},n:function(n,t,i,r){var u={},f;u.Target=i;u.Category=65536;u.Type=t;u.Message=r;u.Id=-1;f=new Array(1);f[0]=_Ewa.lM.a(u,!1);this.d(n,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,f)},d:function(n,t,i,r){var f,o,u,s,e;if(this.b&&(f=$$as(_Ewa.Y,_Ewa.cd.a(this.a)),!f||t!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&t!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||f.S.e(n)))for(o=new _Ewa.nB(t,n,i,r),u=0,s=this.b.length;u<s;u++)e=this.b[u],e&&e(o)}};_Ewa.rj=function(n,t){this.a=n;this.c=t};_Ewa.rj.prototype={b:null,e:function(n){n&&(this.b||(this.b=[]),Array.add(this.b,n))},f:function(n){this.b&&Array.remove(this.b,n)},a:0,c:null,g:function(n){return this.a!==n.dispid?!1:this.a===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.a===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.c===n.ddaBinding.Name:!0},d:function(n){if(this.b){var i=this,t=function(t){var i=t;i(n)};Array.forEach(this.b,t)}},h:function(){this.b=[]}};_Ewa.Y=function(n,t){this.bG=Function.createDelegate(this,this.bW);this.bJ=Function.createDelegate(this,this.ct);this.bq=Function.createDelegate(this,this.cr);this.bs=Function.createDelegate(this,this.cu);this.bp=Function.createDelegate(this,this.co);this.br=Function.createDelegate(this,this.cs);this.bt=Function.createDelegate(this,this.cv);this.bI=Function.createDelegate(this,this.N);this.bH=Function.createDelegate(this,this.cq);this.P=[];this.bm=[];this.bO=[];this.bc=[];this.bn=new($$sc.q.$$(String))($$sc.e.a());this.bf=[];this.bE=[];_Ewa.Y.initializeBase(this,[!1]);this.O=n;this.bh=t;this.cm();_Ewa.rl.a(this);this.bj=0};_Ewa.Y.a=function(n,t){var i=n.PrimaryMarketplace.SolutionId;return t.a(395)&&n.OwnerAddinAssetId&&(i=n.OwnerAddinAssetId),i};_Ewa.Y.e=function(n,t){var i=0;return t.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?n.RequestFlags&1&&(n.RequestFlags&256)!=256||(i=16):i=(n.RequestFlags&1)?0:16,i!==16&&t.isChangeGateEnabled("OfficeVSO:3815811_RichApiDonotShowSavingState")&&(n.RequestFlags&2048)==2048&&(i=16),i};_Ewa.Y.l=function(n){var t={recording:n};return JSON.stringify(t)};_Ewa.Y.k=function(n){var t={};return t["visibility"]=n?"Visible":"Hidden",JSON.stringify(t)};_Ewa.Y.n=function(n){var t=n.getMarketplaceID(),i=n.getMarketplaceVersion(),r=n.getStoreType(),u=n.getStoreLocator();return _Ewa.Y.g("2",t,i,r,u)};_Ewa.Y.c=function(n,t){var i=_Ewa.Y.a(n,t),r=n.PrimaryMarketplace.SolutionVersion,u=n.PrimaryMarketplace.MarketplaceType,f=n.PrimaryMarketplace.MarketplaceRef;return _Ewa.Y.g("2",i,r,u,f)};_Ewa.Y.g=function(n,t,i,r,u){var f=_Ewa.Y.o(r).toString();return String.format("{0}|{1}|{2}|{3}|{4}|||",n,t,i,f,u)};_Ewa.Y.h=function(n){var i=n.split("|");if(i.length<7)return Diag.a.a(35755850,0,10,"DdaEventDispatch.GetWebExtensionDataFromCustomFunctionAddinId: Unexpected customFunctionAddinId='{0}'.",n),null;if(i[0]!=="2")return Diag.a.a(35755851,0,10,"DdaEventDispatch.GetWebExtensionDataFromCustomFunctionAddinId: Unexpected format='{0}'.",i[0]),null;var r=i[1],u=i[2],f=_Ewa.Y.p(i[3]),e=i[4],o=i[5];r&&r.length||(r=o);var s=["customFunctionAddinId",n],h=[s],t={};return t.InstanceId=String.format("{{{0}}}",Common.F.a().a),t.WebExtensionOsfControlType=4,t.WebExtensionType=1,t.PrimaryMarketplace={},t.PrimaryMarketplace.SolutionId=r,t.PrimaryMarketplace.SolutionVersion=u,t.PrimaryMarketplace.MarketplaceRef=e,t.PrimaryMarketplace.MarketplaceType=f,t.OsfPropertyBag=h,t.ContainsCustomFunctions=!0,t};_Ewa.Y.p=function(n){var t=parseInt(n);return t===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:t===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:t===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:t===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:t===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:t===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:t===OSF.StoreTypeEnum.OneDrive?OSF.StoreType.OneDrive:t===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:t===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:t===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:t===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:null};_Ewa.Y.o=function(n){return n===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:n===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:n===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:n===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:n===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:n===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:n===OSF.StoreType.OneDrive?OSF.StoreTypeEnum.OneDrive:n===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:n===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:n===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:n===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:-1};_Ewa.Y.m=function(n){var t={};return t.AppVersion=n.appVersion,t.AssetId=n.assetId,t.AssetStoreId=n.assetStoreId.toString(),t.CurrentStoreType=n.currentStoreType,t.Height=n.height,t.Id=n.id,t.StoreId=n.storeId,t.TargetType=n.targetType,t.Width=t.TargetType===1?0:n.width,t.SharedRuntimeId=n.sharedRuntimeId,t};_Ewa.Y.i=function(n){return n===OSF.DDA.EventDispId.dispidSettingsChangedEvent||n===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||n===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||n===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||n===OSF.DDA.EventDispId.dispidRichApiMessageEvent||n===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||n===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||n===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};_Ewa.Y.j=function(n){var t;return t=new CommandUI.AddInCommands.l,t.e=n.infoType,t.i=n.id,t.c=n.title,t.f=n.description,t.g=n.buttonTxt,t.a=n.buttonCallback,t.h=n.highPriority,t.b=n.dismissCallback,t.d=n.errorCode,t.j=n.iframeNotificationUrl,t};_Ewa.Y.f=function(n){var t=n==="FA000000014",i;return t||(i="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1",t=n===i),t};_Ewa.Y.q=function(n){return n==="FA000000005"};_Ewa.Y.prototype={V:null,U:null,T:null,bb:null,bh:null,bA:!1,bi:!1,bl:!1,bB:!1,ba:null,bd:null,bo:350,by:null,ck:function(){return this.by||(this.by=new Common.Utils.d(this.O.bD()))},u:function(n){this.dv("cd",n)},I:function(n){this.dw("cd",n)},n:function(n){this.dv("csc",n)},h:function(n){this.dw("csc",n)},t:function(n){this.dv("ca",n)},H:function(n){this.dw("ca",n)},v:function(n){this.dv("ci",n)},w:function(n){this.dv("ekros",n)},J:function(n){this.dw("ekros",n)},W:function(){var i,f,e;if(!this.U){var n={},o=!(this.O.r()&1),t=_Ewa.s.b.b,s=this.O.l(),u=Common.C.a+Common.C.e,r=0;this.O.a(831)&&(r|=1);this.O.a(832)&&(r|=2);n.pageBaseUrl=t.LayoutsContentUrlPrefix;n.appName=OSF.AppName.ExcelWebApp;n.appVersion="16";n.clientMode=o?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;n.appUILocale=this.O.f().UICultureTag;n.dataLocale=this.O.f().DataCultureTag;n.docUrl=s.ClientUrl;n.hostControl=this;n.formFactor=OSF.FormFactor.Default;n.lcid=this.O.Q().toString();n.localizedScriptsUrl=Common.C.a+Common.C.g;n.localizedImagesUrl=u;n.localizedStylesUrl=Common.C.a+Common.C.h;n.localizedResourcesUrl=u;n.osfOmexBaseUrl=t.OsfOmexBaseUrl;n.firstPartyManifestCDNUrl=t.FirstPartyAddInManifestCDN;n.sdxAssetsToPrefetchMapping=Common.a.a.i.SdxAssetsToPrefetchMapping;n.sdxCdnUrl=t.SdxCdnUrl;n.sdxDmsUrl=t.SdxDmsUrl;n.devCatalogUrl=t.DevCatalogUrl;n.oneDriveCatalogBaseApiUrl=t.OneDriveCatalogBaseApiUrl;n.controlStatusChanged=this.bH;n.notifyHost=this.bI;n.allowExternalMarketplace=this.O.c().c().a(27)&&_Ewa.Y.d;n.trustAgaves=this.O.a(5);n.enableAddinCommands=this.O.a(64);n.enableBlackForestRedirect=this.O.a(110);n.enableMyOrg=this.O.c().c().a(33);n.enableMyApps=this.O.c().c().a(34);n.enableDevCatalog=this.O.a(56);n.enablePrivateCatalog=this.cy();n.enableTaskpaneUpgradeToAppCommand=this.O.a(115);n.showSignOutFromPrivateCatalogMessage=this.O.c().c().a(36);n.enableUploadFileDevCatalog=this.O.a(64)&&!this.O.a(369);n.userNameHashCode=Common.e.e(Common.a.r);n.envCode=this.O.f().OfficeAddinTelemetryDataSourceCode.toString();n.enableSingleSignOnForAddin=!this.O.a(33)&&Common.a.cl;n.enableServiceDeliveredExperience=this.O.a(106);n.enableDisplayBlockedMinorError=this.O.a(246);n.hideAppsExtensionUrl=Common.a.da;n.enableAnonymousUseLegacyCatalogService=this.O.a(228);n.enableInsertDialogAccessibilityFix=this.O.a(240);n.disableAppsForOfficeThirdParty=this.O.a(250);n.enableFirstPartySSO=this.O.a(264);n.wacSessionId=this.O.f().UserSessionId;n.disableLogging=!this.O.f().AriaLoggingIsEnabled;n.enableFirstPartySDXErrorMessages=this.O.a(279);n.enableRichApiCellEditDelay=this.O.a(256);n.isHostDocumentDomain=this.O.a(293);n.loggableUserId=Common.a.a.i.LoggableUserId;n.sessionStartInfoJson=Common.a.a.i.SessionStartInfoJson;n.wopiHostOriginFromPostMessage=Common.a.cy;n.wopiHostOriginFromWacPropBag=Common.a.a.i.PostMessageOrigin;n.wacIsEmbedded=Common.a.a.a("IsEmbedded");n.accessibilityAllowFocusAddinTaskpane=Common.a.a.a("AccessibilityAllowFocusAddinTaskpane");n.enableRemoveAppCommandsAddin=Common.a.a.a("RemoveAppCommandsAddinIsEnabled");n.isHostFrameTrustCheckEnabledForAddIns=Common.a.a.a("HostFrameTrustCheckIsEnabledForAddIns");n.isHostFrameTrusted=Common.a.J;n.agaveAddinUploadEnabled=this.O.a(58);n.hostAllowedSdxEmbedding=Common.a.a.a("HostAllowedSdxEmbedding");n.addinEnforceHttpsIsEnabled=this.O.a(875);n.addinXdmUseOriginIsEnabled=this.O.a(856);n.hostFeatureGateFlag=r;this.U=new OSF.ContextActivationManager(n);this.U.setIframeAttributeBag({frameborder:0,marginheight:0,marginwidth:0});this.U.setWSA(Common.a.n);this.U&&typeof this.U.hostCheckReadyHandler!="undefined"&&(i=this.U,Common.a.fW(i.$$d_hostCheckReadyHandler||(i.$$d_hostCheckReadyHandler=Function.createDelegate(i,i.hostCheckReadyHandler))));try{f=Common.Utils.a.a();e=f.a(Common.App.OAuth.b);this.U.setOAuthManager(e)}catch(h){}}return this.U},bk:!1,S:null,bg:null,bw:null,bK:null,bu:null,bv:null,bx:null,bj:0,Z:null,O:null,k:function(n){var t={};return t.Name=n.Name,t.BindingType=n.BindingType,t.HasHeaders=n.HasHeaders,n.IsValidRef&&(t.ColCount=n.Reference.LastColumn-n.Reference.FirstColumn+1,t.RowCount=n.Reference.LastRow-n.Reference.FirstRow+1),t},r:function(n,t){var i=this.ce(t);this.U.launchInsertDialog(n,null,i)},G:function(n,t){var i={};i.callbackFunc=n;i.storeType=OSF.StoreTypeEnum.MarketPlace;i.fromInsertDialog=!1;i.refresh=t;this.U.queryEntitlementDetails(i)},invokeDdaMethod:function(n,t){var i=this.Q(n.DdaMethod.ControlId);if(!i){this.R(5001,t,!0);return}i.bb(n,t)},registerDdaEventAsync:function(n,t,i,r,u){var f=this.Q(t);if(!f){this.R(5001,u,!0);return}if(!_Ewa.Y.i(n)){this.R(5e3,u,!0);return}f.bf(n,i,r,u)},unregisterDdaEventAsync:function(n,t,i,r,u){var f=this.Q(t);if(!f){this.R(5001,u,!0);return}if(!_Ewa.Y.i(n)){this.R(5e3,u,!0);return}f.bl(n,i,r,u)},dispose:function(){this.bB||(this.O.G(this.bt),this.V.h(this.br),this.V.G(this.bp),this.V.v(this.bs),this.bh.b(this),this.O.g().e(this.bq),this.O=null,this.bh=null,this.T=null,this.P=null,this.bm=null,this.bb&&(this.bb.dispose(),this.bb=null),System.a.a(this.bg),this.bd&&(this.bd.dispose(),this.bd=null),_Ewa.cp.prototype.dispose.call(this),this.bB=!0,Diag.a.a(39613473,0,50,"DdaFacade is disposed"))},l:function(n){var t=this.Q(n);return t?t.X():null},L:function(n){var t,r,i;if(this.bA!==n){for(this.bA=n,t=0,r=this.P.length;t<r;t++)i=this.P[t],n?i.J(!1):i.V();this.bg.q(n)}},D:function(n){var t=this.Q(n);return t?t.W():null},cu:function(){var f,e,n,t,o,i,s,r,u;for(this.ba=this.V.s().WebExtensions,f=this,e=function(n){return f.O.a(158)?!n.h||!n.h.length:!0},n=this.P.length-1;n>=0;--n)t=this.P[n],o=this.cj(t.b.InstanceId),!o&&e(t)&&(t.Q(),Array.removeAt(this.P,n));if(this.ba)for(i=0,s=this.ba.length;i<s;i++)r=this.ba[i],u=this.Q(r.WebExtensionId),u&&(u.f=r)},cq:function(n){this.dt("csc",n.getID(),null)},N:function(n,t,i){var s,h,ot,y,st,f,r,ht,p,w,b,lt,c,e,d,l,u,g,at,nt,o,tt,a,it,v,kt,rt,vt,dt,ut,yt,pt,ft,wt,et;if(t===OSF.AgaveHostAction.Select)_Ewa.b.a(this.O).s(!0),this.bT(!0);else if(t===OSF.AgaveHostAction.UnSelect)this.bT(!1);else if(t===OSF.AgaveHostAction.CancelDialog)this.X(-684355545,null,!0);else if(t===OSF.AgaveHostAction.InsertAgave)s={},h=i,h&&(s.ack5=h,s.CommandValueId=_Ewa.Y.m(h),this.X(-741808261,s,!0));else if(t===OSF.AgaveHostAction.NotifyHostError)ot={ak1:this.U.getManifestInvaildErrorString()},this.X(-2025863019,ot,!0);else if(t===OSF.AgaveHostAction.RefreshAddinCommands)this.O.a(64)&&this.X(543799107,null,!0);else if(t===OSF.AgaveHostAction.CtrlF6Exit||t===OSF.AgaveHostAction.CtrlF6ExitShift){if(y=this.O.b().a(_Ewa.fY,15,!1),!y)return;st=this.Q(n);f=st.j;f&&f.bc();Common.c.b()&&document.activeElement.blur();r={};r.keyCode=117;r.type="keydown";r.ctrlKey=!0;r.shiftKey=t===OSF.AgaveHostAction.CtrlF6ExitShift;r.srcElement=_Ewa.ef.isInstanceOfType(f)?f.e():_Ewa.b.a(this.O).C();ht=new Sys.UI.DomEvent(r);y.a(ht)}else if(t===OSF.AgaveHostAction.PageIsReady){if(p=this.Q(n),w=p.j,w&&w.m()===OSF.OsfControlTarget.TaskPane){if(b=this.O.b().a(_Ewa.dk,183,!1),!b)return;if(this.P)for(var ct=this.P,bt=ct.length,k=0;k<bt;++k)lt=ct[k],_Ewa.Y.f(lt.k())&&b.k();this.Z&&this.Z.k(p.b.InstanceId)}}else if(t===OSF.AgaveHostAction.TabExit)if(c=this.Q(n),e=c.j,e){if(e.m()===OSF.OsfControlTarget.InContent)e.bt();else if(e.m()===OSF.OsfControlTarget.TaskPane){if(d=this.O.b().a(_Ewa.dk,183,!1),!d)return;Common.c.b()&&document.activeElement.blur();d.k()}}else c&&c.l===4&&this.U.notifyAgave(n,OSF.AgaveHostAction.TabIn);else if(t===OSF.AgaveHostAction.TabExitShift)l=this.Q(n),u=l.j,u?u.m()===OSF.OsfControlTarget.InContent?u.bY():u.m()===OSF.OsfControlTarget.TaskPane&&(g=_Ewa.ef.isInstanceOfType(u)?u:null,g&&(Common.c.b()&&document.activeElement.blur(),g.o())):l&&l.l===4&&this.U.notifyAgave(n,OSF.AgaveHostAction.TabIn);else if(t===OSF.AgaveHostAction.EscExit||t===OSF.AgaveHostAction.ExitNoFocusable||t===OSF.AgaveHostAction.ExitNoFocusableShift){if(at=this.Q(n),nt=at.j,nt)nt.bc();else if(t===OSF.AgaveHostAction.EscExit){for(o=null,tt=Common.App.AppsForOffice.AppsForOfficeDialogManager.a.$$ge();tt.$$mn();)if(a=tt.$$cu(),a.a.b===n){a.a.a.i();o=a.b;break}o&&(it=this.Q(o),it&&it.l!==4&&this.W().notifyAgave(o,OSF.AgaveHostAction.TabIn))}}else if(t===OSF.AgaveHostAction.InstallCustomFunctions){if(!this.O.a(158)){Diag.a.a(36721667,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");return}v=i;kt=this;_Ewa.cm.a(this.O).b(function(){return!1});rt=this;_Ewa.f.cw(_Ewa.k.b(_Ewa.dE,this.O.b(),278,279,-2),function(n){var t=n.a();rt.O.b().a(_Ewa.dE,278,!1)||rt.O.b().b(_Ewa.dE,278,t);t.a(v.osfControl.getMarketplaceID(),_Ewa.Y.n(v.osfControl),v).j()},this.du(),3)}else if(t===OSF.AgaveHostAction.UninstallCustomFunctions){if(!this.O.a(158)){Diag.a.a(39965697,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");return}vt=i;dt=this;_Ewa.cm.a(this.O).b(function(){return!1});ut=this;_Ewa.f.cw(_Ewa.k.b(_Ewa.dE,this.O.b(),278,279,-2),function(n){var t=n.a();ut.O.b().a(_Ewa.dE,278,!1)||ut.O.b().b(_Ewa.dE,278,t);t.c(vt.solutionId).j()},this.du(),3)}else t===OSF.AgaveHostAction.SendTelemetryEvent?Common.App.AppsForOffice.o.a(i):t===OSF.AgaveHostAction.LaunchExtensionComponent?(yt=i,pt=Common.App.AppsForOfficeCommon.b.b(),pt.c(yt)):t===OSF.AgaveHostAction.RefreshRibbonGallery?(ft=this.O.b().a(_Ewa.eM,352,!1),ft&&ft.d(i)):t===OSF.AgaveHostAction.RemoveAppCommandsAddin&&(wt=i,this.cx(wt.assetId),et=this.O.b().a(_Ewa.dk,183,!1),et&&et.b())},R:function(n,t,i){var r={};r.CommandValueId=n;r.DdaMethodCallback=t;this.X(451041795,r,i)},Y:function(n){var t={};t.DdaMethodCallback=n;this.X(1237877382,t,!0)},X:function(n,t,i){var e=new _Ewa.T(n,0,this.O.t(),0,null),u=t?t.DdaMethodCallback:null,f,r;this.bd&&_Ewa.b.a(this.O).m()&&_Ewa.rh.b(n,t)?this.bd.g(n,t):(f=this.O.h().b(e,t,null),i&&(r=this,_Ewa.f.cw(f,function(n){var t=!1,i=n;_Ewa.cr.b(i)?r.R(5001,u,t):i.a()||(_Ewa.b.a(r.O).m()?r.R(5004,u,t):r.R(5001,u,t))},this.du(),8)))},ch:function(n){var t=this;return!!this.be(function(i){return _Ewa.Y.a(i.b,t.O)===_Ewa.Y.a(n,t.O)&&i.b.PrimaryMarketplace.MarketplaceType===n.PrimaryMarketplace.MarketplaceType&&i.b.PrimaryMarketplace.MarketplaceRef===n.PrimaryMarketplace.MarketplaceRef&&i.b.PrimaryMarketplace.SolutionVersion===n.PrimaryMarketplace.SolutionVersion})},Q:function(n){var t=this;return this.be(function(t){return t.b.InstanceId.startsWith(n)})},bQ:function(n){var t=this;return this.be(function(t){return t.h===n})},bP:function(n){var t=this;return this.be(function(t){return t.k()===n&&!(!t.h||!t.h.length)})},ci:function(n,t,i,r){var u=this;return this.be(function(f){return u.O.a(624)&&f.k()===n&&f.b.PrimaryMarketplace.MarketplaceRef.toLowerCase()===t.toLowerCase()&&f.b.PrimaryMarketplace.MarketplaceType.toLowerCase()===i.toLowerCase()&&!!f.b.SharedRuntime&&!!f.b.SharedRuntime.Resid&&!!r&&!!r.Resid&&f.b.SharedRuntime.Resid.toLowerCase()===r.Resid.toLowerCase()})},cd:function(n,t){var i=this.Q(n);i&&(i.I(t),i.A(!0))},cz:function(n,t){var i=this.Q(n);i&&i.A(t)},g:function(n){var t,i,e,r,s,h,c,f,l;if(n.WebExtensionType!==1||this.O.r()&8388608&&n.TaskpaneVisible||this.O.r()&8388608&&!n.TaskpaneVisible&&n.SharedRuntime){if(t=null,this.O.a(624)&&_Ewa.l.g(n)){if(t=_Ewa.Y.c(n,this.O),!this.O.isChangeGateEnabled("OfficeVSO:3772790_fixURLErrorForNonSharedRuntimeCF"))if(this.O.isChangeGateEnabled("OfficeVSO:3773770_fixSettingAPIFailureForSharedRuntime"))if(i=["customFunctionAddinId",t],n.OsfPropertyBag){r=!1;for(var o=n.OsfPropertyBag,a=o.length,u=0;u<a;++u)if(s=o[u],s[0]==="customFunctionAddinId"){r=!0;break}r||(n.OsfPropertyBag[n.OsfPropertyBag.length]=i)}else e=[i],n.OsfPropertyBag=e;else h=["customFunctionAddinId",t],c=[h],n.OsfPropertyBag=c;n.TaskpaneWidth=this.bo}f=new _Ewa.gn(this,this.T,n,!1).P();t&&(f.h=t);Array.add(this.P,f);this.bU(n.InstanceId)||(l=String.format("{0}|{1}|{2}|{3}|{4}",n.PrimaryMarketplace.SolutionId,n.PrimaryMarketplace.SolutionVersion,n.PrimaryMarketplace.MarketplaceRef,n.PrimaryMarketplace.MarketplaceType,n.WebExtensionType),this.dt("ci",l,null))}},y:function(n){if(n&&n.length){var i=[],t=this;Array.forEach(n,function(n){var r=n,u;r.ContainsCustomFunctions&&(u=_Ewa.Y.c(r,t.O),t.bn.b(u)||(t.bn.a(u),Array.add(t.bE,r)),t.ch(r)||Array.add(i,r))});i.length&&this.bL(i)}},p:function(n,t){if(!this.Q(n.InstanceId)){var i=t(),r=new _Ewa.gn(this,this.T,n,!1).O(i);Array.add(this.P,r)}},M:function(n){_Ewa.Y.b.b(n)&&_Ewa.Y.b.a(n).c()},E:function(n){_Ewa.Y.b.b(n)&&_Ewa.Y.b.a(n).b()},cl:function(n){var u=null,t,r,i=null,o,f,s,h,a,v,y;if(this.O.a(624)){if(t=_Ewa.Y.h(n),!t)return Diag.a.a(50426760,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),$$sc.a.a(String,null);if(r=this.U.getOsfControl(_Ewa.Y.a(t,this.O)),r&&(o=r.getManifest(),o&&(i=o.getSharedRuntimeForCustomFunctions("Workbook"))),u=i&&i.LifeTime===1?this.ci(t.PrimaryMarketplace.SolutionId,t.PrimaryMarketplace.MarketplaceRef,t.PrimaryMarketplace.MarketplaceType,i):this.bQ(n),u)return $$sc.a.a(String,u.b.InstanceId)}else{if(u=this.bQ(n),u)return $$sc.a.a(String,u.b.InstanceId);if(t=_Ewa.Y.h(n),!t)return Diag.a.a(38134349,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),$$sc.a.a(String,null);r=this.U.getOsfControl(_Ewa.Y.a(t,this.O))}if(f=new($$sc.C.$$(String)),this.O.isChangeGateEnabled("OfficeVSO:3768149_CustomFunctionCreateInstanceIdFromServer"))return(this.O.a(624)&&_Ewa.l.L(i)&&(t.SharedRuntime=i),s=r?r.getNotificationParams():[],!s.length)?this.bM(t):(h=this,a=this,this.bF(s,function(){_Ewa.f.cw(f.a,function(){h.bM(t)},h.du(),3)},function(){}),f.a);var e=this,c=function(){if(e.O.a(624)&&i&&i.LifeTime===1)t.WebExtensionOsfControlType=3,t.TaskpaneVisible=!1,t.SharedRuntime=i,e.g(t);else{_Ewa.Y.b.c(t.InstanceId,new CommandUI.AddInCommands.AddinCommandsUILessDialog);var r=_Ewa.Y.b.a(t.InstanceId).a();e.bN(t,r,n)}return e.bD(t,null),t.InstanceId},l=r?r.getNotificationParams():[];return l.length?(v=this,y=this,this.bF(l,function(){f.b(c())},function(){f.b(c())}),f.a):$$sc.a.a(String,c())},o:function(n){var t=this.bP(n),i;t&&(i=t.b.SharedRuntime,i||this.i(t.b.InstanceId))},i:function(n){var t=this.bP(n);return t?(this.s(t.b.InstanceId),!0):!1},cc:function(n){if(!this.Q(n.InstanceId)){var t=new _Ewa.gn(this,this.T,n,!1);Array.add(this.P,t)}},bY:function(n){if(this.P&&n>=0&&n<this.P.length){var t=this.P[n],i=t.e;return Array.removeAt(this.P,n),this.bW(t),_Ewa.a.f(i),!0}return!1},s:function(n){if(!this.P)return!1;for(var t=0,i=this.P.length;t<i;t++)if(this.P[t].b.InstanceId===n)return this.bY(t);return!1},cx:function(n){var i,t,r;if(!this.P)return!1;for(i=n.toLowerCase(),t=0,r=this.P.length;t<r;t++)if(i===this.P[t].b.OwnerAddinAssetId.toLowerCase())return this.bY(t);return!1},x:function(n){n.ck()&&(this.Q(n.a().y.InstanceId)||this.g(n.a().y),this.V.b()&&this.cd(n.a().y.InstanceId,n.j()))},e:function(n){if(this.P)for(var t=0,i=this.P.length;t<i;t++)if(this.P[t].b.WebExtensionType===1&&_Ewa.e.b(this.P[t].k(),n,!0))return this.P[t].b.InstanceId;return null},A:function(n,t){if(!t||!n||!n.length)return null;if(this.O.a(624)&&this.P)for(var i=0,r=this.P.length;i<r;i++)if(this.P[i].b.WebExtensionType===1&&_Ewa.e.b(this.P[i].k(),n,!0)&&this.P[i].b.SharedRuntime&&_Ewa.e.b(this.P[i].b.SharedRuntime.Resid,t.Resid,!0))return this.P[i].b.InstanceId;return null},q:function(n,t){return n?t?String.format("{0}.{1}",n,t):n:""},d:function(n,t,i){var u=t,f=!1,r,e;if((!u||!u.length)&&this.P)for(r=0,e=this.P.length;r<e;r++)if(this.P[r].b.WebExtensionType===1&&_Ewa.e.b(this.P[r].k(),n,!0))if(this.O.a(624)&&i){if(this.P[r].b.SharedRuntime&&_Ewa.e.b(this.P[r].b.SharedRuntime.Resid,i.Resid,!0)){this.P[r].S(!0);u=this.P[r].b.InstanceId;f=!0;break}}else{u=this.P[r].b.InstanceId;f=!0;break}return!u||!u.length||this.dt("ca",u,null),f},K:function(n,t){var i,r;if(!n||!n.length){Diag.a.a(51176384,0,15,"SetAppRuntimeState: Invalid controlId.");throw Error.invalidOperation("SetAppRuntimeState: Invalid controlId.");}else if(i=this.Q(n),i&&this.O.a(624)&&_Ewa.l.g(i.b))i.S(t),t&&(this.dt("ca",n,null),this.O.isChangeGateEnabled("OfficeVSO:3887874_SetAppRuntimeStateApiReadout")&&i.e&&i.e.firstChild&&(r=i.e.firstChild.title,r&&r.length>0&&this.ck().a(r)));else{Diag.a.a(51176355,0,50,"SetAppRuntimeState: run on non-shared runtime app.");throw Error.invalidOperation("SetAppRuntimeState only apply to shared runtime app.");}},C:function(n){var i=!1,t;if(!n||!n.length){Diag.a.a(51176386,0,15,"GetAppRuntimeState: Invalid controlId.");throw Error.invalidOperation("GetAppRuntimeState: Invalid controlId.");}else if(t=this.Q(n),t&&this.O.a(624)&&_Ewa.l.g(t.b))i=t.b.TaskpaneVisible;else{Diag.a.a(51176385,0,50,"GetAppRuntimeState: run on non-shared runtime app.");throw Error.invalidOperation("GetAppRuntimeState only apply to shared runtime app.");}return i},z:function(n,t){var i=this.Q(n);return i?i.G(t):null},bU:function(n){return this.cg(this.bm,n)},f:function(n){Array.add(this.bO,n)},j:function(){return this.P},b:function(n){var t=this.Q(n);return t?t.b:null},a:function(){return this.W()},m:function(n){this.dt("ekros",n,this)},bC:function(n){var i,t;n&&(i=this.Q(n.InstanceId),i&&(n.SharedRuntime||(this.s(i.b.InstanceId),this.W().purgeOsfControl(i.b.InstanceId,!1)),t={},t.Id=n.PrimaryMarketplace.SolutionId,t.TargetType=n.WebExtensionType,t.AppVersion=n.PrimaryMarketplace.SolutionVersion,t.CurrentStoreType=n.PrimaryMarketplace.MarketplaceType,t.StoreId=n.PrimaryMarketplace.MarketplaceRef,t.AssetId=n.PrimaryMarketplace.SolutionId,t.AssetStoreId=n.PrimaryMarketplace.MarketplaceRef,t.Width=n.TaskpaneWidth,this.ca(t)))},c:function(){this.T.m()},bS:function(n,t){var i=_Ewa.Y.l(t),r=this.b(n);this.T.n(r.InstanceId,2202,"Workbook",i)},bR:function(n){for(var t=0,i=this.P.length;t<i;t++)this.bS(this.P[t].b.InstanceId,n)},B:function(n,t){var i=_Ewa.Y.k(t);this.T.n(n,65539,"",i)},be:function(n){var i;if(!this.P)return null;for(var r=this.P,u=r.length,t=0;t<u;++t)if(i=r[t],n(i))return i;return null},bM:function(n){var t=new($$sc.C.$$(String)),i=_Ewa.Y.c(n,this.O),r,u;return this.O.a(624)&&_Ewa.l.g(n)?(r=this,this.bD(n,function(u){if(!u){Diag.a.a(594388363,0,10,"InsertAgaveTaskPane for customfunction: {0} failed",i);t.SX(Error.create("Null insert data"));return}n.InstanceId=u.InstanceId;n.WebExtensionOsfControlType=3;n.TaskpaneVisible=!1;r.g(n);t.b(n.InstanceId)})):(_Ewa.Y.b.c(n.InstanceId,new CommandUI.AddInCommands.AddinCommandsUILessDialog),u=_Ewa.Y.b.a(n.InstanceId).a(),this.bN(n,u,i),this.bD(n,null),t.b(n.InstanceId)),t.a},bN:function(n,t,i){if(!this.Q(n.InstanceId)){var r=new _Ewa.gn(this,this.T,n,!1);r.h=i;r.O(t);Array.add(this.P,r)}},bD:function(n,t){var u=_Ewa.Y.c(n,this.O),r,e;if(this.bn.b(u)){if(t)for(var f=this.bE,o=f.length,i=0;i<o;++i)if(r=f[i],e=_Ewa.Y.c(r,this.O),e===u){t(r,0);break}}else this.bf.push(n),this.bf.length>=1&&this.bX(n,t)},bX:function(n,t){var u=null,i={},a,v;i.Id=_Ewa.Y.a(n,this.O);i.TargetType=n.WebExtensionType;i.AppVersion=n.PrimaryMarketplace.SolutionVersion;i.CurrentStoreType=n.PrimaryMarketplace.MarketplaceType;i.StoreId=n.PrimaryMarketplace.MarketplaceRef;i.AssetId=n.PrimaryMarketplace.SolutionId;i.AssetStoreId=n.PrimaryMarketplace.MarketplaceRef;i.Width=n.TaskpaneWidth;i.ContainsCustomFunctions=!0;this.O.a(624)&&_Ewa.l.g(n)&&(i.SharedRuntimeId=n.SharedRuntime.Resid);var f=this.O.d().a(),c=this.O.d().a().b(!1),e=f.a(9,c);e.sharedInfo=i;var y=this,s=function(n){var t=_Ewa.V.a(n.b);Diag.a.a(38372576,0,10,"DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: {0}",_Ewa.h.a(t,","))},r=this,h=function(n){if((!n||_Ewa.S.a(n))&&Diag.a.a.apply(null,[39965700,0,10,"InsertAgaveTaskPane for addin {0} finish with errors: {0}",i.Id].concat(n.Errors)),r.bf.shift(),r.bf.length>0){var u=r.bf[0];r.bX(u,t)}},o;if(this.O.isChangeGateEnabled("OfficeVSO:3768149_CustomFunctionCreateInstanceIdFromServer")&&t){var p=this,l=function(n){var i=n.Result;u=i?i.AgaveData:null;u||t(null,n.Errors?n.Errors[0].ErrorCause:5001);t(u,0)},w=this;o=function(n,t){return _Ewa.i.a(f,"InsertAgaveTaskpane",e,_Ewa.n.a(n,h,l),_Ewa.n.b(t,s),null,0,null)}}else a=this,o=function(n,t){return _Ewa.i.a(f,"InsertAgaveTaskpane",e,_Ewa.n.a(n,h),_Ewa.n.b(t,s),null,0,null)};v=this;_Ewa.M.a(this.O.g(),o,function(n){return new _Ewa.bd(519,0,n,0,null)},null)},cy:function(){return this.O.a(580)?this.O.z().a(35):this.O.c().c().a(35)},F:function(n){var r=this,i=this.be(function(n){return _Ewa.Y.f(n.k())}),t;i&&(t=this.W().getOsfControl(i.b.InstanceId),t&&t.notifyAgave(OSF.AgaveHostAction.SendMessage,n))},cm:function(){var n=isNullOrUndefined(this.O)||this.O.a(331);isNullOrUndefined(this.O)&&Diag.a.a(39965576,0,50,"VSO#2693929: Initialize is called. EwaControl is null");n&&Diag.a.a(39965577,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.bl);this.bl||(_Ewa.rp.a(this.O),this.V=this.O.c(),this.T=new _Ewa.lM(this.O),this.O.E(this.bt),this.V.g(this.br),this.V.F(this.bp),this.V.t(this.bs),this.O.g().c(this.bq),this.bV(),this.cp(),this.cn(),this.O.b().b(_Ewa.bA,35,this),this.bh.a(this),n&&Diag.a.a(39965578,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.S=new _Ewa.lP,n&&Diag.a.a(39965579,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.bw=new _Ewa.Au(this.O,this.S,this.T),this.bK=new _Ewa.Av(this.O,this.S,this.T),this.bg=new _Ewa.As(this.O,this.S,this.T),this.bu=new _Ewa.Ar(this.O,this.S,this.T),this.bv=new _Ewa.At(this.O,this.S,this.T),this.bx=new _Ewa.Aw(this.O,this.S,this.T),this.O.N()&&(this.Z=new _Ewa.Ax(this.O,this.S,this.T)),this.O.a(256)&&(this.bd=new _Ewa.rh(this,_Ewa.b.a(this.O))),this.bl=!0,Diag.a.a(39613474,0,50,"DdaFacade is initialized"))},cj:function(n){if(!this.ba)return null;for(var t=0,i=this.ba.length;t<i;t++)if(n.startsWith(this.ba[t].WebExtensionId))return this.ba[t];return null},bV:function(){var i=this.V,n,r,t,u,f;if(i.a()&&!this.bi){if(i.f()){if(this.bk=this.O.c().c().a(22),i.f().WebExtensions&&i.f().WebExtensions.length){for(n=i.f().WebExtensions,r=!1,t=n.length-1;t>=0;t--){if(!this.V.b()){if(Array.add(this.bm,n[t].InstanceId),n[t].WebExtensionType!==1){Array.removeAt(n,t);continue}if(this.O.a(624)&&_Ewa.l.g(n[t])&&n[t].SharedRuntime.State)n[t].SharedRuntime.State===1?n[t].TaskpaneVisible=!1:n[t].SharedRuntime.State===2?n[t].TaskpaneVisible=!0:Diag.a.a(51176387,0,10,"The sharedRuntime state is invalid");else if(this.O.isChangeGateEnabled("OfficeVSO:3914950_BlockInstallationForNotInUseAddin")&&!n[t].ContainsCustomFunctions&&!n[t].TaskpaneVisible&&!_Ewa.hG.a(n[t])){Array.removeAt(n,t);continue}}this.O.a(250)&&n[t].PrimaryMarketplace.MarketplaceType.toLowerCase()!==OSF.StoreType.FirstParty.toLowerCase()&&(Array.removeAt(n,t),r||(r=!0,u=_Ewa.k.b(_Ewa.cM,this.O.b(),5,4,-2),f=this,_Ewa.f.cw(u,function(){u.a().a(28,null)},this.du(),3)))}this.bL(n)}}else this.bk=!1;this.bi=!0}},bT:function(n){var u=_Ewa.b.a(this.O),f=u.a().b().a(),t,r;if(f&&n){if(t=!1,this.P)for(var e=this.P,o=e.length,i=0;i<o;++i)if(r=e[i],_Ewa.Y.f(r.k())||_Ewa.Y.q(r.k())){t=!0;break}t||u.a().b().c(f,!0)}},cp:function(){var n=this.W();n&&this.V.b()&&this.O.j()&&_Ewa.A.i(this.O.j())&&(_Ewa.kg.a(this.O).bc()?_Ewa.kg.a(this.O).a():_Ewa.kg.a(this.O).t(this.bJ))},ct:function(){this.O.j()&&_Ewa.A.i(this.O.j())&&_Ewa.kg.a(this.O).a()},bL:function(n){for(var f=null,e=100,i=this,r,u,f=function(n){var t=n.WebExtensionData,u=n.IsTaskPane,h=n.RecordHandler,s=function(){if(i.bc.shift(),i.bc.length>0){var n=i.bc[0];f(n)}},c,r,o;if(i.e(t.PrimaryMarketplace.SolutionId)){s();return}if(u&&(t.WebExtensionOsfControlType=1),u&&!t.TaskpaneVisible&&!_Ewa.hG.a(t)&&(c=!t.SharedRuntime||!t.SharedRuntime.State,!i.O.a(624)||c&&!t.ContainsCustomFunctions)){s();return}r=new _Ewa.gn(i,i.T,t,!u);r.P();i.O.a(624)&&_Ewa.l.g(t)&&(r.h=_Ewa.Y.c(t,i.O),t.TaskpaneWidth=i.bo);_Ewa.hG.a(t)&&(t.WebExtensionToolTip="");u&&t.TaskpaneVisible&&!_Ewa.hG.a(t)&&(t.TaskpaneWidth=i.bo);Array.add(i.P,r);o=null;o=_Ewa.x.a().b(function(){r.e&&(System.a.a(o),o=null,h&&h(n,r),s())},e,_Ewa.m.I,!0,!1)},t=0;t<n.length;t++)this.Q(n[t].InstanceId)||(n[t].WebExtensionType!==1?this.g(n[t]):this.O.a(64)?(this.O.r()&8388608||n[t].TaskpaneVisible)&&(r={},r.marketplaceId=n[t].PrimaryMarketplace.SolutionId,r.marketplaceVersion=n[t].PrimaryMarketplace.SolutionVersion,r.storeType=n[t].PrimaryMarketplace.MarketplaceType,r.storeId=n[t].PrimaryMarketplace.MarketplaceRef,r.targetData=n[t],u=this,this.W().isAddinCommandsAsync(r,function(n,t,i){var e,o,s;if(!n){Diag.a.a(17367836,220,10,"Judging AddinCommands failed for {0} from {1} during document loading",i.targetData.PrimaryMarketplace.SolutionId,i.targetData.PrimaryMarketplace.MarketplaceType);return}if(e=i.targetData,t){if(!u.O.a(109))return;if(r.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())return;o=!1;s=function(n){var s=n,l,a,t,r;if(!s.errorCode){if(s.value)for(var c=s.value,v=c.length,h=0;h<v;++h){if(l=c[h],o)break;a=l[1];o=a.toUpperCase()===e.PrimaryMarketplace.SolutionId.toUpperCase()}o?u.O.a(624)&&_Ewa.l.g(e)&&u.bz(e,f):(t={},r=i,t.Id=r.marketplaceId,t.TargetType=e.WebExtensionType,t.AppVersion=r.marketplaceVersion,t.CurrentStoreType=e.PrimaryMarketplace.MarketplaceType,t.StoreId=r.storeId,t.AssetId=r.marketplaceId,t.AssetStoreId=r.storeId,t.Width=e.TaskpaneWidth,e.TaskpaneVisible=!0,u.cb(t,e,f))}};u.G(s,!0)}else u.bz(e,f)})):this.bz(n[t],f))},bz:function(n,t){var i={};i.WebExtensionData=n;i.IsTaskPane=!0;this.bc.push(i);this.bc.length===1&&t(i)},cb:function(n,t,i){var r={},u;r.ActivationInfo=n;r.WebExtensionData=t;r.IsTaskPane=!1;u=this;r.RecordHandler=function(n,t){var i=n.ActivationInfo,f=n.WebExtensionData,r=function(){u.s(t.b.InstanceId);u.W().purgeOsfControl(t.b.InstanceId,!1);u.ca(i)};u.a().insertBlankControlWithErrorUX(u.cw(t,i),r)};this.bc.push(r);this.bc.length===1&&i(r)},ca:function(n){var t={},r,i,u;t.id=n.Id;t.targetType=n.TargetType;t.currentStoreType=n.CurrentStoreType;t.assetId=n.AssetId;t.appVersion=n.AppVersion;t.storeId=n.StoreId;t.assetStoreId=n.AssetStoreId;r=new($$sc.u.$$(Object));r.b(t);i={};i.ack2=r;i.ack0=3;u=new _Ewa.T(407117407,0,this.O.t(),0,null);this.O.h().b(u,i,null)},cw:function(n,t){var i={};return i.div=n.e,i.id=n.b.InstanceId,i.marketplaceID=t.Id,i.marketplaceVersion=t.AppVersion,i.store=t.StoreId,i.storeType=t.CurrentStoreType,i.osfControlType=OSF.OsfControlTarget.TaskPane,i},cv:function(){this.bV()},cr:function(n,t){var i,r,u;t.b===1&&(i=t.a,i&&(r=new _Ewa.AA(_Ewa.bL.c(i.b),_Ewa.bL.c(i.c),_Ewa.bL.c(i.d),_Ewa.bL.a(i.b,i.c),_Ewa.bL.a(i.c,i.d),i.f,i.a&&i.a.a()&&i.a.a().ServerCorrelationId?i.a.a().ServerCorrelationId:null,i.a?Enum.toString(_Ewa.fb,i.a.c()):null,_Ewa.ck.b(_Ewa.bL.a(i.b,_Ewa.v.a().a()))),u=Sys.Serialization.JavaScriptSerializer.serialize(r),Diag.a.a(50872916,0,50,u)))},cs:function(n,t){var r,u,i,f,e;if(!this.V.a()&&_Ewa.ln.a(t))Array.forEach(this.P,this.bG),Array.clear(this.P),this.bi=!1;else{if(this.O.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")&&t.b){for(r=[],u=0;u<this.P.length;u++)i=this.P[u],i.l&&i.l!==3&&i.l!==4||Array.add(r,i);for(f=0;f<r.length;f++)e=r[f],this.s(e.b.InstanceId)}this.bZ();this.O.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(this.bi=!1)}},co:function(){this.bZ()},bZ:function(){var n=new _Ewa.Ay(this.O,this.S,this.bj);if(isNullOrUndefined(this.O)?Diag.a.a(39965580,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):this.O.a(331)&&Diag.a.a(39965581,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+isNullOrUndefined(this.S)),n.e()){var o=this,r=function(){},s=this,u=function(n){var t=_Ewa.V.a(n.b);Diag.a.a(38372578,0,10,"ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: {0}.",_Ewa.h.a(t,","))},t=n.d(),i=this,f=function(n,f){return _Ewa.i.a(i.O.d().a(),"ExecuteRichApiRequest",i.cf(t),_Ewa.n.a(n,r),_Ewa.n.b(f,u),null,0,null)},e=_Ewa.Y.e(t,this.O);this.O.g().d(new _Ewa.bd(507,0,f,e,null))}},cf:function(n){var t=this.O.d().a().a(1,null);return t.request=n,t},bW:function(n){var t=n;t.Q();this.dt("cd",t.b.InstanceId,null)},cg:function(n,t){if(n)for(var i=0;i<n.length;i++)if(_Ewa.e.b(n[i],t,!0))return!0;return!1},ce:function(n){var t={},i;return(t.navigationMode=OSF.OsfNavigationMode.DefaultMode,t.assetId=null,t.category=null,!n||n.length<3)?t:(_Ewa.e.a(n[0])||(i=parseInt(n[0]),isNaN(parseInt(i))||(t.navigationMode=i)),_Ewa.e.a(n[1])||(t.assetId=n[1]),_Ewa.e.a(n[2])||(t.category=n[2]),t)},cn:function(){var n,t;if(this.O.a(76)&&(n=this.O.l().FullDocumentInfo.EmbeddingPageOrigin,n&&n.length&&n.trim()!=="*")){this.bb=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new _Ewa.Aq(this),n,this.O.l().FullDocumentInfo.EmbeddingPageSessionInfo,this.O.z().a(2));try{this.bb.init()}catch(i){try{this.bb.dispose()}catch(r){}this.bb=null;Diag.a.a(41181569,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+i.message)}t={};t.a=this.O.f().UserSessionId;_Ewa.y.a().a(39,t,!1)}},bF:function(n,t,i){var r=_Ewa.Y.j(n[0]),u=r.a,f=r.b,e=this,o;r.a=function(){u&&u();var f=r.e!==OSF.InfoType.Error?t:null;n.shift();n.length?e.bF(n,f,i):f&&f()};o=this;r.b=function(){f&&f();i&&r.e!==OSF.InfoType.Error&&i()};CommandUI.AddInCommands.a.h(r)}};_Ewa.rl=function(n){this.k=Function.createDelegate(this,this.o);this.l=Function.createDelegate(this,this.p);this.g=new($$sc.v.$$(Function));this.h=new($$sc.v.$$(Function));this.f=n;this.a().b(this.l);this.a().a(this.k)};_Ewa.rl.a=function(n){if(!n.O.b().a(_Ewa.gP,232,!1)){var t=new _Ewa.rl(n);n.O.b().b(_Ewa.gP,232,t)}};_Ewa.rl.prototype={g:null,h:null,i:null,j:null,f:null,a:function(){return this.i||(this.i=Common.App.AppsForOffice.AppsForOfficeDialogManager.getInstance(this.n())),this.i},n:function(){if(!this.j&&this.f){var n=this.f.W();this.j=n}return this.j},b:function(n,t,i,r){if(this.f.O.a(33))this.f.R(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,i,!0);else{Diag.a.a(19931726,0,50,"DialogMessageReceivedEventManager.AddHandler called!");var u=this,f=function(r){r===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(u.g.c(n,t),u.f.Y(i)):(Diag.a.a(19931727,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),u.f.R(r,i,!0))};this.g.b(n)?f(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.q(n,r,f)}},c:function(n,t,i){this.f.O.a(33)?this.f.R(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,i,!0):(Diag.a.a(595121569,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),this.h.c(n,t),this.f.Y(i))},d:function(n,t){if(this.f.O.a(33))this.f.R(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,t,!0);else if(this.g.b(n)){Diag.a.a(19931728,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!");var i=this,r=function(r){i.g.d(n);r===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?i.f.Y(t):(Diag.a.a(19931729,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),i.f.R(r,t,!0))};this.a().c(n,r)}else this.f.R(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,t,!0)},e:function(n,t){this.f.O.a(33)?this.f.R(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,t,!0):(Diag.a.a(595121568,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.h.d(n),this.f.Y(t))},q:function(n,t,i){try{var r=this,u=function(n){r.f.cc(r.m(n))};this.a().f(t,n,i,u)}catch(f){Diag.a.a(19690967,0,10,"DialogMessageReceivedEventManager: show dialog failed. Exception message: {0}",f.message);i(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}},m:function(n){var t={};return t.InstanceId=n.id,t.WebExtensionType=n.osfControlType===OSF.OsfControlTarget.InContent?0:1,t.PrimaryMarketplace={},t.PrimaryMarketplace.SolutionId=n.marketplaceID,t.PrimaryMarketplace.SolutionVersion=n.marketplaceVersion,t.PrimaryMarketplace.MarketplaceRef=n.store,t.PrimaryMarketplace.MarketplaceType=n.storeType,t},p:function(n,t){if(this.g.b(t.a)){var i=new _Ewa.QJ(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,t.a,null,t.b,t.c);this.g.a(t.a)(i);t.b===OSF.DialogMessageType.DialogClosed&&this.g.d(t.a)}},o:function(n,t){if(this.h.b(t.a)){var i=new _Ewa.QK(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,t.a,null,t.c,t.b);this.h.a(t.a)(i)}}};_Ewa.Aq=function(n){this.d=Function.createDelegate(this,this.g);this.a=n};_Ewa.Aq.prototype={a:null,b:null,c:!1,invokeDdaMethod:function(n,t){var i={};i.CommandValueId=n;i.DdaMethodCallback=t;this.a.X(974713501,i,!0)},registerDdaEventAsync:function(n,t,i,r,u){if(!(n===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)){this.a.R(-1,u,!0);return}n===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&this.f();this.b||(this.b=[]);var f=this.e(n,i);f||(f=new _Ewa.rj(n,i),Array.add(this.b,f));f.e(r);this.a.Y(u)},unregisterDdaEventAsync:function(n,t,i,r,u){if(!(n===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)){this.a.R(-1,u,!0);return}var f=this.e(n,i);f&&f.f(r);this.a.Y(u)},f:function(){if(!this.c){var n=_Ewa.b.a(this.a.O).a();n.g(this.d);this.c=!0}},g:function(){var t=this,n=function(n){var t=n;t.a===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&t.d(new _Ewa.nB(t.a,"",null,null))};Array.forEach(this.b,n)},e:function(n,t){var i,r;if(!this.b)return null;for(i=0;i<this.b.length;i++)if(r=this.b[i],r.a===n&&r.c===t)return r;return null}};_Ewa.gn=function(n,t,i,r){this.F=Function.createDelegate(this,this.H);this.C=Function.createDelegate(this,this.Y);this.E=Function.createDelegate(this,this.be);this.D=Function.createDelegate(this,this.bd);_Ewa.gn.initializeBase(this);this.c=n.O;this.d=n;this.b=i;this.b.InstanceId=i.SrcLocationOverrideResourceId?n.q(i.InstanceId,i.SrcLocationOverrideResourceId):i.InstanceId;this.u=t;this.f={};this.f.WebExtensionId=i.InstanceId;this.x="osfControl_"+i.InstanceId;this.r="disabled_"+i.InstanceId;this.f.BindingData=i.BindingData;this.v=this.d.bU(i.InstanceId);this.l=i.WebExtensionOsfControlType;this.y=r;this.o=this.c.a(475)};_Ewa.gn.b=function(n){return n===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||n===OSF.DDA.EventDispId.dispidBindingDataChangedEvent};_Ewa.gn.a=function(n){return n===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||n===OSF.DDA.EventDispId.dispidSettingsChangedEvent||n===OSF.DDA.EventDispId.dispidRichApiMessageEvent};_Ewa.gn.c=function(n){return n===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||n===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};_Ewa.gn.prototype={b:null,p:0,u:null,i:null,x:null,f:null,n:!1,t:null,s:null,g:0,r:null,d:null,v:!0,j:null,l:0,h:null,m:null,q:null,w:!1,o:!1,y:!1,B:null,a:function(){return this.b.InstanceId},c:null,e:null,k:function(){return this.b.SrcLocationOverrideResourceId?this.d.q(this.b.PrimaryMarketplace.SolutionId,this.b.SrcLocationOverrideResourceId):this.b.PrimaryMarketplace.SolutionId},P:function(){var r,e,u,t,i,n,f;return this.c.a(250)&&this.b.PrimaryMarketplace.MarketplaceType.toLowerCase()!==OSF.StoreType.FirstParty.toLowerCase()?(r=_Ewa.k.b(_Ewa.cM,this.c.b(),5,4,-2),e=this,_Ewa.f.cw(r,function(){r.a().a(28,null)},this.du(),3),this):(this.b.WebExtensionType===1?(u=this,_Ewa.f.cw(_Ewa.ch.a(this.c),function(n){n.a().h(_Ewa.ef,u.c.b(),77,6,u.D)},this.du(),3)):(t=this.K(),i=_Ewa.L.a(this.c),t||(n={},n.Type=3,n.Id=this.f.WebExtensionId,n.WebExtensionData=this.b,n.ContentHtml="<div/>",n.Version=0,n.AbsoluteLeft=0,n.AbsoluteTop=0,n.AbsoluteRight=0,n.AbsoluteBottom=0,n.Width=0,n.Height=0,n.ZOrder=0,n.OriginDeltaX=0,n.OriginDeltaY=0,f=new _Ewa.gB(n),i.t(f,null),t=i.b(f.h(),null)),t?(this.z(t.j().firstChild),this.j=$$as(_Ewa.iX,t)):i.i(this.E)),this)},O:function(n){return this.z(n),this},Q:function(){this.y||this.d.W().purgeOsfControl(this.b.InstanceId,!1);this.T(!0);var n=this.K();n&&_Ewa.L.a(this.c).d(n,14,!1);this.d.S.m(this.b.InstanceId);this.d.S.f(this.b.InstanceId,!0);this.e=null},bb:function(n,t){if(!this.c.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")&&!!this.g){this.d.R(5004,t,!0);return}var i={};i.CommandValueId=n;i.DdaMethodCallback=t;this.d.X(974713501,i,!0)},bf:function(n,t,i,r){var f,e,u;if(!this.c.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")&&!!this.g){this.d.R(-1,r,!0);return}if(_Ewa.gn.b(n)&&(isNullOrUndefined(t)||isNullOrUndefined(this.G(t)))){this.d.R(3002,r,!0);return}if(Diag.a.a(36444195,0,50,"eventId: {0}, targetId: {1}",n,t),_Ewa.gn.a(n)&&this.Z(),_Ewa.gn.c(n)&&this.ba(),n===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent){if(this.c.a(33)){this.d.R(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,r,!0);return}f=this.d.O.b().a(_Ewa.gP,232,!1);f.b(this.b.InstanceId,i,r,t);return}if(n===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent){if(this.c.a(33)){this.d.R(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,r,!0);return}e=this.d.O.b().a(_Ewa.gP,232,!1);e.c(this.b.InstanceId,i,r,t);return}n===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent&&this.N(-1777565636,r);this.i||(this.i=[]);u=this.L(n,t);u||(u=new _Ewa.rj(n,t),Array.add(this.i,u));u.h();u.e(i);this.d.Y(r);n===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.m&&(this.q=i)},bl:function(n,t,i,r){var f,e,u;if(n===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent){if(this.c.a(33)){this.d.R(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,r,!0);return}f=this.d.O.b().a(_Ewa.gP,232,!1);f.d(this.b.InstanceId,r);return}if(n===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent){if(this.c.a(33)){this.d.R(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,r,!0);return}e=this.d.O.b().a(_Ewa.gP,232,!1);e.e(this.b.InstanceId,r);return}if(n===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent&&this.N(1592314317,r),u=this.L(n,t),!!this.g){this.d.R(-1,r,!0);return}if(!u){this.d.Y(r);return}u.f(i);u.b.length>0||Array.remove(this.i,u);this.i.length?_Ewa.gn.a(n)&&this.U(!1):this.T(!1);this.d.Y(r)},I:function(n){var t=_Ewa.a.a(n,this.x);t||n.appendChild(_Ewa.a.f(this.e))},A:function(n){_Ewa.a.b(this.e,n,!0)},bg:function(n,t){_Ewa.a.l(this.e,n,!1);_Ewa.a.r(this.e,t,!1)},J:function(n){if(!this.g&&!_Ewa.a.a(this.e,this.r)&&this.e){var t=document.createElement("div");t.id=this.r;t.className="ewa-wx-disabled-div";t.style.backgroundImage="url("+_Ewa.s.b.a(75)+")";t.style.opacity=n?"1":"0";t.style.backgroundRepeat="no-repeat";t.style.backgroundPosition="center";this.e.insertBefore(t,this.e.firstChild)}this.g++},V:function(){this.g>0&&this.g--;this.g||(_Ewa.a.f(_Ewa.a.a(this.e,this.r)),this.c.isChangeGateEnabled("OfficeVSO:4049691_SelectionChangedWithinBinding")?this.n&&!_Ewa.g.l(this.t,this.o?_Ewa.b.a(this.c).a().d().a():[_Ewa.b.a(this.c).a().a()])&&this.H(null,null):this.n&&this.s!==_Ewa.b.a(this.c).a().a()&&this.H(null,null))},G:function(n){if(!this.f||!this.f.BindingData)return null;for(var t=0;t<this.f.BindingData.length;t++)if(this.f.BindingData[t].Name===n)return this.f.BindingData[t];return null},X:function(){var n=this.M();return n?n.getDefaultIconUrl():null},W:function(){if(this.b.TaskpaneTitle)return this.b.TaskpaneTitle;var n=this.M();return n?n.getDefaultDisplayName():null},R:function(){if(this.m&&this.q){var n=new _Ewa.nB(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.b.InstanceId,null,this.m);this.q(n);this.m=null;this.q=null}},S:function(n){this.c.a(624)&&this.B&&this.B.c(n)},bj:function(){var i,n,t,r;this.c.c().b()&&this.bc()&&(i=_Ewa.kg.a(this.c),i.c(this.e),this.A(!1));this.d.bk?(this.y||(n={},n.div=this.e,n.id=this.b.InstanceId,n.marketplaceID=this.b.PrimaryMarketplace.SolutionId,n.marketplaceVersion=this.b.PrimaryMarketplace.SolutionVersion,n.store=this.b.PrimaryMarketplace.MarketplaceRef,n.storeType=this.b.PrimaryMarketplace.MarketplaceType,n.ownerAddinAssetId=this.b.OwnerAddinAssetId,n.ownerAddinStoreType=this.b.OwnerAddinStoreType,this.b.AssetMarketplace&&(n.alternateReference={},n.alternateReference.marketplaceID=this.b.AssetMarketplace.SolutionId,n.alternateReference.marketplaceVersion=this.b.AssetMarketplace.SolutionVersion,n.alternateReference.store=this.b.AssetMarketplace.MarketplaceRef,n.alternateReference.storeType=this.b.AssetMarketplace.MarketplaceType),n.settings=this.b.OsfPropertyBag,n.reason=this.v?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted,n.osfControlType=this.b.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent,n.isForUILessAction=this.b.WebExtensionOsfControlType===4,n.sourceLocationOverrideResourceId=this.b.SrcLocationOverrideResourceId,n.focusOnIframeWhenLoaded=this.b.FocusOnIframeWhenLoaded,_Ewa.hG.a(this.b)&&(n.featureGates=Common.a.a.A(n.marketplaceID)),n.hostInfoFlags=0,_Ewa.e.a(this.h)||(n.hostInfoFlags|=2),this.c.a(624)&&_Ewa.l.g(this.b)&&(n.hostInfoFlags|=1),this.c.a(64)&&this.c.a(115)&&_Ewa.e.a(this.h)&&(t=this,n.virtualOsfControlActivationCallback=function(){t.d.bC(t.b)}),this.c.a(624)&&(n.sharedRuntimeId=this.b.SharedRuntime?this.b.SharedRuntime.Resid:null,_Ewa.l.g(this.b)&&(this.c.isChangeGateEnabled("OfficeVSO:3892740_fixReLaunchAppCommandOnChildControl")?(r=this.d.W().getOsfControl(_Ewa.Y.a(this.b,this.c)),r||this.d.bC(this.b)):this.d.bC(this.b))),n.initialDisplayMode=this.b.TaskpaneVisible?2:1,this.d.W().insertOsfControl(n)),this.g=0):this.J(!0)},T:function(n){this.U(n);this.bk()},Z:function(){this.p||this.u.o(this.C);this.p++},U:function(n){this.p>0&&(n?this.p=0:this.p--,this.p||this.u.r(this.C))},ba:function(){if(!this.n){var n=_Ewa.b.a(this.c).a();this.c.isChangeGateEnabled("OfficeVSO:4049691_SelectionChangedWithinBinding")?this.t=this.o?_Ewa.g.p(_Ewa.b.a(this.c).a().d().a()):[_Ewa.b.a(this.c).a().a().f()]:this.s=n.a();n.g(this.F);this.n=!0}},bk:function(){this.n&&(_Ewa.b.a(this.c).a().h(this.F),this.n=!1)},bh:function(n){var t=new _Ewa.o(n.Reference.FirstRow+1,n.Reference.FirstColumn+1,n.Reference.LastRow+1,n.Reference.LastColumn+1,!1,!1),i,r;if(n.BindingType===1&&(n.HasHeaders&&(t.a=t.a-1),n.HasTotals&&(t.d=t.d+1)),this.c.isChangeGateEnabled("OfficeVSO:4049691_SelectionChangedWithinBinding")){var o=this.o?_Ewa.b.a(this.c).a().d().a():[_Ewa.b.a(this.c).a().a()],u=t.bn(this.t),f=t.bn(o),e=t.o(this.o?_Ewa.b.a(this.c).a().d().c():_Ewa.b.a(this.c).a().a());if(e&&(_Ewa.by.a(u)&&!_Ewa.by.a(f)||!_Ewa.by.a(u)&&!_Ewa.by.a(f)&&!_Ewa.g.l(u,f)))return e}else if(i=_Ewa.b.a(this.c).a().a().o(t),r=this.s.o(t),!r&&i||r&&i&&!i.g(r))return i;return null},bi:function(){var n=this,t=function(t){var i=t,r,u;(i.a!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&i.a!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||n.d.S.e(n.b.InstanceId))&&(i.a===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent?i.d(new _Ewa.nB(i.a,n.b.InstanceId,null,null)):i.a===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent&&(r=n.G(i.c),r&&r.IsValidRef&&(n.c.c().b()?n.c.n().a().e():n.c.e().a().a)===r.Reference.SheetName&&(u=n.bh(r),u&&i.d(new _Ewa.QH(i.a,n.b.InstanceId,n.d.k(r),r,u.a-1,u.b-1,u.k(),u.m())))))};Array.forEach(this.i,t)},H:function(){this.g||(this.bi(),this.c.isChangeGateEnabled("OfficeVSO:4049691_SelectionChangedWithinBinding")?this.t=this.o?_Ewa.g.p(_Ewa.b.a(this.c).a().d().a()):[_Ewa.b.a(this.c).a().a().f()]:this.s=_Ewa.b.a(this.c).a().a())},L:function(n,t){var i,r;if(!this.i)return null;for(i=0;i<this.i.length;i++)if(r=this.i[i],r.a===n&&r.c===t)return r;return null},Y:function(n){if(n.controlId===this.b.InstanceId){var i=this,t=function(t){var i=t;i.g(n)&&i.d(n)};Array.forEach(this.i,t)}},K:function(){for(var n,i=_Ewa.L.a(this.c).a(),t=i.length-1;t>=0;--t)if(n=i[t],n.a().a===3&&n.a().y.InstanceId===this.f.WebExtensionId)return n;return null},bc:function(){for(var t,n=0;n<this.c.n().d();n++)if(t=this.c.n().g(n),t.k===this.f.WebExtensionId)return!0;return!1},bd:function(n){var t=$$as(_Ewa.ef,n),i;t&&!t.h()&&(t.l(this.b),t.n(this.d),this.B=t,this.z(t.e()),this.c.a(624)&&this.b.SharedRuntime&&this.b.SharedRuntime.LifeTime===1&&!this.b.TaskpaneVisible&&t.c(!1),t.i(),this.v||_Ewa.ch.a(this.c).a().d(t,!0),i=this.c.b().a(_Ewa.baj.$$(_Ewa.ef),77,!1),i.g(this.D),this.j=$$as(_Ewa.iX,t))},z:function(n){this.e=n;this.e.id=this.x;this.e.className="ewa-wx-container-div";this.e.dir=this.c.s()?"rtl":"ltr";this.bj()},be:function(n,t){t.a.a().a===3&&t.a.a().y.InstanceId===this.f.WebExtensionId&&(this.j=$$as(_Ewa.iX,t.a),this.z(t.a.j().firstChild),_Ewa.L.a(this.c).o(this.E))},M:function(){if(!!this.g)return null;var n=_Ewa.hG.a(this.b)?"":this.b.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.b.PrimaryMarketplace.SolutionId,n)},N:function(n,t){var i,r;if(this.c.a(33)){this.d.R(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,t,!0);return}try{if(Diag.a.a(19931730,0,50,"HandleDialogNotificationShownInAddinEvent called!"),this.l!==4){this.d.R(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,t,!0);return}i={};i.OsfcontrolId=this.b.InstanceId;r=new _Ewa.T(n,0,this.c.k()?2:1,0,null);this.c.h().b(r,i,null);this.d.Y(t)}catch(u){Diag.a.a(19931731,0,10,"HandleDialogNotificationShownInAddinEvent called. Error message: {0}.",u.message);this.d.R(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,t,!0)}}};_Ewa.Ar=function(n,t,i){this.m=Function.createDelegate(this,this.q);this.l=Function.createDelegate(this,this.p);this.a=n;this.k=t;this.f=i};_Ewa.Ar.prototype={k:null,f:null,a:null,i:0,j:0,b:null,c:null,o:function(n){var t,i;n.messageType===51?(this.n(n.actionType,t={val:this.i},this.l),this.i=t.val):n.messageType===52&&(this.n(n.actionType,i={val:this.j},this.m),this.j=i.val)},n:function(n,t,i){if(n===1)t.val||_Ewa.b.a(this.a).a().b().k(i),t.val++,this.r();else if(n===2){if(t.val<1)return;t.val===1&&_Ewa.b.a(this.a).a().b().l(i);t.val--}},p:function(){var r=_Ewa.b.a(this.a).a().b().e(),n,t,i;this.h(r)&&(n=this.g(r),n)&&(t={},t.chartId=n,t.worksheetId=this.e(),i=_Ewa.H.a(t),this.d(51,n,i),this.d(51,this.e(),i))},q:function(){var n,t,i;if(this.b&&(n={},n.chartId=this.b,n.worksheetId=this.c,t=_Ewa.H.a(n),this.d(52,this.b,t),this.d(52,this.c,t)),i=_Ewa.b.a(this.a).a().b().e(),!this.h(i)){this.b=null;this.c=null;return}this.b=this.g(i);this.c=this.e()},d:function(n,t,i){t&&this.k.b(n,t)&&this.f.c(n,t,i)},g:function(n){if(!n||!n.a())return null;var i=n.a().b,t=i.match(new RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));return t&&t.length===1?t[0]:null},e:function(){var n=this.a.e().a();return!n||n.k?null:n.j},r:function(){var n=_Ewa.b.a(this.a).a().b().e();this.h(n)&&(this.b=this.g(n),this.c=this.e())},h:function(n){return!!n&&!!n.a()&&!n.a().a}};_Ewa.Ax=function(n,t,i){this.g=Function.createDelegate(this,this.l);this.h=Function.createDelegate(this,this.n);this.a=n;this.f=t;this.d=i;this.m()};_Ewa.Ax.prototype={f:null,d:null,a:null,b:0,c:null,j:function(n){var r=this.b,t,i;n.actionType===1?(this.b++,this.e()&&(t=$$as(_Ewa.Y,_Ewa.cd.a(this.a)),t.bR(!0))):n.actionType===2&&(this.b--,this.e()&&(i=$$as(_Ewa.Y,_Ewa.cd.a(this.a)),i.bR(!1)));this.c=n.controlId;Diag.a.a(594105035,0,50,"AttachOrDetachMacroRecorderEventHandler: registerEventAction.ActionType: {0}; registerEventAction.ControlId: {1}; this.registeredMacroRecorderEventHandlerCount: {2} --> {3}",_Ewa.rn.toString(n.actionType),this.c,r,this.b)},k:function(n){if(this.e()){var t=$$as(_Ewa.Y,_Ewa.cd.a(this.a));t.bS(n,this.i()&&this.b>0)}},i:function(){var t=null,n=$$as(_Ewa.Y,_Ewa.cd.a(this.a));return isNullOrUndefined(n.Z.c)||(t=n.Q(n.Z.c)),!!t},n:function(){return this.b>0},m:function(){if(this.a.N()){var n=this;_Ewa.f.cw(_Ewa.k.b(_Ewa.jO,this.a.b(),297,298,-2),function(t){var i=t.a();i&&i.a(n.h,n.g)},this.a.i(),3)}},l:function(n,t){var r=2201,u="Workbook",i={};i.eventId=n;i.payload=t;this.f.b(r,u)&&this.d.c(r,u,_Ewa.H.a(i))},e:function(){return this.a.a(12)}};_Ewa.lP=function(){this.a={};this.c={}};_Ewa.lP.a=function(n,t){return String.format("{0}#{1}",n,t)};_Ewa.lP.prototype={d:0,h:function(n,t){return this.a[_Ewa.lP.a(n,t)]},f:function(n,t){if(!t&&isNullOrUndefined(this.c[n])){this.c[n]=1;return}t&&!isNullOrUndefined(this.c[n])&&delete this.c[n]},e:function(n){return isNullOrUndefined(this.c[n])},i:function(n){var t=_Ewa.lP.a(n.messageType,n.targetId);n.actionType===1?this.j(n.controlId,n.messageType,t):n.actionType===2&&this.k(n.controlId,n.messageType,t)},m:function(n){var t,u,i;if(n&&(t=Object.keys(this.a),!isNullOrUndefined(t)&&!(t.length<=0)))for(var f=t,e=f.length,r=0;r<e;++r)u=f[r],i=this.a[u],i[n]&&(delete i[n],Object.keys(i).length||delete this.a[u])},b:function(n,t){var r=_Ewa.lP.a(n,t),i=this.a[r];return!!i&&Object.keys(i).length>0},l:function(){return!Common.S.a(this.a)},g:function(){var f=[],e=this.a,i,t,r,u,o,n;for(i in e){t={key:i,value:e[i]};r=t.value;for(u in r)o={key:u,value:r[u]},n={},n.eventType=parseInt(t.key.split("#")[0]),n.targetId=t.key.split("#")[1],n.addinId=o.key,f.push(n)}return f},j:function(n,t,i){var u,r,f;this.a[i]?(r=this.a[i],r[n]?(f=r[n],r[n]=f+1):r[n]=1):(u={},u[n]=1,this.a[i]=u);t===100&&this.d++},k:function(n,t,i){var r,u;this.a[i]?(r=this.a[i],n?(u=r[n],u===1?(delete r[n],Object.keys(r).length||delete this.a[i]):r[n]=u-1,t===100&&this.d--):Diag.a.a(23941468,0,50,"The OsfControl[{0}] doesn't register event with key[{1}].",n,i)):Diag.a.a(23941467,0,50,"The event with key[{0}] that will be unregistered doesn't exist.",i)}};_Ewa.As=function(n,t,i){this.i=Function.createDelegate(this,this.l);_Ewa.As.initializeBase(this,[!1]);this.b=n;this.d=t;this.e=i;this.a=_Ewa.b.a(n);this.g={};this.h={}};_Ewa.As.prototype={b:null,d:null,e:null,a:null,c:0,f:0,g:null,h:null,n:function(){return!this.f&&this.c>0},m:function(n){var t=$$as(_Ewa.co,this.b.e());if(n.actionType===1)this.c||this.a.a().g(this.i),this.c++;else if(n.actionType===2){if(this.c<1)return;this.c===1&&this.a.a().h(this.i);this.c--}},q:function(n){n?this.f++:(this.f>0&&this.f--,this.f||this.l(null,new _Ewa.xt(!1)))},l:function(n,t){var r,e;if(this.n()&&!this.a.F()&&!this.a.M()&&(!t||!t.a)&&(r=$$as(_Ewa.E,this.b.e().a()),r)&&!r.k){var i=r.j,u=this.b.a(475)?this.a.a().d().a():[this.a.a().a()],f=null,o=null;this.d.d>0&&(f=this.a.g().a(this.a.a().c(),!1),o=i in this.h?this.h[i]:null);i in this.g&&!_Ewa.g.l(this.g[i],u)&&(e=this,_Ewa.f.c($$sc.a.a(Boolean,!0),function(){e.p(i,u);e.o(i,u,f,o)},this.du()));this.g[i]=_Ewa.g.p(u);this.h[i]=f}},p:function(n,t){var i={},r;i.worksheetId=n;i.address=this.k(t);r=_Ewa.H.a(i);this.d.b(14,n)&&this.e.c(14,n,r);this.b.a(9)&&this.d.b(14,"Workbook")&&this.e.c(14,"Workbook",r)},o:function(n,t,i,r){var u,f,e,o;this.d.d>0&&(u="",f="",this.b.a(15)?(r&&(u=r.h),i&&(f=i.h)):(r&&(u=r.A.toString()),i&&(f=i.A.toString())),r?i?(e=i.b.bn(t),u!==f&&this.j(u,"",n),this.j(f,this.k(e),n)):this.j(u,"",n):i&&(o=i.b.bn(t),this.j(f,this.k(o),n)))},j:function(n,t,i){if(this.d.b(100,n)){var r={};r.address=t;r.worksheetId=i;this.e.c(100,n,_Ewa.H.a(r))}},k:function(n){return _Ewa.g.m(n,",",this.b,!1,!1,!1)},dispose:function(){this.c>0&&this.a.a().h(this.i);this.g=null;this.h=null;this.c=0;this.a=null;this.b=null;this.d=null;this.e=null}};_Ewa.At=function(n,t,i){this.f=Function.createDelegate(this,this.m);this.e=n;this.h=t;this.g=i};_Ewa.At.prototype={h:null,g:null,e:null,c:0,d:0,a:null,b:null,j:function(n){var t=_Ewa.b.a(this.e).a();n.actionType===1?(this.c||this.d||t.b().k(this.f),n.messageType===2101?this.c++:n.messageType===2102&&this.d++):n.actionType===2&&(n.messageType===2101?this.c=this.c>0?this.c-1:0:n.messageType===2102&&(this.d=this.d>0?this.d-1:0),this.c||this.d||t.b().l(this.f))},m:function(){var i=_Ewa.b.a(this.e).a().b().e(),n,r,t,u;if(this.d>0&&this.a&&this.b&&(n={},n.shapeId=this.a,n.worksheetId=this.b,r=_Ewa.H.a(n),this.i(2102,this.a,r)),this.l(i)){if(this.a=this.n(i),this.b=this.k(),!this.a||!this.b){Diag.a.a(38372579,344,10,"Something goes wrong, we got invalid shape id: '{0}', or worksheet id: '{1}' from a Floating object or gridview.",this.a,this.b);return}this.c>0&&(t={},t.shapeId=this.a,t.worksheetId=this.b,u=_Ewa.H.a(t),this.i(2101,this.a,u))}else this.a=null,this.b=null},l:function(n){return!!n&&!!n.a()&&(!n.a().a||n.a().a===7||n.a().a===1||n.a().a===3||n.a().a===5)},n:function(n){if(!n||!n.a())return null;var i=n.a().b,t=i.match(new RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")),r=t&&t.length===1?t[0]:null;return r?r:(Diag.a.a(38372608,344,10,"Expect get the guid like shape id from the floating object id: '{0}', but we failed.",i),null)},k:function(){var n=this.e.e().a();return!n||n.k?null:n.j},i:function(n,t,i){t&&this.h.b(n,t)&&this.g.c(n,t,i)}};_Ewa.Au=function(n,t,i){this.m=Function.createDelegate(this,this.x);this.l=Function.createDelegate(this,this.w);this.n=Function.createDelegate(this,this.y);this.k=Function.createDelegate(this,this.v);this.b=n;this.j=t;this.e=i};_Ewa.Au.prototype={j:null,e:null,b:null,f:0,i:0,g:0,h:0,p:function(n){n.messageType===11?n.targetId==="Workbook"?this.r(n.actionType):this.q(n.actionType):n.messageType===12&&(n.targetId==="Workbook"?this.s(n.actionType):this.t(n.actionType))},q:function(n){var t;this.a(n,t={val:this.f},this.k);this.f=t.val},t:function(n){var t;this.a(n,t={val:this.i},this.n);this.i=t.val},r:function(n){var t;this.a(n,t={val:this.g},this.l);this.g=t.val},s:function(n){var t;this.a(n,t={val:this.h},this.m);this.h=t.val},a:function(n,t,i){n===1?this.o(t,i):n===2&&this.u(t,i)},o:function(n,t){n.val||this.b.e().c(t);n.val++},u:function(n,t){n.val<1||(n.val===1&&this.b.e().e(t),n.val--)},v:function(n,t){var i=$$as(_Ewa.E,t.a),r,u;this.d(i)&&(r={},r.worksheetId=i.j,u=_Ewa.H.a(r),this.c(11,i.j,u,!1))},y:function(n,t){var i=$$as(_Ewa.E,t.b),r,u;this.d(i)&&(r={},r.worksheetId=i.j,u=_Ewa.H.a(r),this.c(12,i.j,u,!1))},w:function(n,t){var r=$$as(_Ewa.E,t.a),i,u;this.d(r)&&(i={},i.worksheetId=r.j,u=_Ewa.H.a(i),this.c(11,null,u,!0))},x:function(n,t){var r=$$as(_Ewa.E,t.b),i,u;this.d(r)&&(i={},i.worksheetId=r.j,u=_Ewa.H.a(i),this.c(12,null,u,!0))},d:function(n){return!!n&&!n.k},c:function(n,t,i,r){var u=r?"Workbook":t;this.j.b(n,u)&&this.e.c(n,u,i)}};_Ewa.Av=function(n,t,i){this.g=Function.createDelegate(this,this.j);this.h=Function.createDelegate(this,this.k);this.d=n;this.a=_Ewa.b.a(n);this.e=t;this.c=i;this.m()};_Ewa.Av.prototype={e:null,c:null,d:null,a:null,b:null,f:!1,m:function(){for(var r,t,i=this.a.H(),u=i.length,n=0;n<u;++n)r=i[n],t=r.j(),Common.f.a().a("msospPointerDown",t,this.h),Common.i.a().a("click",t,this.g)},k:function(n){var t,i,r,u=(r=this.a.bK(n.get_clientPoint(),i={val:t}),t=i.val,r);return this.f=n.b===3&&!!t&&(this.d.a(475)?this.a.a().d().i(t):this.a.a().a().i(t)),this.b=n.get_clientPoint(),!1},j:function(n){var t,u,f,i,r,e;if(this.a.F()||this.a.M()||this.f||n.k()||n.i()||n.a.button||!this.b||!n.get_clientPoint()||n.get_clientPoint().x!==this.b.x||n.get_clientPoint().y!==this.b.y)return!1;if(i=(f=this.a.bK(n.get_clientPoint(),u={val:t}),t=u.val,f),r=$$as(_Ewa.E,this.d.e().a()),i&&r&&!r.k){if(!this.a.a().u().i(t))return!1;e=new _Ewa.BZ(r,t,_Ewa.l.k(i.x),_Ewa.l.k(i.y));this.l(null,e)}return!1},l:function(n,t){var u=t.d,i,r,f,e;this.i(u)&&(i={},i.worksheetId=u.j,i.address=t.a.toString(),i.offsetX=t.b,i.offsetY=t.c,r=u.j,this.e.b(21,r)&&(f=_Ewa.H.a(i),this.c.c(21,r,f)),r="Workbook",this.e.b(21,r)&&(e=_Ewa.H.a(i),this.c.c(21,r,e)))},i:function(n){return!!n&&!n.k}};_Ewa.Aw=function(n,t,i){this.b=Function.createDelegate(this,this.l);this.a=n;this.h=t;this.f=i};_Ewa.Aw.prototype={h:null,f:null,a:null,e:0,d:null,c:null,k:function(n){if(n.messageType===2e3)if(n.actionType===1)this.e||(_Ewa.b.a(this.a).a().b().k(this.b),_Ewa.L.a(this.a).j(this.b),_Ewa.L.a(this.a).i(this.b)),this.e++,this.m();else if(n.actionType===2){if(!this.e)return;this.e===1&&(_Ewa.b.a(this.a).a().b().l(this.b),_Ewa.L.a(this.a).p(this.b),_Ewa.L.a(this.a).o(this.b));this.e--}},l:function(){var n=_Ewa.b.a(this.a).a().b().e(),t;n?this.j(n)?(t=this.i(),this.g(t),this.d=n.a().b,this.c=t):this.d&&(this.g(this.c),this.d=null,this.c=null):this.d&&(this.g(this.c),this.d=null,this.c=null)},g:function(n){var t={},i;t.worksheetId=n;t.revisionLoad=!1;i=_Ewa.H.a(t);n&&this.h.b(2e3,n)&&this.f.c(2e3,n,i)},i:function(){var n=this.a.e().a();return!n||n.k?null:n.j},m:function(){var n=_Ewa.b.a(this.a).a().b().e();this.j(n)&&(this.d=n.a().b,this.c=this.i())},j:function(n){return!!n&&n.ch()}};_Ewa.Ay=function(n,t,i){this.c=n;this.a=t;this.b=i};_Ewa.Ay.prototype={c:null,a:null,b:0,e:function(){return this.c.a(331)?this.a.l()||!!this.b:!1},d:function(){var t={},i,r,n;return t.eventRegistrationInfos=this.a.g(),t.runtimeCalculationMode=this.b,r=(i=new _Ewa.Az,i.runtimeState=t,i),n={},n.HttpMethod="POST",n.PathAndQuery="RestoreRuntimeState",n.RequestHeaders=null,n.RequestBody=JSON.stringify(r),n.RequestFlags=1,n}};_Ewa.AA=function(n,t,i,r,u,f,e,o,s){this.enqueueUtcTime=n;this.processUtcTime=t;this.dequeueUtcTime=i;this.inQueueDurationInMS=r;this.executionDurationInMS=u;this.operationCount=f;this.ServerCorrelationId=e;this.UserOperationName=o;this.IsDocumentHidden=s};_Ewa.AA.prototype={enqueueUtcTime:null,processUtcTime:null,dequeueUtcTime:null,inQueueDurationInMS:0,executionDurationInMS:0,operationCount:0,ServerCorrelationId:null,UserOperationName:null,IsDocumentHidden:!1};_Ewa.rp=function(n,t,i){this.k=Function.createDelegate(this,this.u);this.m=Function.createDelegate(this,this.x);this.l=Function.createDelegate(this,this.v);this.g=Function.createDelegate(this,this.r);this.h=Function.createDelegate(this,this.s);this.n=Function.createDelegate(this,this.y);_Ewa.rp.resolveInheritance();this.j=this.kH;this.p=this.eD;_Ewa.rp.initializeBase(this,[i,n,!0]);this.d=t;Sys.UI.DomElement.addCssClass(this.dr,"ewr-chrtcontarea");Sys.UI.DomElement.addCssClass(this.dr,"ewa-scrollbars");i.tabIndex=0;this.q(this.ds.j(),!1);this.dz().a("mousedown",this.n,!1);var r=this;this.dz().a("contextmenu",function(n){_Ewa.B.a(n,!0)},!1);this.ds.e().i(this.h);this.ds.n().i(this.h);this.ds.n().c(this.g);this.ds.e().c(this.g);this.d.b(this.l);this.d.h(this.m);this.d.d(this.k)};_Ewa.rp.a=function(n){if(!_Ewa.kg.a(n)){var t=n.be();n.b().b(_Ewa.rm,34,new _Ewa.rp(n,new _Ewa.kS(n,n.c(),n.d().b(),3,0),t.appendChild(t.ownerDocument.createElement("div"))))}};_Ewa.rp.prototype={d:null,f:null,e:null,i:!1,b:function(){return this.d},dispose:function(){this.ds&&(this.ds.e().h(this.h),this.ds.n().h(this.h),this.ds.n().e(this.g),this.ds.e().e(this.g));this.d&&(this.d.a(this.l),this.d.i(this.m),this.d.e(this.k));this.o();System.a.a(this.d);this.d=null;_Ewa.a.f(this.dr);_Ewa.Qi.prototype.dispose.call(this)},c:function(n){_Ewa.a.f(_Ewa.a.a(this.dr,n.id));this.dr.appendChild(n)},a:function(){if(this.e&&!this.i){var t=$$as(_Ewa.Y,_Ewa.cd.a(this.ds)),n=t.Q(this.e.InstanceId);n&&(n.bg(this.e.Width,this.e.Height),n.I(this.dr),n.A(!0),this.i=!0)}},x:function(n,t){if(t.a.b===this.f&&this.e){var i=$$as(_Ewa.Y,this.ds.b().a(_Ewa.bA,35,!1));i.cz(this.e.InstanceId,!1)}},v:function(n,t){var i=t.a.a;switch(i.v){case 1:case 3:case 5:this.z(t)}},u:function(){this.gh(!0)},z:function(n){this.e=n.a.a.u;this.i=!1;this.a()},A:function(n){this.ds.c().E()&&n&&(n.i||(n.i=new _Ewa.kf),n.i.a=new _Ewa.P(this.dr.scrollLeft,this.dr.scrollTop),n.i.d=20)},o:function(){this.d.v(this.f);this.f=null;this.e=null;this.i=!1},s:function(n,t){this.dG()&&this.A(t.b);this.o()},r:function(n,t){this.q(t.a,!!t.b)},q:function(n,t){var r=this.dJ(!!n&&_Ewa.A.i(n)),i;r&&(this.d.y(n,_Ewa.z.e,i={val:this.f}),this.f=i.val,this.gX(t,!1))},y:function(){this.ds.c().I()}};_Ewa.ES=function(n,t){this.f=Function.createDelegate(this,this.k);this.g=n;this.h=t;this.e=!1;this.h.b().b(_Ewa.lO,224,this)};_Ewa.ES.prototype={h:null,g:null,d:null,c:null,e:!1,a:function(n){if(this.e){Diag.a.a(19718340,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times.");return}if(this.e=!0,this.c={},this.d={},!n){Diag.a.a(19273180,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object.");return}n.w(this.f)},b:function(n){var t,i,r;if(!n){Diag.a.a(19273181,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.");return}n.J(this.f);t=this.c;for(i in t)r={key:i,value:t[i]},System.a.a(r.value);this.c=null;this.d=null;this.e=!1},k:function(n,t){var u=null,f=null,i=null,e,o,r;if(t)_Ewa.ef.isInstanceOfType(t)?(e=t,u=e.e(),i=e.z()):_Ewa.dI.isInstanceOfType(t)&&(o=t,u=o.A(),i=o.z());else{Diag.a.a(19718341,0,10,"Invalid parameter for ReadoutSelection");return}if(!u){Diag.a.a(19273183,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter.");return}if(f=$$as(_Ewa.bA,n),!f){Diag.a.a(19273182,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object.");return}this.i(i,u,f)||i in this.c||(this.d[i]=0,r=this,this.c[i]=_Ewa.x.a().b(function(){r.d[i]>=10||r.i(i,u,f)?(delete r.d[i],r.c[i].dispose(),delete r.c[i]):r.d[i]=r.d[i]+1},500,_Ewa.m.l,!0,!1))},i:function(n,t,i){var f=this.j(i,n),u,r;return f?!1:(u=t.querySelector("iframe"),!u)?(Diag.a.a(20022086,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0):(r=u.title,!r||!r.length)?(Diag.a.a(19273185,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0):(this.g.a(r),!0)},j:function(n,t){var i=n.a().getOsfControl(t);return i?i.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}};_Ewa.tQ=function(n){_Ewa.tQ.initializeBase(this);this.h=n;this.j()};_Ewa.tQ.a=function(n){n.b().b(_Ewa.baj.$$(_Ewa.lO),225,new _Ewa.tQ(n))};_Ewa.tQ.prototype={h:null,b:function(){var n=this.h.b(),t=this;_Ewa.f.cw(_Ewa.k.b(_Ewa.cE,n,211,212,this.m),function(i){var r=n.a(_Ewa.lO,224,!1)||new _Ewa.ES(i.a(),t.h);t.i(r)},this.du(),3)}};_Ewa.Az.registerClass("_Ewa.Az");_Ewa.rk.registerClass("_Ewa.rk",_Ewa.pU.$$(_Ewa.bA));_Ewa.rh.registerClass("_Ewa.rh",_Ewa.WY);_Ewa.rh.a.registerClass("_Ewa.rh.a");_Ewa.rj.registerClass("_Ewa.rj");_Ewa.Y.registerClass("_Ewa.Y",_Ewa.cp,_Ewa.ho,_Ewa.bA,_Ewa.Ua,Sys.IDisposable);_Ewa.gn.registerClass("_Ewa.gn",_Ewa.Ya,_Ewa.ZX);_Ewa.Ax.registerClass("_Ewa.Ax");_Ewa.lP.registerClass("_Ewa.lP");_Ewa.As.registerClass("_Ewa.As",_Ewa.WY);_Ewa.AA.registerClass("_Ewa.AA");_Ewa.rp.registerClass("_Ewa.rp",_Ewa.Qi,_Ewa.rm,_Ewa.hr,Sys.IDisposable);_Ewa.tQ.registerClass("_Ewa.tQ",_Ewa.pU.$$(_Ewa.lO));_Ewa.iW.a=null;_Ewa.Y.b=new($$sc.v.$$(CommandUI.AddInCommands.t));_Ewa.Y.d=!0;_Ewa.TY.a();Type.registerNamespace("_Ewa");_Ewa.nJ=function(){};_Ewa.nJ.a=function(n,t,i,r,u,f){var e=n.a(9,f);return e.sharedInfo=t,_Ewa.i.a(n,"ShowAgaveTaskpane",e,i,r,u,0,null)};_Ewa.fA=function(){this.c=Function.createDelegate(this,this.g);this.b=Function.createDelegate(this,this.e)};_Ewa.fA.c=function(){return _Ewa.fA.a||(_Ewa.fA.a=new _Ewa.fA),_Ewa.fA.a};_Ewa.fA.prototype={a:null,d:function(n){_Ewa.fA.b||(this.a=n,this.f(),_Ewa.fA.b=!0)},f:function(){Common.a.c().b(860152194,2147483648,this.b,96);Common.a.c().a(741381681,2147483648,this.c)},e:function(n,t,i,r,u){if(i===2){var f=u?u:{},e=f.callback,o=f.refresh?f.refresh:!1;if(!e)return 16;this.a.G(e,o)}return 32},g:function(n,t,i,r,u){if(i===2){var f=u?u.callback:null;f&&this.a.v(f)}return 32}};_Ewa.re=function(n,t,i,r,u,f){this.m=Function.createDelegate(this,this.L);this.r=Function.createDelegate(this,this.M);this.n=Function.createDelegate(this,this.N);this.o=Function.createDelegate(this,this.C);this.p=Function.createDelegate(this,this.G);this.q=Function.createDelegate(this,this.H);this.h={};this.k={};_Ewa.re.initializeBase(this,[!1]);this.c=n;this.c.isChangeGateEnabled("OfficeVSO:4026121_AgaveCommandManagerService")?this.f=f:(this.l=t,this.d=i,this.g=r,this.j=u,this.j.a(2451283737,2147483648,this.q),this.j.a(1323818969,2147483648,this.p))};_Ewa.re.prototype={l:null,d:null,c:null,e:null,g:null,j:null,f:null,a:function(n){this.dv("IDS",n)},b:function(n){this.dw("IDS",n)},dispose:function(){System.a.a(this.e);this.e=null;_Ewa.cp.prototype.dispose.call(this)},v:function(){return!1},w:function(){return!1},t:function(n,t,i,r){var u=!1,f;switch(t.a){case-684355545:u=!0;break;case-741808261:u=!!i;break;case-859308420:case 418618014:u=n===1&&!!r&&r.a===1;break;case-515602470:f=this.c.a(302)&&n===2;u=(n===1||f)&&!!r&&r.a===1;break;case 195934415:case-336193495:u=n===1&&!!r&&r.a===1;break;case 1296389134:u=n===1&&!!r&&r.a===1;break;case 1221897806:u=this.c.a(218)&&n===2;break;case-1898891716:u=this.c.N()}return u},u:function(n,t,i){var r=$$sc.a.a(Boolean,!0),e=t.a,u,f;switch(t.a){case 1296389134:u=i.SourceControlId;f=i.LabelText;this.c.isChangeGateEnabled("OfficeVSO:4026121_AgaveCommandManagerService")?this.f.f(u,f):this.P(u,f);break;case-684355545:this.c.isChangeGateEnabled("OfficeVSO:4026121_AgaveCommandManagerService")?this.f.c():this.A();break;case-741808261:r=this.c.isChangeGateEnabled("OfficeVSO:4026121_AgaveCommandManagerService")?this.f.e(i,t):this.y(i,t);break;case-859308420:case-515602470:case-336193495:case 195934415:case 418618014:case 1221897806:r=this.c.isChangeGateEnabled("OfficeVSO:4026121_AgaveCommandManagerService")?this.f.d(i,n,t):this.E(i,n,t);break;case-1898891716:break;default:r=_Ewa.K.a(e)}return r},A:function(){this.e.i()},G:function(n,t,i,r,u){if(i!==2)return 32;var f=u,o=f.extId,e=o.a(),s=f.OptionalProps,h=s.a.SourceLocationOverrideResourceId;return e?(this.d.a().refreshOsfControl(e,h),32):8},H:function(n,t,i,r,u){var v;if(i!==2)return 32;var o=u,h=o.extId,y=o.ComponentType,c=o.ComponentId,p=o.HostProps,e=o.OptionalProps,f=new Common.App.AppsForOfficeCommon.a;f.h=e.a.InstanceToken;f.a=e.a.TaskPaneTitle;"TaskPaneWidth"in e.a&&(f.d=e.a.TaskPaneWidth);f.b=e.a.SourceLocationOverrideResourceId;f.c=e.b;f.f=e.a.OnTaskPaneClose;f.g=c;var l=new _Ewa.T(-859308420,0,2,0,""),a=h.b()===OSF.StoreType.Sdx,s=new _Ewa.re.a;return s.a="ewa-ptp-header",s.e=this.D(c),v=this.i(l,h.a(),f,a,s,!1),32},D:function(n){switch(n){case"MakerCodeEditor":case"MakerScriptRecorder":case"MakerScriptGallery":case"MakerScriptDetail":return"ewa-ptp-title-maker";default:return null}},E:function(n,t,i){var r=$$sc.a.a(Boolean,!0),u;return((i.a===-515602470||i.a===-336193495||i.a===195934415)&&(r=this.F(n,t,i)),i.a===418618014&&(u=new Common.App.AppsForOfficeCommon.a,u.a=_Ewa.ClientStringManager.a().a(1525),r=this.i(i,"HelloWorld",u,!0,null,!1)),i.d===this.c.m()+"Ribbon.Help"||i.d==="Help"||this.c.isChangeGateEnabled("OfficeVSO:3009717_EnableTellMeHelpForAgaveHelpPane")&&(Array.indexOf(["A0","Help","ContactSupport","WhatsNew"],n.MenuItemId)!==-1||n.SourceControlId==="GetHelpFromErrorCard"))?this.x(n,i):i.c===7&&n.SourceControlId===this.c.m()+"giveFeedbackPane"?(n.MenuItemId="GiveFeedback",this.x(n,i)):(i.a===1221897806&&(r=this.O(i)),r)},F:function(n,t,i){var r=new Common.App.AppsForOfficeCommon.a,f=new _Ewa.re.a,u={},e;u.LaunchSource=$$as(String,n.SourceControlId);u.StartTimeMs=Date.now();r.c=u;r.e=!0;r.d=320;e=this.c.a(750);switch(i.a){case 195934415:u.LaunchMode="RecommendedPivotTables";r.b=this.c.a(715)?"RecommendPivotTables.PPE":"RecommendPivotTables";r.a=_Ewa.ClientStringManager.a().a(1524);f.b="ewanov_pivottable";break;case-336193495:u.LaunchMode="RecommendedCharts";r.b=this.c.a(715)?"RecommendCharts.PPE":"RecommendCharts";r.a=_Ewa.ClientStringManager.a().a(1523);f.b="ewanov_recommendedCharts";break;case-515602470:default:u.LaunchMode="Default";this.c.a(302)&&(u.LaunchSelectionMode=t.toString());r.b=this.c.a(715)?"Insights.Https.PPE":"Insights.Https";r.a=this.c.a(880)?_Ewa.ClientStringManager.a().a(1522):_Ewa.ClientStringManager.a().a(1521)}return this.i(i,"FA000000005",r,e,f,!1)},O:function(n){var f=_Ewa.b.a(this.c),i=new Common.App.AppsForOfficeCommon.a,t={},r,u;return t.ActiveTab="Format",t.DatapaneFlighting=this.c.a(219),t.startTimeMs=Date.now(),r=f.a().b().f(),r&&(t.SubSelection=r),i.c=t,i.a=_Ewa.ClientStringManager.a().a(842),u=new _Ewa.re.a,u.a="ewa-ptp-header",this.i(n,"FA000000014",i,!0,u,!1)},x:function(n,t){var u=n.MenuItemId.toString(),i={},r=new Common.App.AppsForOfficeCommon.a,e,f,o;r.a=_Ewa.ClientStringManager.a().a(8);switch(u){case"A0":e=n.CommandValueId||"";i.query=e.split("|").slice(2,2147483647).join("|");break;case"Help":i.gwdropdownflightinfo=this.c.a(307);i.query="";break;case"GiveFeedback":this.c.a(497)?(r.a=_Ewa.ClientStringManager.a().a(1497),r.b="Help.GiveFeedback.Url",i.feedback=this.B()):i.query=u;break;case"HelpArticle":i.query=n.CommandValueId;break;case"ContactSupport":case"ShowTraining":case"WhatsNew":i.query=u;break;default:return $$sc.a.a(Boolean,!0)}return r.c=i,f=new _Ewa.re.a,f.a="ewa-ptp-header",o=n.EnabledInViewMode||!1,this.i(t,"FA000000012",r,!1,f,o)},B:function(){var u=Common.Utils.a.a().c(Common.App.c),f=Common.Utils.a.a().c(Common.App.CustomerFeedback.e),i,n,t,r;return this.g?this.g.a()?this.s():f.b().a(this.o):Diag.a.a(41552071,1302,15,"feedbackFormManager is undefined"),i={},Common.a.a.p(i),n=u.b().a(i),t={},"telemetryGroup"in n&&(t=n.telemetryGroup),t.processSessionId=n.sessionId,t.officeBuild=n.build,n.telemetryGroup=t,n.feedbackType=-1,n.userVoiceEnabled=!1,this.c.a(501)&&"userVoice"in n&&(r=n.userVoice,"url"in r&&(n.userVoiceLink=r.url,n.userVoiceEnabled=!0,Diag.a.a(41552072,1302,15,"feedback pane user voice is enable"))),this.c.a(498)&&(n.disableIncludeScreenshot=!1),this.c.a(499)&&(n.disableScreenshotPreview=!1),this.c.a(500)&&(n.includeScreenshotSelectedDefault=!0),n},s:function(){var t,r;if(Fdbk.a.h()){Diag.a.a(41552073,1302,15,"OBF is undefined");return}try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.n);return}catch(n){t=n?n.toString():null;Diag.a.a(593806755,1302,15,"Failed to use createScreenshot "+t)}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.n);return}catch(i){r=i?i.toString():null;Diag.a.a(593806754,1302,15,"Failed to use html2canvas"+r)}},C:function(n){n&&(this.g.b(n),this.s())},N:function(n){var i=n.toDataURL("image/jpeg",null),r=this.d.e("FA000000012.Help.GiveFeedback.Url"),t={};t.screenshot=i;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(r,"onScreenshot",t,null)},i:function(n,t,i,r,u,f){var h=$$sc.a.a(Boolean,!0),e,s,o;return i||(i=new Common.App.AppsForOfficeCommon.a),e={},e.AppVersion="0.0.0.0",e.AssetId=t,e.Id=t,e.AssetStoreId="",e.CurrentStoreType=r?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,e.Height=0,e.Width=0,e.StoreId=r?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,e.TargetType=OSF.OsfControlTarget.TaskPane,e.IsToBePersisted=!1,e.SourceLocationOverrideResourceId=i.b,i.a&&(this.k[t]=i.a),i.c&&(this.h[e.AssetId]=i.c),s={},s.CommandValueId=e,o={},o.appVersion=e.AppVersion,o.assetId=e.AssetId,o.assetStoreId=e.AssetStoreId,o.currentStoreType=e.CurrentStoreType,o.height=e.Height,o.id=e.Id,o.storeId=e.StoreId,o.targetType=e.TargetType,o.width=e.Width,o.isAddinCommands=!r,s.ack5=o,u||(u=new _Ewa.re.a),u.d=i.e,u.c=i.d,s.InsertAgaveClientSideParametersKey=u,s.EnabledInViewMode=f,this.y(s,n)},y:function(n,t){var e=$$sc.a.a(Boolean,!0),f=this.c,r,u=n.ack5,b,i,s,h,k,c,p,w;if("SourceControlId"in n){if((r={},b=n.SourceControlId,i=b.split("|"),i.length!==8)||_Ewa.e.a(i[0])||_Ewa.e.a(i[1])||_Ewa.e.a(i[2])||isNaN(parseInt(i[2]))||_Ewa.e.a(i[3])||isNaN(parseInt(i[3]))||_Ewa.e.a(i[4])||_Ewa.e.a(i[5])||isNaN(parseInt(i[5]))||_Ewa.e.a(i[6])||_Ewa.e.a(i[7]))return _Ewa.f.a();u={};u.appVersion=r.AppVersion=i[0];u.assetId=r.AssetId=i[1];u.id=r.Id=i[1];u.height=r.Height=parseInt(i[2]);u.width=r.Width=parseInt(i[3]);u.storeId=r.StoreId=i[4];u.targetType=r.TargetType=parseInt(i[5]);u.assetStoreId=r.AssetStoreId=i[6];u.currentStoreType=r.CurrentStoreType=i[7]}else r=n.CommandValueId;if(s=null,"InsertAgaveClientSideParametersKey"in n&&(s=n.InsertAgaveClientSideParametersKey),this.e&&this.e.i(),!r||!u)return Diag.a.a(17367833,220,10,"Inserting addin needs inserted agave parameters"),e;if(this.c.J()&&"EnabledInViewMode"in n&&(r.EnabledInViewMode=n.EnabledInViewMode),h=t.a===1221897806,k=this.c.a(302)&&t.a===-515602470,!r.EnabledInViewMode&&(!(h||k)&&!f.X(null,1)||h&&!f.X(null,2)))return e;if(c=isNullOrUndefined(r.IsToBePersisted)||r.IsToBePersisted?0:16,r.TargetType===1)e=this.I(r,u,t,s,c);else{var d=_Ewa.b.a(f),o=this.l.e(d),g=f.c().b()?f.j().d:f.j().a,l,a,v,y;o?(p=o.b,l=p.a().a,a=p.a().b,v=o.a.x,y=o.a.y):(l=a=1,w=this.l.d(d),v=w.a,y=w.b);var nt=this.c.d().a().b(!1),tt=this,it=function(n,t){return _Ewa.lL.b(f.d().a(),r,g,l,a,v,y,_Ewa.n.a(n,tt.r),t,null,nt)},rt=this;e=_Ewa.M.a(this.c.g(),it,function(n){return new _Ewa.bd(534,0,n,c,null)},t)}return e},I:function(n,t,i,r,u){var f=this,s=function(n,t){var i=n.Id,e,o;if((n.CurrentStoreType===OSF.StoreType.FirstParty||n.CurrentStoreType===OSF.StoreType.Sdx)&&n.SourceLocationOverrideResourceId&&(i=f.d.q(n.Id,n.SourceLocationOverrideResourceId)),(n.CurrentStoreType===OSF.StoreType.FirstParty||n.CurrentStoreType===OSF.StoreType.Sdx)&&(f.c.a(397)&&f.d.d(i,null,null)&&(e=f.d.e(i),e&&(o=f.z(f.d.b(e).OsfPropertyBag,n.AssetId),f.d.a().getOsfControl(e).setSettings(o))),f.d.a().refreshOsfControl(n.Id,n.SourceLocationOverrideResourceId)),!f.d.d(i,null,null)){var s=f.c.d().a().b(!1),h=519,c=function(t,i){return _Ewa.lL.a(f.c.d().a(),n,_Ewa.n.a(t,f.m),i,r,s)};return isNullOrUndefined(n.IsToBePersisted)||n.IsToBePersisted||(h=538,c=function(t,i){return Diag.a.a(41760896,220,50,"Web Method ShowAgaveTaskpane is called, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",n.CurrentStoreType,n.StoreId,n.AssetId),_Ewa.nJ.a(f.c.d().a(),n,_Ewa.n.a(t,f.m),i,r,s)}),_Ewa.M.a(f.c.g(),c,function(n){return new _Ewa.bd(h,0,n,u,null)},t)}return _Ewa.f.a()},h=this,c=function(n){var t,i,r;return Diag.a.a(17367834,220,50,"Insert addincommands for {0} from {1}.",n.assetId,n.currentStoreType),t={},i=new($$sc.u.$$(Object)),i.b(n),t.ack2=i,t.ack0=3,r=new _Ewa.T(407117407,0,h.c.t(),0,null),h.c.h().b(r,t,null)},o,e,l,a;return!this.c.a(64)||n.StoreId===OSF.StoreType.FirstParty?s(n,i,r):t.isAddinCommands?c(t):(o=new($$sc.C.$$(Boolean)),e={},e.marketplaceId=n.Id,e.marketplaceVersion=n.AppVersion,e.storeType=n.CurrentStoreType,e.storeId=n.StoreId,e.targetData=n,this.c.a(115)&&(e.clearCache=!0),l=this,this.d.a().isAddinCommandsAsync(e,function(n,t,i){o.b(t);n||Diag.a.a(17367835,220,10,"Judging AddinCommands failed for {0} from {1} during addin inserting",i.targetData.Id,i.targetData.CurrentStoreType)}),a=this,_Ewa.f.tc(o.a,function(u){var f=u.a();return f?c(t):s(n,i,r)},this.c.i()))},P:function(n,t){if(n){this.dt("IDS",null,null);var i=n.split("|");this.J(n,t,i);this.e=new Common.App.AppsForOffice.e;this.e.j("",null,null);this.d.r(this.e.a,i)}},L:function(n,t){var u=n.Result,i=u?u.AgaveData:null,r=t;Diag.a.b(8949913,0,i.TaskpaneWidth===350,"Taskpane width is {0}, assetId is {1}.",i.TaskpaneWidth,i.AssetMarketplace.SolutionId);this.k[i.PrimaryMarketplace.SolutionId]&&(i.TaskpaneTitle=this.k[i.PrimaryMarketplace.SolutionId]);r&&(i.FocusOnIframeWhenLoaded=r.d,r.c&&(i.TaskpaneWidth=r.c),i.IconCssClass=r.b,i.HeaderCssClass=r.a,i.TitleCssClass=r.e);this.h[i.PrimaryMarketplace.SolutionId]&&(i.OsfPropertyBag=this.z(i.OsfPropertyBag,i.PrimaryMarketplace.SolutionId));_Ewa.hG.a(i)||(i.WebExtensionOsfControlType=1);i&&(this.d.f(u.SolutionId),this.d.g(i))},z:function(n,t){var i,e,u,r,h;if(!this.h[t])return n;if(i={},n)for(var c=n,p=c.length,f=0;f<p;++f)e=c[f],i[e[0]]=e[1];u=this.h[t];for(var l=Object.keys(u),w=l.length,o=0;o<w;++o)r=l[o],i[r]=r==="feedback"&&this.c.a(497)?Sys.Serialization.JavaScriptSerializer.serialize(u[r]):Sys.Serialization.JavaScriptSerializer.serialize(u[r].toString());for(var b=Object.keys(i).length,a=new Array(b),v=0,y=Object.keys(i),k=y.length,s=0;s<k;++s)h=y[s],a[v]=[h,i[h].toString()],v++;return a},M:function(n){var i=n.Result,t=null===i?null:i.SolutionId;!t||!t.length||(this.d.f(t),_Ewa.L.a(this.c).c(3,t,!1))},J:function(n,t,i){var f=this.c.f().UserSessionId,e=this.c.f().UICultureTag,o=this.c.f().UICultureTagLcid,s=this.c.f().WacHostId,r="",u="";i.length>=5&&(r=i[3],u=i[4]);this.K(r,u,n,t,e,o,f,s)},K:function(n,t,i,r,u,f,e,o){var s={};s.a=e;s.b=i;s.c=r;s.d=n;s.e=t;s.f=u;s.g=f;s.h=o;_Ewa.y.a().a(36,s,!1)}};_Ewa.re.a=function(){};_Ewa.re.a.prototype={d:!1,c:0,b:null,a:null,e:null};_Ewa.rf=function(n){_Ewa.rf.initializeBase(this,[n])};_Ewa.rf.a=function(n){_Ewa.ba.a(76,new _Ewa.rf(n))};_Ewa.rf.prototype={n:null,p:null,q:null,dispose:function(){this.p=null;this.n=null;_Ewa.ba.prototype.dispose.call(this)},l:function(){var t,i,n,r;this.h.isChangeGateEnabled("OfficeVSO:4026121_AgaveCommandManagerService")?(t=this,_Ewa.fn.a(_Ewa.hI,this.h,374,375,function(n){t.k([new _Ewa.re(t.h,null,null,null,null,n),new _Ewa.ro(t.h)],null)})):(this.p&&this.n||(i=this.h.b(),this.p=_Ewa.k.a(_Ewa.fp,i,104,this.du(),this.m),this.n=_Ewa.k.a(_Ewa.bA,i,106,this.du(),this.m),this.q=_Ewa.s.c(37,0,!1,!1,76,this.m),n=this,_Ewa.f.cw(_Ewa.f.ws([this.p,this.n,this.q],this.du(),3),function(){var u=new Common.App.AppsForOfficeCommon.e(Common.Utils.c.a()),f=new Common.App.AppsForOfficeCommon.k(Common.a.a,Common.a.d,"WAC_Excel"),e=new Common.App.AppsForOfficeCommon.j(u,f,"PreinstalledAppsData_Excel",null),i=null,t,r;n.h.a(497)&&(i=Common.Utils.a.a().c(Common.App.CustomerFeedback.d).b());Common.App.AppsForOfficeCommon.c.a.a=e;_Ewa.fA.c().d(n.n.a());t=new _Ewa.re(n.h,n.p.a(),n.n.a(),i,Common.a.c(),null);n.h.b().b(_Ewa.nK,206,t);n.p=null;n.n=null;r=new _Ewa.ro(n.h);n.k([t,r],null)},this.du(),3)),r=this,Common.Utils.a.a().b(Common.Utils.d).c(Common.Utils.f).a().b(function(){return new Common.Utils.d(r.h.bD())}))}};_Ewa.AgaveCommandManager=function(n,t,i,r,u){this.q=Function.createDelegate(this,this.J);this.p=Function.createDelegate(this,this.H);this.r=Function.createDelegate(this,this.z);this.u=Function.createDelegate(this,this.I);this.s=Function.createDelegate(this,this.C);this.t=Function.createDelegate(this,this.D);this.k={};this.n={};_Ewa.AgaveCommandManager.initializeBase(this,[!1]);this.g=n;this.o=i;this.h=t;this.j=r;this.m=u;this.m.a(2451283737,2147483648,this.t);this.m.a(1323818969,2147483648,this.s)};_Ewa.AgaveCommandManager.prototype={o:null,h:null,g:null,i:null,j:null,m:null,a:function(n){this.dv("IDS",n)},b:function(n){this.dw("IDS",n)},dispose:function(){System.a.a(this.i);this.i=null;_Ewa.cp.prototype.dispose.call(this)},c:function(){this.i.i()},f:function(n,t){if(n){this.dt("IDS",null,null);var i=n.split("|");this.F(n,t,i);this.i=new Common.App.AppsForOffice.e;this.i.j("",null,null);this.h.r(this.i.a,i)}},d:function(n,t,i){var r=$$sc.a.a(Boolean,!0),u;return((i.a===-515602470||i.a===-336193495||i.a===195934415)&&(r=this.B(n,t,i)),i.a===418618014&&(u=new Common.App.AppsForOfficeCommon.a,u.a=_Ewa.ClientStringManager.a().a(1525),r=this.l(i,"HelloWorld",u,!0,null,!1)),i.d===this.g.m()+"Ribbon.Help"||i.d==="Help"||this.g.isChangeGateEnabled("OfficeVSO:3009717_EnableTellMeHelpForAgaveHelpPane")&&(Array.indexOf(["A0","Help","ContactSupport","WhatsNew"],n.MenuItemId)!==-1||n.SourceControlId==="GetHelpFromErrorCard"))?this.w(n,i):i.c===7&&n.SourceControlId===this.g.m()+"giveFeedbackPane"?(n.MenuItemId="GiveFeedback",this.w(n,i)):(i.a===1221897806&&(r=this.K(i)),r)},e:function(n,t){var e=$$sc.a.a(Boolean,!0),f=this.g,r,u=n.ack5,b,i,s,h,k,c,p,w;if("SourceControlId"in n){if((r={},b=n.SourceControlId,i=b.split("|"),i.length!==8)||_Ewa.e.a(i[0])||_Ewa.e.a(i[1])||_Ewa.e.a(i[2])||isNaN(parseInt(i[2]))||_Ewa.e.a(i[3])||isNaN(parseInt(i[3]))||_Ewa.e.a(i[4])||_Ewa.e.a(i[5])||isNaN(parseInt(i[5]))||_Ewa.e.a(i[6])||_Ewa.e.a(i[7]))return _Ewa.f.a();u={};u.appVersion=r.AppVersion=i[0];u.assetId=r.AssetId=i[1];u.id=r.Id=i[1];u.height=r.Height=parseInt(i[2]);u.width=r.Width=parseInt(i[3]);u.storeId=r.StoreId=i[4];u.targetType=r.TargetType=parseInt(i[5]);u.assetStoreId=r.AssetStoreId=i[6];u.currentStoreType=r.CurrentStoreType=i[7]}else r=n.CommandValueId;if(s=null,"InsertAgaveClientSideParametersKey"in n&&(s=n.InsertAgaveClientSideParametersKey),this.i&&this.i.i(),!r||!u)return Diag.a.a(593605401,220,10,"Inserting addin needs inserted agave parameters"),e;if(this.g.J()&&"EnabledInViewMode"in n&&(r.EnabledInViewMode=n.EnabledInViewMode),h=t.a===1221897806,k=this.g.a(302)&&t.a===-515602470,!r.EnabledInViewMode&&(!(h||k)&&!f.X(null,1)||h&&!f.X(null,2)))return e;if(c=isNullOrUndefined(r.IsToBePersisted)||r.IsToBePersisted?0:16,r.TargetType===1)e=this.E(r,u,t,s,c);else{var d=_Ewa.b.a(f),o=this.o.e(d),g=f.c().b()?f.j().d:f.j().a,l,a,v,y;o?(p=o.b,l=p.a().a,a=p.a().b,v=o.a.x,y=o.a.y):(l=a=1,w=this.o.d(d),v=w.a,y=w.b);var nt=this.g.d().a().b(!1),tt=this,it=function(n,t){return _Ewa.lL.b(f.d().a(),r,g,l,a,v,y,_Ewa.n.a(n,tt.u),t,null,nt)},rt=this;e=_Ewa.M.a(this.g.g(),it,function(n){return new _Ewa.bd(534,0,n,c,null)},t)}return e},y:function(){var u=Common.Utils.a.a().c(Common.App.c),f=Common.Utils.a.a().c(Common.App.CustomerFeedback.e),i,n,t,r;return this.j?this.j.a()?this.v():f.b().a(this.r):Diag.a.a(593605400,1302,15,"feedbackFormManager is undefined"),i={},Common.a.a.p(i),n=u.b().a(i),t={},"telemetryGroup"in n&&(t=n.telemetryGroup),t.processSessionId=n.sessionId,t.officeBuild=n.build,n.telemetryGroup=t,n.feedbackType=-1,n.userVoiceEnabled=!1,this.g.a(501)&&"userVoice"in n&&(r=n.userVoice,"url"in r&&(n.userVoiceLink=r.url,n.userVoiceEnabled=!0,Diag.a.a(593605399,1302,15,"feedback pane user voice is enable"))),this.g.a(498)&&(n.disableIncludeScreenshot=!1),this.g.a(499)&&(n.disableScreenshotPreview=!1),this.g.a(500)&&(n.includeScreenshotSelectedDefault=!0),n},K:function(n){var f=_Ewa.b.a(this.g),i=new Common.App.AppsForOfficeCommon.a,t={},r,u;return t.ActiveTab="Format",t.DatapaneFlighting=this.g.a(219),t.startTimeMs=Date.now(),r=f.a().b().f(),r&&(t.SubSelection=r),i.c=t,i.a=_Ewa.ClientStringManager.a().a(842),u=new _Ewa.AgaveCommandManager.a,u.a="ewa-ptp-header",this.l(n,"FA000000014",i,!0,u,!1)},w:function(n,t){var u=n.MenuItemId.toString(),i={},r=new Common.App.AppsForOfficeCommon.a,e,f,o;r.a=_Ewa.ClientStringManager.a().a(8);switch(u){case"A0":e=n.CommandValueId||"";i.query=e.split("|").slice(2,2147483647).join("|");break;case"Help":i.gwdropdownflightinfo=this.g.a(307);i.query="";break;case"GiveFeedback":this.g.a(497)?(r.a=_Ewa.ClientStringManager.a().a(1497),r.b="Help.GiveFeedback.Url",i.feedback=this.y()):i.query=u;break;case"HelpArticle":i.query=n.CommandValueId;break;case"ContactSupport":case"ShowTraining":case"WhatsNew":i.query=u;break;default:return $$sc.a.a(Boolean,!0)}return r.c=i,f=new _Ewa.AgaveCommandManager.a,f.a="ewa-ptp-header",o=n.EnabledInViewMode||!1,this.l(t,"FA000000012",r,!1,f,o)},B:function(n,t,i){var r=new Common.App.AppsForOfficeCommon.a,f=new _Ewa.AgaveCommandManager.a,u={},e;u.LaunchSource=$$as(String,n.SourceControlId);u.StartTimeMs=Date.now();r.c=u;r.e=!0;r.d=320;e=this.g.a(750);switch(i.a){case 195934415:u.LaunchMode="RecommendedPivotTables";r.b=this.g.a(715)?"RecommendPivotTables.PPE":"RecommendPivotTables";r.a=_Ewa.ClientStringManager.a().a(1524);f.b="ewanov_pivottable";break;case-336193495:u.LaunchMode="RecommendedCharts";r.b=this.g.a(715)?"RecommendCharts.PPE":"RecommendCharts";r.a=_Ewa.ClientStringManager.a().a(1523);f.b="ewanov_recommendedCharts";break;case-515602470:default:u.LaunchMode="Default";this.g.a(302)&&(u.LaunchSelectionMode=t.toString());r.b=this.g.a(715)?"Insights.Https.PPE":"Insights.Https";r.a=_Ewa.ClientStringManager.a().a(1521)}return this.l(i,"FA000000005",r,e,f,!1)},D:function(n,t,i,r,u){var v;if(i!==2)return 32;var o=u,h=o.extId,y=o.ComponentType,c=o.ComponentId,p=o.HostProps,e=o.OptionalProps,f=new Common.App.AppsForOfficeCommon.a;f.h=e.a.InstanceToken;f.a=e.a.TaskPaneTitle;"TaskPaneWidth"in e.a&&(f.d=e.a.TaskPaneWidth);f.b=e.a.SourceLocationOverrideResourceId;f.c=e.b;f.f=e.a.OnTaskPaneClose;f.g=c;var l=new _Ewa.T(-859308420,0,2,0,""),a=h.b()===OSF.StoreType.Sdx,s=new _Ewa.AgaveCommandManager.a;return s.a="ewa-ptp-header",s.e=this.A(c),v=this.l(l,h.a(),f,a,s,!1),32},C:function(n,t,i,r,u){if(i!==2)return 32;var f=u,o=f.extId,e=o.a(),s=f.OptionalProps,h=s.a.SourceLocationOverrideResourceId;return e?(this.h.a().refreshOsfControl(e,h),32):8},A:function(n){switch(n){case"MakerCodeEditor":case"MakerScriptRecorder":case"MakerScriptGallery":case"MakerScriptDetail":return"ewa-ptp-title-maker";default:return null}},l:function(n,t,i,r,u,f){var h=$$sc.a.a(Boolean,!0),e,s,o;return i||(i=new Common.App.AppsForOfficeCommon.a),e={},e.AppVersion="0.0.0.0",e.AssetId=t,e.Id=t,e.AssetStoreId="",e.CurrentStoreType=r?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,e.Height=0,e.Width=0,e.StoreId=r?OSF.StoreType.Sdx:OSF.StoreType.FirstParty,e.TargetType=OSF.OsfControlTarget.TaskPane,e.IsToBePersisted=!1,e.SourceLocationOverrideResourceId=i.b,i.a&&(this.n[t]=i.a),i.c&&(this.k[e.AssetId]=i.c),s={},s.CommandValueId=e,o={},o.appVersion=e.AppVersion,o.assetId=e.AssetId,o.assetStoreId=e.AssetStoreId,o.currentStoreType=e.CurrentStoreType,o.height=e.Height,o.id=e.Id,o.storeId=e.StoreId,o.targetType=e.TargetType,o.width=e.Width,o.isAddinCommands=!r,s.ack5=o,u||(u=new _Ewa.AgaveCommandManager.a),u.d=i.e,u.c=i.d,s.InsertAgaveClientSideParametersKey=u,s.EnabledInViewMode=f,this.e(s,n)},E:function(n,t,i,r,u){var f=this,s=function(n,t){var i=n.Id,e,o;if((n.CurrentStoreType===OSF.StoreType.FirstParty||n.CurrentStoreType===OSF.StoreType.Sdx)&&n.SourceLocationOverrideResourceId&&(i=f.h.q(n.Id,n.SourceLocationOverrideResourceId)),(n.CurrentStoreType===OSF.StoreType.FirstParty||n.CurrentStoreType===OSF.StoreType.Sdx)&&(f.g.a(397)&&f.h.d(i,null,null)&&(e=f.h.e(i),e&&(o=f.x(f.h.b(e).OsfPropertyBag,n.AssetId),f.h.a().getOsfControl(e).setSettings(o))),f.h.a().refreshOsfControl(n.Id,n.SourceLocationOverrideResourceId)),!f.h.d(i,null,null)){var s=f.g.d().a().b(!1),h=519,c=function(t,i){return _Ewa.lL.a(f.g.d().a(),n,_Ewa.n.a(t,f.p),i,r,s)};return isNullOrUndefined(n.IsToBePersisted)||n.IsToBePersisted||(h=538,c=function(t,i){return Diag.a.a(593605398,220,50,"Web Method ShowAgaveTaskpane is called, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",n.CurrentStoreType,n.StoreId,n.AssetId),_Ewa.nJ.a(f.g.d().a(),n,_Ewa.n.a(t,f.p),i,r,s)}),_Ewa.M.a(f.g.g(),c,function(n){return new _Ewa.bd(h,0,n,u,null)},t)}return _Ewa.f.a()},h=this,c=function(n){var t,i,r;return Diag.a.a(593605397,220,50,"Insert addincommands for {0} from {1}.",n.assetId,n.currentStoreType),t={},i=new($$sc.u.$$(Object)),i.b(n),t.ack2=i,t.ack0=3,r=new _Ewa.T(407117407,0,h.g.t(),0,null),h.g.h().b(r,t,null)},o,e,l,a;return!this.g.a(64)||n.StoreId===OSF.StoreType.FirstParty?s(n,i,r):t.isAddinCommands?c(t):(o=new($$sc.C.$$(Boolean)),e={},e.marketplaceId=n.Id,e.marketplaceVersion=n.AppVersion,e.storeType=n.CurrentStoreType,e.storeId=n.StoreId,e.targetData=n,this.g.a(115)&&(e.clearCache=!0),l=this,this.h.a().isAddinCommandsAsync(e,function(n,t,i){o.b(t);n||Diag.a.a(593605396,220,10,"Judging AddinCommands failed for {0} from {1} during addin inserting",i.targetData.Id,i.targetData.CurrentStoreType)}),a=this,_Ewa.f.tc(o.a,function(u){var f=u.a();return f?c(t):s(n,i,r)},this.g.i()))},I:function(n){var i=n.Result,t=null===i?null:i.SolutionId;!t||!t.length||(this.h.f(t),_Ewa.L.a(this.g).c(3,t,!1))},x:function(n,t){var i,e,u,r,h;if(!this.k[t])return n;if(i={},n)for(var c=n,p=c.length,f=0;f<p;++f)e=c[f],i[e[0]]=e[1];u=this.k[t];for(var l=Object.keys(u),w=l.length,o=0;o<w;++o)r=l[o],i[r]=r==="feedback"&&this.g.a(497)?Sys.Serialization.JavaScriptSerializer.serialize(u[r]):Sys.Serialization.JavaScriptSerializer.serialize(u[r].toString());for(var b=Object.keys(i).length,a=new Array(b),v=0,y=Object.keys(i),k=y.length,s=0;s<k;++s)h=y[s],a[v]=[h,i[h].toString()],v++;return a},H:function(n,t){var u=n.Result,i=u?u.AgaveData:null,r;if(!i){Diag.a.a(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.");return}r=t;Diag.a.b(593605393,0,i.TaskpaneWidth===350,"Taskpane width is {0}, assetId is {1}.",i.TaskpaneWidth,i.AssetMarketplace.SolutionId);this.n[i.PrimaryMarketplace.SolutionId]&&(i.TaskpaneTitle=this.n[i.PrimaryMarketplace.SolutionId]);r&&(i.FocusOnIframeWhenLoaded=r.d,r.c&&(i.TaskpaneWidth=r.c),i.IconCssClass=r.b,i.HeaderCssClass=r.a,i.TitleCssClass=r.e);this.k[i.PrimaryMarketplace.SolutionId]&&(i.OsfPropertyBag=this.x(i.OsfPropertyBag,i.PrimaryMarketplace.SolutionId));_Ewa.hG.a(i)||(i.WebExtensionOsfControlType=1);i&&(this.h.f(u.SolutionId),this.h.g(i))},F:function(n,t,i){var f=this.g.f().UserSessionId,e=this.g.f().UICultureTag,o=this.g.f().UICultureTagLcid,s=this.g.f().WacHostId,r="",u="";i.length>=5&&(r=i[3],u=i[4]);this.G(r,u,n,t,e,o,f,s)},G:function(n,t,i,r,u,f,e,o){var s={};s.a=e;s.b=i;s.c=r;s.d=n;s.e=t;s.f=u;s.g=f;s.h=o;_Ewa.y.a().a(36,s,!1)},v:function(){var t,r;if(Fdbk.a.h()){Diag.a.a(593605392,1302,15,"OBF is undefined");return}try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.q);return}catch(n){t=n?n.toString():null;Diag.a.a(593605391,1302,15,"Failed to use createScreenshot "+t)}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.q);return}catch(i){r=i?i.toString():null;Diag.a.a(593605390,1302,15,"Failed to use html2canvas"+r)}},z:function(n){n&&(this.j.b(n),this.v())},J:function(n){var i=n.toDataURL("image/jpeg",null),r=this.h.e("FA000000012.Help.GiveFeedback.Url"),t={};t.screenshot=i;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(r,"onScreenshot",t,null)}};_Ewa.AgaveCommandManager.a=function(){};_Ewa.AgaveCommandManager.a.prototype={d:!1,c:0,b:null,a:null,e:null};_Ewa.rg=function(n){_Ewa.rg.initializeBase(this);this.h=n;this.j()};_Ewa.rg.a=function(n){n.b().b(_Ewa.baj.$$(_Ewa.hI),375,new _Ewa.rg(n))};_Ewa.rg.prototype={h:null,b:function(){var n=this.h.b(),t=_Ewa.k.a(_Ewa.bA,n,106,this.du(),-2),r=_Ewa.k.a(_Ewa.fp,n,104,this.du(),-2),f=_Ewa.s.c(37,0,!1,!1,375,this.m),i=this,u;_Ewa.f.cw(_Ewa.f.ws([r,t,f],this.du(),3),function(){var e=new Common.App.AppsForOfficeCommon.e(Common.Utils.c.a()),o=new Common.App.AppsForOfficeCommon.k(Common.a.a,Common.a.d,"WAC_Excel"),s=new Common.App.AppsForOfficeCommon.j(e,o,"PreinstalledAppsData_Excel",null),f=null,u;i.h.a(497)&&(f=Common.Utils.a.a().c(Common.App.CustomerFeedback.d).b());Common.App.AppsForOfficeCommon.c.a.a=s;_Ewa.fA.c().d(t.a());u=new _Ewa.AgaveCommandManager(i.h,t.a(),r.a(),f,Common.a.c());n.b(_Ewa.nK,206,u);i.i(n.a(_Ewa.hI,374,!1)||n.b(_Ewa.hI,374,u))},this.du(),3);u=this;Common.Utils.a.a().b(Common.Utils.d).c(Common.Utils.f).a().b(function(){return new Common.Utils.d(u.h.bD())})}};_Ewa.TW=function(){};_Ewa.TW.a=function(){_Ewa.j.a(function(n){_Ewa.rf.a(n);_Ewa.rg.a(n)})};_Ewa.lL=function(){};_Ewa.lL.a=function(n,t,i,r,u,f){var e=n.a(9,f);return e.sharedInfo=t,_Ewa.i.a(n,"InsertAgaveTaskpane",e,i,r,u,0,null)};_Ewa.lL.b=function(n,t,i,r,u,f,e,o,s,h,c){var l=n.a(9,c);return l.sharedInfo=t,l.sheetName=i,l.positionRow=r,l.positionCol=u,l.positionOffsetX=f,l.positionOffsetY=e,_Ewa.i.a(n,"InsertWebExtension",l,o,s,h,0,null)};_Ewa.ro=function(n){_Ewa.ro.initializeBase(this,[!1]);this.a=n;this.b=!1};_Ewa.ro.prototype={a:null,b:!1,v:function(){return!1},w:function(){return!1},t:function(n,t){var i=this.a.a(174);return t.a===-983891024&&i},u:function(n,t,i){var r=$$sc.a.a(Boolean,!0),u;return t.a===-983891024&&(this.a.isChangeGateEnabled("OfficeVSO:4026121_AgaveCommandManagerService")?this.c():(u=this,r=this.a.h().b(new _Ewa.T(-1898891716,t.b,t.e,t.c,t.d),i,null).CW(function(){u.c()}))),r},c:function(){var s=new Common.App.SmartLookup.h(null),r={},h=_Ewa.b.a(this.a),c=h.e(null),u=c.l(),n,l=(n=new Common.App.SmartLookup.e,n.neighborhood=u,n.mentionStart=0,n.mentionLength=u?u.length:0,n),i,a=(i=new Common.App.SmartLookup.f,i.selection=l,i.entryPoint=0,i),f=this,o;s.a(!1).then(function(n){n.applicationName="Excel";n.isFirstLaunch=f.b;n.themeId=5;r.SmartLookupApplicationInterface=JSON.stringify(a);r.AppProperties=JSON.stringify(n);f.b=!1});var e=null,v=new Common.App.AppsForOfficeCommon.h("ExcelOnline","Web","en-Us"),y=new Common.App.AppsForOfficeCommon.f("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0"),t=new Common.App.AppsForOfficeCommon.g;t.a.TaskPaneTitle=_Ewa.ClientStringManager.a().a(1519);t.a.TaskPaneWidth=350;t.a.SourceLocationOverrideResourceId="WAC.PROD.URL";t.b=r;Common.App.AppsForOfficeCommon.b.b().b(y,"Taskpane","SmartLookupSDXTaskpane",v,t,o={val:e});e=o.val}};_Ewa.re.registerClass("_Ewa.re",_Ewa.cp,_Ewa.jK,_Ewa.nK);_Ewa.re.a.registerClass("_Ewa.re.a");_Ewa.rf.registerClass("_Ewa.rf",_Ewa.ba);_Ewa.AgaveCommandManager.registerClass("_Ewa.AgaveCommandManager",_Ewa.cp,_Ewa.hI,_Ewa.nK);_Ewa.AgaveCommandManager.a.registerClass("_Ewa.AgaveCommandManager.a");_Ewa.rg.registerClass("_Ewa.rg",_Ewa.pU.$$(_Ewa.hI));_Ewa.ro.registerClass("_Ewa.ro",_Ewa.cp,_Ewa.jK);_Ewa.fA.a=null;_Ewa.fA.b=!1;_Ewa.TW.a();Type.registerNamespace("_Ewa");_Ewa.AR=function(n,t,i){this.currentUserToken=n;this.currentUserMlapiToken=t;this.currentUserId=i};_Ewa.AR.prototype={currentUserToken:null,currentUserMlapiToken:null,currentUserId:null};_Ewa.Uu=function(){};_Ewa.Uu.prototype={UserId:null,OfficeScriptingEnabled:!1};_Ewa.fd=function(n,t,i,r,u,f){this.id=n;this.shareId=t;this.name=i;this.dateFirstPublished=r;this.dateLastPublished=u;this.description=f};_Ewa.fd.prototype={id:null,shareId:null,name:null,dateFirstPublished:0,dateLastPublished:0,body:null,description:null,a:function(){return!!this.shareId||this.shareId.length>0}};_Ewa.Ut=function(){this.operationName=operation;this.scriptMetadata=script};_Ewa.Ut.prototype={operationName:null,scriptMetadata:null};_Ewa.rz=function(n,t){this.a=n;this.h=t};_Ewa.rz.prototype={a:null,e:function(n){for(var t=0;t<this.a.length;t++)if(this.a[t].id===n||this.a[t].shareId===n)return t;return-1},h:null,b:function(){this.h(this.a)},c:function(n){return this.e(n.id)===-1?(this.a.push(n),!0):!1},i:function(n){var t=this.e(n.id),i;return t!==-1?(i=this.a[t].shareId,this.a[t]=n,this.a[t].shareId=i,!0):!1},f:function(n){var t=this.e(n);return t!==-1?(this.a.splice(t,1),!0):!1},g:function(n){var t=this.e(n);return t!==-1?this.a[t]:null},d:function(n){return n>=0&&this.a.length>n?this.a[n]:null}};_Ewa.rw=function(n,t){this.b=n;this.a=t};_Ewa.rw.prototype={a:null,b:null,w:function(){return!1},u:function(n,t,i){var u=$$sc.a.a(Boolean,!0),r=t.a,f,e;switch(r){case-1095086781:case 1845457202:case 1904816141:case 1606046412:this.a.isChangeGateEnabled("OfficeVSO:4026121_AgaveCommandManagerService")?(f=r===1904816141?i.MenuItemId.toString():null,this.b.a(r,f)):(e=this,u=this.a.h().b(new _Ewa.T(-1898891716,t.b,t.e,t.c,t.d),i,null).CW(function(){var n=r===1904816141?i.MenuItemId.toString():null;e.b.a(r,n)}))}return u},t:function(n,t){var i=!1,r=t.a;switch(r){case-1095086781:case 1845457202:case 1904816141:case 1606046412:i=this.a.N()}return i},v:function(n,t,i){return t==="PopulateAutomateGalleryMenu"&&this.a.N()?(this.b.f(t,i),!0):!1}};_Ewa.rx=function(n){_Ewa.rx.initializeBase(this,[n])};_Ewa.rx.a=function(n){n.b().b(_Ewa.baj.$$(Array),308,new _Ewa.rx(n))};_Ewa.rx.prototype={l:function(){var n,t;this.h.isChangeGateEnabled("OfficeVSO:4026121_AgaveCommandManagerService")?(n=this,_Ewa.fn.a(_Ewa.hI,this.h,374,375,function(){var t=n.h.b().a(_Ewa.eM,352,!1);t?n.k([new _Ewa.rw(t,n.h)],null):Diag.a.a(593605389,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")})):(t=this,_Ewa.fn.a(_Ewa.eM,this.h,352,351,function(n){t.k([new _Ewa.rw(n,t.h)],null)}))}};_Ewa.AutomateCommandManager=function(n,t,i){var f,e,r,u;this.h=n;this.q=t;this.m=i;this.k=!1;f=this;this.i=new _Ewa.rz([],function(n){_Ewa.AutomateCommandManager.d(n)});e=this;this.j=new _Ewa.rz([],function(n){_Ewa.AutomateCommandManager.e(n)});this.n=new _Ewa.dn(this,n);this.l=Common.g.a();typeof makerstorage!="undefined"&&(r=_Ewa.gp.d(this.h),r&&makerstorage.setStorageEnvironmentOverride(r),this.h.f().DocumentHostInfo.HostTier==="TestHost"?(makerstorage.useLocalStorage(!0,0),this.p=!0,this.o=!0,this.s()):(this.C(),u=this,this.w(function(n){u.B(n)})))};_Ewa.AutomateCommandManager.c=function(n,t,i){if(t.val=null,i.val=null,n){var r=n.indexOf(":");if(r!==-1)return t.val=n.substr(0,r),i.val=n.substr(r+1),!0}return!1};_Ewa.AutomateCommandManager.a=function(n,t){n?(_Ewa.z.a().b()?t[CommandUI.Controls.a.GalleryButtonProps]=_Ewa.dn.e(n):t[CommandUI.Controls.a.InnerHTML]=_Ewa.dn.g(n),t.Alt=n.name):(t[CommandUI.Controls.a.GalleryButtonProps]=null,t[CommandUI.Controls.a.InnerHTML]="",t.Alt="")};_Ewa.AutomateCommandManager.d=function(n){n.sort(function(n,t){return t.dateLastPublished-n.dateLastPublished})};_Ewa.AutomateCommandManager.e=function(n){n.sort(function(n,t){return _Ewa.e.e(n.name,t.name,!0)})};_Ewa.AutomateCommandManager.prototype={h:null,q:null,n:null,p:!1,o:!1,i:null,j:null,m:null,k:!1,b:function(){return this.k},l:0,c:function(){return this.p&&this.o},s:function(){var i,r,n,t;this.c()&&(_Ewa.r.a()?_Ewa.r.q(this.h)&&(this.h.isChangeGateEnabled("OfficeVSO:4013230_MakerFollowEncapsulation")?(r=Common.g.a()-this.l,Diag.a.a(593891465,0,50,"AutomateCommandRenderer.ShowAutomateTabIfEnabled turning on tab on SLR. Time: {0} milliseconds.",r),_Ewa.dt.a(this.h).a().s("Automate"),n=["AutomateRecorder","AutomateCode"],this.h.a(493)&&n.push("AutomateGallery"),_Ewa.dt.a(this.h).a().r(n,!1)):(t=this,Common.App.AppLifecycleManager.get_instance().a(7,function(){var i,n;if(!Common.L.b()){Diag.a.a(593891466,0,15,"AutomateCommandRenderer.ShowAutomateTabIfEnabled called before appChrome is loaded, aborting and automate tab will not shown.");return}i=Common.g.a()-t.l;Diag.a.a(593774166,0,50,"AutomateCommandRenderer.ShowAutomateTabIfEnabled turning on tab on SLR in {0} milliseconds.",i);n=[appChrome.actions.activateRibbonTab("Automate"),appChrome.actions.updateControlHiddenState("AutomateRecorder",!1),appChrome.actions.updateControlHiddenState("AutomateCode",!1)];t.h.a(493)&&n.push(appChrome.actions.updateControlHiddenState("AutomateGallery",!1));appChrome.api.dispatch(n)},3))):(i=Common.g.a()-this.l,Diag.a.a(593891467,0,50,"AutomateCommandRenderer.ShowAutomateTabIfEnabled turning on tab on MLR in {0} milliseconds",i),_Ewa.l.N(this.h.m()+"Ribbon.Automate-title","block")))},f:function(n,t){return n!=="PopulateAutomateGalleryMenu"?!1:(_Ewa.r.a()?t.MenuItems=this.n.c(t.MenuId):t.PopulationXML=this.n.d(t.MenuId),!0)},e:function(){var t,n;this.h.f().DocumentHostInfo.HostTier==="TestHost"?(t=this,this.z(function(){t.v()})):(n=this,this.w(function(t){n.y(t);n.v()}))},g:function(n,t){if(!this.k){_Ewa.AutomateCommandManager.a(null,t);return}switch(n){case"1":case"2":case"3":this.E(parseInt(n),t);return;default:this.F(n,t);return}},d:function(n){var r=!1,t="",i=n,u=new _Ewa.fd(i.scriptMetadata.id,i.scriptMetadata.shareId||"",i.scriptMetadata.name,i.scriptMetadata.dateFirstPublished,i.scriptMetadata.dateLastPublished,""),f,e,o,s,h,c,l,a;switch(i.operationName){case"Publish":r=(e=this.M(u,f={val:t}),t=f.val,e);break;case"Delete":r=(s=this.K(u,o={val:t}),t=o.val,s);break;case"Attach":r=(c=this.J(u,h={val:t}),t=h.val,c);break;case"Detach":r=(a=this.L(u,l={val:t}),t=l.val,a)}r?(Diag.a.a(594137311,0,50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons.",t),this.h.A()):Diag.a.a(594137310,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery. {0}",t)},a:function(n,t){var r=null,u=new Common.App.AppsForOfficeCommon.h("ExcelOnline","Web","en-Us"),f=new Common.App.AppsForOfficeCommon.f("FA000000043",OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0"),i=new Common.App.AppsForOfficeCommon.g,e;i.b.DocumentHostInfo=_Ewa.H.a(this.h.f().DocumentHostInfo);i.b.AutomateGalleryFlight=this.h.a(493);i.b.CodeEditorUrl=_Ewa.gp.a(this.h);i.b.OfficeScriptingTaker=this.h.a(797);i.b.MakerTestService=this.h.a(495);i.b.UseLocalStorage=this.h.f().DocumentHostInfo.HostTier==="TestHost";switch(n){case-1095086781:case 1606046412:i.b.Script="";i.b.Destination="BackStage";i.b.IsOwner=!0;this.r(r,u,f,i,_Ewa.ClientStringManager.a().a(1780),600,_Ewa.gp.a(this.h),"MakerCodeEditor");break;case 1845457202:this.r(r,u,f,i,_Ewa.ClientStringManager.a().a(1781),360,_Ewa.gp.c(this.h),"MakerScriptRecorder");break;case 1904816141:e=this.H(t);i.b.Script=_Ewa.H.a(e);i.b.Destination="Details";i.b.IsOwner=!!this.i.g(e.id);this.r(r,u,f,i,_Ewa.ClientStringManager.a().a(1780),600,_Ewa.gp.a(this.h),"MakerCodeEditor");this.h.A()}},r:function(n,t,i,r,u,f,e,o){r.a.TaskPaneTitle=u;r.a.TaskPaneWidth=f;r.a.SourceLocationOverrideResourceId=e;var s;Common.App.AppsForOfficeCommon.b.b().b(i,"Taskpane",o,t,r,s={val:n});n=s.val},w:function(n){if(this.h.isChangeGateEnabled("OfficeVSO:4035588_OAuthCheckLoggableUserId")&&Common.a.a.a("IsAnonymousUser")){Diag.a.a(593375832,0,50,"AutomateCommandManager: Do not try to fetch a token for anonymous user.");return}if(!this.q){Diag.a.a(51684370,0,10,"AutomateCommandManager: OAuthManager can not be null.");return}if(Common.a.a){var t=Common.g.a(),i=this,r=this;this.q.a("Maker","https://officescripting.microsoft.com").then(function(i){if(i.IsSuccess){var r=Common.g.a()-t;Diag.a.a(51684371,0,50,"OAuthManager successfully fetched a token for Maker Service in {0} milliseconds",r);n(i.Token)}else Diag.a.a(51684372,0,15,"OAuthManager failed to fetched a token for Maker Service.")}).catch(function(){})}},y:function(n){var t=this.h.c().j();makerstorage.setSessionId(t);makerstorage.setUserAccessInfo(new _Ewa.AR(n,null,null))},C:function(){var n=this;Common.Utils.a.a().c(Common.App.ApplicationFeatureHelper.a).a(function(t){t.a("ExcelOfficeScripting",!1).then(function(t){t&&(n.p=!0,n.s())})})},B:function(n){var i,t,r;this.y(n);i=Common.g.a();try{t=this;r=this;makerstorage.getUserPermissions().then(function(n){var u=Common.g.a()-i,r=n;Diag.a.a(51684373,0,50,"MakerStorage.GetUserPermission returned {0} and Automate Tab delayed for {1} milliseconds.",r.OfficeScriptingEnabled,u);r.OfficeScriptingEnabled&&(t.o=!0,t.s())}).catch(function(n){Diag.a.a(51684374,0,15,"MakerStorage.GetUserPermission threw an exception. {0}",JSON.stringify(n))})}catch(u){Diag.a.a(594929358,0,15,"Caught a general exception in MakerStorage.GetUserPermission. {0}",JSON.stringify(u))}},O:function(n){var t=new($$sc.C.$$(Boolean)),i=this,r=function(r){var u=r.Result,f,e;u.ResponseStatusCode===200?(f=u.ResponseBody.join(""),e=JSON.parse(f),n(i.N(e.value)),t.b(!0)):t.b(!1)},e=this,u=function(n){var i=_Ewa.V.a(n.b);Diag.a.a(51684375,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery. {0}",_Ewa.h.a(i,","));t.b(!1)},f=this.A();return this.D(r,u,f,t)},v:function(){if(this.G(),this.h.a(797)){var n=this;this.O(function(t){n.I(t)})}},G:function(){var t=Common.g.a(),n,i;try{n=this;i=this;makerstorage.getScripts("Fetch-Scripts-From-Automate-Tab").then(function(i){for(var r,e=Common.g.a()-t,f=i,o=f.length,u=0;u<o;++u)r=f[u],n.i.c(new _Ewa.fd(r.id,"",r.name,r.dateFirstPublished,r.dateLastPublished,""));n.i.b();n.k=!0;Diag.a.a(51684376,0,50,"MakerStorage.GetScripts finished reading all published scripts. Count: {0}, Time: {1} milliseconds.",n.i.a.length,e);n.h.A()}).catch(function(n){Diag.a.a(51684377,0,15,"Failed to fetch all published scripts from Maker service. Maker storage exception: {0}",n)})}catch(r){Diag.a.a(594929357,0,15,"Caught a general exception in MakerStorage.GetScripts. Exception: {0}",r)}},I:function(n){for(var r=Common.g.a(),t=0,u=n.$$ge(),f,i,e;u.$$mn();){f=u.$$cu();try{i=this;e=this;makerstorage.getSharedScript(f.a,"Fetch-Scripts-From-Automate-Tab").then(function(u){Diag.a.a(593875014,0,50,"MakerStorage.GetSharedScript finished reading a shared script. Script body size: {0}.",u.body.length);i.k=!0;t++;i.j.c(new _Ewa.fd(u.id,n.a(u.id),u.name,u.dateFirstPublished,u.dateLastPublished,""));i.x(t,n.g,r)}).catch(function(i){Diag.a.a(51684379,0,15,"MakerStorage.GetSharedScript threw an exception while fetching a shared script. Exception: {0}",i);t++;e.x(t,n.g,r)})}catch(o){Diag.a.a(594929356,0,15,"Caught a general excepton in MakerStorage.GetSharedScript. Exception: {0}",o)}}},x:function(n,t,i){if(n===t){var r=Common.g.a()-i;Diag.a.a(51684380,0,50,"MakerStorage.GetSharedScript finished reading all shared scripts. Count: {0}, Time: {1} milliseconds.",this.j.a.length,r);this.j.b();this.h.A()}},A:function(){var n={},t;return n.HttpMethod="Get",n.PathAndQuery="customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",n.RequestHeaders=null,n.RequestBody="",n.RequestFlags=0,t=this.h.d().a().a(1,null),t.request=n,t},D:function(n,t,i,r){var f=this.h.g(),u=this.h.d(),e=null,o=null,s=null,v=this,h=function(){var h=f.i()||u.a().c()>0||u.b().c()>0,c,r;return h?!1:(e&&f.e(e),o&&u.e(o),s&&u.g(s),c=i.request,r=function(r,f){return _Ewa.i.a(u.a(),"ExecuteRichApiRequest",i,_Ewa.n.a(r,n),_Ewa.n.b(f,t),null,0,null)},f.d(new _Ewa.bd(507,0,r,16,null)),!0)},c,l,a;return h()||(c=this,e=function(){h()},l=this,o=function(){h()},a=this,s=function(){h()},f.c(e),u.d(o),u.f(s)),r.a},N:function(n){var e=new($$sc.v.$$(String)),o=_Ewa.AutomateCommandManager.b.parseFromString(n,"text/xml").getElementById("script-ids-node-id"),r,t,i,u,f,s,h,c;if(o)for(r=o.getElementsByTagName("scriptId"),t=0;t<r.length;t++)i=r[t].getAttribute("id"),!i||!i.length||(c=_Ewa.AutomateCommandManager.c(i,s={val:u},h={val:f}),u=s.val,f=h.val,c)&&e.c(u,f);return e},H:function(n){switch(n){case"1":case"2":case"3":return this.t(parseInt(n));default:return this.u(n)}},F:function(n,t){var i=this.u(n);_Ewa.AutomateCommandManager.a(i,t)},E:function(n,t){var i=this.t(n);_Ewa.AutomateCommandManager.a(i,t)},t:function(n){var t=this.j?this.j.a.length:0,i=this.i?this.i.a.length:0;return t>=n?this.j.d(n-1):i>=n-t?this.i.d(n-t-1):null},u:function(n){var t,i;if(this.k){if(this.i&&(t=this.i.g(n),t))return t;if(this.j&&(i=this.j.g(n),i))return i}return null},M:function(n,t){if(this.i.c(n))return this.i.b(),t.val="",!0;t.val="";var i=new _Ewa.fd(n.id,"",n.name,n.dateFirstPublished,n.dateLastPublished,"");return this.j.i(i),this.j.b(),this.i.i(n),this.i.b(),!0},K:function(n,t){return this.j.f(n.id),this.i.f(n.id)?(t.val="",!0):(t.val="Deleting a script but script could not be found in published collection.",!1)},J:function(n,t){var i=new _Ewa.fd(n.id,"",n.name,n.dateFirstPublished,n.dateLastPublished,"");return this.i.c(i)&&this.i.b(),this.j.c(n)?(this.j.b(),t.val="",!0):(t.val="Could not attach a script that is already attached.",!1)},L:function(n,t){return this.j.f(n.id)?(t.val="",!0):(t.val="Detaching a script but the script could not be found in the collection.",!1)},z:function(n){try{var t=[makerstorage.saveScript(new _Ewa.fd("TestHostScript1","","Script 1",0,0,"Test host scripts."),Common.bm.a().toString()),makerstorage.saveScript(new _Ewa.fd("TestHostScript2","","Script 2",0,0,"Test host scripts."),Common.bm.a().toString()),makerstorage.saveScript(new _Ewa.fd("TestHostScript3","","Script 3",0,0,"Test host scripts."),Common.bm.a().toString()),makerstorage.saveScript(new _Ewa.fd("TestHostScript4","","Script 4",0,0,"Test host scripts."),Common.bm.a().toString()),makerstorage.saveScript(new _Ewa.fd("TestHostScript5","","Script 5",0,0,"Test host scripts."),Common.bm.a().toString()),makerstorage.saveScript(new _Ewa.fd("TestHostScript6","","Script 6",0,0,"Test host scripts."),Common.bm.a().toString())],i=this;Promise.all(t).then(function(){n()})}catch(r){}}};_Ewa.ry=function(n){_Ewa.ry.initializeBase(this);this.h=n;this.j()};_Ewa.ry.a=function(n){n.b().b(_Ewa.baj.$$(_Ewa.eM),351,new _Ewa.ry(n))};_Ewa.ry.prototype={h:null,b:function(){var n=_Ewa.k.b(_Ewa.ht,this.h.b(),349,350,this.m),r=_Ewa.s.c(97,4,!1,!1,351,this.m),i=_Ewa.k.a(_Ewa.dJ,this.h.b(),102,this.h.i(),this.m),u=[n,r,i],t=this;_Ewa.f.cw(_Ewa.f.ws(u,this.du(),3),function(){t.i(t.h.b().a(_Ewa.eM,352,!1)||new _Ewa.AutomateCommandManager(t.h,n?n.a():null,i.a()))},this.du(),3)}};_Ewa.dn=function(n,t){this.a=n;this.b=t};_Ewa.dn.g=function(n){var t=n.a()?"ewaautomate_trigger":"ewaautomate_script",i=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" align="middle"><\/span>',t,_Ewa.s.a(16)),r=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}<\/p><\/div>',n.name);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}<\/div>',i,r)};_Ewa.dn.d=function(n,t,i){for(var r,f,u=0;u<i;u++)r=t.d(u),r&&(f=r.a()?r.shareId:r.id,Array.add(n,String.format('<GalleryButton Id="{0}" Command="{1}" ImageClass="{2}" Image="{3}" MenuItemId="{4}" ElementDimensions="{5}" LabelText="{6}" InnerHTML="{7}" QueryCommand="{8}" Alt="{9}"/>',f,"1904816141",r.a()?"ewaautomate_trigger":"ewaautomate_script",_Ewa.s.a(16),f,"Size64by48",r.name,Common.e.b(_Ewa.dn.g(r)),"QueryClearGallerySelection",r.name)))};_Ewa.dn.f=function(n,t){return Common.u.g(t,"Size64by48","3",n)};_Ewa.dn.c=function(n,t,i,r,u,f){var o,v,s,l;if(i&&i.a.length>0){var h=f.f(t,3,"Size150by20",null).b(!1),a={},c={},y=_Ewa.dn.b(160,30),e={};for(e.display="flex",e.height="100%",e.flexWrap="nowrap",e.justifyContent="left",e.alignItems="left",e.lineHeight="normal",c.root=y,c.flexContainer=e,a.galleryButtonInExpanded=c,h.GalleryStyle=a,o=0;o<i.a.length&&o<r;o++)v=i.d(o),Array.add(h.GalleryItems,_Ewa.dn.e(v));Array.add(n.ControlList,h)}else l=(s=new Common.dN,s.Id=t,s.ExternalId=t,s.LabelText=u,s),n.ControlsId=l.Id+".Controls",Array.add(n.ControlList,l)};_Ewa.dn.a=function(n,t){var i;return i=new Common.ck,i.Id=n,i.Title=t,i.MenuSectionTitleFocusable=!0,i.ShowMenuSectionTitleBackground=!0,i.ShowMenuSectionTitleIcon=!0,i.ControlList=[],i};_Ewa.dn.e=function(n){var t=n.shareId||n.id;return _Ewa.dn.h(t,"1904816141","QueryAutomateGalleryButtons",n.name,n.a()?"TriggerScript_20":"MacroDefault_20",n.a()?"ewaautomate_trigger":"ewaautomate_script",t,null)};_Ewa.dn.h=function(n,t,i,r,u,f,e,o){var c={},h,s;return c.root=_Ewa.dn.b(20,20),h={},h.root=_Ewa.dn.b(20,20),s=new Common.en,s.Id=n,s.ExternalId=n,s.MenuItemId=e?e:n,s.Command=t,s.Icon=u,s.Image=_Ewa.s.a(16),s.ImageClass=f,s.LabelText=r,s.FullIconStyle=c,s.PreviewIconStyle=h,s.Alt=o?o:r,s};_Ewa.dn.b=function(n,t){var i={};return i.width=n,i["min-width"]=n,i.height=t,i};_Ewa.dn.prototype={a:null,b:null,d:function(n){var t=[],i,r;return this.b.a(797)&&this.a.j.a.length>0&&(i=[],_Ewa.dn.d(i,this.a.j,Math.min(50,this.a.j.a.length)),t.push(Common.u.b(n,_Ewa.dn.f(i,"OnThisWorkbookSeeMore"),null,_Ewa.ClientStringManager.a().a(1787),null,null,null))),this.a.i.a.length>0&&(r=[],_Ewa.dn.d(r,this.a.i,Math.min(6,this.a.i.a.length)),t.push(Common.u.b(n,_Ewa.dn.f(r,"MyRecentScriptsSeeMore"),null,_Ewa.ClientStringManager.a().a(1788),null,null,null))),this.b.a(797)&&this.a.j.a.length||this.a.i.a.length||t.push(Common.u.b(n,Common.u.g("EmptyStatePlaceHolder","Size64by48","3",[String.format('<GalleryButton Id="{0}" Command="{1}" ImageClass="{2}" Image="{3}" MenuItemId="{4}" ElementDimensions="{5}" LabelText="{6}" InnerHTML="{7}" QueryCommand="{8}" Alt="{9}"/>',"EmptyStateGalleryButton","1904816141","","","EmptyStateGalleryButton","Size64by48","","","QueryClearGallerySelection","")]),null,null,null,null,null)),t.push(Common.u.b(n,Common.u.d("AllMyScriptsControls",[Common.u.e("AllMyScriptsButton","1606046412",_Ewa.ClientStringManager.a().a(1785),_Ewa.s.a(16),"ewaautomate_allmyscripts",null,null,_Ewa.ClientStringManager.a().a(1786),null,null,null,null,null,null,!0,null,null,null,null,null,null,null)]),null,null,null,null,null)),Common.u.c(t)},c:function(n){var i=this.a.m.c(null).b(),u,f,t,e,r;return this.b.a(797)&&(u=_Ewa.dn.a(n,_Ewa.ClientStringManager.a().a(1787)),_Ewa.dn.c(u,"OnThisWorkbookSeeMore",this.a.j,50,_Ewa.ClientStringManager.a().a(1783),this.a.m),Array.add(i.MenuSectionList,u)),f=_Ewa.dn.a(n,_Ewa.ClientStringManager.a().a(1788)),_Ewa.dn.c(f,"MyRecentScriptsSeeMore",this.a.i,6,_Ewa.ClientStringManager.a().a(1784),this.a.m),Array.add(i.MenuSectionList,f),e=(t=new Common.bY,t.Id="AllMyScriptsButton",t.ExternalId="AllMyScriptsButton",t.Command="1606046412",t.LabelText=_Ewa.ClientStringManager.a().a(1785),t.Alt=_Ewa.ClientStringManager.a().a(1785),t.Image16by16=_Ewa.s.a(16),t.Image16by16Class="ewaautomate_allmyscripts_20",t.Visible=!0,t),r=_Ewa.dn.a(n,null),r.ControlsId="myScriptsSection.Controls",Array.add(r.ControlList,e),Array.add(i.MenuSectionList,r),i}};_Ewa.AR.registerClass("_Ewa.AR");_Ewa.fd.registerClass("_Ewa.fd");_Ewa.rz.registerClass("_Ewa.rz");_Ewa.rw.registerClass("_Ewa.rw",null,_Ewa.jK);_Ewa.rx.registerClass("_Ewa.rx",_Ewa.ba);_Ewa.AutomateCommandManager.registerClass("_Ewa.AutomateCommandManager",null,_Ewa.eM);_Ewa.ry.registerClass("_Ewa.ry",_Ewa.pU.$$(_Ewa.eM));_Ewa.AutomateCommandManager.b=new DOMParser;Type.registerNamespace("_Ewa");_Ewa.Ur=function(){};_Ewa.Ur.a=function(){_Ewa.j.a(function(n){_Ewa.rx.a(n);_Ewa.ry.a(n)})};_Ewa.Ur.a();__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var t=function(){function n(){}return n.httpMethodGet="GET",n.httpMethodPost="POST",n.httpMethodPatch="PATCH",n.httpMethodDelete="DELETE",n.processQuery="ProcessQuery",n.actionId="ActionId",n.actionIndex="ActionIndex",n.actions="Actions",n.arrayTypeSufix="[]",n.code="Code",n.count="Count",n.error="Error",n.expand="Expand",n.getAsyncEnumeratorJsName="getAsyncEnumerator",n.getCount="GetCount",n.getItemAt="GetItemAt",n.getObjectByReferenceId="_GetObjectByReferenceId",n.getReferenceCount="_GetReferenceCount",n.id="Id",n.idLowerCase="id",n.idPrivate="_Id",n.idPrivateLowerCase="_id",n.index="_Index",n.isNull="_IsNull",n.items="_Items",n.keepReference="_KeepReference",n.location="Location",n.maxRecursiveQueryDepth=100,n.message="Message",n.nullableTypeSuffix="?",n.objectPathIdPrivate="_ObjectPathId",n.onAccess="_OnAccess",n.processedResults="ProcessedResults",n.referenceId="_ReferenceId",n.referenceIdLowerCase="_referenceid",n.removeAllReferences="_RemoveAllReferences",n.removeReference="_RemoveReference",n.results="Results",n.traceIds="TraceIds",n.value="Value",n}();n.Constants=t})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(n){var t;(function(n){var t=function(){function t(){this.m_eventIdControlMapByTarget={};this.m_richApiMessageEntriesByControl={};this.m_batchFireEventScheduled=!1}return t.prototype.initHost=function(n){this.m_host=n},t.prototype.register=function(n,t,i){var u,r;if(t=this.normalizeTargetId(t),u=this.m_eventIdControlMapByTarget[t],u||(u={},this.m_eventIdControlMapByTarget[t]=u),r=u[i],r||(r={},u[i]=r),r[n]=typeof r[n]=="undefined"?1:r[n]+1,r[n]===1&&this.m_host)this.m_host.onRegisterRichApiEvent(t,i)},t.prototype.unregister=function(n,t,i){var u,r;if(t=this.normalizeTargetId(t),u=this.m_eventIdControlMapByTarget[t],u&&(r=u[i],r&&r[n]>0))if(r[n]===1){if(this.m_host)this.m_host.onUnregisterRichApiEvent(t,i);delete r[n]}else r[n]=r[n]-1},t.prototype.isEventRegistered=function(n,t){var i,r,u;if((n=this.normalizeTargetId(n),i=this.m_eventIdControlMapByTarget[n],!i)||(r=i[t],!r))return!1;for(u in r)return!0;return!1},t.prototype.fireEvent=function(n,i,r){var h=this,f,e,o,u,s;if((n=this.normalizeTargetId(n),f=this.m_eventIdControlMapByTarget[n],f)&&(e=f[i],e)){for(o in e)u=this.m_richApiMessageEntriesByControl[o],u||(u=[],this.m_richApiMessageEntriesByControl[o]=u),s=[t.s_richapiMessageCategoryEvent,i,n,JSON.stringify(r)],u.push(s);this.m_batchFireEventScheduled||(this.m_batchFireEventScheduled=!0,setTimeout(function(){h.batchFireEvent()},0))}},t.prototype.batchFireEvent=function(){var n,t,i;this.m_batchFireEventScheduled=!1;n=this.m_richApiMessageEntriesByControl;this.m_richApiMessageEntriesByControl={};for(t in n)i=n[t],this.m_host&&this.m_host.sendRichApiMessageEventEntriesToControl(t,i)},t.prototype.normalizeTargetId=function(t){return n.Utility.isNullOrUndefined(t)?"":t},t.s_richapiMessageCategoryEvent=65536,t}();n.EventManager=t})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(n){var t;(function(n){var t=function(){function n(){}return n.accessDenied="AccessDenied",n.apiNotFound="ApiNotFound",n.generalException="GeneralException",n.invalidArgument="InvalidArgument",n.invalidOperation="InvalidOperation",n.invalidRequest="InvalidRequest",n}();n.ErrorCodes=t})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(n){var t;(function(n){var t=function(){function t(n){this.m_context=n;this.m_requestMessage=JSON.parse(this.m_context.request.body);this.m_objectPaths={};this.m_resolvedObjects={};this.m_traceIds=[]}return t.prototype.process=function(){var i=this,t,r,u,f,e;for(this.m_context.response.writer.startObjectScope(),this.m_context.response.writer.writeName(n.Constants.results),this.m_context.response.writer.startArrayScope(),t=n.Utility.createPromiseFromResult(null),r=0;r<this.m_requestMessage.Actions.length;r++)u=new n.JsonWriter,f=this.createProcessOneActionFunc(u,this.m_requestMessage.Actions[r],r),t=t.then(f),e=this.createWriteActionWriterFunc(this.m_context.response.writer,u),t=t.then(e);return t.then(function(){i.m_context.response.writer.endScope();i.writeTraceIds(i.m_context.response.writer);i.m_context.response.writer.endScope()})["catch"](function(n){i.processError(n)})},t.prototype.processError=function(i){var u=this.m_context.response.reset(),r=this.m_context.response.writer,f=n.UtilityInternal.convertToRichApiException(i);r.startObjectScope();r.writeName(n.Constants.error);t.writeError(r,f,this.m_currentActionIndex);this.writeTraceIds(r);u.isEmpty||(r.writeName(n.Constants.processedResults),r.writeRawValueFrom(u));r.endScope();n.Logger.SendULSTraceTag(JSON.stringify(f),this.m_context.host.hostName(),50,35211328)},t.writeError=function(t,i,r){t.startObjectScope();t.writeName(n.Constants.code);t.writeValue(i.code);t.writeName(n.Constants.message);t.writeValue(i.message);n.Utility.isNullOrEmptyString(i.location)||(t.writeName(n.Constants.location),t.writeValue(i.location));r>=0&&(t.writeName(n.Constants.actionIndex),t.writeValue(r));t.endScope()},t.prototype.createProcessOneActionFunc=function(t,i,r){var u=this;return function(){return n.Utility.createPromiseFromResult(null).then(function(){return u.m_currentActionIndex=r,u.processOneAction(t,i)})}},t.prototype.createWriteActionWriterFunc=function(t,i){return function(){if(i.isEmpty)throw n.Utility.createInvalidOperationException();t.writeRawValueFrom(i)}},t.prototype.processOneAction=function(t,i){switch(i.ActionType){case 1:return this.processActionInstantiate(t,i);case 3:return this.processActionMethod(t,i);case 2:return this.processActionQuery(t,i);case 4:return this.processActionSetProperty(t,i);case 5:return this.procesActionTrace(t,i);case 6:return this.processActionRecursiveQuery(t,i);default:throw n.Utility.createInvalidOperationException();}},t.prototype.processActionInstantiate=function(t,i){var r=this;return this.getObjectFromObjectPathId(i.ObjectPathId).then(function(n){var t=r.shouldNotKeepReference(i.ObjectPathId);return r.invokeKeepReferenceIfNecessary(t,n)}).then(function(u){if(t.startObjectScope(),t.writeName(n.Constants.actionId),t.writeValue(i.Id),t.writeName(n.Constants.value),u)return r.writeObjectBasicIds(t,u).then(function(){t.endScope()});t.writeValueNull();t.endScope()})},t.prototype.writeObjectBasicIds=function(t,i){var f=this,u=this.m_context.typeReg.getType(i.getTypeName()),r;return t.startObjectScope(),r=n.Utility.createPromiseFromResult(null),r=r.then(function(){var r=u.tryGetProperty(n.Constants.id);if(r)return n.UtilityInternal.invokePropertyGetAsync(f.m_context,u,r,i).then(function(i){t.writeName(n.Constants.id);t.writeValue(i)})}),r=r.then(function(){var r=u.tryGetProperty(n.Constants.idPrivate);if(r)return n.UtilityInternal.invokePropertyGetAsync(f.m_context,u,r,i).then(function(i){t.writeName(n.Constants.idPrivate);t.writeValue(i)})}),r=r.then(function(){var r=u.tryGetProperty(n.Constants.referenceId);if(r)return n.UtilityInternal.invokePropertyGetAsync(f.m_context,u,r,i).then(function(i){typeof i!="string"||n.Utility.isNullOrEmptyString(i)||(t.writeName(n.Constants.referenceId),t.writeValue(i))})}),r.then(function(){t.endScope()})},t.prototype.processActionMethod=function(t,i){var r=this;return this.getObjectFromObjectPathId(i.ObjectPathId).then(function(u){if(u){var e=r.m_context.typeReg.getType(u.getTypeName()),f=e.getMethod(i.Name);return r.resolveMethodArguments(i.ArgumentInfo,f.parameters).then(function(o){return n.UtilityInternal.invokeMethodAsync(r.m_context,e,f,u,o).then(function(u){t.startObjectScope();t.writeName(n.Constants.actionId);t.writeValue(i.Id);t.writeName(n.Constants.value);var e=r.m_context.typeReg.tryGetType(f.returnTypeName);n.UtilityInternal.writeValue(t,r.m_context,e,u);t.endScope()})})}r.writeActionNullObjectResult(t,i)})},t.prototype.processActionQuery=function(t,i){var r=this;return this.getObjectFromObjectPathId(i.ObjectPathId).then(function(u){var e,f,o;if(t.startObjectScope(),t.writeName(n.Constants.actionId),t.writeValue(i.Id),t.writeName(n.Constants.value),u)return e=r.m_context.typeReg.getType(u.getTypeName()),f=new n.RESTfulQuery,f.init(i.QueryInfo.Select,i.QueryInfo.Expand,i.QueryInfo.Top,i.QueryInfo.Skip),o=r.shouldNotKeepReference(i.ObjectPathId),r.writeQueryResult(t,f,u,e,-1,null,1,o).then(function(){t.endScope()});t.writeValueNull();t.endScope()})},t.prototype.processActionRecursiveQuery=function(t,i){var u=this,f,e,r;if(n.Utility.isNullOrUndefined(i.RecursiveQueryInfo))throw n.Utility.createInvalidArgumentException("action.RecursiveQueryInfo");if(f={},i.RecursiveQueryInfo.Queries)for(e in i.RecursiveQueryInfo.Queries)f[e.toLowerCase()]=i.RecursiveQueryInfo.Queries[e];if(r={Queries:f,MaxDepth:i.RecursiveQueryInfo.MaxDepth},n.Utility.isNullOrUndefined(r.MaxDepth)&&(r.MaxDepth=n.Constants.maxRecursiveQueryDepth),r.MaxDepth<0||r.MaxDepth>n.Constants.maxRecursiveQueryDepth)throw n.Utility.createInvalidArgumentException("action.RecursiveQueryInfo.MaxDepth");return this.getObjectFromObjectPathId(i.ObjectPathId).then(function(f){var e,o,s;if(t.startObjectScope(),t.writeName(n.Constants.actionId),t.writeValue(i.Id),t.writeName(n.Constants.value),f)return e=u.m_context.typeReg.getType(f.getTypeName()),o=new n.RESTfulQuery,u.tryGetQueryForType(r,e,o),s=u.shouldNotKeepReference(i.ObjectPathId),u.writeQueryResult(t,o,f,e,-1,r,1,s).then(function(){t.endScope()});t.writeValueNull();t.endScope()})},t.prototype.processActionSetProperty=function(t,i){var r=this;return this.getObjectFromObjectPathId(i.ObjectPathId).then(function(u){if(u){var f=r.m_context.typeReg.getType(u.getTypeName()),e=f.getProperty(i.Name);return r.resolveMethodArguments(i.ArgumentInfo,e.parameters).then(function(t){return n.UtilityInternal.invokePropertySetAsync(r.m_context,f,e,u,t[0])}).then(function(){r.writeActionNullResult(t,i)})}r.writeActionNullObjectResult(t,i)})},t.prototype.writeActionNullResult=function(t,i){t.startObjectScope();t.writeName(n.Constants.actionId);t.writeValue(i.Id);t.writeName(n.Constants.value);t.writeValueNull();t.endScope()},t.prototype.writeActionNullObjectResult=function(t,i){t.startObjectScope();t.writeName(n.Constants.actionId);t.writeValue(i.Id);t.writeName(n.Constants.value);t.startObjectScope();t.writeName(n.Constants.isNull);t.writeValue(!0);t.endScope();t.endScope()},t.prototype.procesActionTrace=function(t,i){var r=this;return n.Utility.createPromiseFromResult(null).then(function(){r.m_traceIds.push(i.Id);r.writeActionNullResult(t,i)})},t.prototype.shouldNotKeepReference=function(n){return this.m_requestMessage.ObjectPaths[n].D},t.prototype.getObjectFromObjectPathId=function(n){var i=this,t=this.m_objectPaths[n];return t?t.then(function(n){return i.invokeOnAccess(n)}):(t=this.createObjectFromObjectPath(this.m_requestMessage.ObjectPaths[n]),t=t.then(function(t){return i.m_resolvedObjects[n]=t,t}),this.m_objectPaths[n]=t,t.then(function(n){return i.invokeOnAccess(n)}))},t.prototype.getResolvedObjectFromObjectPathId=function(t){var i=this.m_resolvedObjects[t];if(n.Utility.isUndefined(i))throw n.Utility.createInvalidRequestException();return i},t.prototype.createObjectFromObjectPath=function(t){switch(t.ObjectPathType){case 1:return this.createObjectFromObjectPathGlobalObject(t);case 5:return this.createObjectFromObjectPathIndexer(t);case 3:return this.createObjectFromObjectPathMethod(t);case 2:return this.createObjectFromObjectPathNewObject(t);case 4:return this.createObjectFromObjectPathProperty(t);case 6:return this.createObjectFromObjectPathReferenceId(t);case 7:return n.Utility.createPromiseFromResult(null)}throw n.Utility.createInvalidOperationException();},t.prototype.createObjectFromObjectPathGlobalObject=function(){var t=this.m_context.request.globalObject;return n.Utility.createPromiseFromResult(t)},t.prototype.createObjectFromObjectPathIndexer=function(t){var i=this;return this.getObjectFromObjectPathId(t.ParentObjectPathId).then(function(r){if(!r)return null;var u=i.m_context.typeReg.getType(r.getTypeName()),f=u.getIndexerMethod();return n.UtilityInternal.invokeMethodAsync(i.m_context,u,f,r,t.ArgumentInfo.Arguments)})},t.prototype.createObjectFromObjectPathMethod=function(t){var i=this;return this.getObjectFromObjectPathId(t.ParentObjectPathId).then(function(r){if(!r)return null;var u=i.m_context.typeReg.getType(r.getTypeName()),f=u.getMethod(t.Name);return i.resolveMethodArguments(t.ArgumentInfo,f.parameters).then(function(t){return n.UtilityInternal.invokeMethodAsync(i.m_context,u,f,r,t)})})},t.prototype.createObjectFromObjectPathNewObject=function(t){var i=t.Name,r=this.m_context.typeReg.getType(i),u=n.UtilityInternal.createObject(this.m_context,r);return n.Utility.createPromiseFromResult(u)},t.prototype.createObjectFromObjectPathProperty=function(t){var i=this;return this.getObjectFromObjectPathId(t.ParentObjectPathId).then(function(r){if(!r)return null;var u=i.m_context.typeReg.getType(r.getTypeName()),f=u.getProperty(t.Name);return n.UtilityInternal.invokePropertyGetAsync(i.m_context,u,f,r)})},t.prototype.createObjectFromObjectPathReferenceId=function(t){var r=t.Name,i=this.m_context.typeReg.getType(this.m_context.request.globalObject.getTypeName()),u=i.getMethod(n.Constants.getObjectByReferenceId);return n.UtilityInternal.invokeMethodAsync(this.m_context,i,u,this.m_context.request.globalObject,[r])},t.prototype.resolveMethodArguments=function(t,i){for(var o,s,e,f,h,u=[],r=0;r<i.length&&r<t.Arguments.length;r++)u.push(t.Arguments[r]);for(r=0;r<i.length&&r<u.length;r++)o=this.m_context.typeReg.tryGetType(i[r].parameterTypeName),n.Utility.isNullOrEmptyString(i[r].fallbackComplexTypeName)?i[r].parameterTypeName.indexOf("DateTime")>=0?u[r]=this.convertStringValueToDateValue(u[r]):o&&(u[r]=this.resolveEnumIntValueIfHasEnumType(u[r],o)):(s=this.m_context.typeReg.getType(i[r].fallbackComplexTypeName),u[r]=this.resolveComplexTypeIfNecessary(u[r],s));if(e=n.Utility.createPromiseFromResult(null),t.ReferencedObjectPathIds){for(f=[],r=0;r<u.length;r++)this.collectObjectPathIdInfos(f,[r],u[r],t.ReferencedObjectPathIds[r]);for(r=0;r<f.length;r++)h=this.createGetObjectFromObjectPathIdAndStoreParameterArgFunc(f[r].objectPathId,u,f[r].indices),e=e.then(h)}return e.then(function(){return n.Utility.createPromiseFromResult(u)})},t.prototype.convertStringValueToDateValue=function(i){var f,r,u;if(n.Utility.isNullOrUndefined(i))return null;if(typeof i=="string"){if(!t.s_regexISODate.test(i))throw n.Utility.createInvalidArgumentException("value");if(f=Date.parse(i),n.Utility.isNullOrUndefined(f))throw n.Utility.createInvalidArgumentException("value");return new Date(f)}if(Array.isArray(i)){for(r=i,u=0;u<r.length;u++)r[u]=this.convertStringValueToDateValue(r[u]);return r}return i},t.prototype.resolveComplexTypeIfNecessary=function(t,i){var f,e,o,s,u,r,h,c;if(Array.isArray(t)){for(f=t,e=0;e<f.length;e++)f[e]=this.resolveComplexTypeIfNecessary(f[e],i);return f}if(typeof t=="object"){o=n.UtilityInternal.createObject(this.m_context,i);for(s in t)u=i.tryGetProperty(s),u&&!u.isReadonly&&(r=t[s],h=this.m_context.typeReg.tryGetType(u.propertyTypeName),n.Utility.isNullOrEmptyString(u.fallbackComplexTypeName)?typeof r=="object"&&r&&typeof r[n.Constants.objectPathIdPrivate]=="number"&&r[n.Constants.objectPathIdPrivate]>0?r=this.getResolvedObjectFromObjectPathId(r[n.Constants.objectPathIdPrivate]):h&&(r=this.resolveEnumIntValueIfHasEnumType(r,h)):(c=this.m_context.typeReg.getType(u.fallbackComplexTypeName),r=this.resolveComplexTypeIfNecessary(r,c)),n.UtilityInternal.invokePropertySet(this.m_context,i,u,o,r,!1));return o}return t},t.prototype.resolveEnumIntValueIfHasEnumType=function(n,t){var r,i;if(Array.isArray(n)&&t.arrayItemTypeInfo)for(r=n,i=0;i<r.length;i++)r[i]=this.resolveEnumIntValueIfHasEnumType(r[i],t.arrayItemTypeInfo);else t.isEnum&&typeof n=="string"&&(n=t.getEnumFieldValue(n));return n},t.prototype.collectObjectPathIdInfos=function(n,t,i,r){var s,o,u,f,e;if(Array.isArray(r)&&Array.isArray(i))for(s=r,o=i,u=0;u<o.length;u++){for(f=[],e=0;e<t.length;e++)f.push(t[e]);f.push(u);this.collectObjectPathIdInfos(n,f,o[u],s[u])}else r>0&&r===i&&n.push({objectPathId:r,indices:t})},t.prototype.createGetObjectFromObjectPathIdAndStoreParameterArgFunc=function(n,t,i){var r=this;return function(){return r.getObjectFromObjectPathId(n).then(function(n){for(var r=t,u=0;u<i.length-1;u++)r=r[i[u]];r[i[i.length-1]]=n})}},t.prototype.writeTraceIds=function(t){if(this.m_traceIds.length>0){t.writeName(n.Constants.traceIds);t.startArrayScope();for(var i=0;i<this.m_traceIds.length;i++)t.writeValue(this.m_traceIds[i]);t.endScope()}},t.prototype.tryGetQueryForType=function(t,i,r){var f=n.UtilityInternal.getShortTypeName(i.name).toLowerCase(),u=t.Queries[f];return(n.Utility.isNullOrUndefined(u)&&(n.Utility.isNullOrEmptyString(i.childItemTypeName)||(f=n.UtilityInternal.getShortTypeName(i.childItemTypeName).toLowerCase(),u=t.Queries[f])),u)?(r.init(u.Select,u.Expand,u.Top,u.Skip),!0):!1},t.prototype.writeQueryResult=function(t,i,r,u,f,e,o,s){var c=this,h,l;return t.startObjectScope(),f>=0&&(t.writeName(n.Constants.index),t.writeValue(f)),h=n.Utility.createPromiseFromResult(null),h=h.then(function(){return c.invokeKeepReferenceIfNecessary(s,r)}),l=u.tryGetItemAtMethod(),u.supportEnumeration?(h=h.then(function(){return c.writeScalarProperties(t,i,r,u,!0)}),h=h.then(function(){return c.writeChildItemsUsingEnumerator(t,i,r,u,e,o,s)})):l?(h=h.then(function(){return c.writeScalarProperties(t,i,r,u,!0)}),h=h.then(function(){return c.writeChildItemsUsingGetItemAt(t,i,r,u,l,e,o,s)})):(h=h.then(function(){return c.writeScalarProperties(t,i,r,u,!1)}),(e===null||o<e.MaxDepth)&&(h=h.then(function(){return c.writeNavigationProperties(t,i,u,r,e,o+1,s)}))),h.then(function(){t.endScope()})},t.prototype.writeScalarProperties=function(t,i,r,u,f){var o=n.Utility.createPromiseFromResult(null),s,e,h,c;for(s in u.properties)e=u.properties[s],(e.propertyTypeCategory==1||e.propertyTypeCategory==2)&&(f||i.shouldSelectProperty(e.lowerCaseName,e.excludedFromDefaultLoad))&&(h=this.m_context.typeReg.tryGetType(e.propertyTypeName),c=this.createWriteScalarOnePropertyFunc(t,u,e,r,h),o=o.then(c));return o},t.prototype.createWriteScalarOnePropertyFunc=function(t,i,r,u,f){var e=this;return function(){return n.UtilityInternal.invokePropertyGetAsync(e.m_context,i,r,u).then(function(i){t.writeName(r.name);n.UtilityInternal.writeValue(t,e.m_context,f,i)})}},t.prototype.writeNavigationProperties=function(t,i,r,u,f,e,o){var c=n.Utility.createPromiseFromResult(null),a,s,l,h,v;for(a in r.properties)s=r.properties[a],s.propertyTypeCategory==3&&i.shouldExpandProperty(s.lowerCaseName)&&(l=this.m_context.typeReg.getType(s.propertyTypeName),f?(h=new n.RESTfulQuery,this.tryGetQueryForType(f,l,h)||(h=i.createQueryForProperty(s.lowerCaseName))):h=i.createQueryForProperty(s.lowerCaseName),v=this.createWiteNavigationOnePropertyFunc(t,r,s,u,h,l,f,e,o),c=c.then(v));return c},t.prototype.createWiteNavigationOnePropertyFunc=function(t,i,r,u,f,e,o,s,h){var c=this;return function(){return n.UtilityInternal.invokePropertyGetAsync(c.m_context,i,r,u).then(function(i){if(t.writeName(r.name),n.Utility.isNullOrUndefined(i))t.writeValueNull();else return c.writeQueryResult(t,f,i,e,-1,o,s,h)})}},t.prototype.writeChildItemsUsingEnumerator=function(t,i,r,u,f,e,o){var c=this,h=0,s;return i.skip>0&&(h=i.skip),s=0,i.top>0&&(s=i.top),n.UtilityInternal.invokeGetAsyncEnumerator(this.m_context,u,r,h,s).then(function(r){var v=c.m_context.typeReg.getType(u.childItemTypeName),y=h,l=0,a;return s>0&&(l=h+s),t.writeName(n.Constants.items),t.startArrayScope(),a=c.enumeratorLoop(r,y,l,function(r,u){return n.Utility.isNullOrUndefined(r)?(t.writeValueNull(),n.Utility.createPromiseFromResult(null)):c.writeQueryResult(t,i,r,v,u,f,e,o)}),a.then(function(){t.endScope()})})},t.prototype.enumeratorLoop=function(t,i,r,u){var f=this;return r===0||i<r?t.moveNext().then(function(e){return e?u(t.get_current(),i).then(function(){return f.enumeratorLoop(t,i+1,r,u)}):n.Utility.createPromiseFromResult(null)}):n.Utility.createPromiseFromResult(null)},t.prototype.writeChildItemsUsingGetItemAt=function(t,i,r,u,f,e,o,s){var c=this,v=this.m_context.typeReg.getType(f.returnTypeName),h=u.tryGetProperty(n.Constants.count),l=u.tryGetMethod(n.Constants.getCount),a;return!h&&!l?n.Utility.createPromiseFromResult(null):(a=h?n.UtilityInternal.invokePropertyGetAsync(this.m_context,u,h,r):n.UtilityInternal.invokeMethodAsync(this.m_context,u,l,r,[]),a.then(function(h){var a=0,l;return i.skip>0&&(a=i.skip),l=h,i.top>0&&(l=a+i.top,l>h&&(l=h)),t.writeName(n.Constants.items),t.startArrayScope(),c.getItemAtLoop(u,f,r,a,l,function(r,u){return n.Utility.isNullOrUndefined(r)?(t.writeValueNull(),n.Utility.createPromiseFromResult(null)):c.writeQueryResult(t,i,r,v,u,e,o,s)}).then(function(){t.endScope()})}))},t.prototype.getItemAtLoop=function(t,i,r,u,f,e){var o=this;return u<f?n.UtilityInternal.invokeMethodAsync(this.m_context,t,i,r,[u]).then(function(n){return e(n,u)}).then(function(){return o.getItemAtLoop(t,i,r,u+1,f,e)}):n.Utility.createPromiseFromResult(null)},t.prototype.invokeOnAccess=function(t){if(t){var i=this.m_context.typeReg.getType(t.getTypeName()),r=i.tryGetMethod(n.Constants.onAccess);if(r)return n.UtilityInternal.invokeMethodAsync(this.m_context,i,r,t,[]).then(function(){return t})}return n.Utility.createPromiseFromResult(t)},t.prototype.invokeKeepReferenceIfNecessary=function(t,i){if(!t&&i&&i!==this.m_context.request.globalObject&&this.m_requestMessage.AutoKeepReference){var r=this.m_context.typeReg.getType(i.getTypeName()),u=r.tryGetMethod(n.Constants.keepReference);if(u)return n.UtilityInternal.invokeMethodAsync(this.m_context,r,u,i,[]).then(function(){return i})}return n.Utility.createPromiseFromResult(i)},t.s_regexISODate=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(\.\d+)?(([+-]\d\d:\d\d)|Z)?$/,t}();n.JsComRequestProcessor=t})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(n){var t;(function(n){var t=function(){function t(){this.m_scopes=[]}return t.prototype.startScope=function(t){var i,r;if(i=t==0?{scopeType:t,object:{}}:{scopeType:t,object:[]},this.m_scopes.length>0)if(r=i.object,this.m_scopes[this.m_scopes.length-1].scopeType==1)this.m_scopes[this.m_scopes.length-1].object.push(r);else{if(n.Utility.isNullOrEmptyString(this.m_pendingPropertyName))throw n.Utility.createInvalidOperationException();this.m_scopes[this.m_scopes.length-1].object[this.m_pendingPropertyName]=r;this.m_pendingPropertyName=null}this.m_scopes.push(i);n.Utility.isNullOrUndefined(this.m_firstScope)&&(this.m_firstScope=i)},t.prototype.endScope=function(){this.m_scopes.splice(this.m_scopes.length-1)},t.prototype.startArrayScope=function(){this.startScope(1)},t.prototype.startObjectScope=function(){this.startScope(0)},t.prototype.writeName=function(t){if(this.m_scopes.length<1||this.m_scopes[this.m_scopes.length-1].scopeType!=0)throw n.Utility.createInvalidOperationException();if(!n.Utility.isNullOrEmptyString(this.m_pendingPropertyName))throw n.Utility.createInvalidOperationException();this.m_pendingPropertyName=t},t.prototype.writeValue=function(t){if(n.Utility.isNullOrUndefined(t)&&(t=null),this.m_scopes.length<1)throw n.Utility.createInvalidOperationException();if(this.m_scopes[this.m_scopes.length-1].scopeType==1)this.m_scopes[this.m_scopes.length-1].object.push(t);else{if(n.Utility.isNullOrEmptyString(this.m_pendingPropertyName))throw n.Utility.createInvalidOperationException();this.m_scopes[this.m_scopes.length-1].object[this.m_pendingPropertyName]=t;this.m_pendingPropertyName=null}},t.prototype.writeValueNull=function(){this.writeValue(null)},t.prototype.writeRawValueFrom=function(n){this.writeValue(n.m_firstScope.object)},t.prototype.getJsonString=function(){return this.m_firstScope?JSON.stringify(this.m_firstScope.object):""},Object.defineProperty(t.prototype,"isEmpty",{get:function(){return this.m_firstScope?!1:!0},enumerable:!0,configurable:!0}),t}();n.JsonWriter=t})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(n){var t;(function(n){var t=function(){function t(t,i,r,u,f,e,o){this.m_name=i;this.m_dispatchId=r;this.m_returnTypeName=u;this.m_returnTypeCategory=f;this.m_operationType=e;this.m_parameters=[];this.m_apiName=n.UtilityInternal.getApiName(t,i);this.m_apiFlags=o}return Object.defineProperty(t.prototype,"name",{get:function(){return this.m_name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"returnTypeCategory",{get:function(){return this.m_returnTypeCategory},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"returnTypeName",{get:function(){return this.m_returnTypeName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dispatchId",{get:function(){return this.m_dispatchId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"methodOperationType",{get:function(){return this.m_operationType},enumerable:!0,configurable:!0}),t.prototype.addParameter=function(t,i,r,u){var f=new n.ParameterInformation(t,i,r,u);return this.m_parameters.push(f),f},Object.defineProperty(t.prototype,"parameters",{get:function(){return this.m_parameters},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiName",{get:function(){return this.m_apiName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiFlags",{get:function(){return this.m_apiFlags},enumerable:!0,configurable:!0}),t}();n.MethodInformation=t})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(n){var t;(function(n){var t=function(){function t(t,i,r,u){this.m_name=t;this.m_typeName=i;this.m_typeCategory=r;this.m_typeCategory===1?this.m_fallbackComplexTypeName=u:this.m_typeCategory===2&&(this.m_fallbackComplexTypeName=n.UtilityInternal.getTypeNameWithoutArraySuffix(i))}return Object.defineProperty(t.prototype,"name",{get:function(){return this.m_name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parameterTypeName",{get:function(){return this.m_typeName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parameterTypeCategory",{get:function(){return this.m_typeCategory},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fallbackComplexTypeName",{get:function(){return this.m_fallbackComplexTypeName},enumerable:!0,configurable:!0}),t}();n.ParameterInformation=t})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(n){var t;(function(n){var t=function(){function t(t,i,r,u,f,e,o,s){this.m_name=i;this.m_dispatchId=r;this.m_propertyTypeName=u;this.m_propertyTypeCategory=f;this.m_isReadonly=e;this.m_parameters=[];this.m_parameters.push(new n.ParameterInformation("value",u,f,o));this.m_apiName=n.UtilityInternal.getApiName(t,i);this.m_lowerCaseName=i.toLowerCase();this.m_camelLowerCaseName=n.UtilityInternal.toCamelLowerCase(i);this.m_propertyTypeCategory===1?this.m_fallbackComplexTypeName=o:this.m_propertyTypeCategory===2&&(this.m_fallbackComplexTypeName=n.UtilityInternal.getTypeNameWithoutArraySuffix(u));this.m_apiFlags=s}return Object.defineProperty(t.prototype,"name",{get:function(){return this.m_name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lowerCaseName",{get:function(){return this.m_lowerCaseName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"camelLowerCaseName",{get:function(){return this.m_camelLowerCaseName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"propertyTypeCategory",{get:function(){return this.m_propertyTypeCategory},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"propertyTypeName",{get:function(){return this.m_propertyTypeName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReadonly",{get:function(){return this.m_isReadonly},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fallbackComplexTypeName",{get:function(){return this.m_fallbackComplexTypeName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dispatchId",{get:function(){return this.m_dispatchId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parameters",{get:function(){return this.m_parameters},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiName",{get:function(){return this.m_apiName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"apiFlags",{get:function(){return this.m_apiFlags},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"excludedFromDefaultLoad",{get:function(){return(this.m_apiFlags&256)!=0},enumerable:!0,configurable:!0}),t}();n.PropertyInformation=t})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(n){var t;(function(n){var t=function(){function n(){}return n.accessDenied="AccessDenied",n.apiNotFound="ApiNotFound",n.invalidArgument="InvalidArgument",n.invalidOperation="InvalidOperation",n.invalidRequest="InvalidRequest",n}();n.ResourceStrings=t})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(n){var t;(function(n){var t=function(){function t(){this.m_select=new n.SelectExpandQuery;this.m_expand=new n.SelectExpandQuery;this.m_top=0;this.m_skip=0}return Object.defineProperty(t.prototype,"top",{get:function(){return this.m_top},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skip",{get:function(){return this.m_skip},enumerable:!0,configurable:!0}),t.prototype.init=function(n,t,i,r){this.m_select.init(!0,n);this.m_expand.init(!1,t);this.m_top=i;this.m_skip=r},t.prototype.shouldSelectProperty=function(t,i){return(this.m_select.isEmpty||this.m_select.hasWildcard)&&!i?!0:this.m_select.properties[t]?!0:this.m_expand.properties[t]?!0:t==n.Constants.idLowerCase||t==n.Constants.idPrivateLowerCase||t==n.Constants.referenceIdLowerCase?!0:!1},t.prototype.shouldExpandProperty=function(n){return this.shouldSelectProperty(n,!1)&&(this.m_expand.properties[n]||this.m_select.properties[n])?!0:!1},t.prototype.createQueryForProperty=function(n){var i=new t;return this.m_select.properties[n]&&(i.m_select=this.m_select.properties[n]),this.m_expand.properties[n]&&(i.m_expand=this.m_expand.properties[n]),i},t}();n.RESTfulQuery=t})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(n){var t;(function(n){var t=function(){function t(){}return t.executeRichApiRequest=function(i,r,u,f){var o,e,s,h;return t.s_typeReg||(o=new n.TypeRegistration,r&&r(o),o.addAuxEnumTypes(),t.s_typeReg=o),e=new n.RichApiRequestContext(t.s_typeReg,i),e.request.init(f,u),s=n.Utility.createPromiseFromResult(null),e.request.requestType==0&&(h=new n.JsComRequestProcessor(e),s=h.process()),s.then(function(){return n.Utility.createPromiseFromResult(e.response.toArrayData())})},t.initEventManagerHost=function(i){t.s_eventManager||(t.s_eventManager=new n.EventManager);t.s_eventManager.initHost(i)},t.getEventManager=function(){return t.s_eventManager||(t.s_eventManager=new n.EventManager),t.s_eventManager},t}();n.RichApi=t})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(n){var t;(function(n){var t=function(n){function t(i,r,u,f){var e=n.call(this,r)||this;return Object.setPrototypeOf(e,t.prototype),e.name="OfficeExtension.WacRuntime.RichApiException",e.code=i,e.message=r,e.httpStatusCode=u,e.location=f,e}return __extends(t,n),t}(Error);n.RichApiException=t})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(n){var t;(function(n){var t=function(){function t(){}return t.prototype.init=function(t,i){this.m_globalObject=i;this.m_method=t[1];var r=t[2],u=r.indexOf("?");u>=0?(this.m_path=r.substr(0,u),this.m_query=r.substr(u+1)):(this.m_path=r,this.m_query="");this.m_requestType=this.m_method==n.Constants.httpMethodPost&&this.m_path==n.Constants.processQuery?0:1;this.m_body=t[4];this.m_requestFlags=t[6]},Object.defineProperty(t.prototype,"requestType",{get:function(){return this.m_requestType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"method",{get:function(){return this.m_method},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.m_path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"query",{get:function(){return this.m_query},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"body",{get:function(){return this.m_body},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requestFlags",{get:function(){return this.m_requestFlags},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"globalObject",{get:function(){return this.m_globalObject},enumerable:!0,configurable:!0}),t}();n.RichApiRequest=t})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(n){var t;(function(n){var t=function(){function t(){}return t.prototype.hostName=function(){return""},t.prototype.appId=function(){return""},t.prototype.createInstance=function(){throw n.Utility.createInvalidRequestException();},t}(),i=function(){function i(i,r){this.m_typeReg=i;this.m_request=new n.RichApiRequest;this.m_response=new n.RichApiResponse;r||(r=new t);this.m_richApiHost=r}return Object.defineProperty(i.prototype,"request",{get:function(){return this.m_request},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"response",{get:function(){return this.m_response},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"typeReg",{get:function(){return this.m_typeReg},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"host",{get:function(){return this.m_richApiHost},enumerable:!0,configurable:!0}),i}();n.RichApiRequestContext=i})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(n){var t;(function(n){var t=function(){function t(){this.m_writer=new n.JsonWriter}return t.prototype.reset=function(){var t=this.m_writer;return this.m_writer=new n.JsonWriter,t},Object.defineProperty(t.prototype,"writer",{get:function(){return this.m_writer},enumerable:!0,configurable:!0}),t.prototype.toArrayData=function(){var n=[];return n[0]=200,n[1]=null,n[2]=this.m_writer.getJsonString(),n},t}();n.RichApiResponse=t})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(n){var t;(function(n){var t=function(){function t(){this.m_hasWildcard=!1;this.m_properties={}}return Object.defineProperty(t.prototype,"hasWildcard",{get:function(){return this.m_hasWildcard},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){var n=!0;for(var t in this.m_properties){n=!1;break}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return this.m_properties},enumerable:!0,configurable:!0}),t.prototype.init=function(i,r){var o,f,h,s,u,e;if(r)for(o=0;o<r.length;o++)for(f=this,h=r[o].split("/"),s=0;s<h.length;s++)if(u=h[s],u=u.trim().toLowerCase(),u=="*"){if(!i)throw n.Utility.createInvalidRequestException();f.m_hasWildcard=!0}else e=f.m_properties[u],e||(e=new t,f.m_properties[u]=e),f=e},t}();n.SelectExpandQuery=t})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(n){var t;(function(n){var t=function(){function n(){}return n}();n.Settings=t;n.settings=new t})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(n){var t;(function(n){var t=function(){function n(){}return n.SendULSTraceTag=function(n,t,i,r){if(window.Microsoft&&Microsoft.Office&&Microsoft.Office.WebExtension&&Microsoft.Office.WebExtension.FULSSupported){var u=1403;if(t=="WordOnline")u=369;else if(t=="OneNoteOnline")u=372;else return;window.Diag&&Diag.UULS&&Diag.UULS.trace&&Diag.UULS.trace(r,u,i,n)}},n}();n.Logger=t})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(n){var t;(function(n){var t=function(){function t(t,i,r,u,f,e){this.m_name=t;this.m_interfaceId=i;this.m_classId=r;this.m_properties={};this.m_methods={};this.m_enumFields={};this.m_enumFieldLowerCaseNameToValue={};this.m_enumFieldValueToName={};this.m_isEnum=u;n.Utility.isNullOrUndefined(f)&&(f=3);this.m_typeCategory=f;n.Utility.isNullOrUndefined(e)&&(e=0);this.m_typeFlags=e}return Object.defineProperty(t.prototype,"name",{get:function(){return this.m_name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEnum",{get:function(){return this.m_isEnum},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isNullableEnum",{get:function(){return this.m_isNullableEnum},set:function(n){this.m_isNullableEnum=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classId",{get:function(){return this.m_classId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"interfaceId",{get:function(){return this.m_interfaceId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"typeCategory",{get:function(){return this.m_typeCategory},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"typeFlags",{get:function(){return this.m_typeFlags},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return this.m_properties},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"supportEnumeration",{get:function(){return this.m_supportEnumeration},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"childItemTypeName",{get:function(){return this.m_childItemTypeName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enumFields",{get:function(){return this.m_enumFields},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"arrayItemTypeInfo",{get:function(){return this.m_arrayItemTypeInfo},set:function(n){this.m_arrayItemTypeInfo=n},enumerable:!0,configurable:!0}),t.prototype.addProperty=function(t,i,r,u,f,e,o){var s=new n.PropertyInformation(this.m_name,t,i,r,u,f,e,o);return this.m_properties[t.toLowerCase()]=s,s},t.prototype.addMethod=function(t,i,r,u,f,e,o){var s=new n.MethodInformation(this.m_name,t,i,r,u,f,o);return this.m_methods[t.toLowerCase()]=s,s},t.prototype.addIndexerMethod=function(n,i,r,u){return this.addMethod(t.s_indexerMethodName,n,i,r,1,null,u)},t.prototype.addEnumField=function(n,t){this.m_enumFields[n]=t;this.m_enumFieldLowerCaseNameToValue[n.toLowerCase()]=t;this.m_enumFieldValueToName[t]=n},t.prototype.setRESTfulOperationMethodNames=function(n,t){this.m_createItemOperationName=n;this.m_deleteOperationName=t},t.prototype.setCollectionInfo=function(n,t){this.m_childItemTypeName=n;this.m_supportEnumeration=t},t.prototype.tryGetIndexerMethod=function(){return this.tryGetMethod(t.s_indexerMethodName)},t.prototype.getIndexerMethod=function(){return this.getMethod(t.s_indexerMethodName)},t.prototype.getMethod=function(t){var u=t.toLowerCase(),i=this.m_methods[u],r;if(!i){r=n.UtilityInternal.getApiName(this.m_name,t);throw n.Utility.createApiNotFoundException(r);}return i},t.prototype.tryGetMethod=function(n){return n=n.toLowerCase(),this.m_methods[n]},t.prototype.getProperty=function(t){var u=t.toLowerCase(),i=this.m_properties[u],r;if(!i){r=n.UtilityInternal.getApiName(this.m_name,t);throw n.Utility.createApiNotFoundException(r);}return i},t.prototype.tryGetProperty=function(n){return n=n.toLowerCase(),this.m_properties[n]},t.prototype.getEnumFieldValue=function(t){var i=this.m_enumFieldLowerCaseNameToValue[t.toLowerCase()];if(n.Utility.isUndefined(i))throw n.Utility.createInvalidRequestException();return i},t.prototype.getEnumFieldName=function(n){return this.m_enumFieldValueToName[n]},t.prototype.tryGetItemAtMethod=function(){return this.tryGetMethod(n.Constants.getItemAt)},t.s_indexerMethodName=".indexer",t}();n.TypeInformation=t})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(n){var t;(function(n){var t=function(){function t(){this.m_types={}}return t.prototype.getType=function(t){var i=this.m_types[t];if(!i)throw n.Utility.createInvalidRequestException();return i},t.prototype.tryGetType=function(n){return this.m_types[n]},t.prototype.addType=function(t,i,r,u,f){var e=new n.TypeInformation(t,i,r,!1,u,f);return this.m_types[t]=e,e},t.prototype.addEnumType=function(t){var i=new n.TypeInformation(t,null,null,!0,0,0);return this.m_types[t]=i,i},t.prototype.addAuxEnumTypes=function(){var e=[],l,i,t,r,o,s,u,f,h,c;for(l in this.m_types)t=this.m_types[l],t.isEnum&&!t.isNullableEnum&&e.push(t);for(i=0;i<e.length;i++){t=e[i];r=t.name;r=r+n.Constants.nullableTypeSuffix;o=this.addEnumType(r);o.isNullableEnum=!0;for(s in t.enumFields)o.addEnumField(s,t.enumFields[s]);u=t.name+n.Constants.arrayTypeSufix;f=new n.TypeInformation(u,null,null,!1,0,0);f.arrayItemTypeInfo=t;this.m_types[u]=f;h=u+n.Constants.arrayTypeSufix;c=new n.TypeInformation(h,null,null,!1,0,0);c.arrayItemTypeInfo=f;this.m_types[h]=c}},t}();n.TypeRegistration=t})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(n){var t;(function(t){var i=function(){function i(){}return i.isNullOrUndefined=function(n){return n===null?!0:typeof n=="undefined"?!0:!1},i.isUndefined=function(n){return typeof n=="undefined"?!0:!1},i.isNullOrEmptyString=function(n){return n===null?!0:typeof n=="undefined"?!0:n.length==0?!0:!1},i.trim=function(n){return n.replace(new RegExp("^\\s+|\\s+$","g"),"")},i.caseInsensitiveCompareString=function(n,t){return i.isNullOrUndefined(n)?i.isNullOrUndefined(t):i.isNullOrUndefined(t)?!1:n.toUpperCase()==t.toUpperCase()},i.createInvalidArgumentException=function(n){return new t.RichApiException(t.ErrorCodes.invalidArgument,i.getLocalizedString(t.ResourceStrings.invalidArgument,n))},i.createInvalidOperationException=function(){return new t.RichApiException(t.ErrorCodes.invalidOperation,i.getLocalizedString(t.ResourceStrings.invalidOperation))},i.createInvalidRequestException=function(){return new t.RichApiException(t.ErrorCodes.invalidRequest,i.getLocalizedString(t.ResourceStrings.invalidRequest))},i.createApiNotFoundException=function(n){return new t.RichApiException(t.ErrorCodes.apiNotFound,i.getLocalizedString(t.ResourceStrings.apiNotFound,n),i.httpStatusCode_BadRequest,n)},i.createRichApiException=function(n,i,r,u){return new t.RichApiException(n,i,r,u)},i.getLocalizedString=function(n,r){var u=n;return t.settings.getLocalizedStringFunc&&(u=t.settings.getLocalizedStringFunc(n)),i.isNullOrEmptyString(r)||(u=u.replace("{0}",r)),u},i.createPromise=function(t){return new n.Promise(t)},i.createPromiseFromResult=function(t){return new n.Promise(function(n){n(t)})},i.getAndValidateArgument=function(n,t,r){return i.validateArgument(n[t],r)},i.validateArgument=function(n,t){var r=n,u;if(i.isNullOrUndefined(n))r=t===i.s_expectedTypeInt?0:t===i.s_expectedTypeNumber?0:t===i.s_expectedTypeBoolean?!1:t===i.s_expectedTypeDate?new Date("1899-12-30T00:00:00.000Z"):null;else if(t!==i.s_expectedTypeAny)if(typeof t===i.s_scriptTypeFunction){if(!(n instanceof t))throw i.createInvalidArgumentException("value");}else if(t===i.s_expectedTypeInt||t===i.s_expectedTypeIntNullable){if(!i.isInt(r))throw i.createInvalidArgumentException("value");}else if(t===i.s_expectedTypeBoolean||t===i.s_expectedTypeBooleanNullable){if(typeof r!==i.s_scriptTypeBoolean)throw i.createInvalidArgumentException("value");}else if(t===i.s_expectedTypeNumber||t===i.s_expectedTypeNumberNullable){if(typeof r!==i.s_scriptTypeNumber)throw i.createInvalidArgumentException("value");}else if(t===i.s_expectedTypeDate||t===i.s_expectedTypeDateNullable){if(!(r instanceof Date))throw i.createInvalidArgumentException("value");}else if(t===i.s_expectedTypeString){if(typeof r!==i.s_scriptTypeString)throw i.createInvalidArgumentException("value");}else if(t.indexOf(i.s_expectedTypeArrayPrefix)===0){if(!Array.isArray(r))throw i.createInvalidArgumentException("value");}else if(t.indexOf(".")>0&&(u=i.getTypeFromTypeName(t),!(r instanceof u)))throw i.createInvalidArgumentException("value");return r},i.getTypeFromTypeName=function(n){var u=n.split("."),t,r;if(u.length==0)throw i.createInvalidOperationException();for(t=window,r=0;r<u.length;r++)if(t)t=t[u[r]];else throw i.createInvalidArgumentException("typeName");if(t&&typeof t===i.s_scriptTypeFunction)return t;throw i.createInvalidArgumentException("typeName");},i.isInt=function(n){return Number(n)===n&&n%1==0},i.httpStatusCode_BadRequest=400,i.s_expectedTypeInt="int",i.s_expectedTypeNumber="number",i.s_expectedTypeBoolean="boolean",i.s_expectedTypeString="string",i.s_expectedTypeDate="date",i.s_expectedTypeAny="any",i.s_expectedTypeArrayPrefix="Array<",i.s_expectedTypeNullableSuffix="?",i.s_expectedTypeIntNullable="int?",i.s_expectedTypeBooleanNullable="boolean?",i.s_expectedTypeNumberNullable="number?",i.s_expectedTypeDateNullable="date?",i.s_scriptTypeNumber="number",i.s_scriptTypeBoolean="boolean",i.s_scriptTypeString="string",i.s_scriptTypeFunction="function",i}();t.Utility=i})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(n){var t;(function(n){var t=function(){function t(){}return t.isUpper=function(n){return n==n.toUpperCase()},t.getApiName=function(n,i){var r=i,u;return(r==".indexer"&&(r="GetItem"),r=t.toCamelLowerCase(r),u=n.lastIndexOf("."),u>0)?n.substr(u+1)+"."+r:n+"."+r},t.toCamelLowerCase=function(n){for(var i=0,r;i<n.length&&t.isUpper(n.charAt(i));)i++;return i<n.length?(r=n.substr(0,i),r=r.toLowerCase(),r+n.substr(i)):n.toLowerCase()},t.getShortTypeName=function(n){var t=n.lastIndexOf(".");return t>0?n.substr(t+1):n},t.createObject=function(n,i){t.checkCreateObjectPermission(n,i);return n.host.createInstance(i.name)},t.constructLogMessage=function(n,t,i){var r={AppId:n.host.appId(),ExceptionCode:i.code,ExceptionMessage:i.message};return r[t]=i.location,JSON.stringify(r)},t.invokePropertyGet=function(i,r,u,f){var s=u.dispatchId,e,o;try{return t.logPropertyGetInvokeUsage(i,u),t.checkPropertyGetPermission(i,r,u),f.invokePropertyGet(s)}catch(h){e=t.convertToRichApiException(h);e.location=u.apiName;o=t.constructLogMessage(i,"PropertyGetError",e);n.Logger.SendULSTraceTag(o,i.host.hostName(),50,35211329);throw e;}},t.invokePropertyGetAsync=function(i,r,u,f){var e=u.dispatchId;return n.Utility.createPromiseFromResult(null).then(function(){return t.logPropertyGetInvokeUsage(i,u),t.checkPropertyGetPermission(i,r,u),f.invokePropertyGetAsync(e)})["catch"](function(r){var f=t.convertToRichApiException(r),e;f.location=u.apiName;e=t.constructLogMessage(i,"PropertyGetAsyncError",f);n.Logger.SendULSTraceTag(e,i.host.hostName(),50,35211330);throw f;})},t.logPropertyGetInvokeUsage=function(i,r){var u,f;!n.Utility.isNullOrEmptyString(r.apiName)&&(u=r.apiName.split("."),u.length>1&&u[1].charCodeAt(0)===t.s_underscoreCharCode)||(f=JSON.stringify({AppId:i.host.appId(),UsageDataType:1,MethodName:r.apiName}),n.Logger.SendULSTraceTag(f,i.host.hostName(),50,35211331))},t.getTypeNameWithoutArraySuffix=function(n){var t=n.indexOf("[");return t>0?n.substr(0,t):n},t.checkCreateObjectPermission=function(n,i){i.typeCategory===3&&(t.checkRestrictedResourceTypeFlags(n,i.typeFlags,i.name),t.checkMakerSafeTypeFlags(n,i.typeFlags,i.name))},t.checkPropertyGetPermission=function(n,i,r){i.typeCategory===3&&r.propertyTypeCategory===3&&(t.checkRestrictedResourceApiFlags(n,r.apiFlags,r.apiName),t.checkMakerSafeApiFlags(n,r.apiFlags,r.name,r.apiName))},t.checkPropertyWritePermission=function(n,i,r){if(i.typeCategory===3){if((n.request.requestFlags&1)==0)throw t.createAccessDeniedException(r.apiName);t.checkRestrictedResourceApiFlags(n,r.apiFlags,r.apiName);t.checkMakerSafeApiFlags(n,r.apiFlags,r.name,r.apiName)}},t.checkMethodPermission=function(n,i,r){if(i.typeCategory===3){if(r.methodOperationType!==1&&(n.request.requestFlags&1)==0)throw t.createAccessDeniedException(r.apiName);t.checkRestrictedResourceApiFlags(n,r.apiFlags,r.apiName);t.checkMakerSafeApiFlags(n,r.apiFlags,r.name,r.apiName)}},t.checkMakerSafeTypeFlags=function(n,i,r){if((n.request.requestFlags&1024)!=0&&(i&64)==0)throw t.createAccessDeniedException(r);},t.isSpecialApiNotRequirePermissionCheck=function(t){return t===n.Constants.getReferenceCount||t===n.Constants.removeReference||t===n.Constants.removeAllReferences||t===n.Constants.keepReference||t===n.Constants.onAccess},t.checkMakerSafeApiFlags=function(n,i,r,u){if((n.request.requestFlags&1024)!=0&&(i&128)==0&&!t.isSpecialApiNotRequirePermissionCheck(r))throw t.createAccessDeniedException(u);},t.checkRestrictedResourceTypeFlags=function(n,i,r){if((n.request.requestFlags&2)==0&&(i&2)!=0)throw t.createAccessDeniedException(r);},t.checkRestrictedResourceApiFlags=function(n,i,r){if((n.request.requestFlags&2)==0&&(i&4)!=0)throw t.createAccessDeniedException(r);},t.invokePropertySet=function(i,r,u,f,e,o){var c=u.dispatchId,s,h;try{o&&t.checkPropertyWritePermission(i,r,u);t.logPropertySetInvokeUsage(i,u);f.invokePropertySet(c,[e])}catch(l){s=t.convertToRichApiException(l);s.location=u.apiName;h=t.constructLogMessage(i,"PropertySetError",s);n.Logger.SendULSTraceTag(h,i.host.hostName(),50,35211332);throw s;}},t.invokePropertySetAsync=function(i,r,u,f,e){var o=u.dispatchId;return n.Utility.createPromiseFromResult(null).then(function(){return t.logPropertySetInvokeUsage(i,u),t.checkPropertyWritePermission(i,r,u),f.invokePropertySetAsync(o,[e])})["catch"](function(r){var f=t.convertToRichApiException(r),e;f.location=u.apiName;e=t.constructLogMessage(i,"PropertySetAsyncError",f);n.Logger.SendULSTraceTag(e,i.host.hostName(),50,35211333);throw f;})},t.logPropertySetInvokeUsage=function(t,i){var r=JSON.stringify({AppId:t.host.appId(),UsageDataType:2,MethodName:i.apiName});n.Logger.SendULSTraceTag(r,t.host.hostName(),50,35211334)},t.invokeMethod=function(i,r,u,f,e){var h=u.dispatchId,o,s;try{return t.logMethodInvokeUsage(i,u),t.checkMethodPermission(i,r,u),f.invokeMethod(h,e)}catch(c){o=t.convertToRichApiException(c);o.location=u.apiName;s=t.constructLogMessage(i,"MethodCallError",o);n.Logger.SendULSTraceTag(s,i.host.hostName(),50,35211335);throw o;}},t.invokeMethodAsync=function(i,r,u,f,e){var o=u.dispatchId;return n.Utility.createPromiseFromResult(null).then(function(){return t.logMethodInvokeUsage(i,u),t.checkMethodPermission(i,r,u),f.invokeMethodAsync(o,e)})["catch"](function(r){var f=t.convertToRichApiException(r),e;f.location=u.apiName;e=t.constructLogMessage(i,"MethodCallAsyncError",f);n.Logger.SendULSTraceTag(e,i.host.hostName(),50,35211336);throw f;})},t.logMethodInvokeUsage=function(i,r){var u,f;!n.Utility.isNullOrEmptyString(r.apiName)&&(u=r.apiName.split("."),u.length>1&&u[1].charCodeAt(0)===t.s_underscoreCharCode)||(f=JSON.stringify({AppId:i.host.appId(),UsageDataType:3,MethodName:r.apiName}),n.Logger.SendULSTraceTag(f,i.host.hostName(),50,35211337))},t.invokeGetAsyncEnumerator=function(n,t,i,r,u){return i.getAsyncEnumerator(r,u)},t.writeValue=function(i,r,u,f){var o,e,h,s;if(n.Utility.isNullOrUndefined(f)){i.writeValueNull();return}if(u&&(f=t.convertEnumValueToStringIfApplicable(u,f)),Array.isArray(f)){for(i.startArrayScope(),o=f,e=0;e<o.length;e++)t.writeValue(i,r,null,o[e]);i.endScope();return}if(typeof f=="object"&&typeof f.getTypeName=="function"){if(h=f.getTypeName(),s=r.typeReg.getType(h),s.typeCategory!=2)throw n.Utility.createInvalidOperationException();t.writeComplexTypeValue(i,r,f,s);return}i.writeValue(f)},t.writeComplexTypeValue=function(n,i,r,u){var e,o;n.startObjectScope();n.writeName("@odata.type");n.writeValue(u.name);e=(u.typeFlags&8)==8;for(o in u.properties){var f=u.properties[o],h=i.typeReg.tryGetType(f.propertyTypeName),s=t.invokePropertyGet(i,u,f,r);s===undefined&&e||(n.writeName(f.camelLowerCaseName),t.writeValue(n,i,h,s))}n.endScope()},t.convertEnumValueToStringIfApplicable=function(n,i){var f,u,r;if(n.isEnum&&typeof i=="number")return n.getEnumFieldName(i);if(Array.isArray(i)&&(f=n.arrayItemTypeInfo,f))for(u=i,r=0;r<u.length;r++)u[r]=t.convertEnumValueToStringIfApplicable(f,u[r]);return i},t.convertToRichApiException=function(t){var i,r;return t instanceof n.RichApiException?i=t:(r=t.message?t.message:t.toString(),i=new n.RichApiException(n.ErrorCodes.generalException,r)),i},t.createAccessDeniedException=function(t){var i=n.Utility.getLocalizedString(n.ResourceStrings.accessDenied);return n.Utility.createRichApiException(n.ErrorCodes.accessDenied,i,403,t)},t.s_underscoreCharCode="_".charCodeAt(0),t}();n.UtilityInternal=t})(t=n.WacRuntime||(n.WacRuntime={}))}(OfficeExtension||(OfficeExtension={})),function(){}(OfficeExtension||(OfficeExtension={})),function(n){var t,i;(function(n){n.OfficeRequire=function(){return null}()})(t=n._Internal||(n._Internal={})),function(n){var t;(function(n){function t(){return function(){"use strict";function lt(n){return typeof n=="function"||typeof n=="object"&&n!==null}function w(n){return typeof n=="function"}function at(n){return typeof n=="object"&&n!==null}function yt(n){b=n}function pt(n){u=n}function gt(){var t=process.nextTick,n=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(n)&&n[1]==="0"&&n[2]==="10"&&(t=window.setImmediate),function(){t(h)}}function ni(){var n=new MessageChannel;return n.port1.onmessage=h,function(){n.port2.postMessage(0)}}function ti(){return function(){setTimeout(h,1)}}function h(){for(var t,i,n=0;n<s;n+=2)t=f[n],i=f[n+1],t(i),f[n]=undefined,f[n+1]=undefined;s=0}function c(){}function ii(){return new TypeError("You cannot resolve a promise with itself")}function ri(){return new TypeError("A promises callback cannot return that same promise.")}function ui(n){try{return n.then}catch(t){return v.error=t,v}}function fi(n,t,i,r){try{n.call(t,i,r)}catch(u){return u}}function ei(t,r,f){u(function(t){var u=!1,e=fi(f,r,function(n){u||(u=!0,r!==n?a(t,n):i(t,n))},function(i){u||(u=!0,n(t,i))},"Settle: "+(t._label||" unknown promise"));!u&&e&&(u=!0,n(t,e))},t)}function oi(t,r){r._state===l?i(t,r._result):r._state===o?n(t,r._result):y(r,undefined,function(n){a(t,n)},function(i){n(t,i)})}function si(t,r){if(r.constructor===t.constructor)oi(t,r);else{var u=ui(r);u===v?n(t,v.error):u===undefined?i(t,r):w(u)?ei(t,r,u):i(t,r)}}function a(t,r){t===r?n(t,ii()):lt(r)?si(t,r):i(t,r)}function hi(n){n._onerror&&n._onerror(n._result);k(n)}function i(n,t){n._state===e&&(n._result=t,n._state=l,n._subscribers.length!==0&&u(k,n))}function n(n,t){n._state===e&&(n._state=o,n._result=t,u(hi,n))}function y(n,t,i,r){var f=n._subscribers,e=f.length;n._onerror=null;f[e]=t;f[e+l]=i;f[e+o]=r;e===0&&n._state&&u(k,n)}function k(n){var i=n._subscribers,e=n._state,r,u,f,t;if(i.length!==0){for(f=n._result,t=0;t<i.length;t+=3)r=i[t],u=i[t+e],r?rt(e,r,u,f):u(f);n._subscribers.length=0}}function it(){this.error=null}function ci(n,t){try{return n(t)}catch(i){return p.error=i,p}}function rt(t,r,u,f){var c=w(u),s,v,h,y;if(c){if(s=ci(u,f),s===p?(y=!0,v=s.error,s=null):h=!0,r===s){n(r,ri());return}}else s=f,h=!0;r._state!==e||(c&&h?a(r,s):y?n(r,v):t===l?i(r,s):t===o&&n(r,s))}function li(t,i){try{i(function(n){a(t,n)},function(i){n(t,i)})}catch(r){n(t,r)}}function r(t,r){var u=this;u._instanceConstructor=t;u.promise=new t(c);u._validateInput(r)?(u._input=r,u.length=r.length,u._remaining=r.length,u._init(),u.length===0?i(u.promise,u._result):(u.length=u.length||0,u._enumerate(),u._remaining===0&&i(u.promise,u._result))):n(u.promise,u._validationError())}function ai(n){return new ut(this,n).promise}function vi(t){function o(n){a(i,n)}function s(t){n(i,t)}var u=this,i=new u(c),f,r;if(!g(t))return n(i,new TypeError("You must pass an array to race.")),i;for(f=t.length,r=0;i._state===e&&r<f;r++)y(u.resolve(t[r]),undefined,o,s);return i}function yi(n){var i=this,t;return n&&typeof n=="object"&&n.constructor===i?n:(t=new i(c),a(t,n),t)}function pi(t){var r=this,i=new r(c);return n(i,t),i}function wi(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");}function bi(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");}function t(n){this._id=ht++;this._state=undefined;this._result=undefined;this._subscribers=[];c!==n&&(w(n)||wi(),this instanceof t||bi(),li(this,n))}var d,f,tt,p,ut,ft,et,ot,st,ht,ct;d=Array.isArray?Array.isArray:function(n){return Object.prototype.toString.call(n)==="[object Array]"};var g=d,s=0,ki={}.toString,vt,b,u=function(n,t){f[s]=n;f[s+1]=t;s+=2;s===2&&(b?b(h):tt())};var wt=typeof window!="undefined"?window:undefined,nt=wt||{},bt=nt.MutationObserver||nt.WebKitMutationObserver,kt=typeof process!="undefined"&&{}.toString.call(process)==="[object process]",dt=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined";f=new Array(1e3);tt=kt?gt():dt?ni():ti();var e=void 0,l=1,o=2,v=new it;return p=new it,r.prototype._validateInput=function(n){return g(n)},r.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},r.prototype._init=function(){this._result=new Array(this.length)},ut=r,r.prototype._enumerate=function(){for(var n=this,i=n.length,r=n.promise,u=n._input,t=0;r._state===e&&t<i;t++)n._eachEntry(u[t],t)},r.prototype._eachEntry=function(n,t){var i=this,r=i._instanceConstructor;at(n)?n.constructor===r&&n._state!==e?(n._onerror=null,i._settledAt(n._state,t,n._result)):i._willSettleAt(r.resolve(n),t):(i._remaining--,i._result[t]=n)},r.prototype._settledAt=function(t,r,u){var f=this,s=f.promise;s._state===e&&(f._remaining--,t===o?n(s,u):f._result[r]=u);f._remaining===0&&i(s,f._result)},r.prototype._willSettleAt=function(n,t){var i=this;y(n,undefined,function(n){i._settledAt(l,t,n)},function(n){i._settledAt(o,t,n)})},ft=ai,et=vi,ot=yi,st=pi,ht=0,ct=t,t.all=ft,t.race=et,t.resolve=ot,t.reject=st,t._setScheduler=yt,t._setAsap=pt,t._asap=u,t.prototype={constructor:t,then:function(n,t){var f=this,i=f._state,r,e,s;return i===l&&!n||i===o&&!t?this:(r=new this.constructor(c),e=f._result,i?(s=arguments[i-1],u(function(){rt(i,r,s,e)})):y(f,r,n,t),r)},"catch":function(n){return this.then(null,n)}},ct}.call(this)}n.Init=t})(t=n.PromiseImpl||(n.PromiseImpl={}))}(t=n._Internal||(n._Internal={})),function(n){function t(){var n=window.navigator.userAgent,t=n.indexOf("Edge/");return t>=0?(n=n.substring(t+5,n.length),n<"14.14393"?!0:!1):!1}function i(){return typeof window=="undefined"&&typeof Promise=="function"?Promise:typeof window!="undefined"&&window.Promise?t()?n.PromiseImpl.Init():window.Promise:n.PromiseImpl.Init()}n.OfficePromise=i()}(t=n._Internal||(n._Internal={}));i=t.OfficePromise;n.Promise=i}(OfficeExtension||(OfficeExtension={}));Type.registerNamespace("_Ewa");_Ewa.ri=function(n){_Ewa.ri.initializeBase(this,[n])};_Ewa.ri.a=function(n){_Ewa.ba.a(82,new _Ewa.ri(n))};_Ewa.ri.prototype={l:function(){var n=_Ewa.k.a(_Ewa.bA,this.h.b(),106,this.du(),-2),r=_Ewa.k.a(Sys.IDisposable,this.h.b(),165,this.du(),-2),t=this,i,u;_Ewa.f.cw(_Ewa.f.ws([n,r],this.du(),3),function(){var i=n.a(),r=Common.Utils.a.a().a(Common.App.NewAndOpen.UX.c);t.k([new _Ewa.bf(t.h,i,r)],null)},this.du(),3);i=Common.Utils.a.a();u=this;_Ewa.f.c(_Ewa.k.a(Common.Q,this.h.b(),137,this.h.i(),-2),function(){i.b(_Ewa.qo).a().b(function(){return new _Ewa.qo})},this.h.i())}};_Ewa.TZ=function(){};_Ewa.TZ.a=function(){_Ewa.j.a(_Ewa.ri.a)};_Ewa.dA=function(){};_Ewa.dA.j=function(n,t,i,r,u,f,e,o,s,h){var c=n.a(1,null);return c.controlId=t,c.coerceType=i,c.valueFormat=r,c.filterType=u,c.currentSheetName=f,c.formula=e,_Ewa.i.a(n,"DdaGetSelectedData",c,o,s,h,0,null)};_Ewa.dA.o=function(n,t,i,r,u,f,e,o){var s=n.a(9,null);return s.controlId=t,s.currentSheetName=i,s.formula=r,s.bindingData=u,_Ewa.i.a(n,"DdaSetSelectedData",s,f,e,o,0,null)};_Ewa.dA.c=function(n,t,i,r,u,f,e,o,s,h){var c=n.a(9,null);return c.controlId=t,c.bindingId=i,c.bindingType=r,c.currentSheetName=u,c.formula=f,c.options=e,_Ewa.i.a(n,"DdaAddBinding",c,o,s,h,0,null)};_Ewa.dA.h=function(n,t,i,r,u,f){var e=n.a(1,null);return e.controlId=t,e.bindingId=i,_Ewa.i.a(n,"DdaGetBinding",e,r,u,f,0,null)};_Ewa.dA.k=function(n,t,i,r,u,f){var e=n.a(9,null);return e.controlId=t,e.bindingId=i,_Ewa.i.a(n,"DdaReleaseBinding",e,r,u,f,0,null)};_Ewa.dA.i=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){var y=n.a(1,null);return y.controlId=t,y.bindingId=i,y.coerceType=r,y.valueFormat=u,y.filterType=f,y.startRow=e,y.startCol=o,y.rowCount=s,y.colCount=h,y.currentSheetName=c,_Ewa.i.a(n,"DdaGetBindingData",y,l,a,v,0,null)};_Ewa.dA.m=function(n,t,i,r,u,f,e,o,s,h){var c=n.a(9,null);return c.controlId=t,c.bindingId=i,c.startRow=r,c.startCol=u,c.currentSheetName=f,c.bindingData=e,_Ewa.i.a(n,"DdaSetBindingData",c,o,s,h,0,null)};_Ewa.dA.g=function(n,t,i,r,u){var f=n.a(1,null);return f.controlId=t,_Ewa.i.a(n,"DdaGetAllBindings",f,i,r,u,0,null)};_Ewa.dA.b=function(n,t,i,r,u){var f=n.a(1,null);return f.controlId=t,_Ewa.i.a(n,"DdaLoadSettings",f,i,r,u,0,null)};_Ewa.dA.l=function(n,t,i,r,u,f,e){var o=n.a(9,null);return o.controlId=t,o.settings=i,o.overwriteIfStale=r,_Ewa.i.a(n,"DdaSaveSettings",o,u,f,e,0,null)};_Ewa.dA.d=function(n,t,i,r,u,f,e,o,s){var h=n.a(9,null);return h.controlId=t,h.bindingId=i,h.isRow=r,h.currentSheetName=u,h.bindingData=f,_Ewa.i.a(n,"DdaAddRowsColumns",h,e,o,s,0,null)};_Ewa.dA.f=function(n,t,i,r,u,f,e){var o=n.a(9,null);return o.controlId=t,o.bindingId=i,o.currentSheetName=r,_Ewa.i.a(n,"DdaDeleteAllDataValues",o,u,f,e,0,null)};_Ewa.dA.e=function(n,t,i,r,u,f,e){var o=n.a(9,null);return o.controlId=t,o.bindingId=i,o.currentSheetName=r,_Ewa.i.a(n,"DdaClearBindingFormats",o,u,f,e,0,null)};_Ewa.dA.n=function(n,t,i,r,u,f,e,o,s){var h=n.a(9,null);return h.controlId=t,h.bindingId=i,h.currentSheetName=r,h.bindingData=u,h.isSetFormats=f,_Ewa.i.a(n,"DdaSetBindingFormats",h,e,o,s,0,null)};_Ewa.dA.a=function(n,t,i,r,u){var f=n.a(1,null);return f.request=t,_Ewa.i.a(n,"ExecuteRichApiRequest",f,i,r,u,0,null)};_Ewa.Am=function(n,t,i,r){_Ewa.Am.initializeBase(this,[n,"Select Data",3,null,"",!1]);this.x=n;this.K=t;this.y=i;this.z=r};_Ewa.Am.prototype={K:null,y:null,b:null,z:null,e:function(){return"DdaBindingPrompt"},x:null,P:function(n,t){var r="<div class='ewa-dlg-ddaprompt-body-sectionlabel ewa-scrollbars'><label for='{1}'>{0}<\/label><\/div>\r\n<div><input type='text' id='{1}' maxlength='388' class='ewa-dlg-body-fullLine' /><\/div>",i,f,u;r=String.format(r,Common.e.b(this.y.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.B.innerHTML=r;this.b=_Ewa.a.a(this.B,"bindingText");i=(!t||!t.length)?null:n.z(t,this.y.DdaBindingsMethod.BindingId);i&&i.IsValidRef?(f=new _Ewa.o(i.Reference.FirstRow+1,i.Reference.FirstColumn+1,i.Reference.LastRow+1,i.Reference.LastColumn+1,!1,!1),this.b.value=i.Reference.SheetName+"!"+f):(u=_Ewa.b.a(this.x).a(),this.b.value=_Ewa.A.a(this.x.j())||this.x.a(475)&&!u.d().b()?"":u.o());this.C();this.w(!1)},H:function(){this.cB();this.I(0,0,!1,!1);this.I(1,0,!1,!1);_Ewa.bY.prototype.H.call(this)},G:function(){_Ewa.a.c(this.b,!1)},bm:function(){return!0},L:function(){var n=this.b.value.trim(),t=n.indexOf("!");return t!==-1&&(n=this.O(n.substring(0,t))+n.substr(t)),this.K.k(this.y,n,0,this.z),!0},bA:function(){this.K.b.a(5001,this.z);_Ewa.bY.prototype.bA.call(this)},O:function(n){var t=_Ewa.e.p(n.trim(),"=");return t.length?t.startsWith("'")&&t.endsWith("'")?t:_Ewa.l.t(t,!1):""}};_Ewa.An=function(n){this.e=n};_Ewa.An.prototype={e:null,a:function(n,t){if(t){var i={};i.Error=n;i.Version=this.e.e();t(i)}},b:function(n,t,i){var r;r=_Ewa.iW.b(n.Errors[0].MessageId);this.a(r,i)},d:function(n){n&&n(this.c())},c:function(){var n={};return n.Error=0,n.Version=this.e.e(),n}};_Ewa.bf=function(n,t,i){this.a=n;this.d=t;this.b=new _Ewa.An(n.c());this.c=new _Ewa.Ao(n,this.b);this.j=i;this.h=new($$sc.o.$$(String,String))($$sc.e.b())};_Ewa.bf.o=function(){return _Ewa.bf.a||(_Ewa.bf.a={},_Ewa.bf.a[Microsoft.Office.WebExtension.CoercionType.Table]=1,_Ewa.bf.a[Microsoft.Office.WebExtension.CoercionType.Text]=2,_Ewa.bf.a[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,_Ewa.bf.a[Microsoft.Office.WebExtension.CoercionType.Html]=4,_Ewa.bf.a[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5),_Ewa.bf.a};_Ewa.bf.p=function(){return _Ewa.bf.b||(_Ewa.bf.b={},_Ewa.bf.b[Microsoft.Office.WebExtension.FilterType.All]=1,_Ewa.bf.b[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2),_Ewa.bf.b};_Ewa.bf.q=function(){return _Ewa.bf.c||(_Ewa.bf.c={},_Ewa.bf.c[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,_Ewa.bf.c[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1),_Ewa.bf.c};_Ewa.bf.l=function(n){var i,t;if(!n||!n.length)return null;for(i=new Array(n.length/2),t=0;t<n.length/2;t++)i[t]={},i[t].Name=n[t*2],i[t].Value=n[t*2+1];return i};_Ewa.bf.r=function(n){var i,t;if(!n||!n.length)return null;for(i=new Array(n.length*2),t=0;t<n.length;t++)i[t*2]=n[t].Name,i[t*2+1]=n[t].Value;return i};_Ewa.bf.i=function(n){var r,t,f,u,i;if(!n||!n.length)return null;for(r=new Array(n.length),t=0,f=n.length;t<f;t++)if(u=n[t].length,u)for(r[t]=new Array(u),i=0;i<u;i++)r[t][i]=n[t][i]==null?null:n[t][i].toString();else return null;return r};_Ewa.bf.e=function(n){return String.isInstanceOfType(n)?_Ewa.u.c(_Ewa.bf.o(),n,0):n};_Ewa.bf.k=function(n){return String.isInstanceOfType(n)?_Ewa.u.c(_Ewa.bf.p(),n,0):n};_Ewa.bf.n=function(n){return String.isInstanceOfType(n)?_Ewa.u.c(_Ewa.bf.q(),n,0):n};_Ewa.bf.s=function(n){switch(n.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1};_Ewa.bf.h=function(n,t){var i={};return i.CoerceType=n,i.CoerceType===1?(i.Data=_Ewa.bf.i(t.Rows),i.Headers=_Ewa.bf.i(t.Headers)):i.Data=_Ewa.bf.i(t),i};_Ewa.bf.j=function(n){return n.CoerceType===1?{Headers:n.Headers,Rows:n.Data}:n.Data};_Ewa.bf.f=function(n){return n.CoerceType===1?!n.Data&&!n.Headers:!n.Data};_Ewa.bf.m=function(n){var i="Unknown",t;if(!n)return i;for(t=0;t<n.length;t++)if(n[t].Name.toLowerCase()==="sdkversion"){i=n[t].Value;break}return i};_Ewa.bf.d=function(n,t,i,r){var u={};return u.Code=n,u.Message=t,u.Location=i,u.ActionIndex=r,u};_Ewa.bf.prototype={h:null,d:null,b:null,c:null,j:null,a:null,dispose:function(){this.h=null;this.a=null},w:function(){return!1},v:function(){return!1},u:function(n,t,i){var r=t.a;switch(r){case 451041795:this.b.a(i.CommandValueId,i.DdaMethodCallback);break;case 974713501:this.J(i.CommandValueId,i.DdaMethodCallback);break;case 1237877382:this.b.d(i.DdaMethodCallback);break;default:return _Ewa.K.a(r)}return $$sc.a.a(Boolean,!0)},t:function(n,t,i){var r=!!i;if(r)switch(t.a){case 974713501:case 1237877382:case 451041795:break;default:r=!1}return r},J:function(n,t){var i=n.DdaMethod,r,u;if(typeof i.DispatchId=="undefined"){this.b.a(5001,t);return}if(!_Ewa.bf.s(n)&&!(this.a.r()&1)){this.b.a(5002,t);return}i.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(r=new _Ewa.Am(this.a,this,n,t),r.P(this.d,n.DdaMethod.ControlId)):i.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.H(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.X(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?this.k(n,this.l(n.DdaMethod.ControlId,!1),0,t):i.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.D(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.V(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.C(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.S(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.A(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?this.L(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.U(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(n.DdaAddRowsColumns.IsRow=!0,this.n(n,t)):i.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(n.DdaAddRowsColumns.IsRow=!1,this.n(n,t)):i.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.s(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.q(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?(n.DdaSetBindingFormats.IsSetFormats=!0,this.p(n,t)):i.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(n.DdaSetBindingFormats.IsSetFormats=!1,this.p(n,t)):i.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?(u=n.DdaBindingsMethod.FailOnCollision?2:1,this.k(n,n.DdaBindingsMethod.ItemName,u,t)):i.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.G(t):i.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.O(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.y(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.E(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.F(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.T(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(n.DdaMethod.ControlId,n),this.b.d(t)):i.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?this.a.a(33)?this.b.a(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,t):this.N(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?this.a.a(33)?this.b.a(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,t):this.M(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.z(n,t):i.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?this.B(n,t):this.b.a(5e3,t)},D:function(n,t){var i,r,u;(n.DdaGetBindingData.CoerceType=_Ewa.bf.e(n.DdaGetBindingData.CoerceType),n.DdaGetBindingData.FilterType=_Ewa.bf.k(n.DdaGetBindingData.FilterType),n.DdaGetBindingData.ValueFormat=_Ewa.bf.n(n.DdaGetBindingData.ValueFormat),this.i(n.DdaGetBindingData.CoerceType,t))&&(n.DdaGetBindingData&&(i=n.DdaGetBindingData,i.FilterType||(i.FilterType=2),i.StartCol=i.StartCol|0,i.StartRow=i.StartRow|0,i.ColCount=isUndefined(i.ColCount)?-1:i.ColCount,i.RowCount=isUndefined(i.RowCount)?-1:i.RowCount),r=this,u=function(n,i,u){if(_Ewa.S.a(n)||!n.Result)r.b.b(n,u,t);else{var f=r.b.c();f.Data=_Ewa.bf.j(n.Result);t(f)}},this.c.g(n.DdaMethod.ControlId,n.DdaGetBindingData.BindingId,n.DdaGetBindingData.CoerceType,n.DdaGetBindingData.ValueFormat,n.DdaGetBindingData.FilterType,n.DdaGetBindingData.StartRow,n.DdaGetBindingData.StartCol,n.DdaGetBindingData.RowCount,n.DdaGetBindingData.ColCount,u,t))},V:function(n,t){var i,r,u;if(n.DdaSetBindingData.CoerceType=_Ewa.bf.e(n.DdaSetBindingData.CoerceType),this.i(n.DdaSetBindingData.CoerceType,t)){if(i=_Ewa.bf.h(n.DdaSetBindingData.CoerceType,n.DdaSetBindingData.Data),_Ewa.bf.f(i)){this.b.a(2e3,t);return}i.CoerceType===1&&(i.CellFormat||(i.CellFormat=n.DdaSetBindingData.CellFormat),i.TableOptions||(i.TableOptions=n.DdaSetBindingData.TableOptions));n.DdaSetBindingData&&(n.DdaSetBindingData.StartCol=n.DdaSetBindingData.StartCol|0,n.DdaSetBindingData.StartRow=n.DdaSetBindingData.StartRow|0);r=this;u=function(n,i,u){_Ewa.S.a(n)?r.b.b(n,u,t):r.b.d(t)};this.c.q(n.DdaMethod.ControlId,n.DdaSetBindingData.BindingId,n.DdaSetBindingData.StartRow,n.DdaSetBindingData.StartCol,i,u,t)}},H:function(n,t){var i,r,u;if(n.DdaGetBindingData.CoerceType=_Ewa.bf.e(n.DdaGetBindingData.CoerceType),n.DdaGetBindingData.ValueFormat=_Ewa.bf.n(n.DdaGetBindingData.ValueFormat),n.DdaGetBindingData.FilterType=_Ewa.bf.k(n.DdaGetBindingData.FilterType),this.i(n.DdaGetBindingData.CoerceType,t)){if(i=this.l(n.DdaMethod.ControlId,!1),!i||!i.length){this.b.a(1001,t);return}r=this;u=function(n,i,u){if(_Ewa.S.a(n))r.b.b(n,u,t);else{var f=r.b.c();f.Data=_Ewa.bf.j(n.Result);t(f)}};this.c.m(n.DdaMethod.ControlId,n.DdaGetBindingData.CoerceType,n.DdaGetBindingData.ValueFormat,n.DdaGetBindingData.FilterType,i,u,t)}},E:function(n,t){var i;if(Common.c.K()){this.b.a(5009,t);return}var o=n,s=o[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],u=o[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],h=n.DdaMethod.ControlId,c=_Ewa.fB.a(this.a);if(u<=0){Diag.a.a(8946265,344,15,"Invalid slice size. It should be greater than 0.");this.b.a(11002,t);return}if(u>4194304){Diag.a.a(8946266,344,15,"Invalid slice size. It should be not greater than 4MB.");this.b.a(1008,t);return}i=null;switch(s){case 1:i="Compressed";break;case 0:i="Text";break;case 2:i="Pdf";break;default:Diag.a.a(8946267,344,15,"Requested file type {0} is not supported.",s);this.b.a(1009,t);return}if(i==="Text"){Diag.a.a(8946268,344,15,"Requested file type {0} is not supported.",i);this.b.a(1009,t);return}var l=_Ewa.uC.a(this.a,i,!1),e=null,r=new XMLHttpRequest,f=this;r.onreadystatechange=function(){var l,n,a,d,v,s,g,y,nt,tt;if(r.readyState===4)if(r.status===200){if(l=r.response,!l){Diag.a.a(8946269,344,15,"Request is successful, but respone have no data for file type {0}.",i);f.b.a(5001,t);return}e=new Uint8Array(l);var p=f.b.c(),w=p,o=e.length,b=++_Ewa.fB.b,k={},it=0;for(n=0;n<o;n=n+u){for(a=[],d=n+u<o?n+u:o,v=0,s=n;s<d;v++,s++)a[v]=e[s];k[(it++).toString()]=a}if(g=new _Ewa.Ap(b,o,u,k),y=c.d(h,g),y){f.b.a(y,t);return}w[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=b;w[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=o;Diag.a.a(8946270,344,50,"GetFileAsync get file successfully for file type {0}, the file size is {1}",i,o);t(p)}else r.status===500?(nt=parseInt(r.statusText),tt=_Ewa.iW.b(nt),f.b.a(tt,t)):(Diag.a.a(8946271,344,15,"Request failed to obtain the file for type {0}.",i),f.b.a(11001,t))};r.open("GET",l,!0);r.responseType="arraybuffer";r.setRequestHeader("If-Modified-Since","0");r.send(null)},F:function(n,t){var u=n,h=u[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],i=u[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()],c=n.DdaMethod.ControlId,l=_Ewa.fB.a(this.a),f=l.e(c,h),r;if(!f){this.b.a(5001,t);return}if(r=f.b,i<0||i>=Object.keys(r).length){this.b.a(5008,t);return}var e=r[i.toString()],o=this.b.c(),s=o;s[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=e;s[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=e.length;t(o)},T:function(n,t){var r=n,u=r[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],f=n.DdaMethod.ControlId,e=_Ewa.fB.a(this.a),i=e.g(f,u);i?this.b.a(i,t):this.b.d(t)},X:function(n,t){var f,i,r;if(n.DdaSetBindingData.CoerceType=_Ewa.bf.e(n.DdaSetBindingData.CoerceType),this.i(n.DdaSetBindingData.CoerceType,t)){if(f=this.l(n.DdaMethod.ControlId,!1),!f||!f.length){this.b.a(2001,t);return}if(i=_Ewa.bf.h(n.DdaSetBindingData.CoerceType,n.DdaSetBindingData.Data),r=_Ewa.b.a(this.a).a(),i.CoerceType===1&&((!i.Data&&this.a.a(475)?r.d().d():r.a().j())&&(i.Headers||(i.Headers=[]),i.Headers.length||Array.add(i.Headers,[]),i.Headers[0].length||Array.add(i.Headers[0],"")),_Ewa.bf.f(i)||(i.CellFormat||(i.CellFormat=n.DdaSetBindingData.CellFormat),i.TableOptions||(i.TableOptions=n.DdaSetBindingData.TableOptions))),_Ewa.bf.f(i)){this.b.a(2e3,t);return}var e=r.a().f(),o=r.c().f(),u=this,s=function(n,f,s){var h,c,l;_Ewa.S.a(n)?u.b.b(n,s,t):(u.a.isChangeGateEnabled("OfficeVSO:4013390_FixDdaMethodHandlerSetSelectedDataActiveCell")||(e=u.a.a(475)?r.d().c().f():r.a().f()),h=e.f(),c=i.Headers?i.Headers[0].length:i.Data[0].length,i.CoerceType!==1||i.Data?i.CoerceType===1&&i.TableOptions&&i.TableOptions.length&&i.TableOptions[0]==!1?(h.a=h.a+1,h.d=h.a+i.Data.length-1,h.c=h.b+c-1):(h.d=h.a+i.Data.length-(i.CoerceType===1?0:1),h.c=h.b+c-1):(h.d=h.a+1,h.c=h.b+c-1),l=u.a.isChangeGateEnabled("OfficeVSO:4013390_FixDdaMethodHandlerSetSelectedDataActiveCell")?h.i(o)?o:h.e():e,r.f(h,l,0,0,!0,"",!1,!0,!0),u.b.d(t))};this.c.s(n.DdaMethod.ControlId,f,i,s,t)}},k:function(n,t,i,r){if(!t){this.b.a(3e3,r);return}var u=this,f=function(n,t,i){if(_Ewa.S.a(n))u.b.b(n,i,r);else{var f=u.b.c();f.Bindings=new Array(1);f.Bindings[0]=u.d.k(n.Result);r(f)}};this.c.h(n.DdaMethod.ControlId,n.DdaBindingsMethod.BindingId,n.DdaBindingsMethod.BindingType,t,i,f,r)},C:function(n,t){var i=this,r=function(n,r,u){if(_Ewa.S.a(n)||!n.Result)i.b.b(n,u,t);else{var f=i.b.c();f.Bindings=new Array(1);f.Bindings[0]=i.d.k(n.Result);t(f)}};this.c.f(n.DdaMethod.ControlId,n.DdaBindingsMethod.BindingId,r,t)},G:function(n){var t=this.b.c(),r=t,i={};i[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.a.l().ClientUrl;r[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=i;n(t)},S:function(n,t){var i=this,r=function(n,r,u){_Ewa.S.a(n)?i.b.b(n,u,t):i.b.d(t)};this.c.o(n.DdaMethod.ControlId,n.DdaBindingsMethod.BindingId,r,t)},A:function(n,t){var i=this,r=function(n,r,u){var f,o,e;if(_Ewa.S.a(n))i.b.b(n,u,t);else{if(f=i.b.c(),n.Result)for(o=n.Result,f.Bindings=new Array(o.length),e=0;e<o.length;e++)f.Bindings[e]=i.d.k(o[e]);else f.Bindings=null;t(f)}};this.c.l(n.DdaMethod.ControlId,r,t)},L:function(n,t){var i=this,r=function(n,r,u){if(_Ewa.S.a(n))i.b.b(n,u,t);else{var f=i.b.c();f.Properties=n.Result;t(f)}};this.c.n(n.DdaMethod.ControlId,r,t)},U:function(n,t){var f=this,e=function(n,i,r){_Ewa.S.a(n)?f.b.b(n,r,t):f.b.d(t)},u={},i,r;for(u.Settings=[],i=0;i<n.DdaSettingsMethod.Properties.length;i++)r={},r.Name=n.DdaSettingsMethod.Properties[i][0],r.Value=n.DdaSettingsMethod.Properties[i][1],u.Settings[i]=r;this.c.p(n.DdaMethod.ControlId,u,n.DdaSettingsMethod.OverwriteIfStale,e,t)},n:function(n,t){var r=_Ewa.bf.h(1,n.DdaAddRowsColumns.Data),i,u;if(_Ewa.bf.f(r)){this.b.a(2e3,t);return}i=this;u=function(n,r,u){_Ewa.S.a(n)?i.b.b(n,u,t):i.b.d(t)};this.c.i(n.DdaMethod.ControlId,n.DdaAddRowsColumns.BindingId,n.DdaAddRowsColumns.IsRow,r,u,t)},s:function(n,t){var i=this,r=function(n,r,u){_Ewa.S.a(n)?i.b.b(n,u,t):i.b.d(t)};this.c.k(n.DdaMethod.ControlId,n.DdaBindingsMethod.BindingId,r,t)},q:function(n,t){var i=this,r=function(n,r,u){_Ewa.S.a(n)?i.b.b(n,u,t):i.b.d(t)};this.c.j(n.DdaMethod.ControlId,n.DdaClearBindingFormats.BindingId,r,t)},p:function(n,t){var i={},u=n.DdaSetBindingFormats.IsSetFormats,r,f;u?i.CellFormat=n.DdaSetBindingFormats.CellFormat:i.TableOptions=n.DdaSetBindingFormats.TableOptions;r=this;f=function(n,i,u){_Ewa.S.a(n)?r.b.b(n,u,t):r.b.d(t)};this.c.r(n.DdaMethod.ControlId,n.DdaSetBindingFormats.BindingId,i,u,f,t)},y:function(n,t){var e=n.ArrayData,r={},f=_Ewa.b.a(this.a).a(),h,c,v,s,a,u,y,l,o;if(e){if(e[0]==="WacPartition"){this.x(n,t);return}if(h=$$as(_Ewa.Y,_Ewa.cd.a(this.a)),e[0]==="SetOsfControlContainerReadyForCustomFunctions"&&(c=h.Q(n.DdaMethod.ControlId),c&&(c.w=!0,c.R())),r.HttpMethod=e[1],r.PathAndQuery=e[2],r.RequestHeaders=_Ewa.bf.l(e[3]),r.RequestBody=e[4],r.AppPermission=e[5],v=e[6],r.RequestFlags=v,s=0,_Ewa.A.d(this.a.j()))switch(f.e()){case 1:s=2;break;case 2:s=3;break;case 128:s=4;break;default:s=1}if(a=null,f.b().e()&&(a=f.b().e().L()),this.a.isChangeGateEnabled("OfficeVSO:4040030_RichApiGetSelectedRanges")?r.SheetMultiRange=this.a.a(475)?_Ewa.g.e(f.d().a(),this.a):_Ewa.g.d(f.a(),this.a):r.SheetRange=this.a.a(475)?_Ewa.g.a(f.d().c(),this.a):_Ewa.g.a(f.a(),this.a),r.ActiveCell=_Ewa.g.a(f.c(),this.a),r.ActiveChartId=a,r.SelectionState=s,u=this.d.b(n.DdaMethod.ControlId),r.InstanceId=u?u.InstanceId:"",u&&u.PrimaryMarketplace){if(y=_Ewa.Y.a(u,this.a),l=u.PrimaryMarketplace.MarketplaceType,l===OSF.StoreType.InMemory){if(!u.OwnerAddinAssetId){this.b.a(5004,t);return}if(u.AssetMarketplace)l=u.AssetMarketplace.MarketplaceType;else{this.b.a(5004,t);return}}r.SolutionId=y;r.MarketplaceType=l;r.SolutionVersion=u.PrimaryMarketplace.SolutionVersion;r.StoreLocation=u.PrimaryMarketplace.MarketplaceRef}else r.SolutionId=r.MarketplaceType="";r.IsEventsEnabled=isNullOrUndefined(h)||h.S.e(r.InstanceId);r.RequestGuid=Common.F.a().a}o=_Ewa.bf.m(r.RequestHeaders);_Ewa.bf.g++;var p=_Ewa.v.a().a(),i=this,b=function(n,u,e){var s,y,b,w,g,tt,it,a,ct,ft,et,lt;i.o(p,!0,n.ServerCorrelationId);var d=null,ot=null,v=n.ServerCorrelationId;if(n&&n.Errors&&n.Errors[0]&&(d=n.Errors[0].MessageIdName,ot=n.Errors[0].Description),_Ewa.S.a(n)||!n.Result)i.e(v,o,"Server error",d,ot),i.b.b(n,e,t);else{if(s=null,i.a.a(330))if(y=n.Result,y&&y.length){for(b=0;b<y.length;b++)if(y[b].RequestGuid===r.RequestGuid){s=y[b];break}s||i.b.b(n,e,t)}else s=n.Result;else s=n.Result;if(!d&&s&&s.ResponseBody&&!_Ewa.e.a(s.ResponseBody[0]))if(w=s.ResponseBody[0],w.startsWith('{"Error":')){s.ResponseBody.length>1&&(w=w.substring(0,w.indexOf("}")+1)+"}");try{g=_Ewa.H.b(w);g.Error&&i.e(v,o,"Pipeline error",g.Error.Code,g.Error.Message)}catch(yt){i.e(v,o,"Json deserialize error",null,"Error info cannot be deserialized.")}}else i.e(v,o,null,null,null);else i.e(v,o,"Server error",d,ot);if(i.a.isChangeGateEnabled("OfficeVSO:4040030_RichApiGetSelectedRanges")){var k=s.SheetMultiRange,h=k?k.SheetName:null,nt=s.ActiveChartId,l=s.SelectionState;if(l===5&&k)i.a.e()&&h&&(i.a.e().f(h)?i.f(h):(tt=null,tt=function(){i.a.e().f(h)&&(Diag.a.a(593900563,0,50,"Sheets item add event handler called"),i.f(h),i.a.e().r(tt))},i.a.e().p(tt),i.a.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")&&(it=null,it=function(){i.a.e().f(h)&&(i.f(h),i.a.e().o(it))},i.a.e().m(it))));else if(l===6||l===7||l===8){if(k&&(a=_Ewa.g.t(k.Ranges),h&&_Ewa.g.s(a,!0)))if(i.a.a(475)){var st=f.d().h(),ht=st<a.length&&a[st].i(f.c()),at=ht?f.c():a[0].e(),vt=ht?st:0;_Ewa.b.a(i.a).bL(a,vt,h,null,at,null,null,3,_Ewa.C.a,!0,!0,null,l===6,!0)}else ct=_Ewa.g.w(a[0],h),_Ewa.b.a(i.a).o(ct,null,null,null,3,_Ewa.C.a,0,!0,!0,null,l===6,!0);l===7?(nt="38.{"+nt.toUpperCase()+"}",_Ewa.L.a(i.a).c(0,nt,!0)):l===8&&_Ewa.L.a(i.a).c(2,nt,!0)}}else{var c=s.SheetRange,rt=s.ActiveChartId,ut=s.SelectionState;ut===5&&c?i.a.e()&&(i.a.e().f(c.SheetName)?i.f(c.SheetName):(ft=null,ft=function(){i.a.e().f(c.SheetName)&&(Diag.a.a(593503880,0,50,"Sheets item add event handler called"),i.f(c.SheetName),i.a.e().r(ft))},i.a.e().p(ft),i.a.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")&&(et=null,et=function(){i.a.e().f(c.SheetName)&&(i.f(c.SheetName),i.a.e().o(et))},i.a.e().m(et)))):ut===6?_Ewa.b.a(i.a).o(c,null,null,null,3,_Ewa.C.a,0,!0,!0,null,!0,!0):ut===7?(_Ewa.b.a(i.a).o(c,null,null,null,3,_Ewa.C.a,0,!0,!0,null,!1,!0),rt="38.{"+rt.toUpperCase()+"}",_Ewa.L.a(i.a).c(0,rt,!0)):ut===8&&(_Ewa.b.a(i.a).o(c,null,null,null,3,_Ewa.C.a,0,!0,!0,null,!1,!0),_Ewa.L.a(i.a).c(2,rt,!0))}if(_Ewa.e.a(s.PostProcessActions))i.g(s,t,null);else{if(!i.a.co()){i.e(v,o,"Promise not supported",null,"Promise is not supported on this browser.");i.b.a(5001,t);return}lt=_Ewa.H.b(s.PostProcessActions);i.R(lt).then(function(){return i.g(s,t,null),Promise.resolve(null)},function(n){return i.g(s,t,n),Promise.reject(n)})}}},w=this;this.c.t(r,b,function(n){w.o(p,!1,null);w.e(null,o,"Web service error",null,null);t(n)})},x:function(n,t){var o=this.d.b(n.DdaMethod.ControlId),f=_Ewa.Y.a(o,this.a),s=new _Ewa.Ql(f,n.DdaMethod.ControlId,this.d,this.a),h=_Ewa.TypeRegister.registerTypes,i={};i.ResponseHeaders=new Array(0);i.ResponseBody=new Array(1);var c=_Ewa.bf.l(n.ArrayData[3]),u=_Ewa.bf.m(c),l=new _Ewa.WacWorkbook(this.a,this.j),r=this,e=this;OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(s,h,l,n.ArrayData).then(function(n){if(!n)return r.m(!1,"The rich api executor call failed",null,u),Diag.a.a(36542158,0,10,"The rich api executor call failed"),i.ResponseStatusCode=500,r.g(i,t,null),null;var f=n;return r.m(!0,"The rich api executor call succeeded",null,u),i.ResponseStatusCode=f[0],i.ResponseBody[0]=f[2],r.g(i,t,null),null},function(n){return i.ResponseStatusCode=400,i.ResponseBody[0]=n.toString(),e.m(!1,"The rich api executor call failed",null,u),Diag.a.a(36542159,0,10,"A Excel Rich API batch execution was failed, AppId:{0}",f),e.g(i,t,null),null})},o:function(n,t,i){_Ewa.bf.g--;var r=_Ewa.bZ.a(_Ewa.v.a(),n);Diag.a.a(36763356,0,50,"Rich Api perf log -- total milliseconds used:{0}, requests pending:{1}, request result:{2}, server correlationid: {3}.",r,_Ewa.bf.g,t?"success":"false",i)},g:function(n,t,i){var u=new Array(3),e,o,f,r,s;u[0]=n.ResponseStatusCode;u[1]=_Ewa.bf.r(n.ResponseHeaders);e=new Array(0);o=!1;i&&n.ResponseBody&&(f=_Ewa.H.b(n.ResponseBody.join("")),f.Error||(r={},r.Error=i,r.TraceIds=f.TraceIds,r.ProcessedResults={},r.ProcessedResults.Results=f.Results,e[0]=_Ewa.H.a(r),o=!0));u[2]=o?e:n.ResponseBody;s=this.b.c();s.Data=u;t(s)},O:function(n,t){var i=new _Ewa.lN(this.a,this.b,this.c);i.d(n,t)},N:function(n,t){Diag.a.a(19931724,0,50,"MessageParent API called!");var r=n,u=r[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],f=this.a.b().a(_Ewa.gP,232,!1),i=f.a().d(n.DdaMethod.ControlId,u);i?(Diag.a.a(19931725,0,10,"MessageParent API Failed!"),this.b.a(i,t)):this.b.d(t)},M:function(n,t){Diag.a.a(595121570,0,50,"MessageChild API called!");var i=n,r=i[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],u=this.a.b().a(_Ewa.gP,232,!1);u.a().e(n.DdaMethod.ControlId,r);this.b.d(t)},z:function(n,t){if(this.a.a(33)||!Common.a.cl){this.b.a(OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,t);return}Diag.a.a(22071488,0,50,"GetAccessToken API called!");var i=this,r=function(r,u){var f,e,s,o;r===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(f="",f=u.a(),e=i.b.c(),s=e,s[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=f,t(e)):(o=i.d.b(n.DdaMethod.ControlId),Diag.a.a(22071489,0,10,"{0}.",{errorCode:r.toString(),appId:_Ewa.Y.a(o,i.a),storeType:o.PrimaryMarketplace.MarketplaceType}),i.b.a(r,t))},u=this;_Ewa.f.c(_Ewa.k.a(Common.Q,this.a.b(),137,this.a.i(),-2),function(t){var i=n,f=u.d.a(),e=Common.App.AppsForOffice.a.c(f,t.a());e.a(n.DdaMethod.ControlId,i.SecurityOrigin||null,i[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,i[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,i[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,r,null)},this.a.i())},B:function(n,t){var i=this;_Ewa.f.c(_Ewa.k.a(Common.Q,this.a.b(),137,this.a.i(),-2),function(){var e=i.d.a(),o=e,s=o.getOsfControl(n.DdaMethod.ControlId),f=s.getManifest(),h=f.getMarketplaceID(),r=f.getWebApplicationId(),u=f.getWebApplicationMsaId(),c=Common.Utils.a.a().a(Common.App.WopiIdentity.b),l=c.getAuthContext(h);l.then(function(n){var e=i.b.c(),o=e,f={};f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=r;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=u?u:r;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=n.get_upn();f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=n.get_userId();f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=n.get_authority();f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Common.App.WopiIdentity.c.a(n.get_authorityType());f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=n.get_isAnonymous();f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=n.get_tenantId();o[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=f;t(e)},function(n){var o=i.b.c(),s=o,f={},e=new Common.App.WopiIdentity.c;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=r;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=u?u:r;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=e.e;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=e.f;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=e.b;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=e.a;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=e.c;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=e.d;f[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=n;s[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=f;o.Error=1;t(o)})},this.a.i())},K:function(n){var t=_Ewa.b.a(this.a).a();return t.e()===16&&!!t.b().a()&&!!t.b().a().a()&&_Ewa.e.b(t.b().a().a().b,n,!0)},l:function(n,t){var i=_Ewa.b.a(this.a).a();return!t&&this.a.a(475)&&!i.d().b()?null:i.e()===1||this.K(n)?i.o():null},i:function(n,t){return(n===1||n===2||n===3)?!0:(this.b.a(1e3,t),!1)},m:function(n,t,i,r){var u={};u.a=this.a.f().UserSessionId;u.b=n;u.c=t;u.d=i;u.e=r;_Ewa.y.a().a(37,u,!1)},e:function(n,t,i,r,u){var f={};!n||!n.length||(f.ServerCorrelationId=n);isNullOrUndefined(t)||(f.Source=t);!i||!i.length||(f.ErrorType=i);!r||!r.length||(f.MessageId=r);!u||!u.length||(f.StatusDescription=u);Diag.a.a(50688452,0,50,_Ewa.H.a(f))},R:function(n){for(var r=this,t=new Promise(function(n){n(null)}),i=0;i<n.length;i++)t=this.Q(t,n[i]);return t},Q:function(n,t){var v,i,f,o,r,u,e,s,h,c,l,a,y;if(!t)return Diag.a.a(34625095,0,10,"Null PostProcessAction."),v=this,n.then(function(){return Promise.reject(_Ewa.bf.d("GeneralException",_Ewa.ClientStringManager.a().a(1490),null,0))});switch(t.actionType){case 1:case 2:i=t;f=this;n=n.then(function(){var n=$$as(_Ewa.Y,_Ewa.cd.a(f.a));if(n.Q(i.controlId)){n.S.i(i);switch(i.messageType){case 14:case 100:n.bg.m(i);break;case 11:case 12:n.bw.p(i);break;case 51:case 52:n.bu.o(i);break;case 2101:case 2102:n.bv.j(i);break;case 2e3:n.bx.k(i);break;case 2201:f.a.N()&&n.Z.j(i)}}else Diag.a.a(23941466,0,10,"OsfControl with instanceId[{0}] doesn't exist.",i.controlId);return Promise.resolve(null)});break;case 3:o=this;n=n.then(function(){return o.I(t),Promise.resolve(null)});break;case 4:r=t;u=this;n=n.then(function(){var n,t;return u.a.a(131)&&(n=_Ewa.b.a(u.a).a().c(),n.a!==r.row+1&&n.b!==r.column+1&&(t=_Ewa.g.a(_Ewa.o.a(r.row+1,r.column+1,!1),u.a),_Ewa.b.a(u.a).o(t,null,null,null,3,_Ewa.C.m,0,!0,!0,null,!1,!0)),_Ewa.fn.a(_Ewa.gq,u.a,243,242,function(n){n.a(r.row+1,r.column+1,1,!1)})),Promise.resolve(null)});break;case 7:e=t;s=this;n=n.then(function(){var n=$$as(_Ewa.Y,_Ewa.cd.a(s.a));return n.S.f(e.controlId,e.isEnableEvents),Promise.resolve(null)});break;case 5:h=this;n=n.then(function(){return h.r(t)});break;case 6:c=this;n=n.then(function(){return c.P(t)});break;case 8:l=this;n=n.then(function(){var n=new _Ewa.cw("cw32",5,null);return _Ewa.J.a(l.a).a(n),Promise.resolve(null)});break;case 9:a=this;n=n.then(function(){return a.W(t)});break;default:y=this;n=n.then(function(){return Promise.reject(_Ewa.bf.d("ApiNotFound",_Ewa.ClientStringManager.a().a(1491),null,0))})}return n},I:function(n){var r,i,t;switch(n.operationType){case 1:r=this;_Ewa.f.cw(_Ewa.k.a(_Ewa.es,this.a.b(),153,this.a.i(),-2),function(n){n.a().a(!1)},this.a.i(),3);break;case 2:i=$$as(_Ewa.Y,_Ewa.cd.a(this.a));t=i.Q(n.controlId);t&&(t.w=!0,t.R())}},r:function(n){var t=n.fileBase64;if(t&&t.length>this.a.f().CreateWorkbookMaxAllowedBase64Size)return Promise.reject(_Ewa.bf.d("InvalidArgument",_Ewa.ClientStringManager.a().a(1494),"Application.CreateWorkbook",0));var i=this,r=new Promise(function(n,r){var u=new CommonUI.d;u.g(4);u.c($a.y,$a.br,1,function(u){u!==2&&u||r(_Ewa.bf.d("OperationCancelled",_Ewa.ClientStringManager.a().a(1493),"Application.CreateWorkbook",0));var f=t?"streamBase64":"streamEmpty",e=new Common.App.NewAndOpen.UX.e("blank","agave",f,t),o=i.j.a(n,r,e);o.q()})}),u=this,f=this;return r.then(function(t){return u.h.b(n.fakeFileId,t),Promise.resolve(null)},function(n){return n?Promise.reject(n):Promise.reject(_Ewa.bf.d("GeneralException",_Ewa.ClientStringManager.a().a(1490),"Application.CreateWorkbook",0))})},P:function(n){var t=this;return new Promise(function(i,r){var u=null,e,o,f;(o=t.h.i(n.fakeFileId,e={val:u}),u=e.val,o)?(f=new CommonUI.d,f.g(4),f.c($a.y,$a.eZ,1,function(n){n===1&&_Ewa.l.d(u,null,null,"DdaMethodHandler.fileUrl");i(null)})):r(_Ewa.bf.d("GeneralException",_Ewa.ClientStringManager.a().a(1490),"Document.Open",0))})},W:function(n){var t=this;return new Promise(function(i){var u=$$as(_Ewa.Y,_Ewa.cd.a(t.a)),r;u.bj=n.runtimeCalculationMode;r=t.a.b().a(_Ewa.cg,268,!1);r&&r.B(n.runtimeCalculationMode===3);i(null)})},f:function(n){var t=$$as(_Ewa.E,this.a.e().b(n));t&&!t.h&&t.g(!0)}};_Ewa.lN=function(n,t,i){this.a=n;this.b=t;this.c=i};_Ewa.lN.a=function(n,t){n.LastRow=t===2?n.FirstRow:n.LastRow;n.LastColumn=t===2?n.FirstColumn:n.LastColumn};_Ewa.lN.prototype={b:null,c:null,a:null,d:function(n,t){var r=n.DdaGoToByIdMethod.GoToType,u=n.DdaGoToByIdMethod.SelectionMode,f=n.DdaGoToByIdMethod.Id.toString().trim(),i=this,e=function(n){var r=i.a.e().b(n.SheetName);r&&!r.h?(_Ewa.b.a(i.a).o(n,null,null,null,3,_Ewa.C.n,0,!0,!0,null,!0,!0),i.b.d(t)):i.b.a(7001,t)};r?r===1?this.f(f,u,e,t):this.b.a(5007,t):this.e(f,u,n.DdaMethod.ControlId,e,t)},e:function(n,t,i,r,u){var f=this,e=function(e){var s,o,h;if(_Ewa.S.a(e)||!e.Result||!e.Result.Reference){f.b.a(7002,u);return}if(s=e.Result,o={},o.SheetName=s.Reference.SheetName,o.FirstRow=s.Reference.FirstRow,o.FirstColumn=s.Reference.FirstColumn,o.LastRow=s.Reference.LastRow,o.LastColumn=s.Reference.LastColumn,_Ewa.lN.a(o,t),s.BindingType!==1){r(o);return}h=function(n,i,e){if(_Ewa.S.a(n)||!n.Result)f.b.b(n,e,u);else{var s=n.Result;t!==2&&(o.FirstRow-=s.Headers.length,o.FirstRow<0&&(o.FirstRow=0));r(o)}};f.c.g(i,n,1,0,2,0,0,-1,-1,h,u)};this.c.f(i,n,e,u)},f:function(n,t,i,r){var o=_Ewa.g.n(n),u,f,e;if(o){u=_Ewa.g.a(o,this.a);_Ewa.lN.a(u,t);i(u);return}if(this.a.c().b()&&this.a.n().f(n)){this.a.n().l(this.a.n().b(n));return}f=this;e=function(u){var e,o;_Ewa.S.a(u)||!u.Result?f.a.e().B(n)?(e={},e.SheetName=n,e.FirstRow=0,e.FirstColumn=0,e.LastRow=0,e.LastColumn=0,i(e)):f.b.a(7002,r):(o=u.Result,_Ewa.lN.a(o,t),i(o))};this.a.e().a()?this.c.x(n,this.a.e().a().a,e,r):this.c.w(n,e,r)}};_Ewa.gm=function(n,t,i,r,u,f,e,o){_Ewa.gm.initializeBase(this,[10,0,t,o]);this.y=n;this.F=i;this.E=r;this.G=u;this.H=f;this.z=e};_Ewa.gm.b=function(){return _Ewa.gm.a||(_Ewa.gm.a=new($$sc.q.$$(String))($$sc.e.a()),_Ewa.gm.a.a("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),_Ewa.gm.a.a("FA000000014")),_Ewa.gm.a};_Ewa.gm.c=function(n){var i=null,r,t;if(!n)return i;for(r="X-OfficeScriptEventId".toLowerCase(),t=0;t<n.length;t++)if(n[t].Name.toLowerCase()===r){i=n[t].Value;break}return i};_Ewa.gm.prototype={z:null,F:null,E:null,G:null,H:null,y:null,g:function(){return 2},C:function(){return this.H},O:function(){return this.F},N:function(){return this.E},Q:function(){return this.y.N()&&this.y.a(12)},n:function(n){return _Ewa.gT.prototype.n.call(this,n)||this.P(n)},R:function(n){if(isNullOrUndefined(n)||isNullOrUndefined(n.RequestBody))return null;var t=JSON.parse(n.RequestBody);return isNullOrUndefined(n.ActiveChartId)||(t.ActiveChartId=n.ActiveChartId),this.y.isChangeGateEnabled("OfficeVSO:4040030_RichApiGetSelectedRanges")?isNullOrUndefined(n.SheetMultiRange)||(t.SheetName=n.SheetMultiRange.SheetName):isNullOrUndefined(n.SheetRange)||(t.SheetName=n.SheetRange.SheetName),t},S:function(n){if(isNullOrUndefined(n)||isNullOrUndefined(n.Result))return null;var t=n.Result;return isNullOrUndefined(t.ResponseBody)?null:t.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(t.ResponseBody.join(""))},T:function(n){return!!n&&!isNullOrUndefined(n.a)&&n.a.length>0},o:function(){var n=this;return function(){var r=n.I(n.z),t,i,u;if(n.T(r)){if(t=n.R(n.z),i=n.S(n.K),t&&!Common.S.a(t)&&i&&!Common.S.a(i))return new _Ewa.gd(r,t,i);u=String.format("requestInfo: {0}; responseInfo: {1}",t?"(not null)":"(null)",i?"(not null)":"(null)")}return new _Ewa.gd(null,null,null)}},x:function(){var n={};return n.OperationType=2,n.RichApiRequest=this.z,n},P:function(n){var t=this;return function(i,r){return _Ewa.dA.a(n,t.z,_Ewa.n.a(i,t.F),_Ewa.n.b(r,t.E),t.G)}},I:function(n){var i,t;if(!this.Q())return null;var r=$$as(_Ewa.Y,_Ewa.cd.a(this.y)),u=r.Z.i(),f=r.Z.b>0;if(u&&f){if(i=this.U(n.SolutionId),t=_Ewa.gm.c(n.RequestHeaders),t&&i)return Diag.a.a(594105038,0,50,"DdaMethodHandler: {0}",{recorderEventId:t,"request.SolutionId":n.SolutionId}),new _Ewa.Hr(n.SolutionId,t);Diag.a.a(594105037,0,50,"DdaMethodHandler: {0}",{recorderEventId:t,isRecorderAwareAddin:i,"request.SolutionId":n.SolutionId})}else Diag.a.a(594105036,0,50,"DdaMethodHandler: {0}.",{isRecorderLoaded:u,isRecorderListening:f});return null},U:function(n){return _Ewa.gm.b().b(n)}};_Ewa.Ao=function(n,t){this.b=Function.createDelegate(this,this.v);this.a=n;this.e=t};_Ewa.Ao.prototype={e:null,a:null,h:function(n,t,i,r,u,f,e){var o=this;this.c(function(s,h){return _Ewa.dA.c(o.a.d().a(),n,t,i,o.d(),r,u,_Ewa.n.a(s,f),_Ewa.n.b(h,o.b),e)},0)},o:function(n,t,i,r){var u=this;this.c(function(f,e){return _Ewa.dA.k(u.a.d().a(),n,t,_Ewa.n.a(f,i),_Ewa.n.b(e,u.b),r)},0)},f:function(n,t,i,r){var u=this;this.c(function(f,e){return _Ewa.dA.h(u.a.d().a(),n,t,_Ewa.n.a(f,i),_Ewa.n.b(e,u.b),r)},16)},l:function(n,t,i){var r=this;this.c(function(u,f){return _Ewa.dA.g(r.a.d().a(),n,_Ewa.n.a(u,t),_Ewa.n.b(f,r.b),i)},16)},g:function(n,t,i,r,u,f,e,o,s,h,c){var l=this;this.c(function(a,v){return _Ewa.dA.i(l.a.d().a(),n,t,i,r,u,f,e,o,s,l.d(),_Ewa.n.a(a,h),_Ewa.n.b(v,l.b),c)},16)},q:function(n,t,i,r,u,f,e){var o=this;this.c(function(s,h){return _Ewa.dA.m(o.a.d().a(),n,t,i,r,o.d(),u,_Ewa.n.a(s,f),_Ewa.n.b(h,o.b),e)},0)},m:function(n,t,i,r,u,f,e){var o=this;this.c(function(s,h){return _Ewa.dA.j(o.a.d().a(),n,t,i,r,o.d(),u,_Ewa.n.a(s,f),_Ewa.n.b(h,o.b),e)},16)},s:function(n,t,i,r,u){var f=this;this.c(function(e,o){return _Ewa.dA.o(f.a.d().a(),n,f.d(),t,i,_Ewa.n.a(e,r),_Ewa.n.b(o,f.b),u)},0)},n:function(n,t,i){var r=this;this.c(function(u,f){return _Ewa.dA.b(r.a.d().a(),n,_Ewa.n.a(u,t),_Ewa.n.b(f,r.b),i)},16)},p:function(n,t,i,r,u){var f=this;this.c(function(e,o){return _Ewa.dA.l(f.a.d().a(),n,t,i,_Ewa.n.a(e,r),_Ewa.n.b(o,f.b),u)},0)},i:function(n,t,i,r,u,f){var e=this;this.c(function(o,s){return _Ewa.dA.d(e.a.d().a(),n,t,i,e.d(),r,_Ewa.n.a(o,u),_Ewa.n.b(s,e.b),f)},0)},k:function(n,t,i,r){var u=this;this.c(function(f,e){return _Ewa.dA.f(u.a.d().a(),n,t,u.d(),_Ewa.n.a(f,i),_Ewa.n.b(e,u.b),r)},0)},j:function(n,t,i,r){var u=this;this.c(function(f,e){return _Ewa.dA.e(u.a.d().a(),n,t,u.d(),_Ewa.n.a(f,i),_Ewa.n.b(e,u.b),r)},0)},r:function(n,t,i,r,u,f){var e=this;this.c(function(o,s){return _Ewa.dA.n(e.a.d().a(),n,t,e.d(),i,r,_Ewa.n.a(o,u),_Ewa.n.b(s,e.b),f)},0)},w:function(n,t,i){var r=this;this.c(function(u,f){var e=r.a.d().a().b(!1);return _Ewa.i.e(r.a.d().a(),n,-1,_Ewa.n.a(u,t),_Ewa.n.b(f,r.b),i,e)},16)},x:function(n,t,i,r){var u=this;this.c(function(f,e){var o=u.a.d().a().b(!1);return _Ewa.i.u(u.a.d().a(),n,t,_Ewa.n.a(f,i),_Ewa.n.b(e,u.b),r,o)},16)},t:function(n,t,i){var u,r;this.a.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(n.RequestFlags=n.RequestFlags&4095);this.a.a(330)?(u=this,this.u(this.a.d().a().b(!1),t,function(){u.e.a(5001,i)},i,n)):(r=this,this.c(function(u,f){return _Ewa.dA.a(r.a.d().a(),n,_Ewa.n.a(u,t),_Ewa.n.b(f,r.b),i)},_Ewa.Y.e(n,this.a)))},d:function(){return this.a.c().b()?this.a.j().d:this.a.S()},v:function(n,t){this.e.a(5001,t)},c:function(n,t){this.a.g().d(new _Ewa.bd(520,0,n,t,null))},u:function(n,t,i,r,u){var f=this.a.o().a("UserAction","Rich Api request");this.a.g().a(new _Ewa.gm(this.a,n,t,i,r,f,u,_Ewa.Y.e(u,this.a)),null)}};_Ewa.Ap=function(n,t,i,r){this.a=n;this.c=t;this.d=i;this.b=r};_Ewa.Ap.prototype={a:0,c:0,d:0,b:null};_Ewa.fB=function(n){this.a={};this.c=n};_Ewa.fB.a=function(n){return n.b().a(_Ewa.fB,200,!1)||n.b().b(_Ewa.fB,200,new _Ewa.fB(_Ewa.fB.c))};_Ewa.fB.prototype={c:0,a:null,d:function(n,t){return(this.b(n)||(this.a[n]={}),this.f(n))?(Diag.a.a(8946273,344,50,"App {0} has reach the limit of number of cached files.",n),11e3):(this.a[n][t.a.toString()]=t,0)},e:function(n,t){var i=null;return this.b(n)&&(i=this.a[n][t.toString()]),i||Diag.a.a(8946274,344,15,"File cache for [agave:{0}, fileHandler:{1}] doesn't exist",n,t),i},b:function(n){return n in this.a},g:function(n,t){if(this.b(n)){var i=this.a[n];return delete i[t.toString()],Object.keys(i).length<1&&delete this.a[n],t.toString()in i?5001:0}return 5001},f:function(n){if(!this.b(n))return!1;var t=this.a[n];return Object.keys(t).length>=this.c}};_Ewa.AppRuntimeService=function(n,t){this.a=t;this.b=n};_Ewa.AppRuntimeService.prototype={b:null,a:null,getAppRuntimeState:function(){var n=this.a.C(this.b);return n?2:1},setAppRuntimeState:function(n){var t=!0;switch(n){case 2:t=!0;break;case 1:t=!1;break;case 0:default:throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument",_Ewa.ClientStringManager.a().a(1494));}this.a.K(this.b,t)},getTypeName:function(){return"Microsoft.AppRuntime.AppRuntimeService"},invokePropertyGet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n,t){switch(n){case 2:return this.getAppRuntimeState();case 1:return this.c(t)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},c:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"int");return this.setAppRuntimeState(t),null}};_Ewa.IdentityType=function(){};_Ewa.IdentityType.prototype={organizationAccount:0,microsoftAccount:1};_Ewa.IdentityType.registerEnum("_Ewa.IdentityType",!1);_Ewa.AuthenticationService=function(n,t){var i=t;this.a=i;this.b=n};_Ewa.AuthenticationService.prototype={a:null,b:null,getAccessToken:function(n){var i=this.a.getOsfControl(this.b),r=i.getManifest(),t=r.getMarketplaceID();this.g(n,t);var u=this,f=function(f,e){if(!i.isFirstParty()||!u.a._enableFirstPartySSO){e("ApiNotAvailable");return}if(!u.e(r,n)){e("AccessDenied");return}var o=Common.Utils.a.a().a(Common.App.WopiIdentity.b),s=n,h=o.getAccessToken(s,t);h.then(function(n){f(n)},function(n){e(n)})},e=OfficeExtension.WacRuntime.Utility.createPromise(f),s=this,o=this;return e.then(function(n){var i=n,t;switch(i.get_authority()){case"OneDriveWOPI":t=1;break;case"SharepointOnline":case"ExchangeOnline":default:t=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new _Ewa.SingleSignOnToken(i.get_accessToken(),t))},function(i){var r,u;return(o.f(n,t,i),i)?(r=i,u=OfficeExtension.WacRuntime.Utility.createPromise(function(n,t){t(OfficeExtension.WacRuntime.Utility.createRichApiException(r,_Ewa.iS.a(r)))}),u):OfficeExtension.WacRuntime.Utility.createPromise(function(n,t){t(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",_Ewa.iS.a("GeneralException")))})})},getPrimaryIdentityInfo:function(){var n=this.a.getOsfControl(this.b),u=n.getManifest(),t=n.getManifest().getMarketplaceID(),f=this,i=function(n,i){var r=Common.Utils.a.a().a(Common.App.WopiIdentity.b),u=r.getPrimaryIdentityInfo(t);u.then(function(t){n(t)},function(n){i(n.toString())})},r=OfficeExtension.WacRuntime.Utility.createPromise(i),e=this,o=this;return r.then(function(n){var t=_Ewa.OfficeIdentityInfo.a(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},function(n){var t,i;return n?(t=n,i=OfficeExtension.WacRuntime.Utility.createPromise(function(n,i){i(OfficeExtension.WacRuntime.Utility.createRichApiException(t,_Ewa.iS.a(t)))}),i):OfficeExtension.WacRuntime.Utility.createPromise(function(n,t){t(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",_Ewa.iS.a("GeneralException")))})})},getTypeName:function(){return"Microsoft.Authentication.AuthenticationService"},invokePropertyGet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){switch(n){case 1:return this.d(t);case 2:return this.getPrimaryIdentityInfo()}var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},d:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"_Ewa.TokenParameters");return this.getAccessToken(t)},e:function(n,t){for(var u,l,i,e,y,s=!1,p=n.getWebApplicationAuthorizations(),h=null,c=p,w=c.length,r=0;r<w;++r)if(u=c[r],u.getResource().toLowerCase()===t.a.toLowerCase()){h=u;s=!0;break}if(!s)return!1;l=t.b.split(" ,+");for(var a=l,b=a.length,f=0;f<b;++f)if(i=a[f],i&&i.length){e=!1;for(var v=h.getScopes(),k=v.length,o=0;o<k;++o)y=v[o],i.toLowerCase()===y.toLowerCase()&&(e=!0);if(!e)return!1}return!0},g:function(n,t){var i=this.c(n.a);Diag.a.a(39105299,369,50,"{0}",{manifestId:t,resource:i})},f:function(n,t,i){var r=this.c(n.a);Diag.a.a(39105300,369,10,"{0}",{manifestId:t,resource:r,error:i})},c:function(n){return n.replace("://","__").replace(new RegExp("\\.","g"),"_dot_").replace("/","\\")}};_Ewa.CustomFunctionEngineStatus=function(){};_Ewa.CustomFunctionEngineStatus.prototype={a:!1,b:!1,c:!1,get_enabled:function(){return this.a},set_enabled:function(n){return this.a=n,n},get_nativeRuntime:function(){return this.b},set_nativeRuntime:function(n){return this.b=n,n},get_streamingEnabled:function(){return this.c},set_streamingEnabled:function(n){return this.c=n,n},getTypeName:function(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"},invokePropertyGet:function(n){switch(n){case 1:return this.a;case 3:return this.b;case 2:return this.c}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n,t){switch(n){case 1:this.a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;case 3:this.b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return;case 2:this.c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)}};_Ewa.CustomFunctionManager=function(n,t,i){this.b=n;this.a=t;this.c=i};_Ewa.CustomFunctionManager.prototype={b:null,a:null,c:null,get_status:function(){var n=new _Ewa.CustomFunctionEngineStatus;return n.a=this.a.a(158),n.c=this.a.a(161),n.b=!1,n},register:function(n){var t=this,i=function(i,r){_Ewa.f.cw(_Ewa.k.a(_Ewa.dE,t.a.b(),279,t.a.i(),-2),function(u){var h=u.a(),e=!1,f,s;if(t.a.isChangeGateEnabled("OfficeVSO:3738713_SharedAppCustomFunctionDynamicRegistrationKeepControl")){var c=t.c.a(),l=c,o=l.getOsfControl(t.b);o&&(f=o.getManifest(),f&&(s=f.getSharedRuntimeForCustomFunctions("Workbook"),s&&(e=!0)))}_Ewa.f.cw(h.b(t.b,n,e),function(n){if(_Ewa.cr.a(n)){var t=n.a();t?i(null):r(OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument",_Ewa.ClientStringManager.a().a(1494)))}else r(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",_Ewa.ClientStringManager.a().a(1490)))},t.a.i(),3)},t.a.i(),3)};return OfficeExtension.WacRuntime.Utility.createPromise(i)},getTypeName:function(){return"Microsoft.ExcelServices.CustomFunctionManager"},invokePropertyGet:function(n){switch(n){case 2:return this.get_status()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){switch(n){case 1:return this.d(t)}var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},d:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string"),i=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,1,"string");return this.register(t,i)}};_Ewa.DynamicRibbon=function(n,t,i,r){this.d=n;this.f=t;this.b=i;this.g=r;var u=this.g.a();this.e=u;this.a=this.e.getOsfControl(this.f);this.c=this.a.getManifest()};_Ewa.DynamicRibbon.prototype={d:null,f:null,b:null,g:null,e:null,a:null,c:null,get_buttons:function(){return null},executeRequestUpdate:function(){return null},getButton:function(n){var t=null,i;if(!this.j())return this.h();if(!(!n||!n.length)){if(i=this.c.getRibbonExtensionControlMap(),!(n in i))return this.i(n);t=new _Ewa.RibbonButton(n,this.d,this.b)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},getTab:function(n){var t=null,i;if(this.j()){if(this.a.getOwnerAddinControlRecreated())return this.k()}else return this.h();if(!(!n||!n.length)){if(i=this.c.getRibbonExtensionControlMap(),!(n in i))return this.i(n);t=new _Ewa.RibbonTab(n,this.d,this.b)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},_OnAccess:function(){return},getTypeName:function(){return"Microsoft.DynamicRibbon.DynamicRibbon"},invokePropertyGet:function(n){switch(n){case 4:return null}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){switch(n){case 1:return null}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){switch(n){case 6:return this.l(t);case 3:return this.m(t);case 5:return this.n(t)}var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},l:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return null},m:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return this.getButton(t)},n:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return this.getTab(t)},i:function(n){return _Ewa.qp.a("ControlIdNotFound",_Ewa.ClientStringManager.a().a(1495)+n)},h:function(){return _Ewa.qp.a("RibbonApiNotAvailable",_Ewa.ClientStringManager.a().a(1492))},k:function(){return _Ewa.qp.a("HostRestartNeeded",_Ewa.ClientStringManager.a().a(1496))},j:function(){return this.b.a(776)?!_Ewa.e.a(this.a.getSharedRuntimeId())&&_Ewa.r.a():!0}};_Ewa.TypeRegister=function(){};_Ewa.TypeRegister.registerTypes=function(n){var t,i,r;t=n.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);i=t.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook");i.addParameter("base64File","String",1,null);t=n.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);i=t.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState");i=t.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState");i.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null);t=n.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);r=t.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null);i=t.addMethod("Register",1,"Void",0,0,"Register");i.addParameter("metadata","String",1,null);i.addParameter("javascript","String",1,null);t=n.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);r=t.addProperty("Enabled",1,"Boolean",1,!1,null);r=t.addProperty("NativeRuntime",3,"Boolean",1,!1,null);r=t.addProperty("StreamingEnabled",2,"Boolean",1,!1,null);t=n.addEnumType("Microsoft.Authentication.IdentityType");t.addEnumField("OrganizationAccount",0);t.addEnumField("MicrosoftAccount",1);t=n.addEnumType("Microsoft.Authentication.AuthorityType");t.addEnumField("External",0);t.addEnumField("Msa",1);t.addEnumField("Aad",2);t=n.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);r=t.addProperty("DisplayName",4,"String",1,!1,null);r=t.addProperty("Email",3,"String",1,!1,null);r=t.addProperty("FederationProvider",2,"String",1,!1,null);r=t.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null);t=n.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);r=t.addProperty("AppId",4,"String",1,!1,null);r=t.addProperty("Authority",2,"String",1,!1,null);r=t.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null);r=t.addProperty("IsAnonymous",5,"Boolean",1,!1,null);r=t.addProperty("TenantId",6,"String",1,!1,null);r=t.addProperty("Upn",1,"String",1,!1,null);t=n.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);r=t.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null);i=t.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken");i.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null);i=t.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext");i=t.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo");t=n.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);r=t.addProperty("AuthChallenge",3,"String",1,!1,null);r=t.addProperty("Policy",4,"String",1,!1,null);r=t.addProperty("Resource",2,"String",1,!1,null);t=n.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);r=t.addProperty("AccessToken",2,"String",1,!1,null);r=t.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null);t=n.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);r=t.addProperty("Id",1,"String",1,!0,null);r=t.addProperty("Value",2,"Object",1,!1,null);t=n.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);i=t.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item");i.addParameter("id","String",1,null);i=t.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject");i.addParameter("id","String",1,null);t=n.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);i=t.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState");i=t.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState");i.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null);t=n.addEnumType("Microsoft.AppRuntime.AppRuntimeState");t.addEnumField("Inactive",0);t.addEnumField("Background",1);t.addEnumField("Visible",2);t=n.addEnumType("Microsoft.AppRuntime.Visibility");t.addEnumField("Hidden",1);t.addEnumField("Visible",2);t=n.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);r=t.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null);i=t.addMethod("ExecuteRequestUpdate",6,"Microsoft.DynamicRibbon.RibbonButton",3,0,"ExecuteRequestUpdate");i.addParameter("jsonUpdate","String",1,null);i=t.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,0,"Button");i.addParameter("id","String",1,null);i=t.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,0,"Tab");i.addParameter("id","String",1,null);i=t.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess");t=n.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);r=t.addProperty("Id",2,"String",1,!0,null);i=t.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility");i.addParameter("visibility","Boolean",1,null);i=t.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess");t=n.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);r=t.addProperty("Enabled",3,"Boolean",1,!1,null);r=t.addProperty("Id",2,"String",1,!0,null);r=t.addProperty("Label",4,"String",1,!0,null);i=t.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled");i.addParameter("enabled","Boolean",1,null);i=t.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess");t=n.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);i=t.addMethod("GetCount",3,"Int32",1,1,"Count");i=t.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3);i.addParameter("key","String",1,null);i=t.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess");t.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0)};_Ewa.OfficeIdentityInfo=function(){};_Ewa.OfficeIdentityInfo.a=function(n){var t=new _Ewa.OfficeIdentityInfo;t.b=n.get_displayName();t.c=n.get_email();switch(n.get_authority()){case"OneDriveWOPI":t.a=1;break;case"SharepointOnline":case"ExchangeOnline":default:t.a=0}return t.d="",t};_Ewa.OfficeIdentityInfo.prototype={b:null,c:null,d:null,a:0,get_displayName:function(){return this.b},set_displayName:function(n){return this.b=n,n},get_email:function(){return this.c},set_email:function(n){return this.c=n,n},get_federationProvider:function(){return this.d},set_federationProvider:function(n){return this.d=n,n},get_identityType:function(){return this.a},set_identityType:function(n){return this.a=n,n},getTypeName:function(){return"Microsoft.Authentication.OfficeIdentityInfo"},invokePropertyGet:function(n){switch(n){case 4:return this.b;case 3:return this.c;case 2:return this.d;case 1:return this.a}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n,t){switch(n){case 4:this.b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 3:this.c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 2:this.d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 1:this.a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)}};_Ewa.RibbonButton=function(n,t,i){this.b=n;this.d=t;this.c=i};_Ewa.RibbonButton.prototype={b:null,d:null,c:null,a:!1,get_enabled:function(){return this.a},set_enabled:function(n){this.a=n;var t={DynamicAddinCommandsMethodDispatchId:1,SolutionId:this.d,SourceControlId:this.b,MethodData:this.a};return _Ewa.cd.a(this.c).X(-1014260128,t,!0),n},get_id:function(){return this.b},get_label:function(){return null},setEnabled:function(){return},_OnAccess:function(){return},getTypeName:function(){return"Microsoft.DynamicRibbon.RibbonButton"},invokePropertyGet:function(n){switch(n){case 3:return this.a;case 2:return this.b;case 4:return null}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n,t){switch(n){case 3:this.set_enabled(OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean"));return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n,t){switch(n){case 5:return this.e(t);case 1:return null}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},e:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return null}};_Ewa.RibbonButtonCollection=function(){};_Ewa.RibbonButtonCollection.prototype={getCount:function(){return 0},getItem:function(){return null},_OnAccess:function(){return},getAsyncEnumerator:function(){return null},getTypeName:function(){return"Microsoft.DynamicRibbon.RibbonButtonCollection"},invokePropertyGet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n,t){switch(n){case 3:return 0;case 2:return this.a(t);case 1:return null}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},a:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return null}};_Ewa.RibbonTab=function(n,t,i){this.a=n;this.c=t;this.b=i};_Ewa.RibbonTab.prototype={a:null,c:null,b:null,get_id:function(){return this.a},setVisibility:function(n){var t={DynamicAddinCommandsMethodDispatchId:2,SolutionId:this.c,SourceControlId:this.a,MethodData:n};_Ewa.cd.a(this.b).X(-1014260128,t,!0)},_OnAccess:function(){return},getTypeName:function(){return"Microsoft.DynamicRibbon.RibbonTab"},invokePropertyGet:function(n){switch(n){case 2:return this.a}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n,t){switch(n){case 3:return this.d(t);case 1:return null}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},d:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return this.setVisibility(t),null}};_Ewa.RibbonTabCollection=function(){};_Ewa.RibbonTabCollection.prototype={getCount:function(){return 0},getItem:function(){return null},_OnAccess:function(){return},getAsyncEnumerator:function(){return null},getTypeName:function(){return"Microsoft.DynamicRibbon.RibbonTabCollection"},invokePropertyGet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n,t){switch(n){case 5:return 0;case 4:return this.a(t);case 1:return null}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},a:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return null}};_Ewa.SingleSignOnToken=function(n,t){this.a=n;this.b=t};_Ewa.SingleSignOnToken.prototype={a:null,b:0,get_accessToken:function(){return this.a},set_accessToken:function(n){return this.a=n,n},get_tokenIdenityType:function(){return this.b},set_tokenIdenityType:function(n){return this.b=n,n},getTypeName:function(){return"Microsoft.Authentication.SingleSignOnToken"},invokePropertyGet:function(n){switch(n){case 2:return this.a;case 3:return this.b}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n,t){switch(n){case 2:this.a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 3:this.b=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)}};_Ewa.TokenParameters=function(){this.b="";this.e=!0;this.d=null};_Ewa.TokenParameters.prototype={c:null,a:null,b:null,get_scope:function(){return this.b},set_scope:function(n){return this.b=n,n},e:!1,get_silentLogin:function(){return this.e},set_silentLogin:function(n){return this.e=n,n},d:null,get_options:function(){return this.d},set_options:function(n){return this.d=n,n},get_authChallenge:function(){return this.c},set_authChallenge:function(n){return this.c=n,n},get_policy:function(){return null},set_policy:function(n){return n},get_resource:function(){return this.a},set_resource:function(n){return this.a=n,n},getTypeName:function(){return"Microsoft.Authentication.TokenParameters"},invokePropertyGet:function(n){switch(n){case 3:return this.c;case 4:return null;case 2:return this.a}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n,t){switch(n){case 3:this.c=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 4:OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return;case 2:this.a=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)}};_Ewa.WacWorkbook=function(n,t){this.a=n;this.b=t};_Ewa.WacWorkbook.prototype={a:null,b:null,createAndOpenWorkbook:function(n){if(n&&n.length>this.a.f().CreateWorkbookMaxAllowedBase64Size){Diag.a.a(38372609,0,15,"Too large base64 stream size:{0}",n.length);throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument",_Ewa.ClientStringManager.a().a(1494));}var i=n?"streamBase64":"streamEmpty",r=new Common.App.NewAndOpen.UX.e("blank","agave",i,n),t=null,u=this,f=function(n,i){var f=new CommonUI.d;f.g(4);f.c($a.y,$a.br,1,function(f){if(f===2||!f){i("Cancelled");return}t=window.open("");var e=u.b.a(n,i,r);e.q()})},e=OfficeExtension.WacRuntime.Utility.createPromise(f),s=this,o=this;return e.then(function(n){if(!n)throw OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",_Ewa.ClientStringManager.a().a(1490));try{t.top.location.href=n}catch(i){Diag.a.a(38630593,0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}, stack:{2}",Common.c.f(),i,_Ewa.ca.a(!0,null));Diag.a.a(38630594,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace");t.location.replace(n)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},function(n){if(n==="Cancelled")throw OfficeExtension.WacRuntime.Utility.createRichApiException("OperationCancelled",_Ewa.ClientStringManager.a().a(1493));return t.close(),o.d(),null})},getTypeName:function(){return"Microsoft.ExcelServices.WacWorkbook"},invokePropertyGet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertyGetAsync:function(n){var t=this.invokePropertyGet(n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)},invokePropertySet:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokePropertySetAsync:function(n,t){return this.invokePropertySet(n,t),OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},invokeMethod:function(n){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(n);},invokeMethodAsync:function(n,t){switch(n){case 1:return this.c(t)}var i=this.invokeMethod(n,t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(i)},c:function(n){var t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"string");return this.createAndOpenWorkbook(t)},d:function(){throw OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",_Ewa.ClientStringManager.a().a(1490));}};_Ewa.qo=function(){};_Ewa.qo.prototype={a:function(n,t){return new _Ewa.AuthenticationService(n,t)}};_Ewa.iS=function(){};_Ewa.iS.a=function(n){return n in _Ewa.iS.b?_Ewa.iS.b[n].toString():n};_Ewa.qp=function(){};_Ewa.qp.a=function(n,t){return OfficeExtension.WacRuntime.Utility.createPromise(function(i,r){r(OfficeExtension.WacRuntime.Utility.createRichApiException(n,t))})};_Ewa.Ql=function(n,t,i,r){this.b=n;this.c=t;this.a=i;this.d=r};_Ewa.Ql.prototype={b:null,c:null,a:null,d:null,hostName:function(){return"ExcelOnline"},appId:function(){return this.b},createInstance:function(n){switch(n){case"Microsoft.Authentication.AuthenticationService":var t=Common.Utils.a.a().a(_Ewa.qo),i=this.a.a(),r=i;return t.a(this.c,r);case"Microsoft.Authentication.TokenParameters":return new _Ewa.TokenParameters;case"Microsoft.ExcelServices.CustomFunctionManager":return new _Ewa.CustomFunctionManager(this.b,this.d,this.a);case"Microsoft.AppRuntime.AppRuntimeService":return new _Ewa.AppRuntimeService(this.c,this.a);case"Microsoft.DynamicRibbon.DynamicRibbon":return new _Ewa.DynamicRibbon(this.b,this.c,this.d,this.a)}Diag.a.a(36542161,0,10,"Typename: {0} is an invalid parameter for the RichApiHost.CreateInstance method.",n);throw OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","GeneralException");}};_Ewa.ri.registerClass("_Ewa.ri",_Ewa.ba);_Ewa.Am.registerClass("_Ewa.Am",_Ewa.bY);_Ewa.bf.registerClass("_Ewa.bf",null,_Ewa.jK,Sys.IDisposable);_Ewa.gm.registerClass("_Ewa.gm",_Ewa.gT);_Ewa.Ap.registerClass("_Ewa.Ap");_Ewa.fB.registerClass("_Ewa.fB");_Ewa.AppRuntimeService.registerClass("_Ewa.AppRuntimeService");_Ewa.AuthenticationService.registerClass("_Ewa.AuthenticationService");_Ewa.CustomFunctionEngineStatus.registerClass("_Ewa.CustomFunctionEngineStatus");_Ewa.CustomFunctionManager.registerClass("_Ewa.CustomFunctionManager");_Ewa.DynamicRibbon.registerClass("_Ewa.DynamicRibbon");_Ewa.TypeRegister.registerClass("_Ewa.TypeRegister");_Ewa.OfficeIdentityInfo.registerClass("_Ewa.OfficeIdentityInfo");_Ewa.RibbonButton.registerClass("_Ewa.RibbonButton");_Ewa.RibbonButtonCollection.registerClass("_Ewa.RibbonButtonCollection");_Ewa.RibbonTab.registerClass("_Ewa.RibbonTab");_Ewa.RibbonTabCollection.registerClass("_Ewa.RibbonTabCollection");_Ewa.SingleSignOnToken.registerClass("_Ewa.SingleSignOnToken");_Ewa.TokenParameters.registerClass("_Ewa.TokenParameters",null,Common.App.WopiIdentity.i);_Ewa.WacWorkbook.registerClass("_Ewa.WacWorkbook");_Ewa.qo.registerClass("_Ewa.qo");_Ewa.bf.a=null;_Ewa.bf.b=null;_Ewa.bf.c=null;_Ewa.bf.g=0;_Ewa.gm.a=null;_Ewa.fB.c=1;_Ewa.fB.b=0;_Ewa.iS.b={GeneralException:"GeneralException",AccessDenied:"AccessDenied",ApiNotAvailable:"ApiNotAvailable",UserNotSignedIn:"UserNotSignedIn",UserAborted:"UserAborted",UnsupportedUserIdentity:"UnsupportedUserIdentity",InvalidResourceUrl:"InvalidResourceUrl",InvalidGrant:"InvalidGrant",AddinIsAlreadyRequestingToken:"AddinIsAlreadyRequestingToken",ResourceNotAllowed:"ResourceNotAllowed",ClientError:"ClientError",ServerError:"ServerError"};_Ewa.TZ.a()}catch(e){typeof _Ewa!="undefined"&&typeof _Ewa.ULSError!="undefined"&&typeof _Ewa.ULSError.sendErrorTraceTag!="undefined"&&_Ewa.ULSError.sendErrorTraceTag(e.message,e.stack,null,0,0);throw e;}